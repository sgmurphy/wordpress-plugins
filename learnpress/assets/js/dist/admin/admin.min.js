!function(e){const t=function(t){const a=e(this).addClass("disabled");t.preventDefault(),e.post({url:a.attr("href"),data:{"lp-ajax":"create-pages"},dataType:"text",success:function(e){const t=a.closest(".lp-notice").html("<p>"+e+"</p>");setTimeout((function(){t.fadeOut()}),2e3)}})};e.fn._filter_post_by_author=function(){const t=e("#post-search-input");if(!t.length)return;const a=e(t[0].form),l=e('<select name="author" id="author"></select>').insertAfter(t).select2({ajax:{url:window.location.href+"&lp-ajax=search-authors",dataType:"json",s:""},placeholder:wp.i18n.__("Search by user","learnpress"),minimumInputLength:3,allowClear:!0}).on("select2:select",(function(){e('input[name="author"]').val(l.val())}));a.on("submit",(function(){window.location.href.removeQueryVar("author").addQueryVar("author",l.val())}))};const a=()=>{e(".lp-meta-box__file").each(((t,a)=>{let l;const i=e(a).find(".lp-meta-box__file_input"),o=e(a).find(".lp-meta-box__file_list"),s=e(a).find(".btn-upload"),n=!!e(a).data("multil");e(s).on("click",(e=>{e.preventDefault(),l||(l=wp.media({states:[new wp.media.controller.Library({filterable:"all",multiple:n})]}),l.on("select",(function(){const e=l.state().get("selection");let t=i.val();e.forEach((function(e){if((e=e.toJSON()).id)if(n?t=t?t+","+e.id:e.id:(t=e.id,o.empty()),"image"===e.type){const t=e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail.url:e.url;o.append('<li class="lp-meta-box__file_list-item image" data-attachment_id="'+e.id+'"><img src="'+t+'" /><ul class="actions"><li><a href="#" class="delete"></a></li></ul></li>')}else o.append('<li class="lp-meta-box__file_list-item image" data-attachment_id="'+e.id+'"><img class="is_file" src="'+e.icon+'" /><span>'+e.filename+'</span><ul class="actions"><li><a href="#" class="delete"></a></li></ul></li>')})),c(),i.val(t)}))),l.open()})),n&&o.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"lp-metabox-sortable-placeholder",start(e,t){t.item.css("background-color","#f6f6f6")},stop(e,t){t.item.removeAttr("style")},update(){let t="";o.find("li.image").css("cursor","default").each((function(){const a=e(this).attr("data-attachment_id");t=t+a+","})),c(),i.val(t)}});const c=()=>{e(o).find("li.image").each(((t,a)=>{e(a).find("a.delete").on("click",(function(){if(e(a).remove(),n){let t="";e(o).find("li.image").css("cursor","default").each((function(){const a=e(this).attr("data-attachment_id");t=t+a+","})),i.val(t)}else i.val("");return!1}))}))};c()}))};e(document).ready((function(){if(a(),e(".learn-press-dropdown-pages").LP("DropdownPages"),e(".learn-press-tip").LP("QuickTip"),e(document).on("click","#learn-press-create-pages",t).on("mousedown",".lp-sortable-handle",(function(t){e("html, body").addClass("lp-item-moving"),e(t.target).closest(".lp-sortable-handle").css("cursor","inherit")})).on("mouseup",(function(t){e("html, body").removeClass("lp-item-moving"),e(".lp-sortable-handle").css("cursor","")})),e.fn._filter_post_by_author(),window.location.hash){const t=window.location.hash;if("#_lp_passing_grade"==t){const a=document.querySelector(t);e("html, body").animate({scrollTop:e(t).offset().top},900,"swing"),a.parentNode.style.border="2px solid orangered"}}e("input").on("click",(function(t){const a=e(t.target);if(!a.length)return;const l=a.attr("id");if(!l)return;const i=l.replace("learn_press_",""),o=e(`.show_if_${i}`);a.is(":checked")?o.show():o.hide()}))}))}(jQuery);