!function(e){e(document).ready(function(){function t(e,t,i){var n;return function(){var r=this,o=arguments,s=function(){n=null,i||e.apply(r,o)},a=i&&!n;clearTimeout(n),n=setTimeout(s,t),a&&e.apply(r,o)}}function i(e){let t=document.createElement("div");return t.innerText=e,t.innerHTML}function n(){e(".dmb_main").not(".dmb_empty_plan").length>0?e(".dmb_no_row_notice").hide():e(".dmb_no_row_notice").show(),e(".dmb_main").not(".dmb_empty_plan").length>5?e(".dmb_add_row, .dmb_clone_row").hide():e(".dmb_add_row, .dmb_clone_row").show()}r=jQuery.fn.clone,jQuery.fn.clone=function(){for(var t=r.apply(this,arguments),i=this.find("textarea").add(this.filter("textarea")),n=t.find("textarea").add(t.filter("textarea")),o=this.find("select").add(this.filter("select")),s=t.find("select").add(t.filter("select")),a=0,l=i.length;a<l;++a)e(n[a]).val(e(i[a]).val());for(var a=0,l=o.length;a<l;++a)s[a].selectedIndex=o[a].selectedIndex;return t},e(".dmb_color_picker").each(function(t,i){e(this).wpColorPicker()}),n();var r,o=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function s(e){return"#"+a((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+a(e[2])+a(e[3])}function a(e){return isNaN(e)?"00":o[(e-e%16)/16]+o[e%16]}function l(t){var i=e(t).closest(".dmb_main").find(".dmb_feature_dump"),n=e(t).closest(".dmb_main").find(".dmb_feature_field");if(0==n.length)i.val("");else{var r=[];n.each(function(t,n){if(e(this).val()){var o=e(this).val().split(",").join(")--(");r.push(o);var s=r.toString().split(",").join("\n").split(")--(").join(",");i.val(s)}})}return!1}e(".dmb_icon_data_url").each(function(t,i){var n=e(this).attr("data-icon");if(""!=n){var r=e(this).siblings(".dmb_upload_icon_btn");e(this).siblings(".dmb_icon_field").val(n),e("<br/><img src='"+n+"' class='dmb_icon_img'/><div class='dmb_clearfix imgClearfix'></div>").insertAfter(r),e('<a class="dmb_remove_icon_btn dmb_button dmb_button_large dmb_button_compact" href="#"><span class="dashicons dashicons-trash"></span></a>').insertAfter(r)}}),e(".dmb_main").not(".dmb_empty_plan").each(function(t,i){var n=e(this).find(".dmb_feature_dump").val(),r=e(this).find(".dmb_features");""!=n&&(n+="\n",e.each(n.split("\n").slice(0,-1),function(e,t){cleanedItem=t.replace(")--(",","),r.append('<div class="dmb_feature"><input class="dmb_field dmb_feature_field" type="text" value="" /><a class="dmb_remove_feature_btn" href="#"><span class="dashicons dashicons-no-alt"></span></a>		<a class="dmb_move_feature_down_btn" class="button" href="#"><span class="dashicons dashicons-arrow-down-alt2"></span></a><a class="dmb_move_feature_up_btn" class="button" href="#"><span class="dashicons dashicons-arrow-up-alt2"></span></a></div>'),r.find(".dmb_feature_field:last").val(cleanedItem)}))}),e("body").on("click",".dmb_remove_icon_btn",function(t){return e(this).parent().find(".dmb_icon_img").remove(),e(this).parent().find(".imgClearfix").remove(),e(this).parent().find(".dmb_icon_field").val(""),e(this).remove(),!1}),e("body").on("click",".dmb_upload_icon_btn",function(){return upload_button=e(this),isAlreadyImg=e(this).siblings(".dmb_icon_data_url").attr("data-icon"),window.send_to_editor=function(t){imgUrl=e(t).attr("src"),isAlreadyImg&&(upload_button.parent().find(".dmb_icon_img").remove(),upload_button.parent().find(".dmb_remove_icon_btn").remove()),e("<br/><img src='"+imgUrl+"' class='dmb_icon_img'/><div class='dmb_clearfix imgClearfix'></div>").insertAfter(upload_button),e('<a class="dmb_remove_icon_btn dmb_button dmb_button_large dmb_button_compact" href="#"><span class="dashicons dashicons-trash"></span></a>').insertAfter(upload_button),upload_button.siblings(".dmb_icon_field").val(imgUrl),tb_remove()},tb_show("","media-upload.php?type=image&amp;TB_iframe=true"),!1}),e("body").on("click",".dmb_add_feature",function(){var t=e(this).siblings(".dmb_features").find(".dmb_feature:last .dmb_feature_field");if(""!=t.val()){var i=e(".empty-feature").clone(!0);i.removeClass("empty-feature").show(),e(this).siblings(".dmb_features").append(i),i.find(".dmb_feature_field").focus()}else t.focus();return!1}),e("body").on("click",".dmb_remove_feature_btn",function(t){return featureList=e(this).closest(".dmb_features"),e(this).parent().remove(),l(e(featureList)),!1}),e("body").on("click",".dmb_move_feature_down_btn",function(t){var i=e(this).closest(".dmb_feature");if(i.next().length>0){var n=i.clone().insertAfter(i.next());i.remove(),l(e(n))}return!1}),e("body").on("click",".dmb_move_feature_up_btn",function(t){var i=e(this).closest(".dmb_feature");if(i.prev().length>0){var n=i.clone().insertBefore(i.prev());i.remove(),l(e(n))}return!1}),e("body").on("keyup",".dmb_feature_field",t(function(t){l(e(this))},150)),e("body").on("click",".dmb_add_row",function(){var t=e(".dmb_empty_plan").clone(!0);return t.removeClass("dmb_empty_plan").addClass("dmb_main").show(),t.find(".emptyDump").removeClass("emptyDump").addClass("dmb_feature_dump"),t.insertBefore(e(".dmb_empty_plan")),t.find(".dmb_title_of_plan").focus(),t.find(".dmb_color_picker_ready").removeClass(".dmb_color_picker_ready").addClass(".dmb_color_picker").wpColorPicker().css({padding:"3px"}),t.find(".dmb_handle_title").html(objectL10n.untitled),n(),!1}),e("body").on("click",".dmb_remove_row_btn",function(t){return e(this).closest(".dmb_main").remove(),n(),!1}),e("body").on("click",".dmb_handle",function(t){return e(this).siblings(".dmb_inner").slideToggle(50),e(this).hasClass("closed")?e(this).removeClass("closed"):e(this).addClass("closed"),!1}),e("body").on("click",".dmb_collapse_rows",function(t){return e(".dmb_handle").each(function(t,i){!e(this).closest(".dmb_empty_plan").length&&(e(this).hasClass("closed")||(e(this).siblings(".dmb_inner").slideToggle(50),e(this).addClass("closed")))}),!1}),e("body").on("click",".dmb_expand_rows",function(t){return e(".dmb_handle").each(function(t,i){e(this).hasClass("closed")&&(e(this).siblings(".dmb_inner").slideToggle(50),e(this).removeClass("closed"))}),!1}),e("body").on("click",".dmb_move_row_down",function(t){if(e(this).closest(".dmb_main").next().hasClass("dmb_main")){var i=e(this).closest(".dmb_main").clone(!0);i.insertAfter(e(this).closest(".dmb_main").next());var n=i.find(".wp-color-result").css("backgroundColor");i.find(".wp-picker-container").remove(),i.find(".dmb_color_box").append('<input class="dmb_color_picker dmb_field" name="plan_colors[]" type="text" value="'+s(n)+'" />'),i.find(".dmb_color_picker").wpColorPicker(),e(this).closest(".dmb_main").remove()}return!1}),e("body").on("click",".dmb_move_row_up",function(t){if(e(this).closest(".dmb_main").prev().hasClass("dmb_main")){var i=e(this).closest(".dmb_main").clone(!0);i.insertBefore(e(this).closest(".dmb_main").prev());var n=i.find(".wp-color-result").css("backgroundColor");i.find(".wp-picker-container").remove(),i.find(".dmb_color_box").append('<input class="dmb_color_picker dmb_field" name="plan_colors[]" type="text" value="'+s(n)+'" />'),i.find(".dmb_color_picker").wpColorPicker(),e(this).closest(".dmb_main").remove()}return!1}),e("body").on("click",".dmb_clone_row",function(t){var i=e(this).closest(".dmb_main").clone(!0);i.insertAfter(e(this).closest(".dmb_main")),i.find(".dmb_handle_title").text(i.find(".dmb_title_of_plan").val()+" ("+objectL10n.copy+")"),i.find(".dmb_title_of_plan").focus();var r=e(this).closest(".dmb_main").find(".wp-color-result").css("backgroundColor");return i.find(".wp-picker-container").remove(),i.find(".dmb_color_box").append('<input class="dmb_color_picker dmb_field" name="plan_colors[]" type="text" value="'+s(r)+'" />'),i.find(".dmb_color_picker").wpColorPicker(),n(),!1}),e(".dmb_title_of_plan").each(function(t,i){""!=e(this).val()&&e(this).closest(".dmb_main").find(".dmb_handle_title").text(e(this).val())}),e("body").on("keyup",".dmb_title_of_plan",t(function(t){var i=e(this),n=i.closest(".dmb_main").find(".dmb_handle_title");""!=i.val()?n.text(i.val()):n.text(objectL10n.untitled)},50)),e("body").on("click",".dmb_text_settings_box_show",function(){e(".dmb_text_settings_box").toggle()}),e("body").on("click",".dmb_show_preview_table",function(){var t={};t.planCount=e(".dmb_main").not(".dmb_empty_plan").length,t.tableCurrency=e("input[name='table_currency']").val(),t.fontTitleAlignment=e("select[name='font_title_alignment'] option:selected").val(),t.fontSizeTitle=e("select[name='font_size_title'] option:selected").val(),t.fontSizeSubtitle=e("select[name='font_size_subtitle'] option:selected").val(),t.fontSizeDescription=e("select[name='font_size_description'] option:selected").val(),t.fontSizePrice=e("select[name='font_size_price'] option:selected").val(),t.fontSizeRecurrence=e("select[name='font_size_recurrence'] option:selected").val(),t.fontSizeButton=e("select[name='font_size_button'] option:selected").val(),t.fontSizeFeatures=e("select[name='font_size_features'] option:selected").val(),"small"==t.fontSizeTitle?t.fontSizeTitle=" rpt_sm_title":"tiny"==t.fontSizeTitle?t.fontSizeTitle=" rpt_xsm_title":t.fontSizeTitle="","small"==t.fontSizeSubtitle?t.fontSizeSubtitle=" rpt_sm_subtitle":"tiny"==t.fontSizeSubtitle?t.fontSizeSubtitle=" rpt_xsm_subtitle":t.fontSizeSubtitle="","small"==t.fontSizeDescription?t.fontSizeDescription=" rpt_sm_description":t.fontSizeDescription="","small"==t.fontSizePrice?t.fontSizePrice=" rpt_sm_price":"tiny"==t.fontSizePrice?t.fontSizePrice=" rpt_xsm_price":"supertiny"==t.fontSizePrice?t.fontSizePrice=" rpt_xxsm_price":t.fontSizePrice="","small"==t.fontSizeRecurrence?t.fontSizeRecurrence=" rpt_sm_recurrence":t.fontSizeRecurrence="","small"==t.fontSizeFeatures?t.fontSizeFeatures=" rpt_sm_features":t.fontSizeFeatures="","small"==t.fontSizeButton?t.fontSizeButton=" rpt_sm_button":t.fontSizeButton="";var n="";n+='<div id="rpt_pricr" style="margin-top:100px;" class="rpt_plans rpt_'+t.planCount+'_plans rpt_style_basic">',n+='<div class="'+t.fontSizeTitle+" "+t.fontSizeSubtitle+" "+t.fontSizeDescription+" "+t.fontSizePrice+" "+t.fontSizeRecurrence+" "+t.fontSizeButton+" "+t.fontSizeFeatures+'">',n+='<style>.rpt_plans .rpt_plan .rpt_foot{line-height:34px;} #rpt_pricr{font-family: "Helvetica Neue", Arial, sans-serif; font-weight: 300; line-height: 27px;}</style>',e(".dmb_main").not(".dmb_empty_plan").each(function(r,o){var a={},l={};a.title=e(this).find(".dmb_title_of_plan").val(),a.subtitle=e(this).find(".dmb_subtitle_of_plan").val(),a.recurrence=e(this).find(".dmb_recurrence_of_plan").val(),a.price=e(this).find(".dmb_price_of_plan").val(),a.description=e(this).find(".dmb_description_of_plan").val(),a.icon=e(this).find(".dmb_icon_of_plan").attr("data-icon"),a.recommended=e(this).find(".dmb_switch_recommended").find(":selected").val(),a.free=e(this).find(".dmb_switch_free").find(":selected").val(),a.features=e(this).find(".dmb_features_of_plan").val(),a.buttonText=e(this).find(".dmb_button_text_of_plan").val(),a.customButton=e(this).find(".dmb_custom_button_of_plan").val(),a.color=s(e(this).find(".wp-color-result").css("backgroundColor"))||"#8dba09",a.recommended&&"yes"==a.recommended?(l.recoClass="rpt_recommended_plan",l.recoImg='<img class="rpt_recommended" src="../wp-content/plugins/dk-pricr-responsive-pricing-table/inc/img/rpt_recommended.png"/>'):(l.recoImg="",l.recoClass=""),n+='<div class="rpt_plan rpt_plan_'+r+" "+l.recoClass+'">',l.titleStyle='style="text-align:'+t.fontTitleAlignment+';"',a.title&&(n+="<div "+l.titleStyle+' class="rpt_title rpt_title_'+r+'">',a.icon&&(n+='<img height=30px width=30px src="'+a.icon+'" class="rpt_icon rpt_icon_'+r+'"/> '),n+=i(a.title),n+=l.recoImg+"</div>"),n+='<div class="rpt_head rpt_head_'+r+'">',a.recurrence&&(n+='<div class="rpt_recurrence rpt_recurrence_'+r+'">'+i(a.recurrence)+"</div>"),a.price&&(n+='<div class="rpt_price rpt_price_'+r+'">',"yes"==a.free||"on"==a.free?(n+='<sup class="rpt_currency">',n+="</sup>"):t.tableCurrency?(n+='<sup class="rpt_currency">',n+=t.tableCurrency,n+="</sup>"):(n+='<sup class="rpt_currency">',n+="</sup>"),n+=i(a.price),n+="</div>"),a.subtitle&&(n+='<div style="color:'+a.color+';" class="rpt_subtitle rpt_subtitle_'+r+'">'+i(a.subtitle)+"</div>"),a.description&&(n+='<div class="rpt_description rpt_description_'+r+'">'+i(a.description)+"</div>"),n+='<div style="clear:both;"></div>',n+="</div>",a.features&&(n+='<div class="rpt_features rpt_features_'+r+'">',l.features=[],l.featureString=a.features,l.featureStringArray=l.featureString.split("\n"),l.featureStringArray=l.featureStringArray.map(function(e){return e.trim()}),e.each(l.featureStringArray,function(e,t){var i,n="<strong></strong><br><br/></br><img><a>";l.features.push((i=t,n=(((n||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join(""),i.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,t){return n.indexOf("<"+t.toLowerCase()+">")>-1?e:""})))}),e.each(l.featureStringArray,function(e,t){if(t){if("-n"==t.substr(0,2)){t=t.substr(2);var o="#bbbbbb"}else o="black";n+='<div style="color:'+o+';" class="rpt_feature rpt_feature_'+r+"-"+e+'">',n+=i(t),n+="</div>"}}),n+="</div>",n+='<div style="clear:both;"></div>'),a.customButton?(n+='<div class="rpt_custom_btn" style="background-color:'+a.color+'">',n+=a.customButton,n+="</div>"):(a.buttonText?(n+='<a href="#" style="background:'+a.color+'" class="rpt_foot rpt_foot_'+r+'">',n+=a.buttonText):n+='<a style="background:'+a.color+'" class="rpt_foot rpt_foot_'+r+'">',n+="</a>"),n+="</div>"}),n+="</div>",n+="</div>",n+='<div style="clear:both;"></div>',n+='<div class="dmb_accuracy_preview_notice">'+objectL10n.previewAccuracy+"</div>",0==t.planCount?e("#dmb_preview_table").append('<div class="dmb_no_row_preview_notice">'+objectL10n.noPlan+"</div>"):e("#dmb_preview_table").append(n),e("#dmb_preview_table").fadeIn(100),setTimeout(function(){e("img.rpt_recommended").each(function(){var t=e(this).parent().outerHeight()/2-e(this).height()/2;e(this).css("top",t-2+"px")})},50)}),e("body").on("click",".dmb_preview_table_close",function(){e("#dmb_preview_table #rpt_pricr, .dmb_accuracy_preview_notice, .dmb_no_row_preview_notice").remove(),e("#dmb_preview_table").fadeOut(100)})})}(jQuery);
