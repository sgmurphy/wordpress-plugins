/*! For license information please see chatbot.js.LICENSE.txt */
(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=React;function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var r=function(e){var t=[];return function(r,o){if("object"===n(o)&&null!==o){if(-1!==t.indexOf(o)){if(!e)throw console.warn("Circular reference found.",{key:r,value:o,cache:t,cacheIndex:t.indexOf(o)}),new Error("Circular reference found. Cancelled.");return}t.push(o)}return o}};function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return JSON.stringify(e,r(n),t)}e.n(t)().Component;var i=["active","disabled"],a=["if","className","disableTransition","children"];function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var f=wp.element,p=f.useState,d=f.useMemo,h=f.useEffect,m=f.useRef,y=function(e){var t=e.active,n=e.disabled,r=l(e,i);return React.createElement("div",u({active:t?"true":"false",disabled:n},r),React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",dangerouslySetInnerHTML:{__html:'<path d="M192 0C139 0 96 43 96 96V256c0 53 43 96 96 96s96-43 96-96V96c0-53-43-96-96-96zM64 216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 89.1 66.2 162.7 152 174.4V464H120c-13.3 0-24 10.7-24 24s10.7 24 24 24h72 72c13.3 0 24-10.7 24-24s-10.7-24-24-24H216V430.4c85.8-11.7 152-85.3 152-174.4V216c0-13.3-10.7-24-24-24s-24 10.7-24 24v40c0 70.7-57.3 128-128 128s-128-57.3-128-128V216z"/>'}}))},v=function(){return d((function(){return function(e,t){return Array.isArray(e)||(e=[e]),t&&Object.entries(t).forEach((function(t){var n=c(t,2),r=n[0];n[1]&&e.push(r)})),e.join(" ")}}),[])};function g(e){return!(!e||"string"!=typeof e)&&0===e.indexOf("http")}var b=function(e){var t=e.if,n=e.className,r=e.disableTransition,o=void 0!==r&&r,i=e.children,s=l(e,a),f=c(p(!1),2),d=f[0],m=f[1],y=c(p("mwai-transition"),2),v=y[0],g=y[1];return h((function(){o?m(t):t?(m(!0),setTimeout((function(){g("mwai-transition mwai-transition-visible")}),150)):g("mwai-transition")}),[t,o]),d?React.createElement("div",u({className:"".concat(n," ").concat(o?"":v),onTransitionEnd:function(){"mwai-transition"!==v||o||m(!1)}},s),i):null};function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,E(r.key),r)}}function E(e){var t=function(e,t){if("object"!=w(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==w(t)?t:String(t)}var S=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),e.instance)return e.instance;this.chatbots=[],this.filters={},this.actions={},e.instance=this,"undefined"!=typeof window&&(window.MwaiAPI=e.instance)}var t,n;return t=e,n=[{key:"getChatbot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?this.chatbots.find((function(t){return t.botId===e||t.customId===e})):this.chatbots[0]}},{key:"addFilter",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.filters[e]||(this.filters[e]=[]),this.filters[e].push({callback:t,priority:n}),this.filters[e].sort((function(e,t){return e.priority-t.priority}))}},{key:"applyFilters",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return this.filters[e]?this.filters[e].reduce((function(e,t){return t.callback.apply(t,[e].concat(r))}),t):t}},{key:"addAction",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.actions[e]||(this.actions[e]=[]),this.actions[e].push({callback:t,priority:n}),this.actions[e].sort((function(e,t){return e.priority-t.priority}))}},{key:"doAction",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.actions[e]&&this.actions[e].forEach((function(e){e.callback.apply(e,n)}))}}],n&&x(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),O=new S,k=function(e,t,n){return O.applyFilters(e,t,n)};function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function R(){R=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),c=new L(r||[]);return o(a,"_invoke",{value:I(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var p="suspendedStart",d="suspendedYield",h="executing",m="completed",y={};function v(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(A([])));E&&E!==n&&r.call(E,a)&&(w=E);var S=b.prototype=v.prototype=Object.create(w);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,a,c){var s=f(e[o],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==j(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function I(t,n,r){var o=p;return function(i,a){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=C(c,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=h;var u=f(t,n,r);if("normal"===u.type){if(o=r.done?m:d,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function C(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,C(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function A(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(j(t)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,s,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},O(k.prototype),u(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new k(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(S),u(S,s,"Generator"),u(S,a,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=A,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:A(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function T(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){P(i,r,o,a,c,"next",e)}function c(e){P(i,r,o,a,c,"throw",e)}a(void 0)}))}}var L=wp.element,A=(L.useMemo,L.useEffect),N=L.useState;function M(e,t){return D.apply(this,arguments)}function D(){return D=T(R().mark((function e(t,n){var r,o,i,a,c,s,u,l,f,p,d,h,m,y,v=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=v.length>2&&void 0!==v[2]?v[2]:null,n){e.next=14;break}return e.prev=2,e.next=5,t.json();case 5:return o=e.sent,r&&console.log("[".concat(r,"] IN: "),o),e.abrupt("return",o);case 10:return e.prev=10,e.t0=e.catch(2),console.error("Could not parse the regular response.",{err:e.t0,data}),e.abrupt("return",{success:!1,message:"Could not parse the regular response."});case 14:i=t.body.getReader(),a=new TextDecoder("utf-8"),c="",s="";case 18:return e.next=21,i.read();case 21:if(u=e.sent,l=u.value,f=u.done,c+=a.decode(l,{stream:!0}),!f){e.next=27;break}return e.abrupt("break",68);case 27:p=c.split("\n"),d=0;case 29:if(!(d<p.length-1)){e.next=65;break}if(0===p[d].indexOf("data: ")){e.next=32;break}return e.abrupt("continue",62);case 32:if("live"!==(h=JSON.parse(p[d].replace("data: ",""))).type){e.next=39;break}r&&console.log("[".concat(r," STREAM] LIVE: "),h),s+=h.data,n&&n(s,h.data),e.next=62;break;case 39:if("error"!==h.type){e.next=51;break}return e.prev=40,r&&console.error("[".concat(r," STREAM] ERROR: "),h.data),e.abrupt("return",{success:!1,message:h.data});case 45:return e.prev=45,e.t1=e.catch(40),console.error("Could not parse the 'error' stream.",{err:e.t1,data:h}),e.abrupt("return",{success:!1,message:"Could not parse the 'error' stream."});case 49:e.next=62;break;case 51:if("end"!==h.type){e.next=62;break}return e.prev=52,m=JSON.parse(h.data),r&&console.log("[".concat(r," STREAM] END: "),m),e.abrupt("return",m);case 58:return e.prev=58,e.t2=e.catch(52),console.error("Could not parse the 'end' stream.",{err:e.t2,data:h}),e.abrupt("return",{success:!1,message:"Could not parse the 'end' stream."});case 62:d++,e.next=29;break;case 65:c=p[p.length-1],e.next=18;break;case 68:return e.prev=68,y=JSON.parse(c),r&&console.log("[".concat(r," STREAM] IN: "),y),e.abrupt("return",y);case 74:return e.prev=74,e.t3=e.catch(68),console.error("Could not parse the buffer.",{err:e.t3,buffer:c}),e.abrupt("return",{success:!1,message:"Could not parse the buffer."});case 78:case"end":return e.stop()}}),e,null,[[2,10],[40,45],[52,58],[68,74]])}))),D.apply(this,arguments)}function F(e,t,n,r){return B.apply(this,arguments)}function B(){return(B=T(R().mark((function e(t,n,r,i){var a;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={"Content-Type":"application/json"},r&&(a["X-WP-Nonce"]=r),i&&(a.Accept="text/event-stream"),e.next=5,fetch("".concat(t),{method:"POST",headers:a,body:o(n)});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t,n,r){return U.apply(this,arguments)}function U(){return U=T(R().mark((function e(t,n,r,o){var i,a=arguments;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>4&&void 0!==a[4]?a[4]:{},e.abrupt("return",new Promise((function(e,a){var c=new FormData;c.append("file",n);for(var s=0,u=Object.entries(i);s<u.length;s++){var l=I(u[s],2),f=l[0],p=l[1];c.append(f,p)}var d=new XMLHttpRequest;d.open("POST",t,!0),r&&d.setRequestHeader("X-WP-Nonce",r),d.upload.onprogress=function(e){if(e.lengthComputable&&o){var t=e.loaded/e.total*100;o(t)}},d.onload=function(){if(d.status>=200&&d.status<300)try{var t=JSON.parse(d.responseText);e(t)}catch(e){a({status:d.status,statusText:d.statusText,error:"The server response is not valid JSON"})}else{try{var n=JSON.parse(d.responseText);return void a({status:d.status,message:n.message})}catch(e){}a({status:d.status,statusText:d.statusText})}},d.onerror=function(){a({status:d.status,statusText:d.statusText})},d.send(c)})));case 2:case"end":return e.stop()}}),e)}))),U.apply(this,arguments)}function H(){return Math.random().toString(36).substring(2)}var z=function(){var e=I(N(!0),2),t=e[0],n=e[1];A((function(){var e=setTimeout((function(){var e=setInterval((function(){n((function(e){return!e}))}),500);return function(){return clearInterval(e)}}),200);return function(){return clearTimeout(e)}}),[]);var r={opacity:t?1:0,width:"1px",height:"1em",borderLeft:"8px solid",marginLeft:"2px"};return React.createElement("span",{style:r})};function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}var G=["children"];function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],o=function(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==$(t)?t:String(t)}(o),o in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Z(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(){Q=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:j(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var p="suspendedStart",d="suspendedYield",h="executing",m="completed",y={};function v(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==n&&r.call(E,a)&&(w=E);var S=b.prototype=v.prototype=Object.create(w);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,a,c){var s=f(e[o],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==$(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function j(t,n,r){var o=p;return function(i,a){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=R(c,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=h;var u=f(t,n,r);if("normal"===u.type){if(o=r.done?m:d,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function R(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,R(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function T(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError($(t)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,s,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},O(k.prototype),u(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new k(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(S),u(S,s,"Generator"),u(S,a,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=T,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;C(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function J(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Y(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){J(i,r,o,a,c,"next",e)}function c(e){J(i,r,o,a,c,"throw",e)}a(void 0)}))}}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||Z(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){if(e){if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ee=wp.element,te=ee.useContext,ne=ee.createContext,re=ee.useState,oe=ee.useMemo,ie=ee.useEffect,ae=ee.useCallback,ce=ee.useRef,se="AI: ",ue=ne(),le=function(){var e=te(ue);if(!e)throw new Error("useChatbotContext must be used within a ChatbotContextProvider");return e},fe=function(e){var t,n,r,i,a,s=e.children,u=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,G),l=u.params,f=u.system,d=u.theme,y=u.atts,v=function(){var e=c(p(null),2),t=e[0],n=e[1],r=m(null);return h((function(){return function(){clearInterval(r.current)}}),[]),{timeElapsed:t,startChrono:function(){if(null===r.current){var e=Date.now();r.current=setInterval((function(){var t,r,o,i=Math.floor((Date.now()-e)/1e3);n((t=i,r=Math.floor(t/60),o=t%60,"".concat(r,":").concat(o.toString().padStart(2,"0"))))}),500)}},stopChrono:function(){clearInterval(r.current),r.current=null,n(null)}}}(),b=v.timeElapsed,w=v.startChrono,x=v.stopChrono,E=oe((function(){return(null==d?void 0:d.settings)||{}}),[d]),S=X(re(f.restNonce),2),j=S[0],R=S[1],I=X(re([]),2),C=I[0],P=I[1],T=X(re(H()),2),L=T[0],A=T[1],N=X(re(""),2),D=N[0],B=N[1],U=X(re(!1),2),z=U[0],$=U[1],W=X(re({localFile:null,uploadedId:null,uploadedUrl:null,uploadProgress:null}),2),J=W[0],Z=W[1],K=X(re(!0),2),ee=K[0],te=K[1],ne=X(re(!1),2),le=ne[0],fe=ne[1],pe=X(re(null),2),de=pe[0],he=pe[1],me=X(re(!1),2),ye=me[0],ve=me[1],ge=X(re(),2),be=ge[0],we=ge[1],xe=ce(),Ee=ce(),Se=ce(!1),Oe=function(e){var t=c(p(!1),2),n=t[0],r=t[1],o=c(p(!1),2),i=o[0],a=o[1];return h((function(){"undefined"!=typeof window&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window)&&a(!0)}),[]),h((function(){if(i){var e=new(window.SpeechRecognition||window.webkitSpeechRecognition);e.interimResults=!0,e.continuous=!0;var t=function(e){var t=Array.from(e.results).map((function(e){return e[0]})).map((function(e){return e.transcript})).join("");B(t)};return n?(e.addEventListener("result",t),e.start()):(e.removeEventListener("result",t),e.abort()),function(){e.abort()}}}),[n,i]),{isListening:n,setIsListening:r,speechRecognitionAvailable:i}}(),ke=Oe.isListening,je=Oe.setIsListening,Re=Oe.speechRecognitionAvailable,Ie=f.stream||!1,Ce=f.botId,Pe=f.customId,Te=f.userData,Le=f.sessionId,Ae=f.contextId,Ne=f.pluginUrl,Me=f.restUrl,De=f.debugMode,Fe=null!==(t=null==f?void 0:f.typewriter)&&void 0!==t&&t,Be=null!==(n=null==f?void 0:f.speech_recognition)&&void 0!==n&&n,_e=null!==(r=null==f?void 0:f.speech_synthesis)&&void 0!==r&&r,Ue=null!==(i=null===(a=l.startSentence)||void 0===a?void 0:a.trim())&&void 0!==i?i:"",He=document.innerWidth<=768,ze=function(e){var t,n,r,o,i,a,c,s,u,l,f,p,d,h,m,y,v,g,b,w,x,E,S,O,k,j,R=null!==(t=null===(n=e.guestName)||void 0===n?void 0:n.trim())&&void 0!==t?t:"",I=null!==(r=null===(o=e.textSend)||void 0===o?void 0:o.trim())&&void 0!==r?r:"",C=null!==(i=null===(a=e.textClear)||void 0===a?void 0:a.trim())&&void 0!==i?i:"",P=parseInt(e.textInputMaxLength),T=null!==(c=null===(s=e.textInputPlaceholder)||void 0===s?void 0:s.trim())&&void 0!==c?c:"",L=null!==(u=null===(l=e.textCompliance)||void 0===l?void 0:l.trim())&&void 0!==u?u:"",A=Boolean(e.window),N=Boolean(e.copyButton),M=Boolean(e.fullscreen),D=null!==(f=null===(p=e.icon)||void 0===p?void 0:p.trim())&&void 0!==f?f:"",F=null!==(d=null===(h=e.iconText)||void 0===h?void 0:h.trim())&&void 0!==d?d:"",B=parseInt(e.iconTextDelay||1),_=null!==(m=null===(y=e.iconAlt)||void 0===y?void 0:y.trim())&&void 0!==m?m:"",U=null!==(v=null===(g=e.iconPosition)||void 0===g?void 0:g.trim())&&void 0!==v?v:"",H=Boolean(e.iconBubble),z=null!==(b=null===(w=e.aiName)||void 0===w?void 0:w.trim())&&void 0!==b?b:"",$=null!==(x=null===(E=e.userName)||void 0===E?void 0:E.trim())&&void 0!==x?x:"",G=null!==(S=null===(O=e.aiAvatar)||void 0===O?void 0:O.trim())&&void 0!==S?S:"",W=null!==(k=null===(j=e.userAvatar)||void 0===j?void 0:j.trim())&&void 0!==k?k:"";return{textSend:I,textClear:C,textInputMaxLength:P,textInputPlaceholder:T,textCompliance:L,window:A,copyButton:N,fullscreen:M,localMemory:Boolean(e.localMemory),imageUpload:Boolean(e.imageUpload),fileSearch:Boolean(e.fileSearch),icon:D,iconText:F,iconTextDelay:B,iconAlt:_,iconPosition:U,iconBubble:H,aiName:z,aiAvatar:G,userName:$,userAvatar:W,guestName:R}}(l),$e=ze.aiName,Ge=ze.userName,We=ze.aiAvatar,qe=ze.userAvatar,Ve=ze.textSend,Qe=ze.textClear,Je=ze.textInputMaxLength,Ye=ze.textInputPlaceholder,Xe=ze.textCompliance,Ze=ze.guestName,Ke=ze.window,et=ze.copyButton,tt=ze.fullscreen,nt=ze.localMemory,rt=ze.icon,ot=ze.iconText,it=ze.iconTextDelay,at=ze.iconAlt,ct=ze.iconPosition,st=ze.iconBubble,ut=ze.imageUpload,lt=ze.fileSearch,ft=nt&&(!!Pe||!!Ce),pt=ft?"mwai-chat-".concat(Pe||Ce):null,dt=oe((function(){var e=rt?g(rt)?rt:Ne+"/images/"+rt:Ne+"/images/chat-green.svg";return{cssVariables:Object.keys(E).reduce((function(e,t){return e["--mwai-".concat(t)]=E[t],e}),{}),iconUrl:e}}),[rt,Ne,E]),ht=dt.cssVariables,mt=dt.iconUrl,yt=X(re(!1),2),vt=yt[0],gt=yt[1],bt=X(re(!1),2),wt=bt[0],xt=bt[1],Et=oe((function(){return"timeless"===(null==d?void 0:d.themeId)?"mwai-tools":"mwai-input"}),[null==d?void 0:d.themeId]),St=oe((function(){return{text:Ve,image:"timeless"===(null==d?void 0:d.themeId)?Ne+"/images/submit-blue-arrow.svg":null,imageOnly:!1}}),[Ne,Ve,null==d?void 0:d.themeId]),Ot=function(){if(Lt(),Ue){var e=[{id:H(),role:"assistant",content:Ue,who:se,timestamp:(new Date).getTime()}];P(e)}else P([])};ie((function(){function e(){return(e=Y(Q().mark((function e(){var t,n;return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=8;break}return e.next=3,F("".concat(Me,"/mwai/v1/start_session"));case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,R(n.restNonce);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[j]),ie((function(){Ot()}),[Ue]),ie((function(){(Pe||Ce)&&O.chatbots.push({botId:Ce,chatId:L,customId:Pe,open:function(){Dt((function(e){return[].concat(V(e),[{action:"open"}])}))},close:function(){Dt((function(e){return[].concat(V(e),[{action:"close"}])}))},clear:function(){Dt((function(e){return[].concat(V(e),[{action:"clear"}])}))},toggle:function(){Dt((function(e){return[].concat(V(e),[{action:"toggle"}])}))},ask:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Dt((function(n){return[].concat(V(n),[{action:"ask",data:{text:e,submit:t}}])}))},setContext:function(e){var t=e.chatId,n=e.messages;Dt((function(e){return[].concat(V(e),[{action:"setContext",data:{chatId:t,messages:n}}])}))}})}),[Ce,L,Pe]),ie((function(){ye?w():(!He&&Se.current&&xe.current.focusInput(),x())}),[ye,w,x,He]);var kt=ae((function(e){pt&&localStorage.setItem(pt,o({chatId:L,messages:e}))}),[pt,L]),jt=function(){he(null)};ie((function(){var e=[];if(pt&&(e=localStorage.getItem(pt)))return e=JSON.parse(e),P(e.messages),void A(e.chatId);Ot()}),[Ce]),ie((function(){if(be){ve(!1);var e=V(C),t=e.length>0?e[e.length-1]:null;if(!be.success)return"assistant"===t.role&&t.isQuerying&&e.pop(),e.pop(),e.push({id:H(),role:"system",content:be.message,who:se,timestamp:(new Date).getTime()}),P(e),void kt(e);if("assistant"===t.role&&t.isQuerying)t.content=k("ai.reply",be.reply),be.images&&(t.images=be.images),t.timestamp=(new Date).getTime(),delete t.isQuerying;else if("assistant"===t.role&&t.isStreaming)t.content=k("ai.reply",be.reply),be.images&&(t.images=be.images),t.timestamp=(new Date).getTime(),delete t.isStreaming;else{var n={id:H(),role:"assistant",content:k("ai.reply",be.reply),who:se,timestamp:(new Date).getTime()};be.images&&(n.images=be.images),e.push(n)}P(e),kt(e)}}),[be]);var Rt=ae(Y(Q().mark((function e(){return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(H());case 2:pt&&localStorage.removeItem(pt),Ot(),B("");case 5:case"end":return e.stop()}}),e)}))),[Ce]),It=ae(function(){var e=Y(Q().mark((function e(t){var n,r,o,i,a,c,s,u,l,f,p,d,h,m;return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ye){e.next=3;break}return console.error("AI Engine: There is already a query in progress."),e.abrupt("return");case 3:return"string"!=typeof t&&(t=D),r=J,o=null==J?void 0:J.uploadedUrl,i=null==J||null===(n=J.localFile)||void 0===n?void 0:n.type,a=!!i&&i.startsWith("image"),c=t,o&&(c=a?"![Uploaded Image](".concat(o,")\n").concat(t):"[Uploaded File](".concat(o,")\n").concat(t)),ve(!0),B(""),Lt(),s=[].concat(V(C),[{id:H(),role:"user",content:c,who:"User: ",timestamp:(new Date).getTime()}]),kt(s),u=H(),l=[].concat(V(s),[{id:u,role:"assistant",content:null,who:se,timestamp:null,isQuerying:!Ie,isStreaming:!!Ie}]),P(l),f=q({botId:Ce,customId:Pe,session:Le,chatId:L,contextId:Ae,messages:C,newMessage:t,newFileId:null==r?void 0:r.uploadedId,stream:Ie},y),e.prev=19,De&&console.log("[CHATBOT] OUT: ",f),p=Ie?function(e){P((function(t){var n=V(t),r=n.length>0?n[n.length-1]:null;return r&&r.id===u&&(r.content=e,r.timestamp=(new Date).getTime()),n}))}:null,e.next=24,F("".concat(Me,"/mwai-ui/v1/chats/submit"),f,j,Ie);case 24:return d=e.sent,e.next=27,M(d,p,De?"CHATBOT":null);case 27:if((h=e.sent).success||!h.message){e.next=37;break}return he(h.message),(m=V(l)).pop(),m.pop(),P(m),kt(m),ve(!1),e.abrupt("return");case 37:we(h),e.next=44;break;case 40:e.prev=40,e.t0=e.catch(19),console.error("An error happened in the handling of the chatbot response.",{err:e.t0}),ve(!1);case 44:case"end":return e.stop()}}),e,null,[[19,40]])})));return function(t){return e.apply(this,arguments)}}(),[ye,J,C,kt,Ie,Ce,Pe,Le,L,Ae,y,D,De,Me,j]),Ct=ae((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(null==J||!J.uploadedId);Se.current=document.activeElement===xe.current.currentElement(),e?It(e):(t||D.length>0)&&It(D)}),[D,It,null==J?void 0:J.uploadedId]),Pt=function(){var e=Y(Q().mark((function e(t){var n,r,o,i,a,c=arguments;return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:"N/A",r=c.length>2&&void 0!==c[2]?c[2]:"N/A",e.prev=2,null!==t){e.next=6;break}return Lt(),e.abrupt("return");case 6:return o={type:n,purpose:r},i="".concat(Me,"/mwai-ui/v1/files/upload"),e.next=10,_(i,t,j,(function(e){Z({localFile:t,uploadedId:null,uploadedUrl:null,uploadProgress:e})}),o);case 10:a=e.sent,Z({localFile:t,uploadedId:a.data.id,uploadedUrl:a.data.url,uploadProgress:null}),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(2),console.error("onFileUpload Error",e.t0),he(e.t0.message||"An unknown error occurred"),Lt();case 19:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}(),Tt=function(){var e=Y(Q().mark((function e(t){return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return de&&jt(),e.abrupt("return",Pt(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Lt=function(){Z({localFile:null,uploadedId:null,uploadedUrl:null,uploadProgress:null})},At=ae((function(){var e=setTimeout((function(){fe((function(e){return e||$(!0),e}))}),1e3*it);return function(){return clearTimeout(e)}}),[ot,it]);ie((function(){if(ot&&!it)$(!0);else if(ot&&it)return At()}),[ot]);var Nt=X(re([]),2),Mt=Nt[0],Dt=Nt[1],Ft=ae(Y(Q().mark((function e(){var t,n,r,o,i,a;return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Mt.length>0&&("ask"===(t=Mt[0]).action?(n=t.data,r=n.text,n.submit?It(r):B(r)):"toggle"===t.action?fe((function(e){return!e})):"open"===t.action?fe(!0):"close"===t.action?fe(!1):"clear"===t.action?Rt():"setContext"===t.action&&(o=t.data,i=o.chatId,a=o.messages,A(i),P(a)),Dt((function(e){return e.slice(1)})));case 1:case"end":return e.stop()}}),e)}))),[Mt,Rt,It,A,B,P]);ie((function(){Ft()}),[Ft]);var Bt={setInputText:B,saveMessages:kt,setMessages:P,resetMessages:Ot,resetError:jt,onClear:Rt,onSubmit:It,onSubmitAction:Ct,onFileUpload:Pt,onUploadFile:Tt,setOpen:fe,setWindowed:te,setShowIconMessage:$,setIsListening:je,setDraggingType:gt,setIsBlocked:xt},_t={theme:d,botId:Ce,customId:Pe,userData:Te,pluginUrl:Ne,inputText:D,messages:C,busy:ye,error:de,setBusy:ve,typewriter:Fe,speechRecognition:Be,speechSynthesis:_e,localMemory:ft,imageUpload:ut,uploadedFile:J,fileSearch:lt,textSend:Ve,textClear:Qe,textInputMaxLength:Je,textInputPlaceholder:Ye,textCompliance:Xe,aiName:$e,userName:Ge,guestName:Ze,aiAvatar:We,userAvatar:qe,isWindow:Ke,copyButton:et,fullscreen:tt,icon:rt,iconText:ot,iconAlt:at,iconPosition:ct,iconBubble:st,cssVariables:ht,iconUrl:mt,chatbotInputRef:xe,conversationRef:Ee,isMobile:He,open:le,windowed:ee,showIconMessage:z,timeElapsed:b,isListening:ke,speechRecognitionAvailable:Re,uploadIconPosition:Et,submitButtonConf:St,draggingType:vt,isBlocked:wt};return React.createElement(ue.Provider,{value:{state:_t,actions:Bt}},s)};function pe(){return pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pe.apply(this,arguments)}const de=["children","options"];var he,me;!function(e){e.blockQuote="0",e.breakLine="1",e.breakThematic="2",e.codeBlock="3",e.codeFenced="4",e.codeInline="5",e.footnote="6",e.footnoteReference="7",e.gfmTask="8",e.heading="9",e.headingSetext="10",e.htmlBlock="11",e.htmlComment="12",e.htmlSelfClosing="13",e.image="14",e.link="15",e.linkAngleBraceStyleDetector="16",e.linkBareUrlDetector="17",e.linkMailtoDetector="18",e.newlineCoalescer="19",e.orderedList="20",e.paragraph="21",e.ref="22",e.refImage="23",e.refLink="24",e.table="25",e.tableSeparator="26",e.text="27",e.textBolded="28",e.textEmphasized="29",e.textEscaped="30",e.textMarked="31",e.textStrikethroughed="32",e.unorderedList="33"}(he||(he={})),function(e){e[e.MAX=0]="MAX",e[e.HIGH=1]="HIGH",e[e.MED=2]="MED",e[e.LOW=3]="LOW",e[e.MIN=4]="MIN"}(me||(me={}));const ye=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","className","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce(((e,t)=>(e[t.toLowerCase()]=t,e)),{for:"htmlFor"}),ve={amp:"&",apos:"'",gt:">",lt:"<",nbsp:" ",quot:"“"},ge=["style","script"],be=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,we=/mailto:/i,xe=/\n{2,}$/,Ee=/^( *>[^\n]+(\n[^\n]+)*\n*)+\n{2,}/,Se=/^ *> ?/gm,Oe=/^ {2,}\n/,ke=/^(?:( *[-*_])){3,} *(?:\n *)+\n/,je=/^\s*(`{3,}|~{3,}) *(\S+)?([^\n]*?)?\n([\s\S]+?)\s*\1 *(?:\n *)*\n?/,Re=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,Ie=/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,Ce=/^(?:\n *)*\n/,Pe=/\r\n?/g,Te=/^\[\^([^\]]+)](:.*)\n/,Le=/^\[\^([^\]]+)]/,Ae=/\f/g,Ne=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,Me=/^\s*?\[(x|\s)\]/,De=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,Fe=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,Be=/^([^\n]+)\n *(=|-){3,} *(?:\n *)+\n/,_e=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?([^>]*)\/{0}>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1)[\s\S])*?)<\/\1>\n*/i,Ue=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,He=/^<!--[\s\S]*?(?:-->)/,ze=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,$e=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,Ge=/^\{.*\}$/,We=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,qe=/^<([^ >]+@[^ >]+)>/,Ve=/^<([^ >]+:\/[^ >]+)>/,Qe=/-([a-z])?/gi,Je=/^(.*\|?.*)\n *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*)\n?/,Ye=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,Xe=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,Ze=/^\[([^\]]*)\] ?\[([^\]]*)\]/,Ke=/(\[|\])/g,et=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,tt=/\t/g,nt=/^ *\| */,rt=/(^ *\||\| *$)/g,ot=/ *$/,it=/^ *:-+: *$/,at=/^ *:-+ *$/,ct=/^ *-+: *$/,st=/^([*_])\1((?:\[.*?\][([].*?[)\]]|<.*?>(?:.*?<.*?>)?|`.*?`|~+.*?~+|.)*?)\1\1(?!\1)/,ut=/^([*_])((?:\[.*?\][([].*?[)\]]|<.*?>(?:.*?<.*?>)?|`.*?`|~+.*?~+|.)*?)\1(?!\1|\w)/,lt=/^==((?:\[.*?\]|<.*?>(?:.*?<.*?>)?|`.*?`|.)*?)==/,ft=/^~~((?:\[.*?\]|<.*?>(?:.*?<.*?>)?|`.*?`|.)*?)~~/,pt=/^\\([^0-9A-Za-z\s])/,dt=/^[\s\S]+?(?=[^0-9A-Z\s\u00c0-\uffff&#;.()'"]|\d+\.|\n\n| {2,}\n|\w+:\S|$)/i,ht=/^\n+/,mt=/^([ \t]*)/,yt=/\\([^\\])/g,vt=/ *\n+$/,gt=/(?:^|\n)( *)$/,bt="(?:\\d+\\.)",wt="(?:[*+-])";function xt(e){return"( *)("+(1===e?bt:wt)+") +"}const Et=xt(1),St=xt(2);function Ot(e){return new RegExp("^"+(1===e?Et:St))}const kt=Ot(1),jt=Ot(2);function Rt(e){return new RegExp("^"+(1===e?Et:St)+"[^\\n]*(?:\\n(?!\\1"+(1===e?bt:wt)+" )[^\\n]*)*(\\n|$)","gm")}const It=Rt(1),Ct=Rt(2);function Pt(e){const t=1===e?bt:wt;return new RegExp("^( *)("+t+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+t+" (?!"+t+" ))\\n*|\\s*\\n*$)")}const Tt=Pt(1),Lt=Pt(2);function At(e,t){const n=1===t,r=n?Tt:Lt,o=n?It:Ct,i=n?kt:jt;return{match(e,t,n){const o=gt.exec(n);return o&&(t.list||!t.inline&&!t.simple)?r.exec(e=o[1]+e):null},order:1,parse(e,t,r){const a=n?+e[2]:void 0,c=e[0].replace(xe,"\n").match(o);let s=!1;return{items:c.map((function(e,n){const o=i.exec(e)[0].length,a=new RegExp("^ {1,"+o+"}","gm"),u=e.replace(a,"").replace(i,""),l=n===c.length-1,f=-1!==u.indexOf("\n\n")||l&&s;s=f;const p=r.inline,d=r.list;let h;r.list=!0,f?(r.inline=!1,h=u.replace(vt,"\n\n")):(r.inline=!0,h=u.replace(vt,""));const m=t(h,r);return r.inline=p,r.list=d,m})),ordered:n,start:a}},render:(t,n,r)=>e(t.ordered?"ol":"ul",{key:r.key,start:"20"===t.type?t.start:void 0},t.items.map((function(t,o){return e("li",{key:o},n(t,r))})))}}const Nt=/^\[([^\]]*)]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/,Mt=/^!\[([^\]]*)]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/,Dt=[Ee,je,Re,De,Be,Fe,He,Je,It,Tt,Ct,Lt],Ft=[...Dt,/^[^\n]+(?:  \n|\n{2,})/,_e,$e];function Bt(e){return e.replace(/[ÀÁÂÃÄÅàáâãäåæÆ]/g,"a").replace(/[çÇ]/g,"c").replace(/[ðÐ]/g,"d").replace(/[ÈÉÊËéèêë]/g,"e").replace(/[ÏïÎîÍíÌì]/g,"i").replace(/[Ññ]/g,"n").replace(/[øØœŒÕõÔôÓóÒò]/g,"o").replace(/[ÜüÛûÚúÙù]/g,"u").replace(/[ŸÿÝý]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function _t(e){return ct.test(e)?"right":it.test(e)?"center":at.test(e)?"left":null}function Ut(e,t,n){const r=n.inTable;n.inTable=!0;const o=t(e.trim(),n);n.inTable=r;let i=[[]];return o.forEach((function(e,t){"26"===e.type?0!==t&&t!==o.length-1&&i.push([]):("27"!==e.type||null!=o[t+1]&&"26"!==o[t+1].type||(e.text=e.text.replace(ot,"")),i[i.length-1].push(e))})),i}function Ht(e,t,n){n.inline=!0;const r=Ut(e[1],t,n),o=e[2].replace(rt,"").split("|").map(_t),i=function(e,t,n){return e.trim().split("\n").map((function(e){return Ut(e,t,n)}))}(e[3],t,n);return n.inline=!1,{align:o,cells:i,header:r,type:"25"}}function zt(e,t){return null==e.align[t]?{}:{textAlign:e.align[t]}}function $t(e){return function(t,n){return n.inline?e.exec(t):null}}function Gt(e){return function(t,n){return n.inline||n.simple?e.exec(t):null}}function Wt(e){return function(t,n){return n.inline||n.simple?null:e.exec(t)}}function qt(e){return function(t){return e.exec(t)}}function Vt(e,t,n){if(t.inline||t.simple)return null;if(n&&!n.endsWith("\n"))return null;let r="";e.split("\n").every((e=>!Dt.some((t=>t.test(e)))&&(r+=e+"\n",e.trim())));const o=r.trimEnd();return""==o?null:[r,o]}function Qt(e){try{if(decodeURIComponent(e).replace(/[^A-Za-z0-9/:]/g,"").match(/^\s*(javascript|vbscript|data(?!:image)):/i))return}catch(e){return null}return e}function Jt(e){return e.replace(yt,"$1")}function Yt(e,t,n){const r=n.inline||!1,o=n.simple||!1;n.inline=!0,n.simple=!0;const i=e(t,n);return n.inline=r,n.simple=o,i}function Xt(e,t,n){const r=n.inline||!1,o=n.simple||!1;n.inline=!1,n.simple=!0;const i=e(t,n);return n.inline=r,n.simple=o,i}function Zt(e,t,n){return n.inline=!1,e(t,n)}const Kt=(e,t,n)=>({children:Yt(t,e[1],n)});function en(){return{}}function tn(){return null}function nn(...e){return e.filter(Boolean).join(" ")}function rn(e,t,n){let r=e;const o=t.split(".");for(;o.length&&(r=r[o[0]],void 0!==r);)o.shift();return r||n}function on(e,n={}){n.overrides=n.overrides||{},n.slugify=n.slugify||Bt,n.namedCodesToUnicode=n.namedCodesToUnicode?pe({},ve,n.namedCodesToUnicode):ve;const r=n.createElement||t.createElement;function o(e,t,...o){const i=rn(n.overrides,`${e}.props`,{});return r(function(e,t){const n=rn(t,e);return n?"function"==typeof n||"object"==typeof n&&"render"in n?n:rn(t,`${e}.component`,e):e}(e,n.overrides),pe({},t,i,{className:nn(null==t?void 0:t.className,i.className)||void 0}),...o)}function i(e){e=e.replace(Ne,"");let r=!1;n.forceInline?r=!0:n.forceBlock||(r=!1===et.test(e));const i=f(l(r?e:`${e.trimEnd().replace(ht,"")}\n\n`,{inline:r}));for(;"string"==typeof i[i.length-1]&&!i[i.length-1].trim();)i.pop();if(null===n.wrapper)return i;const a=n.wrapper||(r?"span":"div");let c;if(i.length>1||n.forceWrapper)c=i;else{if(1===i.length)return c=i[0],"string"==typeof c?o("span",{key:"outer"},c):c;c=null}return t.createElement(a,{key:"outer"},c)}function a(e){const n=e.match(be);return n?n.reduce((function(e,n,r){const o=n.indexOf("=");if(-1!==o){const a=function(e){return-1!==e.indexOf("-")&&null===e.match(ze)&&(e=e.replace(Qe,(function(e,t){return t.toUpperCase()}))),e}(n.slice(0,o)).trim(),c=function(e){const t=e[0];return('"'===t||"'"===t)&&e.length>=2&&e[e.length-1]===t?e.slice(1,-1):e}(n.slice(o+1).trim()),s=ye[a]||a,u=e[s]=function(e,t){return"style"===e?t.split(/;\s?/).reduce((function(e,t){const n=t.slice(0,t.indexOf(":"));return e[n.replace(/(-[a-z])/g,(e=>e[1].toUpperCase()))]=t.slice(n.length+1).trim(),e}),{}):"href"===e||"src"===e?Qt(t):(t.match(Ge)&&(t=t.slice(1,t.length-1)),"true"===t||"false"!==t&&t)}(a,c);"string"==typeof u&&(_e.test(u)||$e.test(u))&&(e[s]=t.cloneElement(i(u.trim()),{key:r}))}else"style"!==n&&(e[ye[n]||n]=!0);return e}),{}):null}const c=[],s={},u={0:{match:Wt(Ee),order:1,parse:(e,t,n)=>({children:t(e[0].replace(Se,""),n)}),render:(e,t,n)=>o("blockquote",{key:n.key},t(e.children,n))},1:{match:qt(Oe),order:1,parse:en,render:(e,t,n)=>o("br",{key:n.key})},2:{match:Wt(ke),order:1,parse:en,render:(e,t,n)=>o("hr",{key:n.key})},3:{match:Wt(Re),order:0,parse:e=>({lang:void 0,text:e[0].replace(/^ {4}/gm,"").replace(/\n+$/,"")}),render:(e,t,n)=>o("pre",{key:n.key},o("code",pe({},e.attrs,{className:e.lang?`lang-${e.lang}`:""}),e.text))},4:{match:Wt(je),order:0,parse:e=>({attrs:a(e[3]||""),lang:e[2]||void 0,text:e[4],type:"3"})},5:{match:Gt(Ie),order:3,parse:e=>({text:e[2]}),render:(e,t,n)=>o("code",{key:n.key},e.text)},6:{match:Wt(Te),order:0,parse:e=>(c.push({footnote:e[2],identifier:e[1]}),{}),render:tn},7:{match:$t(Le),order:1,parse:e=>({target:`#${n.slugify(e[1])}`,text:e[1]}),render:(e,t,n)=>o("a",{key:n.key,href:Qt(e.target)},o("sup",{key:n.key},e.text))},8:{match:$t(Me),order:1,parse:e=>({completed:"x"===e[1].toLowerCase()}),render:(e,t,n)=>o("input",{checked:e.completed,key:n.key,readOnly:!0,type:"checkbox"})},9:{match:Wt(n.enforceAtxHeadings?Fe:De),order:1,parse:(e,t,r)=>({children:Yt(t,e[2],r),id:n.slugify(e[2]),level:e[1].length}),render:(e,t,n)=>o(`h${e.level}`,{id:e.id,key:n.key},t(e.children,n))},10:{match:Wt(Be),order:0,parse:(e,t,n)=>({children:Yt(t,e[1],n),level:"="===e[2]?1:2,type:"9"})},11:{match:qt(_e),order:1,parse(e,t,n){const[,r]=e[3].match(mt),o=new RegExp(`^${r}`,"gm"),i=e[3].replace(o,""),c=(s=i,Ft.some((e=>e.test(s)))?Zt:Yt);var s;const u=e[1].toLowerCase(),l=-1!==ge.indexOf(u),f={attrs:a(e[2]),noInnerParse:l,tag:l?u:e[1]};return n.inAnchor=n.inAnchor||"a"===u,l?f.text=e[3]:f.children=c(t,i,n),n.inAnchor=!1,f},render:(e,t,n)=>o(e.tag,pe({key:n.key},e.attrs),e.text||t(e.children,n))},13:{match:qt($e),order:1,parse:e=>({attrs:a(e[2]||""),tag:e[1]}),render:(e,t,n)=>o(e.tag,pe({},e.attrs,{key:n.key}))},12:{match:qt(He),order:1,parse:()=>({}),render:tn},14:{match:Gt(Mt),order:1,parse:e=>({alt:e[1],target:Jt(e[2]),title:e[3]}),render:(e,t,n)=>o("img",{key:n.key,alt:e.alt||void 0,title:e.title||void 0,src:Qt(e.target)})},15:{match:$t(Nt),order:3,parse:(e,t,n)=>({children:Xt(t,e[1],n),target:Jt(e[2]),title:e[3]}),render:(e,t,n)=>o("a",{key:n.key,href:Qt(e.target),title:e.title},t(e.children,n))},16:{match:$t(Ve),order:0,parse:e=>({children:[{text:e[1],type:"27"}],target:e[1],type:"15"})},17:{match:(e,t)=>t.inAnchor?null:$t(We)(e,t),order:0,parse:e=>({children:[{text:e[1],type:"27"}],target:e[1],title:void 0,type:"15"})},18:{match:$t(qe),order:0,parse(e){let t=e[1],n=e[1];return we.test(n)||(n="mailto:"+n),{children:[{text:t.replace("mailto:",""),type:"27"}],target:n,type:"15"}}},20:At(o,1),33:At(o,2),19:{match:Wt(Ce),order:3,parse:en,render:()=>"\n"},21:{match:Vt,order:3,parse:Kt,render:(e,t,n)=>o("p",{key:n.key},t(e.children,n))},22:{match:$t(Ye),order:0,parse:e=>(s[e[1]]={target:e[2],title:e[4]},{}),render:tn},23:{match:Gt(Xe),order:0,parse:e=>({alt:e[1]||void 0,ref:e[2]}),render:(e,t,n)=>o("img",{key:n.key,alt:e.alt,src:Qt(s[e.ref].target),title:s[e.ref].title})},24:{match:$t(Ze),order:0,parse:(e,t,n)=>({children:t(e[1],n),fallbackChildren:t(e[0].replace(Ke,"\\$1"),n),ref:e[2]}),render:(e,t,n)=>s[e.ref]?o("a",{key:n.key,href:Qt(s[e.ref].target),title:s[e.ref].title},t(e.children,n)):o("span",{key:n.key},t(e.fallbackChildren,n))},25:{match:Wt(Je),order:1,parse:Ht,render:(e,t,n)=>o("table",{key:n.key},o("thead",null,o("tr",null,e.header.map((function(r,i){return o("th",{key:i,style:zt(e,i)},t(r,n))})))),o("tbody",null,e.cells.map((function(r,i){return o("tr",{key:i},r.map((function(r,i){return o("td",{key:i,style:zt(e,i)},t(r,n))})))}))))},26:{match:function(e,t){return t.inTable?(t.inline=!0,nt.exec(e)):null},order:1,parse:function(){return{type:"26"}},render:()=>" | "},27:{match:qt(dt),order:4,parse:e=>({text:e[0].replace(Ue,((e,t)=>n.namedCodesToUnicode[t]?n.namedCodesToUnicode[t]:e))}),render:e=>e.text},28:{match:Gt(st),order:2,parse:(e,t,n)=>({children:t(e[2],n)}),render:(e,t,n)=>o("strong",{key:n.key},t(e.children,n))},29:{match:Gt(ut),order:3,parse:(e,t,n)=>({children:t(e[2],n)}),render:(e,t,n)=>o("em",{key:n.key},t(e.children,n))},30:{match:Gt(pt),order:1,parse:e=>({text:e[1],type:"27"})},31:{match:Gt(lt),order:3,parse:Kt,render:(e,t,n)=>o("mark",{key:n.key},t(e.children,n))},32:{match:Gt(ft),order:3,parse:Kt,render:(e,t,n)=>o("del",{key:n.key},t(e.children,n))}};!0===n.disableParsingRawHTML&&(delete u[11],delete u[13]);const l=function(e){let t=Object.keys(e);function n(r,o){let i=[],a="";for(;r;){let c=0;for(;c<t.length;){const s=t[c],u=e[s],l=u.match(r,o,a);if(l){const e=l[0];r=r.substring(e.length);const t=u.parse(l,n,o);null==t.type&&(t.type=s),i.push(t),a=e;break}c++}}return i}return t.sort((function(t,n){let r=e[t].order,o=e[n].order;return r!==o?r-o:1})),function(e,t){return n(function(e){return e.replace(Pe,"\n").replace(Ae,"").replace(tt,"    ")}(e),t)}}(u),f=(p=function(e,t){return function(n,r,o){const i=e[n.type].render;return t?t((()=>i(n,r,o)),n,r,o):i(n,r,o)}}(u,n.renderRule),function e(t,n={}){if(Array.isArray(t)){const r=n.key,o=[];let i=!1;for(let r=0;r<t.length;r++){n.key=r;const a=e(t[r],n),c="string"==typeof a;c&&i?o[o.length-1]+=a:null!==a&&o.push(a),i=c}return n.key=r,o}return p(t,e,n)});var p;const d=i(e);return c.length?o("div",null,d,o("footer",{key:"footer"},c.map((function(e){return o("div",{id:n.slugify(e.identifier),key:e.identifier},e.identifier,f(l(e.footnote,{inline:!0})))})))):d}const an=e=>{let{children:n,options:r}=e,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}(e,de);return t.cloneElement(on(n,r),o)};function cn(){return cn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cn.apply(this,arguments)}var sn={strings:["These are the default values...","You know what you should do?","Use your own!","Have a great day!"],stringsElement:null,typeSpeed:0,startDelay:0,backSpeed:0,smartBackspace:!0,shuffle:!1,backDelay:700,fadeOut:!1,fadeOutClass:"typed-fade-out",fadeOutDelay:500,loop:!1,loopCount:1/0,showCursor:!0,cursorChar:"|",autoInsertCss:!0,attr:null,bindInputFocusEvents:!1,contentType:"html",onBegin:function(e){},onComplete:function(e){},preStringTyped:function(e,t){},onStringTyped:function(e,t){},onLastStringBackspaced:function(e){},onTypingPaused:function(e,t){},onTypingResumed:function(e,t){},onReset:function(e){},onStop:function(e,t){},onStart:function(e,t){},onDestroy:function(e){}},un=new(function(){function e(){}var t=e.prototype;return t.load=function(e,t,n){if(e.el="string"==typeof n?document.querySelector(n):n,e.options=cn({},sn,t),e.isInput="input"===e.el.tagName.toLowerCase(),e.attr=e.options.attr,e.bindInputFocusEvents=e.options.bindInputFocusEvents,e.showCursor=!e.isInput&&e.options.showCursor,e.cursorChar=e.options.cursorChar,e.cursorBlinking=!0,e.elContent=e.attr?e.el.getAttribute(e.attr):e.el.textContent,e.contentType=e.options.contentType,e.typeSpeed=e.options.typeSpeed,e.startDelay=e.options.startDelay,e.backSpeed=e.options.backSpeed,e.smartBackspace=e.options.smartBackspace,e.backDelay=e.options.backDelay,e.fadeOut=e.options.fadeOut,e.fadeOutClass=e.options.fadeOutClass,e.fadeOutDelay=e.options.fadeOutDelay,e.isPaused=!1,e.strings=e.options.strings.map((function(e){return e.trim()})),e.stringsElement="string"==typeof e.options.stringsElement?document.querySelector(e.options.stringsElement):e.options.stringsElement,e.stringsElement){e.strings=[],e.stringsElement.style.cssText="clip: rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;";var r=Array.prototype.slice.apply(e.stringsElement.children),o=r.length;if(o)for(var i=0;i<o;i+=1)e.strings.push(r[i].innerHTML.trim())}for(var a in e.strPos=0,e.currentElContent=this.getCurrentElContent(e),e.currentElContent&&e.currentElContent.length>0&&(e.strPos=e.currentElContent.length-1,e.strings.unshift(e.currentElContent)),e.sequence=[],e.strings)e.sequence[a]=a;e.arrayPos=0,e.stopNum=0,e.loop=e.options.loop,e.loopCount=e.options.loopCount,e.curLoop=0,e.shuffle=e.options.shuffle,e.pause={status:!1,typewrite:!0,curString:"",curStrPos:0},e.typingComplete=!1,e.autoInsertCss=e.options.autoInsertCss,e.autoInsertCss&&(this.appendCursorAnimationCss(e),this.appendFadeOutAnimationCss(e))},t.getCurrentElContent=function(e){return e.attr?e.el.getAttribute(e.attr):e.isInput?e.el.value:"html"===e.contentType?e.el.innerHTML:e.el.textContent},t.appendCursorAnimationCss=function(e){var t="data-typed-js-cursor-css";if(e.showCursor&&!document.querySelector("["+t+"]")){var n=document.createElement("style");n.setAttribute(t,"true"),n.innerHTML="\n        .typed-cursor{\n          opacity: 1;\n        }\n        .typed-cursor.typed-cursor--blink{\n          animation: typedjsBlink 0.7s infinite;\n          -webkit-animation: typedjsBlink 0.7s infinite;\n                  animation: typedjsBlink 0.7s infinite;\n        }\n        @keyframes typedjsBlink{\n          50% { opacity: 0.0; }\n        }\n        @-webkit-keyframes typedjsBlink{\n          0% { opacity: 1; }\n          50% { opacity: 0.0; }\n          100% { opacity: 1; }\n        }\n      ",document.body.appendChild(n)}},t.appendFadeOutAnimationCss=function(e){var t="data-typed-fadeout-js-css";if(e.fadeOut&&!document.querySelector("["+t+"]")){var n=document.createElement("style");n.setAttribute(t,"true"),n.innerHTML="\n        .typed-fade-out{\n          opacity: 0;\n          transition: opacity .25s;\n        }\n        .typed-cursor.typed-cursor--blink.typed-fade-out{\n          -webkit-animation: 0;\n          animation: 0;\n        }\n      ",document.body.appendChild(n)}},e}()),ln=new(function(){function e(){}var t=e.prototype;return t.typeHtmlChars=function(e,t,n){if("html"!==n.contentType)return t;var r=e.substring(t).charAt(0);if("<"===r||"&"===r){var o;for(o="<"===r?">":";";e.substring(t+1).charAt(0)!==o&&!(1+ ++t>e.length););t++}return t},t.backSpaceHtmlChars=function(e,t,n){if("html"!==n.contentType)return t;var r=e.substring(t).charAt(0);if(">"===r||";"===r){var o;for(o=">"===r?"<":"&";e.substring(t-1).charAt(0)!==o&&!(--t<0););t--}return t},e}()),fn=function(){function e(e,t){un.load(this,t,e),this.begin()}var t=e.prototype;return t.toggle=function(){this.pause.status?this.start():this.stop()},t.stop=function(){this.typingComplete||this.pause.status||(this.toggleBlinking(!0),this.pause.status=!0,this.options.onStop(this.arrayPos,this))},t.start=function(){this.typingComplete||this.pause.status&&(this.pause.status=!1,this.pause.typewrite?this.typewrite(this.pause.curString,this.pause.curStrPos):this.backspace(this.pause.curString,this.pause.curStrPos),this.options.onStart(this.arrayPos,this))},t.destroy=function(){this.reset(!1),this.options.onDestroy(this)},t.reset=function(e){void 0===e&&(e=!0),clearInterval(this.timeout),this.replaceText(""),this.cursor&&this.cursor.parentNode&&(this.cursor.parentNode.removeChild(this.cursor),this.cursor=null),this.strPos=0,this.arrayPos=0,this.curLoop=0,e&&(this.insertCursor(),this.options.onReset(this),this.begin())},t.begin=function(){var e=this;this.options.onBegin(this),this.typingComplete=!1,this.shuffleStringsIfNeeded(this),this.insertCursor(),this.bindInputFocusEvents&&this.bindFocusEvents(),this.timeout=setTimeout((function(){0===e.strPos?e.typewrite(e.strings[e.sequence[e.arrayPos]],e.strPos):e.backspace(e.strings[e.sequence[e.arrayPos]],e.strPos)}),this.startDelay)},t.typewrite=function(e,t){var n=this;this.fadeOut&&this.el.classList.contains(this.fadeOutClass)&&(this.el.classList.remove(this.fadeOutClass),this.cursor&&this.cursor.classList.remove(this.fadeOutClass));var r=this.humanizer(this.typeSpeed),o=1;!0!==this.pause.status?this.timeout=setTimeout((function(){t=ln.typeHtmlChars(e,t,n);var r=0,i=e.substring(t);if("^"===i.charAt(0)&&/^\^\d+/.test(i)){var a=1;a+=(i=/\d+/.exec(i)[0]).length,r=parseInt(i),n.temporaryPause=!0,n.options.onTypingPaused(n.arrayPos,n),e=e.substring(0,t)+e.substring(t+a),n.toggleBlinking(!0)}if("`"===i.charAt(0)){for(;"`"!==e.substring(t+o).charAt(0)&&(o++,!(t+o>e.length)););var c=e.substring(0,t),s=e.substring(c.length+1,t+o),u=e.substring(t+o+1);e=c+s+u,o--}n.timeout=setTimeout((function(){n.toggleBlinking(!1),t>=e.length?n.doneTyping(e,t):n.keepTyping(e,t,o),n.temporaryPause&&(n.temporaryPause=!1,n.options.onTypingResumed(n.arrayPos,n))}),r)}),r):this.setPauseStatus(e,t,!0)},t.keepTyping=function(e,t,n){0===t&&(this.toggleBlinking(!1),this.options.preStringTyped(this.arrayPos,this));var r=e.substring(0,t+=n);this.replaceText(r),this.typewrite(e,t)},t.doneTyping=function(e,t){var n=this;this.options.onStringTyped(this.arrayPos,this),this.toggleBlinking(!0),this.arrayPos===this.strings.length-1&&(this.complete(),!1===this.loop||this.curLoop===this.loopCount)||(this.timeout=setTimeout((function(){n.backspace(e,t)}),this.backDelay))},t.backspace=function(e,t){var n=this;if(!0!==this.pause.status){if(this.fadeOut)return this.initFadeOut();this.toggleBlinking(!1);var r=this.humanizer(this.backSpeed);this.timeout=setTimeout((function(){t=ln.backSpaceHtmlChars(e,t,n);var r=e.substring(0,t);if(n.replaceText(r),n.smartBackspace){var o=n.strings[n.arrayPos+1];n.stopNum=o&&r===o.substring(0,t)?t:0}t>n.stopNum?(t--,n.backspace(e,t)):t<=n.stopNum&&(n.arrayPos++,n.arrayPos===n.strings.length?(n.arrayPos=0,n.options.onLastStringBackspaced(),n.shuffleStringsIfNeeded(),n.begin()):n.typewrite(n.strings[n.sequence[n.arrayPos]],t))}),r)}else this.setPauseStatus(e,t,!1)},t.complete=function(){this.options.onComplete(this),this.loop?this.curLoop++:this.typingComplete=!0},t.setPauseStatus=function(e,t,n){this.pause.typewrite=n,this.pause.curString=e,this.pause.curStrPos=t},t.toggleBlinking=function(e){this.cursor&&(this.pause.status||this.cursorBlinking!==e&&(this.cursorBlinking=e,e?this.cursor.classList.add("typed-cursor--blink"):this.cursor.classList.remove("typed-cursor--blink")))},t.humanizer=function(e){return Math.round(Math.random()*e/2)+e},t.shuffleStringsIfNeeded=function(){this.shuffle&&(this.sequence=this.sequence.sort((function(){return Math.random()-.5})))},t.initFadeOut=function(){var e=this;return this.el.className+=" "+this.fadeOutClass,this.cursor&&(this.cursor.className+=" "+this.fadeOutClass),setTimeout((function(){e.arrayPos++,e.replaceText(""),e.strings.length>e.arrayPos?e.typewrite(e.strings[e.sequence[e.arrayPos]],0):(e.typewrite(e.strings[0],0),e.arrayPos=0)}),this.fadeOutDelay)},t.replaceText=function(e){this.attr?this.el.setAttribute(this.attr,e):this.isInput?this.el.value=e:"html"===this.contentType?this.el.innerHTML=e:this.el.textContent=e},t.bindFocusEvents=function(){var e=this;this.isInput&&(this.el.addEventListener("focus",(function(t){e.stop()})),this.el.addEventListener("blur",(function(t){e.el.value&&0!==e.el.value.length||e.start()})))},t.insertCursor=function(){this.showCursor&&(this.cursor||(this.cursor=document.createElement("span"),this.cursor.className="typed-cursor",this.cursor.setAttribute("aria-hidden",!0),this.cursor.innerHTML=this.cursorChar,this.el.parentNode&&this.el.parentNode.insertBefore(this.cursor,this.el.nextSibling)))},e}();function pn(e){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pn(e)}function dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dn(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],o=function(e){var t=function(e,t){if("object"!=pn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=pn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pn(t)?t:String(t)}(o),o in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mn=function(e){var t={width:9,height:9,margin:"5px 0px 0px 5px",borderRadius:"50%",backgroundColor:"#a3a1a1",opacity:1,animation:"bouncing-loader 0.4s infinite alternate"};return React.createElement(React.Fragment,null,React.createElement("style",null,"\n          @keyframes bouncing-loader {\n            to {\n              opacity: 0.6;\n              transform: translateY(-10px);\n            }\n          }\n        "),React.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:26}},["0.1s","0.2s","0.3s"].map((function(e,n){return React.createElement("div",{key:n,style:hn(hn({},t),{},{animationDelay:e})})}))))};function yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var vn=wp.element.useState;const gn=function(e){var t=e.content,n=v(),r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return yn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(vn(!1),2),o=r[0],i=r[1];return React.createElement("div",{className:n("mwai-copy-button",{"mwai-animate":o}),onClick:function(){try{navigator.clipboard.writeText(t),i(!0),setTimeout((function(){i(!1)}),1e3)}catch(e){console.warn("Not allowed to copy to clipboard. Make sure your website uses HTTPS.",{content:t})}}},React.createElement("div",{className:"mwai-copy-button-one"}),React.createElement("div",{className:"mwai-copy-button-two"}))};var bn=wp.element.useMemo;const wn=function(e){var t=e.role,n=void 0===t?"user":t,r=le().state,o=r.pluginUrl,i=r.iconUrl,a=r.guestName,s=r.userData,u=r.userName,l=r.aiName,f=r.userAvatar,p=r.aiAvatar,d=function(e){return React.createElement("div",{className:"mwai-avatar"},React.createElement("img",{width:"32",height:"32",src:e}))},h=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?i||"".concat(o,"/images/chat-openai.svg"):"".concat(o,"/images/avatar-user.svg");return d(e)},m=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(e){if(g(e))return d(e);if(o&&p||!o&&f)return h(o);var i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Guest: ",n=arguments.length>2?arguments[2]:void 0;if(!n||0===Object.keys(n).length)return t;for(var r=0,o=Object.entries(n);r<o.length;r++){var i=c(o[r],2),a=i[0],s=i[1],u="{".concat(a,"}");e.includes(u)&&(e=e.replace(u,s))}return e||t||"Guest: "}(e,t,n);return function(e){return React.createElement("div",{className:"mwai-name-text"},e)}(i)}return n&&!o?d(n.AVATAR_URL):h(o)},y=bn((function(){return"assistant"===n?m(l,a,s,o,!0):m(u,a,s,o,!1)}),[n,l,u,a,s,o,i,p,f]);return React.createElement("span",{className:"mwai-name"},y)};function xn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return En(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?En(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function En(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Sn=wp.element,On=Sn.useState,kn=Sn.useMemo,jn=Sn.useEffect,Rn=Sn.useRef,In=function(e){var t=e.href,n=e.children;if(!t)return React.createElement("span",null,n);var r=window.location.hostname,o="_self";try{o=r===new URL(t,window.location.href).hostname?"_self":"_blank"}catch(e){console.error("Invalid URL:",e),o="_blank"}if("Uploaded File"===String(n)){var i=t.split("/").pop();return React.createElement("a",{href:t,target:o,rel:"noopener noreferrer",className:"mwai-filename"},React.createElement("span",null,"✓ ",i))}return React.createElement("a",{href:t,target:o,rel:"noopener noreferrer"},n)},Cn=function(e){var t,n=e.message,r=e.onRendered,o=void 0===r?function(){}:r,i=le().state.copyButton,a=xn(On(n.isQuerying||n.isStreaming),1)[0],c=n.isQuerying,s=n.isStreaming,u=null!==(t=n.content)&&void 0!==t?t:"";(u.match(/```/g)||[]).length%2!=0?u+="\n```":n.isStreaming&&(u+="<BlinkingCursor />"),jn((function(){a&&(!a||c||s)||o()}),[a,c,s]);var l=kn((function(){var e={overrides:{BlinkingCursor:{component:z},a:{component:In},img:{props:{onError:function(e){null!==e.target.src.match(/\.(jpeg|jpg|gif|png)$/)&&(e.target.src="https://placehold.co/600x200?text=Expired+Image")},className:"mwai-image"}}}};return e}),[]);return c||s&&!u?React.createElement(mn,null):React.createElement(React.Fragment,null,React.createElement(wn,{role:n.role}),React.createElement("span",{className:"mwai-text"},React.createElement("span",null,React.createElement(an,{options:l},u))),i&&React.createElement(gn,{content:n.content}))},Pn=function(e){var t=e.message,n=e.onRendered,r=void 0===n?function(){}:n,o=xn(On(null==t?void 0:t.images),2),i=o[0],a=o[1];return jn((function(){r()})),t.isQuerying?React.createElement(mn,null):React.createElement(React.Fragment,null,React.createElement(wn,{role:t.role}),React.createElement("span",{className:"mwai-text"},React.createElement("div",{className:"mwai-gallery"},null==i?void 0:i.map((function(e,t){return React.createElement("a",{key:t,href:e,target:"_blank",rel:"noopener noreferrer"},React.createElement("img",{key:t,src:e,onError:function(){return function(e){a((function(t){return t.map((function(t,n){return n===e?"https://placehold.co/600x200?text=Expired+Image":t}))}))}(t)}}))})))))},Tn=function(e){var t=e.message,n=e.conversationRef,r=e.onRendered,o=void 0===r?function(){}:r,i=le().state.copyButton,a=Rn(null),c=xn(On(t.isQuerying),1)[0],s=xn(On(!t.isQuerying),2),u=s[0],l=s[1],f=xn(On(!1),2),p=f[0],d=(f[1],t.content);return function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=m();h((function(){r.current=t}),[t]),h((function(){if(null!==e&&n){var t=setInterval((function(){r.current()}),e);return function(){return clearInterval(t)}}}),[e,n])}(200,(function(){null!=n&&n.current&&(p||(n.current.scrollTop=n.current.scrollHeight))}),!u),jn((function(){if(c){if(a.current){var e={strings:[d],typeSpeed:k("typewriter.speed",15),showCursor:!1,onComplete:function(e){e.cursor&&e.cursor.remove(),o(),l((function(){return!0}))}},t=new fn(a.current,e);return function(){t.destroy()}}}else o()}),[t,t.isQuerying]),React.createElement(React.Fragment,null,t.isQuerying&&React.createElement(mn,null),!t.isQuerying&&c&&React.createElement(React.Fragment,null,React.createElement(wn,{role:t.role}),React.createElement("span",{className:"mwai-text",ref:a})),!t.isQuerying&&!c&&React.createElement(React.Fragment,null,React.createElement(wn,{role:t.role}),React.createElement("span",{className:"mwai-text"},React.createElement(an,null,d))),u&&i&&React.createElement(gn,{content:d}))};const Ln=function(e){var t,n=e.message,r=e.conversationRef,o=le().state.typewriter,i=v(),a=Rn(),c=i("mwai-reply",{"mwai-ai":"assistant"===n.role,"mwai-user":"user"===n.role,"mwai-system":"system"===n.role}),s=(null==n||null===(t=n.images)||void 0===t?void 0:t.length)>0,u=function(){a.current&&(n.isQuerying||a.current.classList.contains("mwai-rendered")||"undefined"!=typeof hljs&&(a.current.classList.add("mwai-rendered"),a.current.querySelectorAll("pre code").forEach((function(e){hljs.highlightElement(e)}))))};return kn((function(){return"user"===n.role?React.createElement("div",{ref:a,className:c},React.createElement(Cn,{message:n})):"assistant"===n.role?s?React.createElement("div",{ref:a,className:c},React.createElement(Pn,{message:n,conversationRef:r,onRendered:u})):o&&!n.isStreaming?React.createElement("div",{ref:a,className:c},React.createElement(Tn,{message:n,conversationRef:r,onRendered:u})):React.createElement("div",{ref:a,className:c},React.createElement(Cn,{message:n,conversationRef:r,onRendered:u})):"system"===n.role?React.createElement("div",{ref:a,className:c},React.createElement(Cn,{message:n,conversationRef:r,onRendered:u})):React.createElement("div",null,React.createElement("i",null,"Unhandled role."))}),[n,r,s,o])};function An(){return An=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},An.apply(this,arguments)}const Nn=t.useLayoutEffect;var Mn=function(e,t){"function"!=typeof e?e.current=t:e(t)};var Dn={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},Fn=function(e){Object.keys(Dn).forEach((function(t){e.style.setProperty(t,Dn[t],"important")}))},Bn=null,_n=function(e,t){var n=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?n+t.borderSize:n-t.paddingSize},Un=function(){},Hn=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak"],zn=!!document.documentElement.currentStyle;function $n(e,n,r){var o,i,a=(o=r,i=t.useRef(o),Nn((function(){i.current=o})),i);t.useLayoutEffect((function(){var t=function(e){return a.current(e)};if(e)return e.addEventListener(n,t),function(){return e.removeEventListener(n,t)}}),[])}var Gn=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],Wn=function(e,n){var r,o=e.cacheMeasurements,i=e.maxRows,a=e.minRows,c=e.onChange,s=void 0===c?Un:c,u=e.onHeightChange,l=void 0===u?Un:u,f=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,Gn),p=void 0!==f.value,d=t.useRef(null),h=function(e,n){var r=(0,t.useRef)();return(0,t.useCallback)((function(t){e.current=t,r.current&&Mn(r.current,null),r.current=n,n&&Mn(n,t)}),[n])}(d,n),m=t.useRef(0),y=t.useRef(),v=function(){var e=d.current,t=o&&y.current?y.current:function(e){var t=window.getComputedStyle(e);if(null===t)return null;var n,r=(n=t,Hn.reduce((function(e,t){return e[t]=n[t],e}),{})),o=r.boxSizing;return""===o?null:(zn&&"border-box"===o&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px"),{sizingStyle:r,paddingSize:parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),borderSize:parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth)})}(e);if(t){y.current=t;var n=function(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=1/0),Bn||((Bn=document.createElement("textarea")).setAttribute("tabindex","-1"),Bn.setAttribute("aria-hidden","true"),Fn(Bn)),null===Bn.parentNode&&document.body.appendChild(Bn);var o=e.paddingSize,i=e.borderSize,a=e.sizingStyle,c=a.boxSizing;Object.keys(a).forEach((function(e){var t=e;Bn.style[t]=a[t]})),Fn(Bn),Bn.value=t;var s=_n(Bn,e);Bn.value=t,s=_n(Bn,e),Bn.value="x";var u=Bn.scrollHeight-o,l=u*n;"border-box"===c&&(l=l+o+i),s=Math.max(l,s);var f=u*r;return"border-box"===c&&(f=f+o+i),[s=Math.min(f,s),u]}(t,e.value||e.placeholder||"x",a,i),r=n[0],c=n[1];m.current!==r&&(m.current=r,e.style.setProperty("height",r+"px","important"),l(r,{rowHeight:c}))}};return t.useLayoutEffect(v),$n(window,"resize",v),r=v,$n(document.fonts,"loadingdone",r),t.createElement("textarea",An({},f,{onChange:function(e){p||v(),s(e)},ref:h}))},qn=t.forwardRef(Wn);function Vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Qn=wp.element,Jn=Qn.useState,Yn=Qn.useMemo,Xn=Qn.useRef;const Zn=function(){var e=v(),t=le(),n=t.state,r=t.actions,o=n.uploadedFile,i=n.busy,a=n.imageUpload,c=n.fileSearch,s=n.draggingType,u=r.onUploadFile,l=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Jn(!1),2),f=l[0],p=l[1],d=Xn(),h=null==o?void 0:o.uploadedId,m=a||c,y=o,g=Yn((function(){return null!=y&&y.localFile?y.localFile.type.startsWith("image/")?"image":"document":s}),[y,s]),b=Yn((function(){var e="idle";null!=y&&y.uploadProgress?e="up":s?e="add":f&&h?e="del":h?e="ok":f&&!h&&(e="add");var t=g?g.toLowerCase():"idle";return"mwai-file-upload-icon mwai-".concat(t,"-").concat(e)}),[g,y,s,f,h]),w=Yn((function(){return null!=y&&y.uploadProgress?y.uploadProgress>99?99:Math.round(y.uploadProgress):""}),[y]);return m?React.createElement("div",{disabled:i,onClick:function(){null!=o&&o.localFile?u(null):i||d.current.click()},onMouseEnter:function(){return p(!0)},onMouseLeave:function(){return p(!1)},className:e("mwai-file-upload",{"mwai-enabled":null==o?void 0:o.uploadedId,"mwai-busy":(null==o?void 0:o.localFile)&&!(null!=o&&o.uploadedId)}),style:{cursor:i?"default":"pointer"}},React.createElement("div",{className:b},React.createElement("span",{className:"mwai-file-upload-progress"},w)),React.createElement("input",{type:"file",ref:d,onChange:function(e){var t=e.target.files[0];t&&u(t)},style:{display:"none"}})):null};function Kn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var er=wp.element,tr=er.useRef,nr=er.useState,rr=er.useEffect,or=er.useImperativeHandle;const ir=function(){var e=v(),t=le(),n=t.state,r=t.actions,o=n.inputText,i=n.textInputMaxLength,a=n.textInputPlaceholder,c=n.error,s=n.speechRecognitionAvailable,u=n.isMobile,l=n.conversationRef,f=n.open,p=n.uploadIconPosition,d=n.draggingType,h=n.isBlocked,m=n.isListening,g=n.busy,b=n.speechRecognition,w=n.imageUpload,x=n.fileSearch,E=n.chatbotInputRef,S=r.onSubmitAction,O=r.setIsListening,k=r.resetError,j=r.setInputText,R=r.setIsBlocked,I=r.setDraggingType,C=r.onUploadFile,P=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Kn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(nr(!1),2),T=P[0],L=P[1],A=tr();or(E,(function(){return{focusInput:function(){var e;null===(e=A.current)||void 0===e||e.focus()},currentElement:function(){return A.current}}})),rr((function(){!u&&f&&A.current.focus(),l.current&&(l.current.scrollTop=l.current.scrollHeight)}),[f,u,l]);var N=function(e,t){e.preventDefault(),e.stopPropagation();var n=e.dataTransfer.items[0];t?w&&function(e){return e.type.startsWith("image/")}(n)?(I("image"),R(!1)):x&&function(e){return["text/x-c","text/x-csharp","text/x-c++","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/html","text/x-java","application/json","text/markdown","application/pdf","text/x-php","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-python","text/x-script.python","text/x-ruby","text/x-tex","text/plain","text/css","text/javascript","application/x-sh","application/typescript"].includes(e.type)}(n)?(I("document"),R(!1)):(I(!1),R(!0)):(I(!1),R(!1))},M=e("mwai-input-text",{"mwai-dragging":d,"mwai-blocked":h});return React.createElement("div",{ref:E,className:M,onDrop:function(e){if(e.preventDefault(),N(e,!1),!g){var t=e.dataTransfer.files[0];t&&("image"===d&&w||"document"===d&&x?C(t):(R(!0),setTimeout((function(){return R(!1)}),2e3)))}},onDragEnter:function(e){return N(e,!0)},onDragLeave:function(e){return N(e,!1)},onDragOver:function(e){return N(e,!0)}},"mwai-input"===p&&React.createElement(Zn,null),React.createElement(qn,{ref:A,disabled:g,placeholder:a,value:o,maxLength:i,onCompositionStart:function(){return L(!0)},onCompositionEnd:function(){return L(!1)},onKeyDown:function(e){T||"Enter"!==e.code||e.shiftKey||(e.preventDefault(),S())},onChange:function(e){return t=e.target.value,m&&O(!1),c&&k(),void j(t);var t}}),b&&React.createElement(y,{active:m,disabled:!s||g,className:"mwai-microphone",onClick:function(){return O(!m)}}))};var ar=wp.element,cr=ar.useMemo,sr=ar.useCallback;const ur=function(){var e=le(),t=e.state,n=e.actions,r=n.onClear,o=n.onSubmitAction,i=n.setIsListening,a=t.textClear,c=t.textSend,s=t.uploadedFile,u=t.inputText,l=t.messages,f=t.isListening,p=t.timeElapsed,d=t.busy,h=t.submitButtonConf,m=!(null==s||!s.uploadProgress),y=!(null!=s&&s.uploadedId)&&u.length<1&&(null==l?void 0:l.length)>1,v=cr((function(){return d?p?React.createElement("div",{className:"mwai-timer"},p):null:null!=h&&h.image?React.createElement("img",{src:h.image,alt:h.alt}):React.createElement("span",null,y?a:c)}),[d,p,y,a,c,h]),g=cr((function(){return"mwai-input-submit ".concat(d?"mwai-busy":"")}),[d]),b=sr((function(){f&&i(!1),y?r():o()}),[y,f,r,o,i]),w=sr((function(){d||b()}),[d,b]);return React.createElement("button",{className:g,disabled:d||m,onClick:w},v)};var lr=wp.element.useMemo;const fr=function(){var e=le(),t=e.state,n=e.actions,r=t.theme,o=t.isWindow,i=t.fullscreen,a=t.aiName,c=t.pluginUrl,s=t.open,u=t.iconUrl,l=t.windowed,f=n.setOpen,p=n.setWindowed,d=lr((function(){if(!o)return null;var e="timeless"===(null==r?void 0:r.themeId),t=e?function(e,t,n){if(g(e))e=React.createElement("div",{className:"mwai-avatar"},React.createElement("img",{alt:"AI Engine",src:e}));else{var r=n||"".concat(t,"/images/chat-openai.svg");e=React.createElement("div",{className:"mwai-avatar"},React.createElement("img",{alt:"AI Engine",src:"".concat(r)}))}return e}(a,c,u):null;return React.createElement(React.Fragment,null,e&&React.createElement(React.Fragment,null,t,React.createElement("div",{className:"mwai-name"},React.createElement("small",null,"Discuss with"),React.createElement("div",null,a)),React.createElement("div",{style:{flex:"auto"}})),React.createElement("div",{className:"mwai-buttons"},i&&React.createElement("div",{className:"mwai-resize-button",onClick:function(){return p(!l)}}),React.createElement("div",{className:"mwai-close-button",onClick:function(){return f(!s)}})))}),[o,null==r?void 0:r.themeId,a,c,u,i,p,l,f,s]);return React.createElement("div",{className:"mwai-header"},d)};var pr=wp.element,dr=pr.useMemo,hr=pr.useEffect;const mr=function(){var e=le(),t=e.state,n=e.actions,r=t.isWindow,o=t.iconText,i=t.showIconMessage,a=t.iconAlt,c=t.iconUrl,s=t.open,u=n.setShowIconMessage,l=n.setOpen;hr((function(){s&&i&&u(!1)}),[s,u,i]);var f=dr((function(){return r?React.createElement("div",{className:"mwai-trigger mwai-open-button"},React.createElement(b,{className:"mwai-icon-text-container",if:o&&i},React.createElement("div",{className:"mwai-icon-text-close",onClick:function(){return u(!1)}},"✕"),React.createElement("div",{className:"mwai-icon-text"},o)),React.createElement("div",{className:"mwai-icon-container",onClick:function(){return l(!0)}},React.createElement("img",{className:"mwai-icon",width:"64",height:"64",alt:a,src:c}))):null}),[r,o,i,a,c,u,l]);return React.createElement(React.Fragment,null,f)};function yr(e){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yr(e)}function vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vr(Object(n),!0).forEach((function(t){br(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function br(e,t,n){return t=function(e){var t=function(e,t){if("object"!=yr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=yr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==yr(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xr=wp.element,Er=xr.useState,Sr=xr.useMemo,Or=xr.useLayoutEffect,kr={overrides:{a:{props:{target:"_blank"}}}};const jr=function(e){var t=v(),n=e.style,r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return wr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Er(!0),2),o=r[0],i=r[1],a=le(),c=a.state,s=a.actions,u=c.theme,l=c.botId,f=c.customId,p=c.messages,d=c.textCompliance,h=c.isWindow,m=c.fullscreen,y=c.iconPosition,g=c.iconBubble,w=c.windowed,x=c.cssVariables,E=c.error,S=c.conversationRef,O=c.open,k=c.busy,j=c.uploadIconPosition,R=s.resetError,I=Sr((function(){return"css"===(null==u?void 0:u.type)?null==u?void 0:u.style:null}),[u]),C=t("mwai-chatbot",br(br(br(br(br(br(br(br({},"mwai-".concat(null==u?void 0:u.themeId,"-theme"),!0),"mwai-window",h),"mwai-bubble",g),"mwai-open",O),"mwai-fullscreen",!w||!h&&m),"mwai-bottom-left","bottom-left"===y),"mwai-top-right","top-right"===y),"mwai-top-left","top-left"===y));Or((function(){o&&S.current&&(S.current.scrollTop=S.current.scrollHeight)}),[p,o,S,k]);var P=Sr((function(){return null==p?void 0:p.map((function(e){return React.createElement(Ln,{key:e.id,message:e})}))}),[p]);return React.createElement(b,{id:"mwai-chatbot-".concat(f||l),className:C,style:gr(gr({},x),n),if:!0,disableTransition:!h},I&&React.createElement("style",null,I),React.createElement(mr,null),React.createElement(fr,null),React.createElement("div",{className:"mwai-content"},React.createElement("div",{ref:S,className:"mwai-conversation",onScroll:function(){if(S.current){var e=S.current,t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;i(n-t<=r+1)}}},P),E&&React.createElement("div",{className:"mwai-error",onClick:function(){return R()}},React.createElement(an,{options:kr},E)),React.createElement("div",{className:"mwai-input"},React.createElement(ir,null),React.createElement(ur,null)),React.createElement("div",{className:"mwai-tools"},"mwai-tools"===j&&React.createElement(Zn,null)),d&&React.createElement("div",{className:"mwai-compliance",dangerouslySetInnerHTML:{__html:d}})))},Rr=function(e){return React.createElement(fe,e,React.createElement(jr,e))};function Ir(e){return Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ir(e)}var Cr=["children"];function Pr(){Pr=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:j(e,n,c)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var p="suspendedStart",d="suspendedYield",h="executing",m="completed",y={};function v(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==n&&r.call(E,a)&&(w=E);var S=b.prototype=v.prototype=Object.create(w);function O(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,a,c){var s=f(e[o],e,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Ir(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function j(t,n,r){var o=p;return function(i,a){if(o===h)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=R(c,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=h;var u=f(t,n,r);if("normal"===u.type){if(o=r.done?m:d,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function R(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,R(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function T(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(Ir(t)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,s,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},O(k.prototype),u(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new k(l(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},O(S),u(S,s,"Generator"),u(S,a,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=T,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;C(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function Tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(n),!0).forEach((function(t){var r,o,i;r=e,o=t,i=n[t],o=function(e){var t=function(e,t){if("object"!=Ir(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=Ir(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ir(t)?t:String(t)}(o),o in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ar(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Nr(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Ar(i,r,o,a,c,"next",e)}function c(e){Ar(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Mr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Dr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fr=wp.element,Br=Fr.useContext,_r=Fr.createContext,Ur=Fr.useState,Hr=Fr.useMemo,zr=Fr.useEffect,$r=Fr.useCallback,Gr=_r(),Wr=function(e){var t=e.children,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,Cr),r=n.system,i=n.theme,a=Mr(Ur([]),2),c=a[0],s=a[1],u=Mr(Ur(null),2),l=u[0],f=u[1],p=Mr(Ur(!1),2),d=p[0],h=p[1],m=Hr((function(){return(null==i?void 0:i.settings)||{}}),[i]),y=r.botId,v=r.customId,g=r.restNonce,b=r.pluginUrl,w=r.restUrl,x=r.debugMode,E=Hr((function(){return Object.keys(m).reduce((function(e,t){return e["--mwai-".concat(t)]=m[t],e}),{})}),[m]),S=$r(Nr(Pr().mark((function e(){var t,n,r,i,a,c=arguments;return Pr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]&&c[0],e.prev=1,t||h(!0),n={botId:y||v},x&&console.log("[DISCUSSIONS] OUT: ",n),e.next=7,fetch("".concat(w,"/mwai-ui/v1/discussions/list"),{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":g},body:o(n)});case 7:return r=e.sent,e.next=10,r.json();case 10:if((i=e.sent).success){e.next=13;break}throw new Error("Could not retrieve the discussions: ".concat(i.message));case 13:x&&console.log("[DISCUSSIONS] IN: ",i),a=i.chats.map((function(e){var t=JSON.parse(e.messages),n=JSON.parse(e.extra);return Lr(Lr({},e),{},{messages:t,extra:n})})),s(a),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.error(e.t0);case 21:return e.prev=21,t||h(!1),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[1,18,21,24]])}))),[]);zr((function(){S();var e=setInterval((function(){S(!0)}),5e3);return function(){return clearInterval(e)}}),[]);var O=function(e){var t=MwaiAPI.getChatbot(e);if(!t)throw new Error("Chatbot not found.",{botId:e,chatbots:MwaiAPI.chatbots});return t},k=function(){var e=Nr(Pr().mark((function e(t){var n;return Pr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.find((function(e){return e.chatId===t}))){e.next=4;break}return console.error("Discussion not found.",{chatId:t,discussions:c}),e.abrupt("return");case 4:O(y).setContext({chatId:t,messages:n.messages}),f(n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Nr(Pr().mark((function e(){return Pr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(y).clear();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R={onDiscussionClick:k,onNewChatClick:j},I={botId:y,pluginUrl:b,busy:d,setBusy:h,cssVariables:E,discussions:c,discussion:l,theme:i};return React.createElement(Gr.Provider,{value:{state:I,actions:R}},t)};function qr(e){return qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qr(e)}function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vr(Object(n),!0).forEach((function(t){Jr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jr(e,t,n){return t=function(e){var t=function(e,t){if("object"!=qr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=qr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qr(t)?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yr=wp.element,Xr=Yr.useMemo,Zr=Yr.useEffect,Kr=function(e){var t=e.discussion,n=e.onClick,r=void 0===n?function(){}:n,o=e.selected,i=void 0!==o&&o,a=v(),c=t.messages,s=c[c.length-1],u=s.content.length>64?s.content.substring(0,64)+"...":s.content,l=a("mwai-discussion",{"mwai-active":i});return React.createElement("li",{className:l,onClick:r},u)};const eo=function(e){var t=e.theme,n=e.style,r=e.params,o=v(),i=Xr((function(){return"css"===(null==t?void 0:t.type)?null==t?void 0:t.style:null}),[t]),a=function(){var e=Br(Gr);if(!e)throw new Error("useDiscussionsContext must be used within a DiscussionsContextProvider");return e}(),c=a.state,s=a.actions,u=c.botId,l=c.cssVariables,f=c.discussions,p=c.discussion,d=c.busy,h=s.onDiscussionClick,m=s.onNewChatClick,y=r.textNewChat;Zr((function(){}));var g=o("mwai-discussions",Jr({},"mwai-".concat(null==t?void 0:t.themeId,"-theme"),!0));return React.createElement(React.Fragment,null,React.createElement("div",{id:"mwai-discussions-".concat(u),className:g,style:Qr(Qr({},l),n)},i&&React.createElement("style",null,i),React.createElement("div",{className:o("mwai-header")},React.createElement("button",{onClick:function(){return m()},disabled:d},React.createElement("span",null,null!=y?y:"+ New chat"))),React.createElement("ul",{className:o("mwai-content")},f.map((function(e){return React.createElement(Kr,{key:e.id,discussion:e,selected:(null==p?void 0:p.id)===e.id,onClick:function(){return h(e.chatId)}})})))))},to=function(e){return React.createElement(Wr,e,React.createElement(eo,e))};var no=wp.element.render;function ro(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}document.addEventListener("DOMContentLoaded",(function(){function e(e,t){e.forEach((function(e){var n=JSON.parse(ro(e.getAttribute("data-params"))),r=JSON.parse(ro(e.getAttribute("data-system"))),o=JSON.parse(ro(e.getAttribute("data-theme")));e.removeAttribute("data-params"),e.removeAttribute("data-system"),e.removeAttribute("data-theme"),no(t({system:r,params:n,theme:o}),e)}))}e(document.querySelectorAll(".mwai-chatbot-container"),Rr),e(document.querySelectorAll(".mwai-discussions-container"),to)}))})();