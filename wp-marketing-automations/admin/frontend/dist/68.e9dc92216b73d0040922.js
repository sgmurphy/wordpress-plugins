(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{1282:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(3),i=a(1),c=a(9),o=a.n(c),s=a(5),l=a(16),b=a(14),m=a(4),p=a(946),u=a(953),d=a(20),f=a(181),y=a(49),O=a(8),g=a(74),j=a(41);function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(Object(a),!0).forEach((function(t){v(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function v(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function E(e,t,a,n,r,i,c){try{var o=e[i](c),s=o.value}catch(e){return void a(e)}o.done?t(s):Promise.resolve(s).then(n,r)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,i=void 0;try{for(var c,o=e[Symbol.iterator]();!(n=(c=o.next()).done)&&(a.push(c.value),!t||a.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}t.default=function(e){var t=location&&location.search?Object(d.parse)(location.search.substring(1)):{},a=Object(u.a)(),c=_(Object(n.useState)(!0),2),w=c[0],v=c[1],k=_(Object(n.useState)({}),2),P=k[0],N=k[1],S=_(Object(n.useState)(!0),2),T=S[0],x=S[1],C=_(Object(n.useState)({message:"",type:1}),2),I=C[0],A=C[1],F=Object(g.a)().setL2Title;Object(n.useEffect)((function(){F("title"in P?P.title:"")}),[P]);var D=_(Object(n.useState)(!1),2),J=D[0],M=D[1],R=_(Object(n.useState)(!1),2),B=R[0],q=(R[1],a.setCampaignValues),G=a.setExclude,H=(Object(m.s)(),function(){var e=!0;!Object(r.isEmpty)(P.title)&&[1,2,3].includes(parseInt(P.type))&&(e=!1),!e&&2==P.type&&B&&(e=!0),e||3!=P.type||Object(m.Rb)()||(e=!0),x(e)}),L=p.a.getCampaignId(),U=p.a.getCampaignData(),V=p.a.getExcludes(),W=!!(!(!U||!U.parent)&&U.parent);Object(n.useEffect)((function(){U&&L>0&&e.campaignId==L&&(N({title:U.title,description:U.description,type:U.type,isPromotional:!U.data||!U.data.hasOwnProperty("is_promotional")||U.data.is_promotional,abType:U.data&&U.data.hasOwnProperty("ab_type")?U.data.ab_type:"standard"}),v(!1)),0==e.campaignId&&(N({title:"",description:"",type:0,isPromotional:!1,abType:!1}),v(!1))}),[L]),Object(n.useEffect)((function(){H()}),[P,B]);var $=function(){var a,n=(a=regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(T){a.next=18;break}if(e.setPending(!0),i=void 0,i={title:U.title,description:U.description,type:U.type,isPromotional:U.data&&U.data.hasOwnProperty("is_promotional")?U.data.is_promotional:null,abType:U.data&&U.data.hasOwnProperty("ab_type")?U.data.ab_type:null},JSON.stringify(i)==JSON.stringify(P)){a.next=14;break}if(!(L>0)){a.next=12;break}return a.prev=4,a.next=7,o()({path:Object(m.u)("/broadcast/".concat(L)),method:"POST",data:{data:{title:P.title,description:P.description,type:P.type,promotional:P.isPromotional,ab_type:P.abType,modified_by:Object(m.G)(),exclude:V},step:1},headers:{"Content-Type":"application/json"}}).then((function(e){if(200==e.code){q("data",h(h({},U),{},{title:e.result.title,description:e.result.description,type:e.result.type,data:e.result.data})),A({message:e.message,type:1});var a=U.data&&!Object(r.isNull)(U.data)&&U.data.hasOwnProperty("filters")?U.data.filters:{};Object(r.isEmpty)(a)||Object(b.k)(a,"/",t),q("step",2)}else A({message:e.message,type:0})}));case 7:a.next=12;break;case 9:a.prev=9,a.t0=a.catch(4),A({message:a.t0.message,type:0});case 12:a.next=17;break;case 14:n=U.data&&U.data.hasOwnProperty("filters")?U.data.filters:{},Object(r.isEmpty)(n)||Object(b.k)(n,"/",t),q("step",2);case 17:e.setPending(!1);case 18:case"end":return a.stop()}var i}),a,null,[[4,9]])})),function(){var e=this,t=arguments;return new Promise((function(n,r){var i=a.apply(e,t);function c(e){E(i,n,r,c,o,"next",e)}function o(e){E(i,n,r,c,o,"throw",e)}c(void 0)}))});return function(){return n.apply(this,arguments)}}();return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(y.a,null),w||Object(r.isEmpty)(P)?Object(n.createElement)("div",{className:"bwf-crm-campaign-preview bwf-placeholder-content"},[0,1,2,3,4].map((function(e){return Object(n.createElement)("div",{className:"bwf-crm-campaign-field",key:e},Object(n.createElement)("div",{className:"is-placeholder long",style:{width:"20%"}}),Object(n.createElement)("div",{className:"is-placeholder long",style:{width:"100%"}}))}))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-campaign-step-div bwf-card-wrap bwf-campaign-step-1"},Object(n.createElement)("div",{className:"bwf-card-header"},Object(n.createElement)("span",{className:"bwf-form-title"},Object(i.__)("Information","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-card-bg-wrap"},Object(n.createElement)(s.TextControl,{value:P.title,label:Object(i.__)("Name","wp-marketing-automations"),className:"bwf-campaign-input-field",placeholder:Object(i.__)("Enter Name","wp-marketing-automations"),onChange:function(e){N(h(h({},P),{},{title:e}))}}),Object(n.createElement)("div",null,Object(n.createElement)(s.Flex,{gap:5,justify:"start",align:"start"},Object(n.createElement)(s.FlexItem,null,Object(n.createElement)("p",{className:"bwf-c-input-label"},Object(i.__)("Type","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf-display-flex gap--8"},Object(n.createElement)(l.a,{isSecondary:"standard"===P.abType,isTertiary:"standard"!==P.abType,className:"bwf-btn-small "+("standard"===P.abType?"is-border is-blue-bg":""),onClick:function(){N(h(h({},P),{},{abType:"standard"}))}},Object(i.__)("Standard","wp-marketing-automations")),Object(n.createElement)(l.a,{isSecondary:"ab"===P.abType,isTertiary:"ab"!==P.abType,className:"bwf-btn-small "+("ab"===P.abType?"is-border is-blue-bg":""),onClick:function(){N(h(h({},P),{},{abType:"ab"}))}},Object(i.__)("A/B Test","wp-marketing-automations")))))),Object(n.createElement)("div",{className:"bwf_clear_8"}),!W&&Object(n.createElement)(j.a,{className:"bwf-crm-campaign-toggle",label:Object(i.__)("Send it to all contacts including unsubscribers","wp-marketing-automations"),help:[Object(n.createElement)(n.Fragment,{key:1},Object(i.__)("This allows you to send the email to all your contacts, even if their status is unsubscribed or unverified.","wp-marketing-automations")),Object(n.createElement)("br",{key:2}),Object(n.createElement)(n.Fragment,{key:3},Object(i.__)("On the default mode, your broadcast will be sent only to the subscribed contacts","wp-marketing-automations"))],checked:!P.isPromotional,onChange:function(e){G([]),N(h(h({},P),{},{isPromotional:!e}))}}),J&&Object(n.createElement)(s.Modal,{title:Object(i.__)("Configure SMS Setting","wp-marketing-automations"),onRequestClose:function(){return M(!1)},style:{minWidth:"540px",height:"fit-content"},className:"bwf-crm-merge-tag-model"},Object(n.createElement)("p",null,Object(n.createElement)(O.a,{icon:"profile"})),Object(n.createElement)("a",{href:"admin.php?page=autonami&tab=connector",className:"bwf-a-no-underline"},Object(i.__)("Click Here to go configuration page","wp-marketing-automations")),Object(n.createElement)("p",null,Object(n.createElement)(l.a,{isPrimary:!0,onClick:function(){return M(!1)}},Object(i.__)("Cancel","wp-marketing-automations")))),Object(n.createElement)(f.a,{message:I.message,type:I.type,removeMessage:function(){return A({message:"",type:1})}})),Object(n.createElement)("div",{className:"bwf-crm-stepper-navigation bwf_text_right"},Object(n.createElement)(l.a,{isPrimary:!0,className:"bwf-crm-navigation-next",disabled:T,onClick:function(){H(),$()},isBusy:e.isPending},Object(i.__)("Next","wp-marketing-automations"))))))}}}]);