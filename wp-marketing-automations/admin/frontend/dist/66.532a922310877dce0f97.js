(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{1353:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(188),c=n(5),o=n(1),i=n(16),l=n(957),s=n(962),u=n(49),m=n(18),b=n(9),d=n.n(b),f=n(4);function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function g(e,t,n,a,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void n(e)}i.done?t(l):Promise.resolve(l).then(a,r)}function O(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){g(c,a,r,o,i,"next",e)}function i(e){g(c,a,r,o,i,"throw",e)}o(void 0)}))}}var j=function(e){return{sendTestEmail:(r=O(regeneratorRuntime.mark((function e(t,n,a,r,c,o){var i,l,s,u,m,b=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=b.length>6&&void 0!==b[6]&&b[6],l=b.length>7&&void 0!==b[7]?b[7]:{},s=b.length>8&&void 0!==b[8]&&b[8],u=b.length>9&&void 0!==b[9]?b[9]:{},e.prev=4,m={email:t,content:JSON.stringify({subject:n,body:a,type:r,mail_data:c,preheader:o,utmEnabled:i,utmDetails:l,overRideSenderInfo:s,overRideInfo:u})},e.next=8,d()({method:"POST",path:Object(f.u)("/send-test-email"),data:m});case 8:return e.abrupt("return",2);case 11:return e.prev=11,e.t0=e.catch(4),e.abrupt("return",3);case 14:case"end":return e.stop()}}),e,null,[[4,11]])}))),function(e,t,n,a,c,o){return r.apply(this,arguments)}),saveEditorContent:(a=O(regeneratorRuntime.mark((function t(n){var a,r,c,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"block"===n[0].type&&n[0].hasOwnProperty("block")&&(a=n[0].block,r=a.template,c=void 0===r?"":r,o=p(a,["template"]),""!==c&&(n[0].body=n[0].block.template),n[0].block=o),t.prev=1,i={content:JSON.stringify(n)},t.next=5,d()({method:"POST",path:Object(f.u)("/form-feeds/".concat(e,"/save-email-content")),data:i});case 5:return t.abrupt("return",2);case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",3);case 11:case"end":return t.stop()}}),t,null,[[1,8]])}))),function(e){return a.apply(this,arguments)}),uploadImage:(n=O(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("image",t),e.prev=2,e.next=5,d()({method:"POST",path:Object(f.u)("/upload-image"),body:n});case 5:return a=e.sent,e.abrupt("return",a&&a.result?a.result:"");case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return","");case 12:case"end":return e.stop()}}),e,null,[[2,9]])}))),function(e){return n.apply(this,arguments)}),fetchCurrentMailEditorContent:(t=O(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d()({method:"GET",path:Object(f.u)("/form-feeds/".concat(e,"/get-email-content"))});case 3:return n=t.sent,t.abrupt("return",n&&n.result?n.result:"");case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return","");case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(){return t.apply(this,arguments)})};var t,n,a,r},_=n(963),w=n(3),v=n(39),y=n(8);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(a=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==i.return||i.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings&&bwfcrm_contacts_data.editor_settings.default&&bwfcrm_contacts_data.editor_settings.default.form?bwfcrm_contacts_data.editor_settings.default.form:{};return e&&0!==Object.keys(n).length?Array.isArray(e.content)&&e.content[0]?(e.content[0].body||(e.content[0].body=n.body?n.body:""),e.content[0].last_updated=t,e.content[0].editor||(e.content[0].editor=n.editor?n.editor:{}),e):S(S({},e),{},{content:[{body:n.body?n.body:"",editor:n.editor?S({},n.editor):{}}]}):e};t.default=function(e){var t,n=e.feedId,b=Object(l.a)(),d=Object(s.a)(),p=b.getUpdateStepThreeStatus(),g=b.getFeed(),O=g&&g.status?parseInt(g.status):1,E=g&&g.last_updated?g.last_updated:"",k=g&&g.data?g.data:{},C=!(!k||!("incentivize_email"in k))&&k.incentivize_email,T=!(!k||!("marketing_status"in k))&&k.marketing_status,x=!(!k||!("not_send_to_subscribed"in k))&&k.not_send_to_subscribed,P=!(!k||!("add_tag_enable"in k))&&k.add_tag_enable,R=k&&"tag_to_add"in k?k.tag_to_add:[],A=k&&"redirect_url"in k?k.redirect_url:"",I=k&&"redirect_mode"in k?k.redirect_mode:"url",F=h(Object(a.useState)(!1),2),D=F[0],B=F[1],J=h(Object(a.useState)(!1),2),M=J[0],z=J[1],U=h(Object(a.useState)(!1),2),L=U[0],q=U[1],G=h(Object(a.useState)(!1),2),$=G[0],H=G[1],K=Object(a.useCallback)((function(e){Object(f.Jb)()?!1===C?d.updateStepThree(n,{incentivize_email:C,marketing_status:T},e):(z(e),B(!0)):H(!0)}),[C,T]),Q=Object(a.useCallback)((function(e){d.updateStepThree(n,{incentivize_email:C,marketing_status:T,incentive_email:e,redirect_mode:I,redirect_url:A,add_tag_enable:P,tag_to_add:R,not_send_to_subscribed:x},M),B(!1)}),[C,T,M,I,A]),V={objectId:"crm.form.".concat(n),mergeTagsContext:"forms"};return Object(a.createElement)("div",{className:"bwf-crm-stepper-wrap bwf-card-wrap bwf-crm-forms-step-3"},Object(a.createElement)(u.a,null),Object(a.createElement)("div",{className:"bwf-card-header"},Object(a.createElement)("span",{className:"bwf-form-title"},Object(o.__)("Lead Notification","wp-marketing-automations"))),Object(a.createElement)("div",{className:"bwf-crm-importer-wrap"},Object(a.createElement)("div",{className:"bwf-crm-import-section"},Object(a.createElement)(c.ToggleControl,{label:Object(o.__)("Enable email notification","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",help:Object(o.__)("Note: Use {{contact_confirmation_link}} for double optin","wp-marketing-automations"),onChange:function(e){return d.setIncentivizeEmail(e)},checked:!!C})),!!C&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf-p-gap bwf-pt-0 bwf-pb-0"},Object(a.createElement)(r.a,{disableDefaultButtons:!0,onEmailContentReady:Q,onEmailContentError:function(){return B(!1)},showTab:!1,initData:N(k&&"incentive_email"in k?S(S({},k.incentive_email),V):V,E),validateEmailContent:!!D,apiMethods:j?j(n):{},openTemplateModal:L,setTemplateModal:q,transactionalEnabled:!0})),Object(a.createElement)("div",{className:"bwf-p-gap"},Object(a.createElement)(c.Card,{className:"bwf-p-gap bwf-border"},Object(a.createElement)(c.ToggleControl,{label:Object(o.__)("Don't send email if contact is already subscribed","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",onChange:function(e){return d.setNotSendToSubscribed(e)},checked:!!x}),Object(a.createElement)(m.a,{gap:5,justify:"start",align:"start"},Object(a.createElement)(c.FlexItem,null,Object(a.createElement)("p",{className:"bwf-heading7-new bwf-mb-8"},Object(o.__)("Redirect After Confirmation","wp-marketing-automations")),Object(a.createElement)("div",{className:"bwf-display-flex bwf-flex-start gap-16"},Object(a.createElement)(c.Button,{isSecondary:!I||"url"===I,isTertiary:I&&"url"!==I,onClick:function(){return d.setRedirectMode("url")},className:"bwf-btn-small "+(I&&"url"!==I?"":"is-border is-blue-bg")},Object(o.__)("URL","wp-marketing-automations")),Object(a.createElement)(c.Button,{isSecondary:I&&"file"===I,isTertiary:I&&"file"!==I,onClick:function(){return d.setRedirectMode("file")},className:"bwf-btn-small "+(I&&"file"===I?"is-border is-blue-bg":"")},Object(o.__)("File","wp-marketing-automations"))))),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)(c.TextControl,{label:"",value:A,onChange:function(e){return d.setRedirectUrl(e)},placeholder:Object(o.__)("Enter URL","wp-marketing-automations")}),Object(a.createElement)("div",{className:"bwf_clear_20"}),Object(a.createElement)(c.ToggleControl,{label:Object(o.__)("Add Tags after confirmation","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",onChange:function(e){return d.setAddTagEnabled(e)},checked:!!P}),P&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)("div",{className:"bwf_clear_10"}),Object(a.createElement)(_.a,{onTagsChange:function(e){d.setTagList(e.map((function(e){return{id:e.key,value:e.label}})))},selected:(t=[],Object(w.isEmpty)(R)||R.map((function(e){t.push({key:e.id,label:e.value})})),t)})),Object(a.createElement)("p",{className:"bwf-mb-0"},Object(o.__)("Note: The settings will work when confirmation link is clicked","wp-marketing-automations"))))),Object(a.createElement)("div",{className:"bwf-crm-import-section sa",style:{paddingTop:"0"}},Object(a.createElement)(c.ToggleControl,{label:Object(o.__)("Auto-confirm Contacts","wp-marketing-automations"),help:Object(o.__)("This will automatically mark new Contacts as Subscribed","wp-marketing-automations"),onChange:function(e){return d.setMarketingStatus(e)},className:"bwf-tooglecontrol-advance",checked:!!T})),Object(a.createElement)("div",{className:"bwf_clear_24"}),Object(a.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(a.createElement)(m.a,null,Object(a.createElement)(m.b,null,Object(a.createElement)(i.a,{className:"bwf-display-flex",isSecondary:!0,onClick:function(){return d.setStep("mapping")}},Object(o.__)("Back","wp-marketing-automations"))),Object(a.createElement)(m.b,{className:"bwf_text_right"},3===parseInt(O)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(i.a,{onClick:function(){return K(O)},isSecondary:!0},Object(o.__)("Save","wp-marketing-automations")),Object(a.createElement)(i.a,{onClick:function(){return K(2)},className:"bwf-ml-10",isPrimary:!0,isBusy:1===p},Object(o.__)("Save & Activate","wp-marketing-automations"))),2===parseInt(O)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(i.a,{onClick:function(){return K(3)},isSecondary:!0},Object(o.__)("Deactivate","wp-marketing-automations")),Object(a.createElement)(i.a,{onClick:function(){return K(O)},className:"bwf-ml-10",isPrimary:!0,isBusy:1===p},Object(o.__)("Save","wp-marketing-automations"))),1===parseInt(O)&&Object(a.createElement)(a.Fragment,null,Object(a.createElement)(i.a,{onClick:function(){return K(O)},isSecondary:!0},!Object(f.Jb)()&&Object(a.createElement)(y.a,{icon:"king",size:16}),Object(o.__)("Save As Draft","wp-marketing-automations")),Object(a.createElement)(i.a,{onClick:function(){return K(2)},className:"bwf-ml-10",isPrimary:!0,isBusy:1===p},!Object(f.Jb)()&&Object(a.createElement)(y.a,{icon:"king",size:16,color:"#fff"}),Object(o.__)("Activate","wp-marketing-automations"))))))),!Object(f.Jb)()&&Object(a.createElement)(v.b,{isOpen:$,onRequestClose:function(){return H(!1)},modalContent:{isFeature:!0,featureTitle:Object(o.__)("Form","wp-marketing-automations")}}))}},963:function(e,t,n){"use strict";var a=n(0),r=n(25),c=n(1),o=n(177);t.a=function(e){var t=e.selected,n=e.onTagsChange;return Object(a.createElement)("div",{className:"bwf-c-field-mapper-terms"},Object(a.createElement)("div",{className:"bwf-input-label"},Object(c.__)("Add Tags","wp-marketing-automations")),Object(a.createElement)(r.a,{autocompleter:o.b,multiple:!1,allowFreeTextSearch:!0,inlineTags:!1,selected:t,onChange:function(e){n(e)},onRemoveTag:function(e,a){var r=t.filter((function(t){return!(t.key==e&&t.label==a)}));n(r)},placeholder:Object(c.__)("Search by tag name","wp-marketing-automations"),showClearButton:!0,disabled:!1}))}}}]);