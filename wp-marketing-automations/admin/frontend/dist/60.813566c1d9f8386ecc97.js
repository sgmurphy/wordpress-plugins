(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{1302:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(4),c=n(20),o=n(970),i=n(958),s=n(6),l=n.n(s),u=n(1),b=n(119),f=n(3),p=n(33),m=n(18),d=n(304),O=n(318),g=n(310),j=n(50),y=n(41);function v(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,c=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw c}}return n}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=Object(j.a)(Object(a.kb)()).formatAmount,P=function(e){var t=e.campaign,n=e.exclude,c=e.onExcludeId,s=!(!t||!t.parent)&&t.parent,j=!!s,h=function(e){var t=Object(f.isEmpty)(e.country)?"":g[e.country],n=Object(a.Ub)([e.city,e.state,t],", ");return Object(f.isEmpty)(Object(f.trim)(n))?"":n},_=function(e){var t=h(e);return e.country||t?Object(r.createElement)(m.a,{justify:"start"},!Object(f.isEmpty)(e.country)&&Object(r.createElement)(m.c,null,Object(r.createElement)(O.a,{code:e.country,size:18})),Object(r.createElement)(m.c,null,t&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("span",null,h(e)),Object(r.createElement)("br",null)))):Object(r.createElement)("span",null,"-")},P=function(e){return Object(r.createElement)(p.a,{href:"admin.php?page=autonami&path=/contact/"+e.id,className:"bwf-a-no-underline"},Object(r.createElement)(d.a,{contact:e,hideJoiningDate:!0}))},S=function(e){return Object(r.createElement)("div",{className:"bwf-c-contact-details-cell"},1==t.type&&(e.email?Object(r.createElement)(m.a,{justify:"start",align:"top"},Object(r.createElement)(m.c,null,e.email)):Object(r.createElement)("span",null,"-")),[2,3].includes(parseInt(t.type))&&(Object(f.isEmpty)(e.contact_no)?"-":Object(r.createElement)(m.a,{justify:"start",align:"top"},Object(r.createElement)(m.c,null,e.contact_no))))},k=Object(o.a)(),N=k.getPageNumber,I=k.getPerPageCount,x=k.getTotalCount,C=k.getLoading,A=k.getContacts,T=Object(i.a)().fetch,D=e.query,L=A(),q=N(),F=I(),M=x(),G=C(),J=w(Object(r.useState)(!0),2),R=J[0],U=J[1];Object(r.useEffect)((function(){R&&M>0&&U(!1)}),[M]);var $=[{key:"id",label:"",required:!0,cellClassName:"bwf-col-action bwf-w-30 bwf-table-col-sticky bwf-sticky-left"},{key:"contact",label:Object(u.__)("Contact","wp-marketing-automations"),isLeftAligned:!0,required:!0},{key:"contact_details",label:Object(u.__)("Details","wp-marketing-automations"),isLeftAligned:!0}];Object(a.Tb)()?$.push({key:"total_spent",label:Object(u.__)("Total Spent","wp-marketing-automations"),isLeftAligned:!0}):$.push({key:"column_location",label:Object(u.__)("Location","wp-marketing-automations"),isLeftAligned:!0});var z=function(e){var t=e.wc,n=t.total_order_count,a=t.total_order_value;t.total_purchased_items;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-listing-total-spent"},a&&n?Object(r.createElement)("div",{className:"bwf-c-total-spent-amount"},E(a)," |"," ",n," ",parseInt(n)>1?Object(u.__)("orders","wp-marketing-automations"):Object(u.__)("order","wp-marketing-automations")):"-"))},B=L.map((function(e){var t=function(e){return Object(f.merge)({id:0,email:"-",first_name:"",last_name:"",creation_date:"",fields:{marketing_status:"0",first_order_date:"",country:"",city:"",state:"",phone:""},wc:{id:1,l_order_date:"",total_order_count:0,total_order_value:0,total_purchased_items:0}},e)}(e),o=[{display:Object(r.createElement)(y.a,{onChange:function(e){return r=t.id,void c(e?n.filter((function(e){return e!==r})):[].concat(v(n),[r]));var r},"aria-label":Object(u.__)("Select"),checked:-1===n.indexOf(t.id)}),value:t.id},{display:P(t),value:""},{display:S(t),value:""}];return Object(a.Tb)()?o.push({display:z(t),value:""}):o.push({display:_(t),value:h(t)}),o})),Q=function(e){if(e!==F){var n=D,r=!1;t&&t.data.is_promotional?(n.status_is=1,r=!0):n.status_is_not=2;var a=!1;n&&n.lists_any&&(a=!0),T(n,0,e,!0,!1,parseInt(3===parseInt(t.type)?2:t.type),r,a,!!j&&s)}},V=l()("bwfcrm-contacts-list",{"has-search":!0}),H=t&&!0===t.data.is_promotional?Object(u.__)("Subscribed Contacts ","wp-marketing-automations"):Object(u.__)("Contacts ","wp-marketing-automations"),K=parseInt(M)-n.length>0?" ("+(parseInt(M)-n.length)+")":"";return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(b.a,{className:V,title:Object(r.createElement)("span",{className:"bwf-heading3-new"},H+K),rows:B,headers:$,query:{paged:q},rowsPerPage:F,totalRows:G?10:M,isLoading:G,onPageChange:function(e,n){var r=(e-1)*F,a=D,c=!1;t&&t.data.is_promotional?(a.status_is=1,c=!0):a.status_is_not=2;var o=!1;a&&a.lists_any&&(o=!0),T(a,r,F,!0,!1,parseInt(3===parseInt(t.type)?2:t.type),c,o,!!j&&s)},onQueryChange:function(e){return"per_page"!==e?function(){}:Q},showMenu:!1,emptyMessage:Object(u.__)("No contacts found","wp-marketing-automations")}))};P.defaultProps={contacts:[]};var S=P,k=n(5),N=n(16),I=n(14),x=n(946),C=n(953),A=n(9),T=n.n(A),D=n(181),L=n(182),q=n(971),F=(n(61),n(985));function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J=function(e){var t,n=e.campaignId,c=e.query,o=Object(q.a)(!0),i=o.loading,s=o.filters;return i?Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",null,Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between"},Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-h-30 bwf-w-90"}),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-h-30 bwf-w-90"})),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",null,Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-300"}),Object(r.createElement)("br",null),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-400"})),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between"},Object(r.createElement)("div",null),Object(r.createElement)("div",{className:"bwf-placeholder-temp bwf-btn bwf-h-36 bwf-w-90"})),Object(r.createElement)("div",{className:"bwf_clear_20"}))):Object(r.createElement)(r.Fragment,null,Object(r.createElement)(k.Card,{className:"bwf-c-campaign-rule-selector"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-space-between"},Object(r.createElement)("div",{className:"bwf-c-campaign-rule-head bwf-w-300 bwf-heading3-new"},Object(u.__)("Segment Contacts","wp-marketing-automations")),Object(r.createElement)(F.c,{restrictedFilters:["status_is","status_is_not"]})),Object(r.createElement)("div",{className:"bwf-c-campaign-rule-container"},Object(r.createElement)(L.a,{siteLocale:"en-US",currency:Object(a.Tb)()?bwfcrm_contacts_data.currency:{},config:{title:Object(u.__)("Select Rules","wp-marketing-automations"),filters:(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},s),!0!==t&&t&&t.status&&delete t.status,t),footerComponent:function(e){return Object(r.createElement)(F.a,{filter:e.data,config:e.config})},enableGrouping:!0},path:"/broadcast/".concat(n),query:c}))))},R=n(49),U=n(66),$=n(74);function z(e,t,n,r,a,c,o){try{var i=e[c](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function B(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,c=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.default=function(e){var t=Q(Object(r.useState)({message:"",type:1}),2),n=t[0],s=t[1],l=e.location,b=l&&l.search?Object(c.parse)(l.search.substring(1)):{},p=(b.page,b.path,B(b,["page","path"])),m=Q(Object(r.useState)({status:!1,loading:!1}),2),d=m[0],O=m[1],g=Object(C.a)(),j=Object(o.a)().getTotalCount,y=Object(i.a)().fetch,v=Object($.a)().setL2Title,w=g.setCampaignValues,h=g.setExclude,_=x.a.getCampaignId(),E=x.a.getCampaignData(),P=x.a.getStep(),A=j(),L=x.a.getExcludes(),q=!(!E||!E.parent)&&E.parent,F=!!q,M=Q(Object(r.useState)(!0),2),G=M[0],V=M[1];Object(r.useEffect)((function(){if(2===parseInt(P)){var e=p,t=!1;!E.data||!E.data.hasOwnProperty("is_promotional")||E.data.is_promotional?(e.status_is=1,t=!0):e.status_is_not=2;var n=!1;e&&e.lists_any&&(n=!0);var r=E&&E.type?E.type:1;y(e,0,10,!0,!1,parseInt(3===parseInt(r)?2:r),t,n,!!F&&q),!G&&h([]),V(!1)}}),[l.search]),Object(r.useEffect)((function(){v("title"in E?E.title:"")}),[E]);var H=function(){var t,n=(t=regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={page:b.page,path:b.path},c=void 0,c=E.data&&!Object(f.isNull)(E.data)&&E.data.hasOwnProperty("filters")?E.data.filters:{},!(JSON.stringify(c)!=JSON.stringify(p)||E.count!=A||Array.isArray(L)&&L.length>0||A<1)){t.next=12;break}if(!((r=parseInt(A)?parseInt(A)-(Array.isArray(L)?L.length:0):0)<1)){t.next=6;break}return O({status:!0,error:Object(u.__)("No Contacts are selected.","wp-marketing-automations")}),t.abrupt("return");case 6:return e.setPending(!0),t.next=9,T()({path:Object(a.u)("/broadcast/".concat(_)),method:"POST",data:{data:{filters:p,count:r,modified_by:Object(a.G)(),exclude:L},step:2},headers:{"Content-Type":"application/json"}}).then((function(e){200==e.code?(w("data",e.result),s({message:e.message,type:1}),w("step",3),Object(I.k)(n,"/",{})):s({message:e.message,type:1})}));case 9:e.setPending(!1),t.next=14;break;case 12:w("step",3),Object(I.k)(n,"/",{});case 14:case"end":return t.stop()}var c}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,a){var c=t.apply(e,n);function o(e){z(c,r,a,o,i,"next",e)}function i(e){z(c,r,a,o,i,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(R.a,null),Object(r.createElement)("div",{className:"bwf-campaign-step-div bwf-card-wrap bwf-campaign-step-2"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(r.createElement)("span",{className:"bwf-form-title"},Object(u.__)("Contacts","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwf-filters-advanced-filters"},F?Object(r.createElement)(k.Card,{className:"bwf-c-campaign-contact-table"},Object(r.createElement)("p",null,Object(u.__)("This broadcast will send emails to those contact, who didn't opened emails in the parent broadcast: ","wp-marketing-automations")+"#"+q)):Object(r.createElement)(J,{campaignId:_,query:b})),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)(k.Card,{className:"bwf-c-campaign-contact-table"},Object(r.createElement)(S,{query:b,campaign:E,exclude:L,onExcludeId:function(e){return h(e)}}))),Object(r.createElement)(D.a,{message:n.message,type:n.type,removeMessage:function(){return s({message:"",type:1})}}),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-crm-campaign-navigation"},Object(r.createElement)(N.a,{className:"bwf-crm-navigation-previous",isSecondary:!0,onClick:function(){var e={page:b.page,path:b.path};Object(I.k)(e,"/",{}),w("step",1)}},Object(u.__)("Previous","wp-marketing-automations")),Object(r.createElement)(N.a,{isPrimary:!0,className:"bwf-crm-navigation-next",onClick:H,isBusy:e.isPending},Object(u.__)("Next","wp-marketing-automations"))))),Object(r.createElement)(U.a,{isLoading:d.loading,successMessage:d.success,errorMessage:d.error,isOpen:d.status,onRequestClose:function(){return O({status:!1})}}))}},958:function(e,t,n){"use strict";var r=n(51),a=n(4),c=n(3);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}t.a=function(){var e=Object(r.a)("contacts"),t=e.fetch,n=e.setStateProp;return i(i({},l(e,["fetch","setStateProp"])),{},{setStateProp:n,fetch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,b=arguments.length>6&&void 0!==arguments[6]&&arguments[6],f=arguments.length>7&&void 0!==arguments[7]&&arguments[7],p=arguments.length>8&&void 0!==arguments[8]&&arguments[8];n("isLoading",!0);var m=e.s,d=void 0===m?"":m,O=(e.page,e.filter,e.path,l(e,["s","page","filter","path"])),g={offset:r,limit:o,search:d,filters:O,get_wc:Object(a.Tb)(),grab_totals:i,only_count:s,fetch_base:u,grab_custom_fields:!1,exclude_unsubs:b,exclude_unsubs_lists:f},j=Object(a.mb)("table_sort_data"),y=j.hasOwnProperty("contact_sort_data")?j.contact_sort_data:{},v=Object(c.isObject)(y)&&!Object(c.isEmpty)(y)?y:{},w=v.orderby,h=void 0===w?"last_modified":w,_=v.order,E=void 0===_?"desc":_;E&&h&&(g.order=E,g.order_by=h),p&&(g.unopen_broadcast=parseInt(p)),t("GET",Object(a.u)("/contacts"),g)},fetchListing:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,b=arguments.length>6&&void 0!==arguments[6]&&arguments[6],f=arguments.length>7&&void 0!==arguments[7]&&arguments[7],p=arguments.length>8&&void 0!==arguments[8]&&arguments[8];n("isLoading",!0);var m=e.s,d=void 0===m?"":m,O=(e.page,e.filter,e.path,l(e,["s","page","filter","path"])),g={offset:r,limit:o,search:d,filters:O,get_wc:Object(a.Tb)(),grab_totals:i,only_count:s,fetch_base:u,grab_custom_fields:!1,exclude_unsubs:b,exclude_unsubs_lists:f},j=Object(a.mb)("table_sort_data"),y=j.hasOwnProperty("contact_sort_data")?j.contact_sort_data:{},v=Object(c.isObject)(y)&&!Object(c.isEmpty)(y)?y:{},w=v.orderby,h=void 0===w?"last_modified":w,_=v.order,E=void 0===_?"desc":_;E&&h&&(g.order=E,g.order_by=h),p&&(g.unopen_broadcast=parseInt(p)),t("GET",Object(a.u)("/v3/contacts/listing"),g)},startIndexing:function(){return t("GET",Object(a.u)("/contacts"),{start_indexing:!0})}})}},970:function(e,t,n){"use strict";var r=n(52);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}t.a=function(){var e=Object(r.a)("contacts"),t=e.getStateProp;return c(c({},i(e,["getStateProp"])),{},{getContacts:function(){return t("contacts_list")},getPageNumber:function(){return parseInt(t("offset"))/parseInt(t("limit"))+1},getPerPageCount:function(){return parseInt(t("limit"))},getTotalCount:function(){return parseInt(t("total"))},getCountData:function(){return t("countData")}})}}}]);