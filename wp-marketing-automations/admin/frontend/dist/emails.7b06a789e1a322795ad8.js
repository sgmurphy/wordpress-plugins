(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1306:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(119),c=n(1),o=n(5),s=n(4),i=n(94),u=n(3),l=n(988),f=n(246),b=n(331);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.default=function(e){var t=e.contactId,n=m(Object(a.useState)({}),2),d=n[0],p=n[1],g=m(Object(a.useState)(!1),2),v=g[0],w=g[1],y=m(Object(a.useState)({status:!1,contactInfo:{}}),2),j=y[0],O=y[1],h=i.a.getContact(),_=i.a.getConversationLimit,k=i.a.getConversations,E=i.a.getConversationOffset,S=i.a.getConversationTotal,C=i.a.getConversationPage,I=i.a.getConversationLoading,N=i.a.getConversationContactId,A=i.a.getContactLoading,L=Object(f.a)().fetchConversations,x=k(),P=I(),T=A(),M=E(),R=S(),q=_(),D=C(),B=N();Object(a.useEffect)((function(){(Object(u.isEmpty)(x)||t!=B)&&L(t,M,q)}),[]);var F=[{key:"subject",label:Object(c.__)("Subject","wp-marketing-automations"),isLeftAligned:!1,cellClassName:"bwf-word-break"},{key:"sent_time",label:Object(c.__)("Sent On","wp-marketing-automations"),isLeftAligned:!0},{key:"opens",label:Object(c.__)("Opens","wp-marketing-automations"),isLeftAligned:!0},{key:"clicks",label:Object(c.__)("Clicks","wp-marketing-automations"),isLeftAligned:!0}],J=function(e){var t=null!=e&&e.c_status?function(e){switch(parseInt(e)){case 1:return Object(a.createElement)("span",{className:"bwf-tags bwf-tag-gray"},Object(c.__)("Draft","wp-marketing-automations"));case 3:return Object(a.createElement)("span",{className:"bwf-tags bwf-tag-red"},Object(c.__)("Failed","wp-marketing-automations"));case 4:return Object(a.createElement)("span",{className:"bwf-tags bwf-tag-orange"},Object(c.__)("Bounced","wp-marketing-automations"));default:return Object(a.createElement)(a.Fragment,null)}}(null==e?void 0:e.c_status):"-";return Object(a.createElement)("a",{className:"bwf-a-no-underline bwf_bold",onClick:function(){p(e),w(!0)}},Object(a.createElement)("span",{className:"bwf-mr-10"},e.subject?e.subject:"-"),t)},U=x&&x.length>0?x.map((function(e){return"ID"in e&&parseInt(e.ID)>0&&[{display:J(e),value:e.subject},{display:Object(s.W)(e.created_at,!1),value:e.created_at},{display:e.open?e.open:0,value:e.open},{display:e.click?e.click:0,value:e.click}]})):[];return Object(a.createElement)("div",{className:"bwf-cs-contact-tab-data"},Object(a.createElement)("div",{className:"bwf-content-header-new"},Object(a.createElement)("div",{className:"bwf-content-header-left"},P||T?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-150 bwf-h-15"}):Object(a.createElement)("div",{className:"bwf-normal-text"},parseInt(R)>0&&Object(c.sprintf)(Object(c.__)("All Emails (%s)","wp-marketing-automations"),R))),Object(a.createElement)("div",{className:"bwf-content-header-right"},P||T?Object(a.createElement)("div",{className:"bwf-placeholder-temp bwf-w-60 bwf-h-30"}):Object(a.createElement)(o.Button,{className:"bwf-btn-small is-blue",isPrimary:!0,onClick:function(){O({status:!0,contactInfo:h})}},Object(c.__)("Send Email","wp-marketing-automations")))),Object(a.createElement)("div",{className:"bwf-c-s-data"},Object(a.createElement)("div",{className:"bwf-c-s-section"},Object(a.createElement)(r.a,{className:"contact-single-table contact-emails",headers:F,hideHeader:"yes",rows:U,query:{paged:D},totalRows:R,rowsPerPage:q,isLoading:P||T,showMenu:!1,onPageChange:function(e,n){return L(t,(e-1)*q,q)},onQueryChange:function(e){return"per_page"===e?function(e){return e!==q&&L(t,M,e)}:function(){return{}}},emptyMessage:Object(c.__)("No emails found","wp-marketing-automations")}))),Object(a.createElement)(l.a,{onRequestClose:function(){return w(!1)},conversation:d,contact:h,isOpen:v}),j.status&&Object(a.createElement)(b.a,{contact:j.contactInfo,setSendMessageModel:O,onSuccess:function(){return L(t,M,q)},messageType:"email"}))}},988:function(e,t,n){"use strict";var a=n(0),r=n(1),c=n(9),o=n.n(c),s=n(4),i=n(311);function u(e,t,n,a,r,c,o){try{var s=e[c](o),i=s.value}catch(e){return void n(e)}s.done?t(i):Promise.resolve(i).then(a,r)}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],a=!0,r=!1,c=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw c}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}t.a=function(e){var t=e.conversation,n=(t=void 0===t?{}:t).ID,c=t.mode,f=t.type,b=e.onRequestClose,m=e.isOpen,d=e.contact,p=void 0===d?{}:d,g=l(Object(a.useState)(null),2),v=g[0],w=g[1],y=l(Object(a.useState)(!1),2),j=y[0],O=y[1],h=l(Object(a.useState)(null),2),_=h[0],k=h[1],E=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!(!parseInt(n)>0)){e.next=2;break}return e.abrupt("return");case 2:return O(!0),e.prev=3,e.next=6,o()({method:"GET",path:Object(s.u)("/v3/contacts/".concat(p.id,"/engagement/").concat(parseInt(n),"?mode=1"))});case 6:"result"in(t=e.sent)&&w(t.result),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0),e.t0&&"message"in e.t0?k(e.t0.message):Object(r.__)("There are some technical difficulties while getting emails. Please contact support.","wp-marketing-automations");case 14:O(!1);case 15:case"end":return e.stop()}}),e,null,[[3,10]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){u(c,a,r,o,s,"next",e)}function s(e){u(c,a,r,o,s,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();Object(a.useEffect)((function(){m&&E()}),[m]);return Object(a.createElement)(i.a,{isOpen:m,isLoading:j,onRequestClose:function(){b(),w(null),k(null)},error:_,subject:parseInt(c)<2&&v&&v.subject,body:v&&v.body?v.body:"",sourceType:f,mode:c,contact:e.contact,conversation:e.conversation,template:v})}}}]);