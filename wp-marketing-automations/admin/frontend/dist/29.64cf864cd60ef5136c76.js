(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{1007:function(e,t,a){},1031:function(e,t,a){},1033:function(e,t,a){"use strict";var n=a(0),r=a(6),c=a.n(r),o=a(3),i=a(63),l=a(1),s=a(9),m=a.n(s),b=a(8),u=(a(1034),a(4)),d=a(20);function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){O(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return w(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}t.a=function(e){var t=e.header,a=void 0===t?Object(l.__)("View Analytics","wp-marketing-automations"):t,r=e.icon,s=void 0===r?"analytic":r,p=e.automationId,O=e.analyticsId,w=e.mode,v=void 0===w?"":w,y=e.extraData,g=void 0===y?{}:y,_=j(Object(n.useState)(!0),2),E=_[0],h=_[1],k=j(Object(n.useState)(!1),2),N=k[0],P=k[1],C=j(Object(n.useState)({}),2),S=C[0],A=C[1],D=function(){parseInt(O)>0&&Object(u.Jb)()?(h(!0),A({}),function(){try{var e=f(f({},g),{},{mode:v});m()({path:Object(u.u)("/automation/".concat(p,"/analytics/").concat(O,"?").concat(Object(d.stringify)(e))),method:"GET"}).then((function(e){200===e.code?Object(o.isEmpty)(e.result)||A(e.result):P(!0),h(!1)}))}catch(e){P(!0),h(!1)}}()):h(!1)},x=function(){var e,t=S.tile,a=void 0===t?[]:t;return N?Object(n.createElement)(n.Fragment,null,Object(l.__)("Error while fetching the Analytics.","wp-marketing-automations")):Object(u.Jb)()?Object(n.createElement)(n.Fragment,null,Object(o.isEmpty)(a)?Object(n.createElement)("div",{className:"bwf-normal-text"},Object(l.__)("No analytics found.","wp-marketing-automations")):Object(n.createElement)("div",{className:"bwf-info-brick"},a.map((function(e,t){var a=e.label,r=void 0===a?"":a,c=e.value,o=void 0===c?"-":c;if(""!==r)return Object(n.createElement)("div",{className:"bwf-info-item",key:t},Object(n.createElement)("span",{className:"bwf-node-content-type"},r),Object(n.createElement)("span",{className:"bwf-node-content-label"},o))})))):(e=[{label:Object(l.__)("Sent","wp-marketing-automations")},{label:Object(l.__)("Open Rate","wp-marketing-automations")}],"email"===v&&e.push({label:Object(l.__)("Click Rate","wp-marketing-automations")},{label:Object(l.__)("Click to Open Rate","wp-marketing-automations")}),e.push({label:Object(l.__)("Revenue","wp-marketing-automations")},{label:Object(l.__)("Revenue/Contact","wp-marketing-automations")},{label:Object(l.__)("Unsubscribe Rate","wp-marketing-automations")}),Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-info-brick"},e.map((function(e,t){return Object(n.createElement)("div",{className:"bwf-info-item",key:t},Object(n.createElement)("span",{className:"bwf-node-content-type"},e.label),Object(n.createElement)("span",{className:"bwf-node-content-label"},"-"))}))),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-normal-text"},Object(l.__)("Email Analytics is a PRO feature.","wp-marketing-automations")+" ",Object(n.createElement)("a",{target:"__blank",className:"bwf-normal-a-t bwf-font-light",href:Object(u.T)("upgrade",{utm_medium:"Automation+Email+Analytics"})},Object(l.__)("Upgrade to PRO","wp-marketing-automations")))))};return Object(n.createElement)("div",{className:"bwf-info-popup"},Object(n.createElement)(i.a,{contentClassName:"bwf-info__popover",position:"top center",renderToggle:function(e){var t=e.onToggle,r=e.isOpen,o=c()("bwf-info__toggle bwf-cursor-pointer",{"is-opened":r});return Object(n.createElement)("div",{className:o,onClick:function(){t(),D()},"aria-expanded":r},Object(n.createElement)(b.a,{size:14,icon:s}),a)},renderContent:function(e){var t=e.onToggle;return Object(n.createElement)("div",{className:"bwf-info-popover-container"},Object(n.createElement)("div",{className:"bwf-info-popover-header"},Object(n.createElement)("div",{className:"bwf-info-header-text"},a,!Object(u.Jb)()&&u.e),Object(n.createElement)("span",{className:"bwf-info-close",onClick:t},Object(n.createElement)(b.a,{icon:"close",size:20}))),Object(n.createElement)("div",{className:"bwf-info-popover-body"},Object(n.createElement)("div",{className:"bwf-info-wrapper"},Object(n.createElement)("div",{className:"bwf-info--content"},E?Object(n.createElement)("div",{className:"bwf-info-brick"},[1,2,3,4,5,6].map((function(e){return Object(n.createElement)("div",{className:"bwf-info-item",key:e},Object(n.createElement)("span",{className:"bwf-node-content-type"},Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-60 bwf-h-15"})),Object(n.createElement)("span",{className:"bwf-node-content-label"},Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-90 bwf-h-15"})))}))):x()))))},focusOnMount:!0}))}},1034:function(e,t,a){},1270:function(e,t,a){},1271:function(e,t,a){},1272:function(e,t,a){},1273:function(e,t,a){},1274:function(e,t,a){},1275:function(e,t,a){},1276:function(e,t,a){},1325:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(945),c=a(3),o=a(6),i=a.n(o),l=a(1),s=(a(1006),a(8)),m=a(5),b=a(302),u=a(120),d=a(4);var p=a(9),f=a.n(p),O=(a(1007),a(66)),j=a(16),w=a(39);function v(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function y(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){v(c,n,r,o,i,"next",e)}function i(e){v(c,n,r,o,i,"throw",e)}o(void 0)}))}}function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){E(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function E(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var N=function(e){var t=Object(n.useContext)(d.h),a=e.isOpen,r=e.onRequestClose,o=e.node,p=e.isEvent,v=void 0===p||p,g=e.automationID,E=o.id,k=Object(b.a)(),N=k.setNodeDatabyId,P=k.fetchAutomation,C=k.setAutomationData,S=k.showSidebar,A=Object(u.a)(),D=A.getEventsList,x=A.getActionsList,I=A.getAutomationSteps,M=A.getAutomationLinks,T=A.getCount,F=A.getAutomationData,L=A.getNodeDataByID,R=A.getautomationMeta,z=v?D():x(),J=h(Object(n.useState)({loading:!1,status:!1}),2),U=J[0],q=J[1],B=z.group,H=void 0===B?[]:B,V=z.list,W=void 0===V?{}:V,G=z.subgroup,$=void 0===G?[]:G,Y=z.subgroup_priority,Q=void 0===Y?{}:Y,X=h(Object(n.useState)(""),2),Z=X[0],K=X[1],ee=h(Object(n.useState)(""),2),te=ee[0],ae=ee[1],ne=h(Object(n.useState)(""),2),re=ne[0],ce=ne[1],oe=h(Object(n.useState)(""),2),ie=oe[0],le=oe[1],se=h(Object(n.useState)(!1),2),me=se[0],be=se[1],ue=h(Object(n.useState)({status:!1}),2),de=ue[0],pe=ue[1],fe=I(),Oe=M(),je=T(),we=F("data"),ve=L(E),ye=ve.data,ge=void 0===ye?{}:ye,_e=ve.stepId,Ee=void 0===_e?0:_e,he=R(),ke=Object.keys(Q).sort((function(e,t){return Q[e]-Q[t]})),Ne=we.source,Pe=void 0===Ne?"":Ne,Ce=we.event,Se=void 0===Ce?"":Ce,Ae=function(e){var t=[],a="";return H.map((function(n){(Object(c.isArray)(n.subgroup)&&n.subgroup.includes(e)||Object(c.isObject)(n.subgroup)&&Object.values(n.subgroup).includes(e))&&(t=n.subgroup,a=n.group_slug)})),{acsubgp:t,acgrp:a}};Object(n.useEffect)((function(){if(Object(c.isEmpty)(H)||(""!=Pe||""!=Se)&&v){var e=Ae(Pe),t=e.acsubgp,a=e.acgrp;ce(Object(c.isObject)(t)?Object.values(t):t),ae(a),le(Se)}else ae(H[0].group_slug),ce(Object(c.isObject)(H[0].subgroup)?Object.values(H[0].subgroup):H[0].subgroup)}),[a]),Object(n.useEffect)((function(){if(Object(c.isEmpty)(Z))if(Object(c.isEmpty)(H)||(""!=Pe||""!=Se)&&v){var e=Ae(Pe),t=e.acsubgp,a=e.acgrp;ce(Object(c.isObject)(t)?Object.values(t):t),ae(a),le(Se)}else ae(H[0].group_slug);else ae("")}),[Z]);var De,xe,Ie=function(){r&&r()},Me=function(){var e=y(regeneratorRuntime.mark((function e(a,n,r,i){var s,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!1,i.hasOwnProperty("event")&&W.hasOwnProperty(i.event)&&W[i.event].hasOwnProperty("need_unique_key")&&W[i.event].need_unique_key&&(s=!0),m={},m=""==Se?{steps:Object(c.cloneDeep)(a).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:n,count:r,data:i,need_unique_key:s}:{data:i,need_unique_key:s},e.prev=4,be(!0),t(Object(l.__)("Updating automation…","wp-marketing-automations")),e.next=9,f()({path:Object(d.u)("/automation/".concat(g)),method:"POST",data:{data:m}}).then(function(){var e=y(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(200!==a.code){e.next=7;break}return e.next=3,P(g).then((function(){C("openStartSidebar",!0)})).then((function(){var e=Object(c.cloneDeep)(o);e.data.selected="start",C("sidebarNodeData",e),S(!0)}));case 3:t(a.message),Object(d.wb)(t,3e3),e.next=8;break;case 7:throw Error(Object(d.p)(null==a?void 0:a.message));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 9:e.next=16;break;case 11:e.prev=11,e.t0=e.catch(4),Object(d.wb)(t,3e3),be(!1),setTimeout((function(){q({status:!0,error:e.t0.message})}),[1500]);case 16:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t,a,n,r){return e.apply(this,arguments)}}(),Te=function(){var e=y(regeneratorRuntime.mark((function e(a,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={steps:Object(c.cloneDeep)(fe).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:Oe,count:je,data:{action:{action:a,intergration:n}},updateStatus:2},e.prev=1,be(!0),t(Object(l.__)("Updating automation…","wp-marketing-automations")),e.next=6,f()({path:Object(d.u)("/automation/".concat(g,"/step/").concat(Ee)),method:"POST",data:r}).then((function(e){if(200!==e.code)throw Error(Object(d.p)(null==e?void 0:e.message));N(o.id,{selected:a},{step_status:2}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&C("meta",_(_({},he),e.result.meta)),t(e.message)})).then((function(){var e=Object(c.cloneDeep)(o);e.data.selected=a,C("sidebarNodeData",e),S(!0),be(!1),Ie(),Object(d.wb)(t,3e3)}));case 6:e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),Object(d.wb)(t,3e3),be(!1),setTimeout((function(){q({status:!0,error:e.t0.message})}),[1500]);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,a){return e.apply(this,arguments)}}(),Fe=function(e){if("string"==typeof e&&""!==e&&Se!==e)if("start"===E&&v)ge.evtGroup=W[e].source_type,ge.event=e,function(e){var t={};t=fe.map((function(t){return"start"==t.id&&(t.data=e),t}));var a=[];1==fe.length?(t.push({id:"end",type:"end",data:{label:Object(l.__)("End Automation","wp-marketing-automations")},hidden:!1,position:{x:250,y:600}}),a=[{id:"endlink",source:"start",target:"end",sourceHandle:"",animated:!1}]):a=Object(c.cloneDeep)(Oe);var n=Object(c.cloneDeep)(we);n.event=e.event,n.source=e.evtGroup,Me(t,a,2,n)}(ge);else{var a=W[e].integration_slug;Te(e,a)}else t(Se===e?Object(l.__)("Please choose a different event to save.","wp-marketing-automations"):v?Object(l.__)("Please choose an event.","wp-marketing-automations"):Object(l.__)("Please choose an action.","wp-marketing-automations")),Object(d.wb)(t,3e3)};return a?Object(n.createElement)(m.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-admin-modal-xl",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(n.createElement)("div",{className:"bwf-modal-search-header"},Object(n.createElement)("div",{className:"bwf-modal-title"},v?Object(l.__)("Select an Event","wp-marketing-automations"):Object(l.__)("Select an Action","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf-modal-search-wrap"},Object(n.createElement)("div",{className:"bwf-component-search-control"},Object(n.createElement)(s.a,{icon:"search",size:15}),Object(n.createElement)(m.TextControl,{value:Z,onChange:K,placeholder:Object(l.__)("Search…","wp-marketing-automations")}))),Object(n.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:Ie},Object(n.createElement)(s.a,{icon:"close",size:20}))),Object(n.createElement)("div",{className:"bwf-event-modal-main"},Object(n.createElement)("div",{className:"bwf-event-modal-body"},Object(n.createElement)("div",{className:"bwf-modal-sidebar"},Object(n.createElement)("div",{className:"bwf-modal-filter-wrap"},H.map((function(e,t){if(function(e){var t=!1;if(e.hasOwnProperty("subgroup")&&!Object(c.isEmpty)(e.subgroup)){var a=[];(Object(c.isObject)(e.subgroup)?Object.values(e.subgroup):e.subgroup).map((function(e){$.hasOwnProperty(e)&&a.push(e)})),Object(c.isEmpty)(a)||(t=!0)}return t}(e))return Object(n.createElement)("div",{key:t,className:i()("bwf-modal-filter",{active:te===e.group_slug}),onClick:function(){le(""),ae(e.group_slug),ce(Object(c.isObject)(e.subgroup)?Object.values(e.subgroup):e.subgroup)}},e.label)})))),Object(n.createElement)("div",{className:"bwf-modal-content-content"},Object(n.createElement)("div",{className:"bwf-modal-content-brick"},Object(n.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(n.createElement)("div",{className:"bwf-brick-content"},(De=[],xe={},Object(c.isEmpty)(Z)?re.map((function(e){xe=_(_({},xe),$[e])})):Object.values($).map((function(e){xe=_(_({},xe),e)})),De.push(xe),De).map((function(e,t){if(Object(c.isEmpty)(e))return Object(n.createElement)(n.Fragment,{key:t});var a=[],r=Object.keys(e);return Object(c.isEmpty)(ke)?a=r:ke.map((function(e){r.includes(e)&&a.push(e)})),Object(n.createElement)("div",{key:t+"-2"},a.map((function(t,a){var r=[];return r=function(e){var t=[];return(Object(c.isObject)(e)?Object.values(e):e).map((function(e){if(W.hasOwnProperty(e)&&W[e].hasOwnProperty(v?"event_name":"action_name")){var a=v?W[e].event_name:W[e].action_name;(Object(c.isEmpty)(Z)||a.toLowerCase().includes(Z.toLowerCase()))&&t.push(e)}})),t}(e[t]),!Object(c.isEmpty)(r)&&Object(n.createElement)(n.Fragment,{key:a},Object(n.createElement)("div",{className:"bwf-brick-content-header",key:a},t),r.map((function(e,t){var a=!!W[e].hasOwnProperty("lock")&&W[e].lock;return Object(n.createElement)(j.a,{key:t,isPrimary:ie===e,isSecondary:ie!==e,className:"bwf-secondary-alter "+(Object(d.Jb)()?a?"locked":"":a?"not-pro locked":"not-pro"),onClick:function(){!Object(d.Jb)()&&a?pe({status:!0,featureTitle:v?W[e].event_name:W[e].action_name}):le(e)},disabled:Object(d.Jb)()&&a},ie===e&&Object(n.createElement)("span",{className:"bwf-circle-tick"},Object(n.createElement)(s.a,{icon:"tick",size:10})),v?W[e].event_name:W[e].action_name,a&&!Object(d.Jb)()&&Object(n.createElement)("span",{className:"bwf-display-flex bwf-ml-5"},Object(n.createElement)(s.a,{icon:"king",size:15})))})))})))}))))),Object(n.createElement)("div",{className:"bwf-modal-inner-footer bwf_text_right"},Object(n.createElement)(j.a,{className:"bwf-modal-cancel-btn",onClick:Ie},Object(l.__)("Cancel","wp-marketing-automations")),Object(n.createElement)(j.a,{isPrimary:!0,isBusy:me,onClick:function(){me||Fe(ie)}},Object(l.__)("Done","wp-marketing-automations")))))),Object(n.createElement)(O.a,{modalTitle:v?Object(l.__)("Event Selection","wp-marketing-automations"):Object(l.__)("Action Selection","wp-marketing-automations"),errorMessage:U.error,onRequestClose:function(){return q({status:!1})},isOpen:U.status}),!Object(d.Jb)()&&Object(n.createElement)(w.b,{isOpen:de.status,onRequestClose:function(){return pe({status:!1})},modalContent:{title:Object(l.sprintf)(Object(l.__)("%s is a PRO Event","funnel-builder"),de.featureTitle),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Event+Upgrade+Modal"})}})):""};function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function A(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var I=function(e){var t=Object(n.useContext)(d.h),a=e.isOpen,r=e.onRequestClose,o=e.node,p=e.automationID,O=o.id,j=Object(b.a)(),w=j.setNodeDatabyId,v=j.setAutomationData,y=j.showSidebar,g=Object(u.a)(),_=g.getGoals,E=g.getAutomationSteps,h=g.getAutomationLinks,k=g.getCount,N=g.getNodeDataByID,P=(0,g.getautomationMeta)(),S=_(),x=S.group,I=void 0===x?[]:x,M=S.list,T=void 0===M?{}:M,F=S.subgroup,L=void 0===F?[]:F,R=S.subgroup_priority,z=void 0===R?{}:R,J=D(Object(n.useState)(""),2),U=J[0],q=J[1],B=D(Object(n.useState)(""),2),H=B[0],V=B[1],W=D(Object(n.useState)(""),2),G=W[0],$=W[1],Y=D(Object(n.useState)(""),2),Q=Y[0],X=Y[1],Z=D(Object(n.useState)(!1),2),K=Z[0],ee=Z[1],te=E(),ae=h(),ne=k(),re=N(O),ce=re.data,oe=void 0===ce?{}:ce,ie=re.stepId,le=void 0===ie?0:ie,se=z[H]?z[H]:{},me=oe.source,be=void 0===me?"":me,ue=oe.benchmark,de=void 0===ue?"":ue,pe=function(e){var t=[],a="";return I.map((function(n){n.subgroup.includes(e)&&(t=n.subgroup,a=n.group_slug)})),{acsubgp:t,acgrp:a}};Object(n.useEffect)((function(){if(Object(c.isEmpty)(I)||""!=be||""!=de){var e=pe(be),t=e.acsubgp,a=e.acgrp;$(t),V(a),X(de)}else V(I[0].group_slug),$(I[0].subgroup)}),[a]),Object(n.useEffect)((function(){if(Object(c.isEmpty)(U))if(Object(c.isEmpty)(I)||""!=be||""!=de){var e=pe(be),t=e.acsubgp,a=e.acgrp;$(t),V(a),X(de)}else V(I[0].group_slug);else V("")}),[U]);var fe,Oe=function(){r&&r()},je=function(){var e,a=(e=regeneratorRuntime.mark((function e(a,n){var r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=oe,ee(!0),r.benchmark=a,t(Object(l.__)("Adding benchmark..","wp-marketing-automations")),e.prev=4,i={steps:Object(c.cloneDeep)(te).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:ae,count:ne,data:{action:{benchmark:a,source:n}},updateStatus:2},e.next=8,f()({path:Object(d.u)("/automation/".concat(p,"/step/").concat(le)),method:"POST",data:i}).then((function(e){200===e.code&&(t(e.message),w(parseInt(O),r,{step_status:2}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&v("meta",C(C({},P),e.result.meta)))})).then((function(){var e=Object(c.cloneDeep)(o);e.data.benchmark=a,v("sidebarNodeData",e),y(!0),ee(!1),Oe()}));case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.log(e.t0),ee(!0);case 14:Object(d.wb)(t,3e3);case 15:case"end":return e.stop()}}),e,null,[[4,10]])})),function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){A(c,n,r,o,i,"next",e)}function i(e){A(c,n,r,o,i,"throw",e)}o(void 0)}))});return function(e,t){return a.apply(this,arguments)}}();return a?Object(n.createElement)(m.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-admin-modal-xl",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(n.createElement)("div",{className:"bwf-modal-search-header"},Object(n.createElement)("div",{className:"bwf-modal-title"},Object(l.__)("Select an Goal","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf-modal-search-wrap"},Object(n.createElement)("div",{className:"bwf-component-search-control"},Object(n.createElement)(s.a,{icon:"search",size:15}),Object(n.createElement)(m.TextControl,{value:U,onChange:q,placeholder:Object(l.__)("Search…..")}))),Object(n.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:Oe},Object(n.createElement)(s.a,{icon:"close",size:20}))),Object(n.createElement)("div",{className:"bwf-event-modal-main"},Object(n.createElement)("div",{className:"bwf-event-modal-body"},Object(n.createElement)("div",{className:"bwf-modal-sidebar"},Object(n.createElement)("div",{className:"bwf-modal-filter-wrap"},I.map((function(e,t){if(function(e){var t=!1;if(e.hasOwnProperty("subgroup")&&!Object(c.isEmpty)(e.subgroup)){var a=[];e.subgroup.map((function(e){L.hasOwnProperty(e)&&a.push(e)})),Object(c.isEmpty)(a)||(t=!0)}return t}(e))return Object(n.createElement)("div",{key:t,className:i()("bwf-modal-filter",{active:H===e.group_slug}),onClick:function(){X(""),V(e.group_slug),$(e.subgroup)}},e.label)})))),Object(n.createElement)("div",{className:"bwf-modal-content-content"},Object(n.createElement)("div",{className:"bwf-modal-content-brick"},Object(n.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(n.createElement)("div",{className:"bwf-brick-content"},(fe=[],Object(c.isEmpty)(U)&&!Object(c.isEmpty)(G)?G.map((function(e){fe.push(L[e])})):Object.values(L).map((function(e){fe.push(e)})),fe).map((function(e,t){if(Object(c.isEmpty)(e))return Object(n.createElement)("div",{key:t});var a=[];return a=se&&Object.keys(se).length>0?Object.keys(e).sort((function(e,t){return se[e]||se[t]?se[e]&&!se[t]?1:!se[e]&&se[t]?-1:se[e]-se[t]:1})):Object.keys(e),Object(n.createElement)("div",{key:t},a.map((function(t,a){var r=function(e){var t=[];return e.map((function(e){if(T.hasOwnProperty(e)&&T[e].hasOwnProperty("event_name")){var a=T[e].event_name;(Object(c.isEmpty)(U)||a.toLowerCase().includes(U.toLowerCase()))&&t.push(e)}})),t}(e[t]);return!Object(c.isEmpty)(r)&&Object(n.createElement)("div",{key:a},Object(n.createElement)("div",{className:"bwf-brick-content-header"},t),r.map((function(e){return Object(n.createElement)(m.Button,{key:e,isPrimary:Q===e,isSecondary:Q!==e,className:"bwf-secondary-alter",onClick:function(){X(e)}},Q===e&&Object(n.createElement)("span",{className:"bwf-circle-tick"},Object(n.createElement)(s.a,{icon:"tick",size:10})),Object(n.createElement)(n.Fragment,null,T[e].event_name))})))})))}))))),Object(n.createElement)("div",{className:"bwf-modal-inner-footer bwf_text_right"},Object(n.createElement)(m.Button,{className:"bwf-modal-cancel-btn",onClick:Oe},Object(l.__)("Cancel","wp-marketing-automations")),Object(n.createElement)(m.Button,{isPrimary:!0,isBusy:K,onClick:function(){K||function(e){if("string"==typeof e&&""!==e){var a=T[e].source_type;je(e,a)}else t(Object(l.__)("Please choose an benchmark.","wp-marketing-automations")),Object(d.wb)(t,3e3)}(Q)}},Object(l.__)("Done","wp-marketing-automations"))))))):""},M=function(e){var t=e.onNodeClick,a=e.onNoteToggleClick,r=e.onElipsisToggleClick,c=e.onInfoToggleClick,o=e.onNodeStatClick,i=e.onNodeQueuedStatClick,l=e.onNodeFailedStatClick,s=e.onAnalyticsClick,m=e.onNodeSkippedStatClick,b=Object(u.a)(),d=b.getEnableCopy,p=b.getEnableMove,f=d(),O=p(),j=Object(n.useCallback)((function(e,t){var a=!(!e.target||"string"!=typeof e.target.className)&&e.target.className;return!!a&&a.includes(t)||e.target.closest("."+t)}),[]);return function(e){if(!f&&!O)if(j(e,"bwf-note__toggle"))a&&a();else if(j(e,"bwf-ellipsis-menu__toggle"))r&&r();else if(j(e,"bwf-info__toggle"))c&&c();else if(j(e,"bwf-queued-status-wrap"))i&&i();else if(j(e,"bwf-failed-status-wrap"))l&&l();else if(j(e,"bwf-skipped-status-wrap"))m&&m();else if(j(e,"bwf-node-analytics"))s&&s();else if(j(e,"bwf-status-wrap"))o&&o();else{var n=j(e,"bwf-ellipsis-menu"),b=j(e,"bwf-note-popup"),u=j(e,"bwf-info-popup");n||b||u||t&&t()}}},T=a(58),F=a(18),L=a(57);function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var J=function(e){var t=e.selected,a=void 0!==t&&t,o=R(Object(n.useState)(!1),2),i=o[0],m=o[1],p=Object(u.a)(),f=p.getEventsList,O=p.getAutomationData,j=p.getOpenStartSidebar,w=p.getEnableMove,v=p.getEnableCopy,y=p.getStatLoading,g=p.getStatData,_=v(),E=w(),h=O(),k=j(),P=y(),C=g(),S=h.ID,A=h.event,D=void 0===A?"":A,x=C.hasOwnProperty("start")?C.start:{};Object(n.useEffect)((function(){k&&(z("sidebarNodeData",e),J(!0))}),[k]);var I=Object(b.a)(),z=I.setAutomationData,J=I.showSidebar,U=f(),q=M({onNodeClick:!Object(c.isEmpty)(D)&&U.list.hasOwnProperty(D)&&function(){U.list[D].hasOwnProperty("fields")&&!Object(c.isEmpty)(U.list[D].fields)&&(z("sidebarNodeData",e),J(!0))},onNodeStatClick:function(){z("showContactModalId",D),z("showContactModalType","completed")},onNodeQueuedStatClick:function(){z("showContactModalId",D),z("showContactModalType","active")}});return Object(n.createElement)("div",{className:"bwf-node-wrapper"},Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(a?"bwf-selected-node":"")+(Object(c.isEmpty)(D)?" bwf-empty-start-node":""),onClick:q},Object(c.isEmpty)(D)?Object(n.createElement)("div",{className:"bwf-node-brick is-start-node",onClick:function(){return m(!0)}},Object(n.createElement)("div",{className:"bwf-node-icon"},Object(n.createElement)(s.a,{size:22,icon:"tap-icon"})),Object(n.createElement)("div",{className:"bwf-display-flex bwf-h4"},Object(l.__)("Select an Event","wp-marketing-automations"))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-brick is-start-node-selected"},Object(n.createElement)("div",{className:"bwf-node-icon icon-start"},Object(n.createElement)(s.a,{size:22,icon:"rocket"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},U.list.hasOwnProperty(D)&&U.list[D].hasOwnProperty("source_label")?U.list[D].source_label:""),Object(n.createElement)("div",{className:"bwf-node-content-label"},U.list.hasOwnProperty(D)&&U.list[D].hasOwnProperty("event_name")?U.list[D].event_name:Object(l.__)("Event Not Found","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"},!Object(c.isEmpty)(D)&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(L.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!_&&!E),renderContent:function(e){var t=e.onToggle;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){m(!0),t()}},Object(n.createElement)(F.a,{justify:"flex-start"},Object(n.createElement)(F.c,null,Object(l.__)("Change Event","wp-marketing-automations")))))}})))),Object(n.createElement)("div",{className:"bwf-node-status bwf-node-m-0"},Object(n.createElement)("div",{className:"bwf-queued-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Active","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},P?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,x.hasOwnProperty("active")?Object(d.Wb)(parseInt(x.active)):0))),Object(n.createElement)("div",{className:"bwf-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},P?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,x.hasOwnProperty("completed")?Object(d.Wb)(parseInt(x.completed)):0)))))),!Object(c.isEmpty)(D)&&Object(n.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(n.createElement)(N,{isOpen:i,node:e,onRequestClose:function(){return m(!1)},automationID:S}))},U=(a(63),a(1270),a(53));function q(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return H(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var V=function(e){var t,a,r=e.node,o=r.id,p=void 0===o?"":o,O=r.data,j=Object(n.useContext)(d.h),w=B(Object(n.useState)(!1),2),v=w[0],y=w[1],g=B(Object(n.useState)(O.hasOwnProperty("note")?O.note:""),2),_=g[0],E=g[1],h=B(Object(n.useState)(!1),2),k=h[0],N=h[1],P=Object(b.a)().setNodeDatabyId,C=Object(u.a)(),S=C.getAutomationData,A=C.getNodeDataByID,D=C.getEnableMove,x=C.getEnableCopy,I=D(),M=x(),F=Object(c.isEmpty)(p)?{}:A(p),R=F.stepId,z=void 0===R?0:R,J=F.data,H=(void 0===J?{}:J).note,V=void 0===H?"":H,W=S().ID,G=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.prev=1,e.next=4,f()({path:Object(d.u)("/automation/".concat(W,"/step/").concat(z)),method:"POST",data:{data:{data:{note:t}}}}).then((function(e){200===e.code&&(j(e.message),O.note=t,P(p,O),N(!1))}));case 4:y(!1),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),j(e.t0.message),y(!1);case 11:Object(d.wb)(j,3e3);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})),function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){q(c,n,r,o,i,"next",e)}function i(e){q(c,n,r,o,i,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}(),$=B(Object(n.useState)(!1),2),Y=$[0],Q=$[1];return Object(n.createElement)("div",{className:"bwf-note-popup"},function(e,t){var a=i()("bwf-note__toggle bwf-cursor-pointer",{"is-opened":t});return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:a,onClick:function(t){I||M||e(t)},"aria-expanded":t},!Object(c.isEmpty)(_)&&Object(n.createElement)("span",{className:"bwf-has-note"}),Object(n.createElement)(s.a,{size:16,icon:"note"})))}((function(){return Q(!Y)}),!0),Y&&Object(n.createElement)(U.a,{position:"top right",className:"bwf-note__popover",onClose:function(){return Q(!1)},focusOnMount:!0},(t=function(){return Q(!Y)},Object(n.createElement)("div",{className:"bwf-note-popover-container"},Object(n.createElement)("div",{className:"bwf-note-popover-header"},Object(n.createElement)("div",{className:"bwf-note-header-text"},Object(l.__)("Notes","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-note-close",onClick:t},Object(n.createElement)(s.a,{icon:"close",size:20}))),Object(n.createElement)("div",{className:"bwf-note-popover-body"},Object(c.isEmpty)(_)||k?Object(n.createElement)(n.Fragment,null,Object(n.createElement)(m.TextareaControl,{value:_,onChange:function(e){N(!0),E(e)}}),Object(n.createElement)("div",{className:"bwf_text_right",onClick:function(){return G(_)}},Object(n.createElement)(m.Button,{isPrimary:!0,isBusy:v},Object(c.isEmpty)(V)?Object(l.__)("Add","wp-marketing-automations"):Object(l.__)("Update","wp-marketing-automations")))):Object(n.createElement)("div",{className:"bwf-note-wrapper"},Object(n.createElement)("div",{className:"bwf-note--content"},Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:(a=_,a.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,'<a href="$1" target="_blank" class="bwf-a-no-underline">$1</a>'))}})),Object(n.createElement)(L.a,{label:Object(l.__)("Event note action","wp-marketing-automations"),renderContent:function(e){var t=e.onToggle;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){N(!0)}},Object(l.__)("Edit","wp-marketing-automations")),Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){t(),E(""),G("")}},Object(l.__)("Delete","wp-marketing-automations")))}})))))))},W=a(1008);function G(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Y(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Y(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Q=function(e){var t=e.readables;return Object(n.createElement)("div",{className:"bwf-step-brick"},t.map((function(e,t){var a=e.map((function(e,t){return Object(c.isEmpty)(e)?Object(n.createElement)(n.Fragment,null):Object(n.createElement)("div",{key:t},0!==t&&Object(n.createElement)("div",{className:"bwf-step-divider"},Object(n.createElement)("span",{className:"bwf-divider"},"AND")),Object(n.createElement)("div",{className:"bwf-step-content-content bwf-two-line-ellipse-text"},e))}));return 0!==t?Object(c.isEmpty)(a)?Object(n.createElement)(n.Fragment,null):Object(n.createElement)("div",{key:t+"-or"},Object(n.createElement)("div",{className:"bwf-step-divider divider-line bwf-or"},Object(n.createElement)("span",{className:"bwf-divider"},"OR")),a):a})))},X=function(e){var t=e.data,a=void 0===t?{}:t,o=e.selected,i=void 0!==o&&o,m=e.id,p=$(Object(n.useState)({status:!1,loading:!0}),2),f=p[0],j=p[1],w=Object(b.a)(),v=w.deleteNode,y=w.setAutomationData,g=w.showSidebar,_=w.setNodeForAdd,E=w.copyNodeHere,h=w.setOpenStepModal,k=w.setModalAnchorNode,N=w.fetchSplitPathNodes,P=Object(u.a)(),C=P.getAutomationId,S=P.getAutomationData,A=P.getEnableCopy,D=P.getEnableMove,x=P.getNodeDataByID,I=P.getLastAddedNode,R=P.getStatLoading,z=P.getStatData,J=I(),U=S().event,q=C(),B=R(),H=z();Object(n.useEffect)((function(){J==m&&(y("sidebarNodeData",e),g(!0),y("lastAddedNode",0))}),[J]);var Y,X,Z=A(),K=D(),ee=x(e.id),te=ee.hasMultiParents,ae=void 0!==te&&te,ne=ee.stepId,re=ee.step_status,ce=void 0===re?1:re,oe=H.hasOwnProperty(ne)?H[ne]:{},ie=Object(c.isEmpty)(U)||d.Hb?{}:Object(W.a)(U,parseInt(q)),le=ie.isLoading,se=ie.error,me=ie.getReadableTexts,be=ie.rules,ue=d.Hb?[]:(Y=a.sidebarValues,X=[],Object(c.isEmpty)(Y)?[]:(Object.keys(Y).map((function(e){var t=Y[e],a=[];!Object(c.isEmpty)(t)&&Object(c.isArray)(t)&&(t.map((function(e){be.hasOwnProperty(e.filter)&&a.push(e)})),Object(c.isEmpty)(a)||X.push(a))})),X)),de=d.Hb||le||se||Object(c.isEmpty)(U)?[]:me(ue),pe=M({onNodeClick:function(){y("sidebarNodeData",e),g(!0)},onNodeStatClick:function(){d.Hb?(y("proModalContent",Object(l.__)("Conditional Step","wp-marketing-automations")),y("showProModal",!0)):(y("showContactModalId",ne),y("showContactModalType","completed"))}});return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-wrapper","data-stepid":ne},Object(n.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),d.Hb?Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ce)?" bwf-draft-node":""),onClick:function(){y("proModalContent",Object(l.__)("Conditional Step","wp-marketing-automations")),y("showProModal",!0)}},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon"},Object(n.createElement)(s.a,{size:26,icon:"condition"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+ne),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Condition","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"})),Object(n.createElement)("div",{className:"bwf-control-event-error"},Object(n.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(n.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ce)?" bwf-draft-node":""),onClick:pe},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon"},Object(n.createElement)(s.a,{size:26,icon:"condition"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+m),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Condition","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"},Object(n.createElement)(V,{node:e}),Object(n.createElement)(L.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!Z&&!K),renderContent:function(t){var a=t.onToggle,r=N();return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){Object(d.Jb)()?(y("enableCopy",!0),y("copyData",{type:"conditional",data:e.data,id:e.id})):(y("proModalContent",Object(l.__)("Copy Step","wp-marketing-automations")),y("showProModal",!0)),a()}},Object(n.createElement)(F.a,{justify:"space-between"},Object(n.createElement)(F.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(F.c,null,d.e))),!r.includes(m)&&Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){Object(d.Jb)()?(y("enableMove",!0),y("moveID",e.id),y("copyData",{type:"conditional",data:e.data,id:e.id})):(y("proModalContent",Object(l.__)("Move Step","wp-marketing-automations")),y("showProModal",!0)),a()}},Object(n.createElement)(F.a,{justify:"space-between"},Object(n.createElement)(F.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(F.c,null,d.e))),Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){var t,n;j({status:!0,onConfirm:(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v(e).then((function(){return j({status:!1})}));case 2:case"end":return t.stop()}}),t)})),n=function(){var e=this,a=arguments;return new Promise((function(n,r){var c=t.apply(e,a);function o(e){G(c,n,r,o,i,"next",e)}function i(e){G(c,n,r,o,i,"throw",e)}o(void 0)}))},function(){return n.apply(this,arguments)})}),a()}},Object(n.createElement)(F.a,{justify:"flex-start"},Object(n.createElement)(F.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Array.isArray(de)&&de.length?Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-step-content"},Object(n.createElement)("div",{className:"bwf-step-content"},Object(n.createElement)(Q,{readables:de}))),Object(n.createElement)("div",{className:"bwf-node-status"},Object(n.createElement)("div",{className:"bwf-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},B?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,oe.hasOwnProperty("completed")?Object(d.Wb)(parseInt(oe.completed)):0))))):Object(n.createElement)(n.Fragment,null,le?Object(n.createElement)("div",{className:"bwf-node-step-content"},Object(n.createElement)("div",{className:"bwf-step-brick"},Object(n.createElement)("div",{className:"bwf-step-content-content"},Object(n.createElement)("div",{className:"bwf-step-brick"},Object(n.createElement)("div",{className:"bwf-step-content-content"},Object(l.__)("Loading","wp-marketing-automations")))))):Object(n.createElement)("div",{className:"bwf-control-event-error"},Object(n.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))))),ae&&Object(n.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},Z||K?Object(n.createElement)("div",{className:"bwf-drag-area",onClick:function(){return E(e,"before","")}},Object(n.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(n.createElement)("div",{className:"bwf-node-add"})),Object(n.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(n.createElement)("div",{className:"bwf-node-add",onClick:function(t){_(e.id,{option:"",position:"before"}),h(!0),k(t.target)}}))),Object(n.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(n.createElement)(O.a,{modalTitle:Object(l.__)("Delete Conditional Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("conditional step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:f.onConfirm,isLoading:!1,onRequestClose:function(){return j({status:!1})},isOpen:f.status,isDelete:!0}))},Z=a(1033),K=a(123);function ee(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function te(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){ee(c,n,r,o,i,"next",e)}function i(e){ee(c,n,r,o,i,"throw",e)}o(void 0)}))}}function ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ne(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ne(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var re=function(e){var t=e.data,a=void 0===t?{}:t,o=e.selected,i=void 0!==o&&o,m=e.id,p=ae(Object(n.useState)(!1),2),f=p[0],j=p[1],w=ae(Object(n.useState)({status:!1,loading:!0}),2),v=w[0],y=w[1],g=Object(b.a)(),_=g.deleteNode,E=g.setAutomationData,h=g.showSidebar,k=g.setNodeForAdd,P=g.copyNodeHere,C=g.setOpenStepModal,S=g.setModalAnchorNode,A=g.fetchSplitPathNodes,D=Object(u.a)(),x=D.getActionsList,I=D.getAutomationData,R=D.getNodeDataByID,z=D.getEnableCopy,J=D.getEnableMove,U=D.getLastAddedNode,q=D.getStatLoading,B=D.getStatData,H=U(),W=x(),G=I(),$=q(),Y=B(),Q=G.ID,X=z(),ee=J(),ne=R(e.id),re=ne.hasMultiParents,ce=void 0!==re&&re,oe=ne.stepId,ie=ne.step_status,le=void 0===ie?1:ie,se=Y.hasOwnProperty(oe)?Y[oe]:{},me=a.sidebarValues,be=void 0===me?{}:me,ue=a.desc_text,de=void 0===ue?"":ue;Object(n.useEffect)((function(){H==m&&(j(!0),E("lastAddedNode",0))}),[H]);var pe,fe,Oe,je=M({onNodeClick:!!a.selected&&function(){W.list.hasOwnProperty(a.selected)&&(E("sidebarNodeData",e),h(!0))},onNodeStatClick:function(){E("showContactModalId",oe),E("showContactModalType","completed")},onNodeFailedStatClick:function(){E("showContactModalId",oe),E("showContactModalType","failed")},onNodeSkippedStatClick:function(){E("showContactModalId",oe),E("showContactModalType","skipped")},onInfoToggleClick:function(){return E("analyticNodeId",oe)}}),we=!$&&se.hasOwnProperty("failed")&&parseInt(se.failed)>0&&se.hasOwnProperty("skipped")&&parseInt(se.skipped)>0;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-wrapper ".concat(we?"bwf-width-2":""),"data-stepid":oe},Object(n.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(a.hasOwnProperty("selected")&&a.selected&&W.list.hasOwnProperty(a.selected)&&2===parseInt(le)&&W.list[a.selected].hasOwnProperty("fields")&&!Object(c.isEmpty)(W.list[a.selected].fields)?" bwf-draft-node":""),onClick:je},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon icon-action"},Object(n.createElement)(s.a,{size:22,icon:"charge"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+m),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Action","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"},a.hasOwnProperty("selected")&&!Object(c.isEmpty)(a.selected)&&Object(n.createElement)(V,{id:m,node:e}),Object(n.createElement)(L.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!X&&!ee),renderContent:function(t){var r=t.onToggle,o=A();return Object(n.createElement)(n.Fragment,null,a.hasOwnProperty("selected")&&!Object(c.isEmpty)(a.selected)&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){Object(d.Jb)()?(E("enableCopy",!0),E("copyData",{type:"action",data:e.data})):(E("proModalContent",{featureTitle:Object(l.__)("Copy Step","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),E("showProModal",!0)),r()}},Object(n.createElement)(F.a,{justify:"space-between"},Object(n.createElement)(F.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(F.c,null,d.e))),!o.includes(m)&&Object(n.createElement)(T.a,{isClickable:!0,onInvoke:te(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(d.Jb)()?(E("enableMove",!0),E("moveID",e.id),E("copyData",{type:"action",data:e.data})):(E("proModalContent",{featureTitle:Object(l.__)("Move Step","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),E("showProModal",!0)),r();case 2:case"end":return t.stop()}}),t)})))},Object(n.createElement)(F.a,{justify:"space-between"},Object(n.createElement)(F.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(F.c,null,d.e)))),Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){var t;y({status:!0,onConfirm:(t=te(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(e).then((function(){return y({status:!1})}));case 2:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}),r()}},Object(n.createElement)(F.a,{justify:"flex-start"},Object(n.createElement)(F.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),a.hasOwnProperty("selected")&&!Object(c.isEmpty)(a.selected)?Object(n.createElement)("div",{className:"bwf-node-step-content"},Object(n.createElement)("div",{className:"bwf-step-content"},Object(n.createElement)("div",{className:"bwf-step-brick"},Object(n.createElement)("div",{className:"bwf-step-content-content"},!Object(c.isEmpty)(a)&&a.hasOwnProperty("selected")&&(Oe=Object(n.createElement)(n.Fragment,null),"wp_sendemail"===a.selected?(pe=be.bwfan_email_data,fe=void 0===pe?{}:pe,Oe=Object(n.createElement)(n.Fragment,null,!Object(c.isEmpty)(fe)&&Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle "},Object(n.createElement)(Z.a,{automationId:Q,analyticsId:oe,mode:"email"})))):"twilio_send_sms"!==a.selected&&"bulkgate_send_transactional_sms"!==a.selected&&"linkmobility_send_sms"!==a.selected||(Oe=Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle"},Object(n.createElement)(Z.a,{automationId:Q,analyticsId:oe,mode:"sms"}))),Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-content-type"},W.list.hasOwnProperty(a.selected)&&W.list[a.selected].hasOwnProperty("integration_nicename")?W.list[a.selected].integration_nicename:""),Object(n.createElement)("div",{className:"bwf-node-content-label"},W.list.hasOwnProperty(a.selected)?W.list[a.selected].action_name:Object(l.__)("Action Not Found","wp-marketing-automations")),!Object(c.isEmpty)(de)&&Object(n.createElement)("div",{className:"bwf-node-content-label bwf-node-desc"+(Object(c.isArray)(de)?"":" bwf-two-line-ellipse-text")},function(e){if(Object(c.isEmpty)(e))return Object(n.createElement)(n.Fragment,null);if(Object(c.isArray)(e)){var t="",a=[];return e.map((function(e){Object(c.isEmpty)(t)&&(t=e),a.push(Object(n.createElement)("span",{key:e},e))})),Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-table-v-center"},Object(n.createElement)("span",null,!Object(c.isEmpty)(t)&&t),!Object(c.isEmpty)(a)&&a.length>1&&Object(n.createElement)("div",{className:"bwf-display-inline",onClick:function(e){e.preventDefault(),e.stopPropagation()}},Object(n.createElement)(K.a,{items:a}))))}return e}(de)),Oe,W.list.hasOwnProperty(a.selected)&&W.list[a.selected].hasOwnProperty("analytics_mode")&&""!==W.list[a.selected].analytics_mode?Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf-mt-3 bwf-cursor-pointer bwf-info__toggle"},Object(n.createElement)(Z.a,{automationId:Q,analyticsId:oe,mode:W.list[a.selected].analytics_mode})):null)))))):Object(n.createElement)("div",{className:"bwf-control-event-error"},Object(n.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer",onClick:function(){return j(!0)}},Object(l.__)("Not Configured","wp-marketing-automations"))),a.hasOwnProperty("selected")&&!Object(c.isEmpty)(a.selected)&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-status"},Object(n.createElement)("div",{className:"bwf-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},$?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,se.hasOwnProperty("completed")?Object(d.Wb)(parseInt(se.completed)):0))),!$&&se.hasOwnProperty("skipped")&&parseInt(se.skipped)>0&&Object(n.createElement)("div",{className:"bwf-skipped-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Skipped","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count bwf-skipped-status"},Object(d.Wb)(parseInt(se.skipped)))),!$&&se.hasOwnProperty("failed")&&parseInt(se.failed)>0&&Object(n.createElement)("div",{className:"bwf-failed-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Failed","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count bwf-failed-status"},Object(d.Wb)(parseInt(se.failed))))))),ce&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},X||ee?Object(n.createElement)("div",{className:"bwf-drag-area",onClick:function(){return P(e,"before","")}},Object(n.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(n.createElement)("div",{className:"bwf-node-add"})),Object(n.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(n.createElement)("div",{className:"bwf-node-add",onClick:function(t){k(e.id,{option:"",position:"before"}),C(!0),S(t.target)}})))),Object(n.createElement)(r.d,{type:"source",isConnectable:!1,position:"bottom"}),Object(n.createElement)(N,{isOpen:f,onRequestClose:function(){return j(!1)},node:e,isEvent:!1,automationID:Q}),Object(n.createElement)(O.a,{modalTitle:Object(l.__)("Delete Action Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("action step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:v.onConfirm,isLoading:!1,onRequestClose:function(){return y({status:!1})},isOpen:v.status,isDelete:!0}))},ce=function(e){var t=Object(u.a)(),a=t.getEnableCopy,c=t.getEnableMove,o=t.getNodeDataByID,i=a(),s=c(),m=Object(b.a)(),d=m.copyNodeHere,p=m.setNodeForAdd,f=m.setOpenStepModal,O=m.setModalAnchorNode,j=o(e.id).hasMultiParents,w=void 0!==j&&j;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-wrapper"},w?Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},i||s?Object(n.createElement)("div",{className:"bwf-drag-area",onClick:function(){return d(e,"before","")}},Object(n.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(n.createElement)("div",{className:"bwf-node-add"})),Object(n.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(n.createElement)("div",{className:"bwf-node-add",onClick:function(t){p(e.id,{option:"",position:"before"}),f(!0),O(t.target)}})),Object(n.createElement)(r.d,{type:"source",position:"top",isConnectable:!1})):Object(n.createElement)(r.d,{type:"source",position:"top",isConnectable:!1}),Object(n.createElement)("div",{className:"bwf-node-content bwf-end"},Object(n.createElement)("div",{className:"bwf-node-content-item"},Object(l.__)("End Automation","wp-marketing-automations")))))};function oe(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return le(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return le(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var se=function(e){var t=e.data,a=void 0===t?{}:t,o=e.selected,i=void 0!==o&&o,m=e.id,p=ie(Object(n.useState)(!1),2),f=p[0],j=p[1],w=ie(Object(n.useState)({status:!1,loading:!0}),2),v=w[0],y=w[1],g=Object(b.a)(),_=g.deleteNode,E=g.setAutomationData,h=g.showSidebar,k=g.setNodeForAdd,N=g.copyNodeHere,P=g.setOpenStepModal,C=g.setModalAnchorNode,S=Object(u.a)(),A=S.getGoals,D=S.getNodeDataByID,x=S.getEnableCopy,R=S.getEnableMove,z=S.getLastAddedNode,J=S.getAutomationData,U=S.getStatLoading,q=S.getStatData,B=A().list,H=z(),W=x(),G=R(),$=U(),Y=q();Object(n.useEffect)((function(){H==m&&(j(!0),E("lastAddedNode",0))}),[H]);var Q=J(),X=D(e.id),Z=X.hasMultiParents,ee=void 0!==Z&&Z,te=X.stepId,ae=X.step_status,ne=void 0===ae?1:ae,re=Q.ID,ce=Y.hasOwnProperty(te)?Y[te]:{},le=a.desc_text,se=void 0===le?"":le,me=M({onNodeClick:!!a&&!!a.benchmark&&function(){E("sidebarNodeData",e),h(!0)},onNodeStatClick:function(){d.Hb?(E("proModalContent",Object(l.__)("Goal Step","wp-marketing-automations")),E("showProModal",!0)):(E("showContactModalId",te),E("showContactModalType","completed"))},onNodeQueuedStatClick:function(){d.Hb?(E("proModalContent",Object(l.__)("Goal Step","wp-marketing-automations")),E("showProModal",!0)):(E("showContactModalId",te),E("showContactModalType","queued"))}});return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-wrapper","data-stepid":te},Object(n.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),d.Hb?Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ne)?" bwf-draft-node":""),onClick:function(){E("proModalContent","Goal Step"),E("showProModal",!0)}},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(n.createElement)(s.a,{size:26,icon:"goal"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+m),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Goal","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"})),Object(n.createElement)("div",{className:"bwf-control-event-error"},Object(n.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(n.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":"")+(2===parseInt(ne)?" bwf-draft-node":""),onClick:me},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(n.createElement)(s.a,{size:26,icon:"goal"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+m),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Goal","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"},a.hasOwnProperty("benchmark")&&!Object(c.isEmpty)(a.benchmark)&&Object(n.createElement)(V,{node:e}),Object(n.createElement)(L.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!W&&!G),renderContent:function(t){var r=t.onToggle;return Object(n.createElement)(n.Fragment,null,a.hasOwnProperty("benchmark")&&!Object(c.isEmpty)(a.benchmark)&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){Object(d.Jb)()?(E("enableCopy",!0),E("copyData",{type:"benchmark",data:e.data})):(E("proModalContent",Object(l.__)("Copy Step","wp-marketing-automations")),E("showProModal",!0)),r()}},Object(n.createElement)(F.a,{justify:"space-between"},Object(n.createElement)(F.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(F.c,null,d.e))),Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){E("enableMove",!0),E("moveID",e.id),E("copyData",{type:"benchmark",data:e.data}),r()}},Object(n.createElement)(F.a,{justify:"flex-start"},Object(n.createElement)(F.c,null,Object(l.__)("Move","wp-marketing-automations"))))),Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){var t,a;y({status:!0,onConfirm:(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_(e).then((function(){return y({status:!1})}));case 2:case"end":return t.stop()}}),t)})),a=function(){var e=this,a=arguments;return new Promise((function(n,r){var c=t.apply(e,a);function o(e){oe(c,n,r,o,i,"next",e)}function i(e){oe(c,n,r,o,i,"throw",e)}o(void 0)}))},function(){return a.apply(this,arguments)})}),r()}},Object(n.createElement)(F.a,{justify:"flex-start"},Object(n.createElement)(F.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),!a.hasOwnProperty("benchmark")||Object(c.isEmpty)(a.benchmark)?Object(n.createElement)("div",{className:"bwf-control-event-error"},Object(n.createElement)("div",{className:"bwf-control-error-msg",onClick:function(){return j(!0)}},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(n.createElement)("div",{className:"bwf-node-step-content"},Object(n.createElement)("div",{className:"bwf-step-content"},Object(n.createElement)("div",{className:"bwf-step-brick"},Object(n.createElement)("div",{className:"bwf-step-content-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},B.hasOwnProperty(a.benchmark)&&B[a.benchmark].hasOwnProperty("source_label")?B[a.benchmark].source_label:""),Object(n.createElement)("div",{className:"bwf-node-content-label"},B.hasOwnProperty(a.benchmark)?B[a.benchmark].event_name:"Goal Not Found"),!Object(c.isEmpty)(se)&&Object(n.createElement)("div",{className:"bwf-node-content-label bwf-node-desc"+(Object(c.isArray)(se)?"":" bwf-two-line-ellipse-text")},function(e){if(Object(c.isEmpty)(e))return Object(n.createElement)(n.Fragment,null);if(Object(c.isArray)(e)){var t="",a=[];return e.map((function(e){Object(c.isEmpty)(t)&&(t=e),a.push(Object(n.createElement)("span",{key:e},e))})),Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-table-v-center"},Object(n.createElement)("span",null,!Object(c.isEmpty)(t)&&t),!Object(c.isEmpty)(a)&&a.length>1&&Object(n.createElement)("div",{className:"bwf-display-inline",onClick:function(e){e.preventDefault(),e.stopPropagation()}},Object(n.createElement)(K.a,{items:a}))))}return e}(se)))))),a.hasOwnProperty("benchmark")&&!Object(c.isEmpty)(a.benchmark)&&Object(n.createElement)("div",{className:"bwf-node-status"},Object(n.createElement)("div",{className:"bwf-queued-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Queued","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},$?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,ce.hasOwnProperty("queued")?Object(d.Wb)(parseInt(ce.queued)):0))),Object(n.createElement)("div",{className:"bwf-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},$?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,ce.hasOwnProperty("completed")?Object(d.Wb)(parseInt(ce.completed)):0))))),ee&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},W||G?Object(n.createElement)("div",{className:"bwf-drag-area",onClick:function(){return N(e,"before","")}},Object(n.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(n.createElement)("div",{className:"bwf-node-add"})),Object(n.createElement)("div",{className:"bwf-paste-label"},"Paste Here")):Object(n.createElement)("div",{className:"bwf-node-add",onClick:function(t){k(e.id,{option:"",position:"before"}),P(!0),C(t.target)}})))),Object(n.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(n.createElement)(I,{isOpen:f,onRequestClose:function(){return j(!1)},node:e,automationID:re}),Object(n.createElement)(O.a,{modalTitle:Object(l.__)("Delete Goal Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("goal step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:v.onConfirm,isLoading:!1,onRequestClose:function(){return y({status:!1})},isOpen:v.status,isDelete:!0,deleteDescriptionText:Object(l.__)("Once you delete this step, all the queued contacts will move to next step right away.","wp-marketing-automations")}))},me=a(78),be=a(10),ue=a.n(be);function de(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function pe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fe(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return fe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Oe={1:Object(l.__)("Delay for a specific period","wp-marketing-automations"),2:Object(l.__)("Delay until a specific date and time","wp-marketing-automations"),3:Object(l.__)("Delay until a custom field date","wp-marketing-automations"),4:Object(l.__)("Delay with variable","wp-marketing-automations")},je={1:Object(l.__)("Sun","wp-marketing-automations"),2:Object(l.__)("Mon","wp-marketing-automations"),3:Object(l.__)("Tue","wp-marketing-automations"),4:Object(l.__)("Wed","wp-marketing-automations"),5:Object(l.__)("Thu","wp-marketing-automations"),6:Object(l.__)("Fri","wp-marketing-automations"),7:Object(l.__)("Sat","wp-marketing-automations")},we=function(e){var t=e.data,a=e.selected,o=void 0!==a&&a,i=e.id,m=pe(Object(n.useState)({status:!1,loading:!0}),2),p=m[0],f=m[1],j=Object(b.a)(),w=j.deleteNode,v=j.setAutomationData,y=j.showSidebar,g=j.setNodeForAdd,_=j.copyNodeHere,E=j.setOpenStepModal,h=j.setModalAnchorNode,k=j.fetchSplitPathNodes,N=Object(u.a)(),P=N.getNodeDataByID,C=N.getEnableCopy,S=N.getEnableMove,A=N.getLastAddedNode,D=N.getStatLoading,x=N.getStatData,I=A(),R=!Object(c.isEmpty)(t)&&t.hasOwnProperty("sidebarValues")?t.sidebarValues:{},z=R.type,J=void 0===z?0:z,U=R.data,q=void 0===U?{}:U,B=D(),H=x();Object(n.useEffect)((function(){I==i&&(v("sidebarNodeData",e),y(!0),v("lastAddedNode",0))}),[I]);var W=function(){switch(parseInt(J)){case 1:var e=q.day_delay,t=void 0===e?{}:e,a=q.enable_time_delay,r=void 0!==a&&a,o=q.enable_week_delay,i=void 0!==o&&o,s=q.time_delay,m=void 0===s?{time:""}:s,b=q.week_delay,u=void 0===b?[]:b;if(!Object(c.isEmpty)(t)){var d=t.text+" "+function(e,t){switch(e){case"min":return parseInt(t)>1?Object(l.__)("Minutes","wp-marketing-automations"):Object(l.__)("Minute","wp-marketing-automations");case"hours":return parseInt(t)>1?Object(l.__)("Hours","wp-marketing-automations"):Object(l.__)("Hour","wp-marketing-automations");case"days":return parseInt(t)>1?Object(l.__)("Days","wp-marketing-automations"):Object(l.__)("Day","wp-marketing-automations");case"weeks":return parseInt(t)>1?Object(l.__)("Weeks","wp-marketing-automations"):Object(l.__)("Week","wp-marketing-automations");case"months":return parseInt(t)>1?Object(l.__)("Months","wp-marketing-automations"):Object(l.__)("Month","wp-marketing-automations");default:return""}}(t.unit,t.text),p=[];return i&&!Object(c.isEmpty)(u)&&u.map((function(e){je.hasOwnProperty(e)&&p.push(je[e])})),r&&m.hasOwnProperty("time")&&!Object(c.isEmpty)(m.time)?(d+=" till "+Object(me.format)(bwfcrm_contacts_data.time_format,ue()(m.time,"HH:mm:ss")),Object(c.isEmpty)(p)||(d+=" "+p.join("/")),m.hasOwnProperty("in_contact_timezone")&&m.in_contact_timezone&&(d+=" ".concat(Object(l.__)("in Contact's Timezone","wp-marketing-automations")))):Object(c.isEmpty)(p)||(d+=" "+p.join("/")),d+"."}break;case 2:var f=q.date,O=void 0===f?"":f,j=q.time_delay,w=void 0===j?{time:"",in_contact_timezone:!1}:j,v=q.enable_step_skip,y=void 0!==v&&v,g=q.skip_to_step,_=void 0===g?{step:"",name:""}:g;if(!Object(c.isEmpty)(O)&&!Object(c.isEmpty)(w.time)){var E="",h="";return w.hasOwnProperty("in_contact_timezone")&&w.in_contact_timezone?E+=" ".concat(Object(l.__)("in Contact's Timezone.","wp-marketing-automations")):E+=".",y&&!Object(c.isEmpty)(_)&&_.hasOwnProperty("step")&&""!=_.step&&_.hasOwnProperty("name")&&""!=_.name&&(h=" ".concat(Object(l.__)("Jump to","wp-marketing-automations")," ").concat(_.name,".")),Object(l.__)("Delay till ","wp-marketing-automations")+" "+Object(me.format)(bwfcrm_contacts_data.date_format,ue()(O))+" "+Object(l.__)("at","wp-marketing-automations")+" "+Object(me.format)(bwfcrm_contacts_data.time_format,ue()(w.time,"HH:mm:ss"))+" "+E+h}break;case 3:var k=q.custom_field,N=q.enable_time_delay,P=void 0!==N&&N,C=q.time_delay,S=q.enable_step_skip,A=void 0!==S&&S,D=q.skip_to_step;if(k.hasOwnProperty("field")&&""!==k.field){var x=Object(l.__)("Delay","wp-marketing-automations");return P?C.hasOwnProperty("duration")&&(x+=" ".concat(Object(l.__)("of","wp-marketing-automations")," ").concat(C.duration," ").concat(C.type," ").concat(C.timing," ")):x+=" ".concat(Object(l.__)("till","wp-marketing-automations")),k.hasOwnProperty("custom_field_label")&&""!==k.custom_field_label?x+=" ".concat(Object(l.__)("Contacts","wp-marketing-automations")," '").concat(k.custom_field_label,"' ").concat(Object(l.__)("field value","wp-marketing-automations")):x+=" ".concat(Object(l.__)("Contacts","wp-marketing-automations")," ( ").concat(k.field," ) ").concat(Object(l.__)("field value","wp-marketing-automations")),k.hasOwnProperty("time")&&""!==k.time&&(x+=" till ".concat(Object(me.format)(bwfcrm_contacts_data.time_format,ue()(k.time,"HH:mm:ss")))),k.hasOwnProperty("in_contact_timezone")&&k.in_contact_timezone?x+=" ".concat(Object(l.__)("in Contact's Timezone.","wp-marketing-automations")):x+=".",A&&!Object(c.isEmpty)(D)&&D.hasOwnProperty("step")&&""!=D.step&&D.hasOwnProperty("name")&&""!=D.name&&(x+=" ".concat(Object(l.__)("Jump to","wp-marketing-automations")," ").concat(D.name,".")),x}break;case 4:var I=q.variable_field,M=q.enable_time_delay,T=void 0!==M&&M,F=q.time_delay,L=q.enable_step_skip,R=void 0!==L&&L,z=q.skip_to_step;if(I.hasOwnProperty("variable")&&""!==I.variable){var U=Object(l.__)("Delay","wp-marketing-automations");return T?F.hasOwnProperty("duration")&&(U+=" ".concat(Object(l.__)("of","wp-marketing-automations")," ").concat(F.duration," ").concat(F.type," ").concat(F.timing," ")):U+=" "+Object(l.__)("till","wp-marketing-automations"),I.hasOwnProperty("variable")&&""!==I.variable&&(U+=" ".concat(Object(l.__)("Orders meta key","wp-marketing-automations")," ").concat(I.variable," value")),I.hasOwnProperty("time")&&""!==I.time&&(U+=" till ".concat(Object(me.format)(bwfcrm_contacts_data.time_format,ue()(I.time,"HH:mm:ss")))),I.hasOwnProperty("in_contact_timezone")&&I.in_contact_timezone?U+=" ".concat(Object(l.__)("in Contact's Timezone.","wp-marketing-automations")):U+=".",R&&!Object(c.isEmpty)(z)&&z.hasOwnProperty("step")&&""!=z.step&&z.hasOwnProperty("name")&&""!=z.name&&(U+=" ".concat(Object(l.__)("Jump to","wp-marketing-automations")," ").concat(z.name,".")),U}break;default:return Object(n.createElement)(n.Fragment,null)}return Object(n.createElement)(n.Fragment,null)},G=C(),$=S(),Y=P(e.id),Q=Y.hasMultiParents,X=void 0!==Q&&Q,Z=Y.stepId,K=Y.step_status,ee=void 0===K?1:K,te=H.hasOwnProperty(Z)?H[Z]:{},ae=M({onNodeClick:function(){v("sidebarNodeData",e),y(!0)},onNodeStatClick:function(){v("showContactModalId",Z),v("showContactModalType","completed")},onNodeQueuedStatClick:function(){v("showContactModalId",Z),v("showContactModalType","queued")}});return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-wrapper","data-stepid":Z},Object(n.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(o?"bwf-selected-node":"")+(2===parseInt(ee)?" bwf-draft-node":""),onClick:ae},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon icon-delay"},Object(n.createElement)(s.a,{size:28,icon:"time-left"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+i),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Delay","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"},Object(n.createElement)(V,{node:e}),Object(n.createElement)(L.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!G&&!$),renderContent:function(t){var a=t.onToggle,r=k();return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){Object(d.Jb)()?(v("enableCopy",!0),v("copyData",{type:"wait",data:e.data})):(v("proModalContent",{featureTitle:Object(l.__)("Copy Step","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),v("showProModal",!0)),a()}},Object(n.createElement)(F.a,{justify:"space-between"},Object(n.createElement)(F.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(F.c,null,d.e))),!r.includes(i)&&Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){Object(d.Jb)()?(v("enableMove",!0),v("moveID",e.id),v("copyData",{type:"wait",data:e.data})):(v("proModalContent",{featureTitle:Object(l.__)("Move Step","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Copy+step+Upgrade+Modal"})}),v("showProModal",!0)),a()}},Object(n.createElement)(F.a,{justify:"space-between"},Object(n.createElement)(F.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(F.c,null,d.e))),Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){var t,n;f({status:!0,onConfirm:(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(e).then((function(){return f({status:!1})}));case 2:case"end":return t.stop()}}),t)})),n=function(){var e=this,a=arguments;return new Promise((function(n,r){var c=t.apply(e,a);function o(e){de(c,n,r,o,i,"next",e)}function i(e){de(c,n,r,o,i,"throw",e)}o(void 0)}))},function(){return n.apply(this,arguments)})}),a()}},Object(n.createElement)(F.a,{justify:"flex-start"},Object(n.createElement)(F.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(c.isEmpty)(t)||!parseInt(J)>0?Object(n.createElement)("div",{className:"bwf-control-event-error"},Object(n.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-step-content"},Object(n.createElement)("div",{className:"bwf-step-content"},Object(n.createElement)("div",{className:"bwf-step-brick"},Object(n.createElement)("div",{className:"bwf-step-content-content"},Oe.hasOwnProperty(J)&&Object(n.createElement)("div",{className:"bwf-node-content-type"},Oe[J]),Object(n.createElement)("div",{className:"bwf-node-content-label bwf-two-line-ellipse-text",title:W()},W()))))),Object(n.createElement)("div",{className:"bwf-node-status"},Object(n.createElement)("div",{className:"bwf-queued-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Queued","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},B?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,te.hasOwnProperty("queued")?Object(d.Wb)(parseInt(te.queued)):0))),Object(n.createElement)("div",{className:"bwf-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},B?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,te.hasOwnProperty("completed")?Object(d.Wb)(parseInt(te.completed)):0)))))),X&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},G||$?Object(n.createElement)("div",{className:"bwf-drag-area",onClick:function(){return _(e,"before","")}},Object(n.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(n.createElement)("div",{className:"bwf-node-add"})),Object(n.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(n.createElement)("div",{className:"bwf-node-add",onClick:function(t){g(e.id,{option:"",position:"before"}),E(!0),h(t.target)}})))),Object(n.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(n.createElement)(O.a,{modalTitle:Object(l.__)("Delete Delay Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("delay step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:p.onConfirm,isLoading:!1,onRequestClose:function(){return f({status:!1})},isOpen:p.status,isDelete:!0,deleteDescriptionText:Object(l.__)("Once you delete this step, all the queued contacts will move to next step right away.","wp-marketing-automations")}))},ve=function(e){return Object(n.createElement)("div",{className:e&&e.data&&e.data.direction&&"no"===e.data.direction?"bwf-yes-no-node  bwf-no-node":"bwf-yes-no-node bwf-yes-node"},Object(n.createElement)(r.d,{type:"target",position:"top",style:{opacity:0},isConnectable:!1}),Object(n.createElement)("span",{className:"bwf-yes-no-wrap"},e&&e.data&&e.data.direction&&"no"===e.data.direction?Object(l.__)("No","wp-marketing-automations"):Object(l.__)("Yes","wp-marketing-automations")),Object(n.createElement)(r.d,{type:"source",position:"bottom",style:{opacity:0},isConnectable:!1}))};function ye(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return _e(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return _e(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Ee=function(e){var t=e.selected,a=void 0!==t&&t,c=e.id,o=ge(Object(n.useState)({status:!1,loading:!0}),2),i=o[0],m=o[1],p=Object(b.a)(),f=p.deleteNode,j=p.setAutomationData,w=p.setNodeForAdd,v=p.copyNodeHere,y=p.setOpenStepModal,g=p.setModalAnchorNode,_=Object(u.a)(),E=_.getNodeDataByID,h=_.getEnableCopy,k=_.getEnableMove,N=_.getLastAddedNode,P=_.getStatLoading,C=_.getStatData,S=N(),A=h(),D=k(),x=P(),I=C();Object(n.useEffect)((function(){S==c&&j("lastAddedNode",0)}),[S]);var R=E(e.id),z=R.hasMultiParents,J=void 0!==z&&z,U=R.stepId,q=I.hasOwnProperty(U)?I[U]:{},B=M({onNodeStatClick:function(){j("showContactModalId",U),j("showContactModalType","completed")}});return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-wrapper","data-stepid":U},Object(n.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),d.Hb?Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(a?"bwf-selected-node":""),onClick:function(){j("proModalContent","Exit Step"),j("showProModal",!0)}},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(n.createElement)(s.a,{size:26,icon:"exit"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+c),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Exit Automation","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"})),Object(n.createElement)("div",{className:"bwf-control-event-error"},Object(n.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(n.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(a?"bwf-selected-node":""),onClick:B},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(n.createElement)(s.a,{size:26,icon:"exit"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+c),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Exit Automation","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"},Object(n.createElement)(L.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!A&&!D),renderContent:function(t){var a=t.onToggle;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){var t,n;m({status:!0,onConfirm:(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f(e).then((function(){return m({status:!1})}));case 2:case"end":return t.stop()}}),t)})),n=function(){var e=this,a=arguments;return new Promise((function(n,r){var c=t.apply(e,a);function o(e){ye(c,n,r,o,i,"next",e)}function i(e){ye(c,n,r,o,i,"throw",e)}o(void 0)}))},function(){return n.apply(this,arguments)})}),a()}},Object(n.createElement)(F.a,{justify:"flex-start"},Object(n.createElement)(F.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(n.createElement)("div",{className:"bwf-node-status"},Object(n.createElement)("div",{className:"bwf-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},x?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,q.hasOwnProperty("completed")?Object(d.Wb)(parseInt(q.completed)):0))))),J&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},A||D?Object(n.createElement)("div",{className:"bwf-drag-area",onClick:function(){return v(e,"before","")}},Object(n.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(n.createElement)("div",{className:"bwf-node-add"}))):Object(n.createElement)("div",{className:"bwf-node-add",onClick:function(t){w(e.id,{option:"",position:"before"}),y(!0),g(t.target)}})))),Object(n.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}),Object(n.createElement)(O.a,{modalTitle:Object(l.__)("Delete Exit Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("exit step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:i.onConfirm,isLoading:!1,onRequestClose:function(){return m({status:!1})},isOpen:i.status,isDelete:!0}))};function he(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function ke(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){he(c,n,r,o,i,"next",e)}function i(e){he(c,n,r,o,i,"throw",e)}o(void 0)}))}}function Ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pe(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Pe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Ce=function(e){var t=e.data,a=void 0===t?{}:t,o=e.selected,i=void 0!==o&&o,m=e.id,p=Ne(Object(n.useState)({status:!1,loading:!0}),2),f=p[0],j=p[1],w=Object(b.a)(),v=w.deleteNode,y=w.setAutomationData,g=w.setNodeForAdd,_=w.copyNodeHere,E=w.setOpenStepModal,h=w.setModalAnchorNode,k=w.showSidebar,N=Object(u.a)(),P=N.getNodeDataByID,C=N.getEnableCopy,S=N.getEnableMove,A=N.getLastAddedNode,D=N.getStatLoading,x=N.getStatData,I=A(),R=C(),z=S(),J=D(),U=x();Object(n.useEffect)((function(){I==m&&y("lastAddedNode",0)}),[I]);var q=(!Object(c.isEmpty)(a)&&a.hasOwnProperty("sidebarValues")?a.sidebarValues:{}).jump_to,B=void 0===q?{}:q,H=B.name,V=void 0===H?"":H,W=B.step,G=void 0===W?"":W,$=P(e.id),Y=$.hasMultiParents,Q=void 0!==Y&&Y,X=$.stepId,Z=U.hasOwnProperty(X)?U[X]:{},K=M({onNodeClick:function(){y("sidebarNodeData",e),k(!0)},onNodeStatClick:function(){Object(d.Jb)()?(y("showContactModalId",X),y("showContactModalType","completed")):(y("proModalContent","Jump Step"),y("showProModal",!0))}});return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-wrapper","data-stepid":X},Object(n.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),d.Hb?Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":""),onClick:function(){y("proModalContent","Jump Step"),y("showProModal",!0)}},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(n.createElement)(s.a,{size:26,icon:"jump"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+m),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Jump","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"})),Object(n.createElement)("div",{className:"bwf-control-event-error"},Object(n.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(n.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(i?"bwf-selected-node":""),onClick:K},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon icon-exit"},Object(n.createElement)(s.a,{size:26,icon:"jump"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+m),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Jump","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"},Object(n.createElement)(L.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!R&&!z),renderContent:function(t){var a=t.onToggle;return Object(n.createElement)(n.Fragment,null,""!=G&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){Object(d.Jb)()?(y("enableCopy",!0),y("copyData",{type:"jump",data:e.data})):(y("proModalContent","Copy Step"),y("showProModal",!0)),a()}},Object(n.createElement)(F.a,{justify:"space-between"},Object(n.createElement)(F.c,null,Object(l.__)("Copy","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(F.c,null,d.e))),Object(n.createElement)(T.a,{isClickable:!0,onInvoke:ke(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(d.Jb)()?(y("enableMove",!0),y("moveID",e.id),y("copyData",{type:"jump",data:e.data})):(y("proModalContent","Move Step"),y("showProModal",!0)),a();case 2:case"end":return t.stop()}}),t)})))},Object(n.createElement)(F.a,{justify:"space-between"},Object(n.createElement)(F.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(F.c,null,d.e)))),Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){var t;j({status:!0,onConfirm:(t=ke(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v(e).then((function(){return j({status:!1})}));case 2:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}),a()}},Object(n.createElement)(F.a,{justify:"flex-start"},Object(n.createElement)(F.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(c.isEmpty)(a)||Object(c.isEmpty)(B)||""==G?Object(n.createElement)("div",{className:"bwf-control-event-error no-padding"},Object(n.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(n.createElement)("div",{className:"bwf-node-step-content"},Object(n.createElement)("div",{className:"bwf-step-content"},Object(n.createElement)("div",{className:"bwf-step-brick"},Object(n.createElement)("div",{className:"bwf-step-content-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Jump to","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf-node-content-label bwf-two-line-ellipse-text"},""!==V?V:"step #"+G))))),Object(n.createElement)("div",{className:"bwf-node-status"},Object(n.createElement)("div",{className:"bwf-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},J?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,Z.hasOwnProperty("completed")?Object(d.Wb)(parseInt(Z.completed)):0))))),Q&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},R||z?Object(n.createElement)("div",{className:"bwf-drag-area",onClick:function(){return _(e,"before","")}},Object(n.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(n.createElement)("div",{className:"bwf-node-add"}))):Object(n.createElement)("div",{className:"bwf-node-add",onClick:function(t){g(e.id,{option:"",position:"before"}),E(!0),h(t.target)}})))),Object(n.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}),Object(n.createElement)(O.a,{modalTitle:Object(l.__)("Delete Jump Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("jump step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:f.onConfirm,isLoading:!1,onRequestClose:function(){return j({status:!1})},isOpen:f.status,isDelete:!0}))};function Se(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return De(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return De(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function De(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var xe=function(e){var t=e.selected,a=void 0!==t&&t,o=e.id,i=e.data,m=void 0===i?{}:i,p=Ae(Object(n.useState)({status:!1,loading:!0}),2),f=p[0],j=p[1],w=Object(b.a)(),v=w.deleteNode,y=w.setAutomationData,g=w.setNodeForAdd,_=w.copyNodeHere,E=w.setOpenStepModal,h=w.setModalAnchorNode,k=w.showSidebar,N=Object(u.a)(),P=N.getNodeDataByID,C=N.getEnableCopy,S=N.getEnableMove,A=N.getLastAddedNode,D=N.getStatLoading,x=N.getStatData,I=A(),R=C(),z=S(),J=D(),U=x();Object(n.useEffect)((function(){I==o&&y("lastAddedNode",0)}),[I]);var q=P(e.id),B=q.hasMultiParents,H=void 0!==B&&B,W=q.stepId,G=U.hasOwnProperty(W)?U[W]:{},$=!Object(c.isEmpty)(m)&&m.hasOwnProperty("sidebarValues")?m.sidebarValues:{},Y=$.split_path,Q=void 0===Y?"":Y,X=$.title,Z=void 0===X?"":X,K=$.desc,ee=void 0===K?"":K,te=M({onNodeClick:function(){y("sidebarNodeData",e),k(!0)},onNodeStatClick:function(){Object(d.Jb)()?(y("showContactModalId",W),y("showContactModalType","completed"),y("contactModalData",{split:!0,pathCount:Q})):(y("proModalContent","Split Path Step"),y("showProModal",!0))},onAnalyticsClick:function(){}});return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-wrapper","data-stepid":W},Object(n.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),d.Hb?Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(a?"bwf-selected-node":""),onClick:function(){y("proModalContent","Split Path Step"),y("showProModal",!0)}},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon icon-split-test"},Object(n.createElement)(s.a,{size:26,icon:"split-test"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+o),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Split Path","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"})),Object(n.createElement)("div",{className:"bwf-control-event-error"},Object(n.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer bwf-display-flex"},Object(n.createElement)(s.a,{icon:"king",size:16,color:"#E15334"}),Object(l.__)("Pro Feature","wp-marketing-automations")))):Object(n.createElement)("div",{className:"bwf-inner-wrapper "+(a?"bwf-selected-node":""),onClick:te},Object(n.createElement)("div",{className:"bwf-node-brick"},Object(n.createElement)("div",{className:"bwf-node-icon icon-split-test"},Object(n.createElement)(s.a,{size:26,icon:"split-test"})),Object(n.createElement)("div",{className:"bwf-node-inner-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},Object(l.__)("Step","wp-marketing-automations")+" "+o),Object(n.createElement)("div",{className:"bwf-node-content-label"},Object(l.__)("Split Path","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf-node-action"},Object(n.createElement)(V,{node:e}),Object(n.createElement)(L.a,{label:Object(l.__)("Quick Actions","wp-marketing-automations"),classes:"bwf-event-action",isDisable:!(!R&&!z),renderContent:function(t){var a=t.onToggle;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){Object(d.Jb)()?(y("enableMove",!0),y("moveID",e.id),y("copyData",{type:"split",data:e.data,id:e.id})):(y("proModalContent",Object(l.__)("Move Step","wp-marketing-automations")),y("showProModal",!0)),a()}},Object(n.createElement)(F.a,{justify:"space-between"},Object(n.createElement)(F.c,null,Object(l.__)("Move","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(F.c,null,d.e))),Object(n.createElement)(T.a,{isClickable:!0,onInvoke:function(){var t,n;j({status:!0,onConfirm:(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v(e).then((function(){return j({status:!1})}));case 2:case"end":return t.stop()}}),t)})),n=function(){var e=this,a=arguments;return new Promise((function(n,r){var c=t.apply(e,a);function o(e){Se(c,n,r,o,i,"next",e)}function i(e){Se(c,n,r,o,i,"throw",e)}o(void 0)}))},function(){return n.apply(this,arguments)})}),a()}},Object(n.createElement)(F.a,{justify:"flex-start"},Object(n.createElement)(F.c,null,Object(l.__)("Delete","wp-marketing-automations")))))}}))),Object(c.isEmpty)(m)||Object(c.isEmpty)(Q)?Object(n.createElement)("div",{className:"bwf-control-event-error"},Object(n.createElement)("div",{className:"bwf-control-error-msg bwf-cursor-pointer"},Object(l.__)("Not Configured","wp-marketing-automations"))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-step-content"},Object(n.createElement)("div",{className:"bwf-step-content"},Object(n.createElement)("div",{className:"bwf-step-brick bwf-split-wrap"},Object(n.createElement)("div",{className:"bwf-step-content-content"},Object(n.createElement)("div",{className:"bwf-node-content-type"},""!==Z?Z:"-"),""!==ee&&Object(n.createElement)("div",{className:"bwf-node-content-label bwf-node-desc bwf-two-line-ellipse-text"},ee)),Object(n.createElement)("div",{className:"bwf-node-analytics bwf-split-path-analytics"},Object(n.createElement)("div",{className:"bwf-analytics-btn",onClick:function(){Object(d.Jb)()?(y("declareWinner",{nodeId:o,stepID:W,title:Z}),y("showSplitWinner",!0)):(y("proModalContent",Object(l.__)("Split Step","wp-marketing-automations")),y("showProModal",!0))}},!Object(d.Jb)()&&Object(n.createElement)(s.a,{icon:"king",size:14,color:"#fff"}),Object(l.__)("View Results","wp-marketing-automations")))))),Object(n.createElement)("div",{className:"bwf-node-status bwf-node-mt-10"},Object(n.createElement)("div",{className:"bwf-status-wrap"},Object(n.createElement)("span",{className:"bwf-node-status-label"},Object(l.__)("Completed","wp-marketing-automations")),Object(n.createElement)("span",{className:"bwf-node-status-count"},J?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-20 bwf-h-10"}):Object(n.createElement)(n.Fragment,null,G.hasOwnProperty("completed")?Object(d.Wb)(parseInt(G.completed)):0)))))),H&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-node-plus-paste-wrap bwf-pos-top"},R||z?Object(n.createElement)("div",{className:"bwf-drag-area",onClick:function(){return _(e,"before","")}},Object(n.createElement)("div",{className:"bwf-drag-node is-copy-paste"},Object(n.createElement)("div",{className:"bwf-node-add"}))):Object(n.createElement)("div",{className:"bwf-node-add",onClick:function(t){g(e.id,{option:"",position:"before"}),E(!0),h(t.target)}})))),Object(n.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1}),Object(n.createElement)(O.a,{modalTitle:Object(l.__)("Delete Split Step","wp-marketing-automations"),deleteEntityName:Object(l.__)("split step","wp-marketing-automations"),confirmButtonText:Object(l.__)("Delete","wp-marketing-automations"),onConfirm:f.onConfirm,isLoading:!1,onRequestClose:function(){return j({status:!1})},isOpen:f.status,isDelete:!0}))},Ie=function(e){var t=e.data,a=void 0===t?{}:t,c=e.id,o=(0,Object(u.a)().getNodeDataByID)(c).stepId,i=Object(d.kc)(),s=a.path,m=void 0===s?"1":s;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-splitpath-node-wrapper","data-stepid":o},Object(n.createElement)(r.d,{type:"target",position:"top",isConnectable:!1}),Object(n.createElement)("div",{className:"bwf-split-node split-path-"+m},Object(l.__)("Path","wp-marketing-automations")+" "+i[m])),Object(n.createElement)(r.d,{type:"source",position:"bottom",isConnectable:!1,style:{opacity:0}}))},Me=(a(1271),a(76)),Te=a(96),Fe=a(332),Le=a(24);a(1272);function Re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ze(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(a),!0).forEach((function(t){Je(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Re(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Je(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return qe(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return qe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Be=function(e){var t=Object(n.useRef)(null),a=e.mergetag,r=e.copyTagToClipBoard,o=e.automationId,s=Ue(Object(n.useState)({}),2),b=s[0],u=s[1],d=Ue(Object(n.useState)({}),2),p=d[0],f=d[1],O=Ue(Object(n.useState)({}),2),j=O[0],w=O[1],v=a.schema,y=void 0===v?[]:v,g=a.tag_name,_=void 0===g?"":g,E=a.default_val,h=void 0===E?[]:E;Object(n.useEffect)((function(){var e={},t={};y.map((function(a){e[a.id]=a.type,t[a.id]=a})),f(e),w(t)}),[y]);var k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!1,n=t.fields,r=t.relation,c=void 0===r?"OR":r;c=c.toUpperCase();try{var o=null;if("OR"===c){if(n&&Array.isArray(n))for(var i=0;i<n.length;i++){o=e[n[i].id];var l=void 0===n[i].value||n[i].value;if(""!=l&&o==l||""==l&&""!=o&&null!=o)return!0}}else"AND"==c&&n&&Array.isArray(n)&&(a=n.every((function(t){o=e[t.id];var a=void 0===t.value||t.value;return(""===a||o==a)&&(""!=a||""!=o&&null!=o)})))}catch(e){console.log(e)}return a},N=Object(n.useMemo)((function(){var e=["{{"+_];if(!Object(c.isEmpty)(b))if("cart_recovery_link"===_){var t=b.coupon_type,a=void 0===t?"static":t,n=b.dynamic_coupon,r=void 0===n?"":n,o=b.static_coupon,i=void 0===o?"":o;"static"===a&&""!==i?e.push("coupon='"+i+"'"):"dynamic"===a&&""!==r&&e.push("coupon='"+r+"'")}else Object.entries(b).map((function(t){var a=Ue(t,2),n=a[0],r=a[1];if(!j[n].hasOwnProperty("toggler")||Object(c.isEmpty)(j[n].toggler)||k(b,j[n].toggler,j[n]))if("search"!=p[n]||Object(c.isEmpty)(r))""!==r&&e.push(n+"='"+r+"'");else{var o=[];r.map((function(e){o.push(e.id)})),e.push(n+"='"+o.join(",")+"'")}}));return e.join(" ")+"}}"}),[b]);return Object(n.createElement)("div",{className:"bwf-merge-tag-wrap bwf_w_full"},Object(n.createElement)(Me.a,{onChange:function(e){!function(e){var t=ze(ze({},h),b);t[e.name]=e.value,u(t)}(e)},initialValues:ze(ze({},h),b),validate:function(){return!1}},(function(e){var a=e.getInputProps,r=e.values;e.errors,e.handleSubmit;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"wr_content",ref:t},Object(n.createElement)("div",null,y.map((function(e,t){return Object(n.createElement)(n.Fragment,{key:t},(Object(c.isEmpty)(e.toggler)||k(r,e.toggler,e))&&e.wrap_before&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(n.createElement)(n.Fragment,null,!1!==e.show&&(Object(c.isEmpty)(e.toggler)||k(r,e.toggler,e))&&Object(n.createElement)(Te.a,{input:e,formProps:a(e.id),values:r,automationId:o})):e.hint?Object(n.createElement)(n.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(c.isEmpty)(e.toggler)||k(r,e.toggler,e))&&e.wrap_after&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))))})),Object(n.createElement)("div",{className:"bwf-merge-tag-config-view"},Object(n.createElement)("span",{className:"bwf-merge-tag"},N),Object(n.createElement)("div",{className:"bwf-display-flex bwf-j-end"},Object(n.createElement)(m.Button,{isPrimary:!0,onClick:function(){r(N)},disabled:(y.map((function(e){if(e.hasOwnProperty("required")&&e.required&&(!b.hasOwnProperty(e.id)||""===b[e.id]))return!1})),!(""!==N))},Object(l.__)("Copy","wp-marketing-automations")))))},He=a(186);function Ve(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function We(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(a),!0).forEach((function(t){Ge(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ve(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ge(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function $e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ye(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ye(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Qe=function(e){var t=Object(n.useContext)(d.h),a=Object(n.useContext)(He.a).setSelectedMergeTag,r=e.isOpen,o=e.onRequestClose,b=e.automationID,p=$e(Object(n.useState)(""),2),f=p[0],O=p[1],j=$e(Object(n.useState)(""),2),w=j[0],v=j[1],y=$e(Object(n.useState)({}),2),g=y[0],_=y[1],E=(0,Object(u.a)().getMergeTagList)();Object(n.useEffect)((function(){r||(_({}),O(""),Object(c.isEmpty)(E)||v(Object.keys(E)[0]))}),[r]);var h=function(){o&&o()},k=function(e){a(e);var n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),t(Object(l.__)("Merge tag copied.","wp-marketing-automations")),Object(d.wb)(t,3e3),h()},N=function(){var e,t=(e={},Object.entries(E).map((function(t){var a=$e(t,2),n=a[0],r=a[1];""!==w?w==n&&(e=r):""!==f?Object.entries(r).map((function(t){var a=$e(t,2),n=a[0],r=a[1];(n.includes(f)||r.hasOwnProperty("tag_name")&&r.tag_name.includes(f))&&(e[n]=r)})):e=We(We({},e),r)})),Object.values(e).sort((function(e,t){return e.priority-t.priority})));return Object(c.isEmpty)(t)?Object(n.createElement)("tr",null,Object(n.createElement)("td",{className:"bwf-no-merge-tag"},Object(l.__)("No Merge Tag Available","wp-marketing-automations"))):Object(n.createElement)(n.Fragment,null,Object.entries(t).map((function(e,t){var a=$e(e,2),r=(a[0],a[1]);return Object(n.createElement)("tr",{key:"row"+t},Object(n.createElement)("td",null,Object(n.createElement)("span",{className:"bwf-tag-label"},r.tag_description)),Object(n.createElement)("td",null,Object(n.createElement)("span",{className:"bwf-tag-slug"},"{{"+r.tag_name+"}}")),Object(n.createElement)("td",null,r.hasOwnProperty("schema")?Object(n.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return _(r)},title:Object(l.__)("Configure","wp-marketing-automations")},Object(n.createElement)(s.a,{color:"#353030",icon:"settings"})):Object(n.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return k("{{"+r.tag_name+"}}")},title:Object(l.__)("Copy","wp-marketing-automations")},Object(n.createElement)(s.a,{color:"#353030",icon:"duplicate"}))))})))};return r?Object(n.createElement)(m.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-event-search-modal__merge-tag bwf-admin-modal-xl",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(n.createElement)("div",{className:"bwf-modal-search-header"},Object(n.createElement)("div",{className:"bwf-modal-title"},Object(c.isEmpty)(g)?Object(l.__)("Merge Tags","wp-marketing-automations"):Object(n.createElement)("div",{className:"bwf-display-flex"},Object(n.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){_({})}},Object(n.createElement)(s.a,{icon:Object(l.isRTL)()?"arrow-right":"arrow-left"})),g.hasOwnProperty("tag_description")?g.tag_description:"")),Object(n.createElement)("div",{className:"bwf-modal-search-wrap"},Object(c.isEmpty)(g)&&Object(n.createElement)("div",{className:"bwf-component-search-control"},Object(n.createElement)(s.a,{icon:"search",size:15}),Object(n.createElement)(m.TextControl,{value:f,onChange:function(e){""===e?Object(c.isEmpty)(E)||v(Object.keys(E)[0]):v(""),O(e)},placeholder:Object(l.__)("Search by name","wp-marketing-automations")}))),Object(n.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:h},Object(n.createElement)(s.a,{icon:"close",size:20}))),Object(n.createElement)("div",{className:"bwf-event-modal-main"},Object(n.createElement)("div",{className:"bwf-event-modal-body bwf-merge-modal-content"+(Object(c.isEmpty)(g)&&!Object(c.isEmpty)(E)?"":" gridfull")},Object(c.isEmpty)(g)?Object(c.isEmpty)(E)?Object(n.createElement)("div",{className:"bwf-modal-content-content"},Object(n.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(n.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(n.createElement)("div",{className:"bwf-brick-content"},Object(n.createElement)("div",{className:"bwf-merge-tag-list"},Object(n.createElement)("div",{className:"bwf-no-merge-tag"},Object(l.__)("No Merge Tag Available","wp-marketing-automations"))))))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-modal-sidebar"},Object(n.createElement)("div",{className:"bwf-modal-filter-wrap"},Object.keys(E).map((function(e){return Object(n.createElement)("div",{key:e,className:i()("bwf-modal-filter",{active:w===e}),onClick:function(){O(""),v(e)}},e)})))),Object(n.createElement)("div",{className:"bwf-modal-content-content"},Object(n.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(n.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(n.createElement)("div",{className:"bwf-brick-content"},Object(n.createElement)("div",{className:"bwf-merge-tag-list"},Object(n.createElement)("table",null,Object(n.createElement)("tbody",null,N())))))))):Object(n.createElement)(Be,{mergetag:g,copyTagToClipBoard:k,automationId:b})))):""},Xe=a(31);function Ze(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ke(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(a),!0).forEach((function(t){et(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ze(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function et(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function tt(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function at(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){tt(c,n,r,o,i,"next",e)}function i(e){tt(c,n,r,o,i,"throw",e)}o(void 0)}))}}function nt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rt(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return rt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var ct=function(){var e=Object(n.useContext)(d.h),t=Object(u.a)(),a=t.getSidebarNodeData,r=t.getSelectedSidebarData,o=t.getAutomationId,m=t.getNodeDataByID,p=t.getAutomationData,O=(0,t.getautomationMeta)(),w=Object(b.a)(),v=w.showSidebar,y=w.setNodeDatabyId,g=w.setAutomationData,_=p().event,E=void 0===_?"":_,h=o(),k=Object(n.useRef)(null),N=nt(Object(n.useState)(!1),2),P=N[0],C=N[1],S=nt(Object(n.useState)(""),2),A=S[0],D=S[1],x=nt(Object(n.useState)(!1),2),I=x[0],M=x[1],T=nt(Object(n.useState)(!1),2),F=T[0],L=T[1],R=nt(Object(n.useState)([]),2),z=R[0],J=R[1],U=nt(Object(n.useState)(!1),2),q=U[0],B=U[1],H=nt(Object(n.useState)(!1),2),V=H[0],W=H[1],G=a(),$=nt(Object(n.useState)(!1),2),Y=$[0],Q=$[1],X=!Object(c.isEmpty)(G)&&G.hasOwnProperty("data")?G.data:{},Z=Object(c.isEmpty)(G)?{}:r(G),K=Z.side_header,ee=void 0===K?[]:K,te=!Object(c.isEmpty)(X)&&X.hasOwnProperty("sidebarValues")?X.sidebarValues:{},ae=Object(c.isEmpty)(Z)?{}:Z,ne=ae.fields,re=void 0===ne?[]:ne,ce=ae.default_values,oe=void 0===ce?{}:ce,ie=!Object(c.isEmpty)(G)&&G.hasOwnProperty("id")?m(G.id):{},le=ie.stepId,se=void 0===le?0:le,me=ie.data;(void 0===me?{}:me).sidebarValues;Object(n.useEffect)((function(){J([]),C(!1)}),[]);var be=function(e,t,a){var n=!1,r=t.fields,c=t.relation,o=void 0===c?"OR":c;o=o.toUpperCase();try{var i=null;if("OR"===o){if(r&&Array.isArray(r))for(var l=0;l<r.length;l++){i=e[r[l].id];var s=void 0===r[l].value||r[l].value;if(Array.isArray(s)&&s.includes(i))return!0;if(""!=s&&i==s||""==s&&""!=i&&null!=i)return!0}}else"AND"==o&&r&&Array.isArray(r)&&(n=r.every((function(t){i=e[t.id];var a=void 0===t.value||t.value;return!(!Array.isArray(a)||!a.includes(i))||(""===a||i==a)&&(""!=a||""!=i&&null!=i)})))}catch(e){console.log(e)}return n},ue=[];Object(c.isEmpty)(re)||re.forEach((function(e){e.hasOwnProperty("required")&&e.required&&ue.push(e)}));var de=function(e){var t=!1;return Object(c.isObject)(e)?Object.keys(e).map((function(a){["",void 0,null].includes(e[a])&&(t=!0)})):["",void 0,null].includes(e)&&(t=!0),t},pe=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a={};return ue.map((function(n){if(n.hasOwnProperty("toggler")&&!Object(c.isEmpty)(n.toggler)&&!be(e,n.toggler))return!1;if((Array.isArray(e[n.id])&&0===e[n.id].length||""===e[n.id]||void 0===e[n.id])&&(a[n.id]=n.hasOwnProperty("errorMsg")?n.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations")),"custom_fields"===n.id&&e[n.id].map((function(e,t){!e.hasOwnProperty("field_value")||""===e.field_value||de(e.field_value)?a["field_value_"+t]=n.hasOwnProperty("errorMsg")?n.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations"):a.hasOwnProperty(n.id)&&delete a[n.id]})),"bwfan_email_data"===n.id)if(e.hasOwnProperty("bwfan_email_data")){e.bwfan_email_data.hasOwnProperty("subject")&&""===e.bwfan_email_data.subject&&(a[n.id]="error");var r=Object(d.y)(),o=[],i=e.bwfan_email_data,s=!(!i.hasOwnProperty("data")||Object(c.isEmpty)(i.data)||!i.data.hasOwnProperty("isTransactional"))&&i.data.isTransactional,m="";i.hasOwnProperty("template")&&(m=i.template),m.includes("{{mail_footer}}")||(s||r.includes("unsubscribe_link")||m.includes("unsubscribe_link"))&&(s||r.includes("business_name")||m.includes("business_name"))&&(s||r.includes("business_address")||m.includes("business_address"))||(s||r.includes("unsubscribe_link")||m.includes("unsubscribe_link")||o.push("{{unsubscribe_link}}"),s||r.includes("business_name")||m.includes("business_name")||o.push("{{business_name}}"),s||r.includes("business_address")||m.includes("business_address")||o.push("{{business_address}}")),Object(c.isEmpty)(o)?D(""):(a[n.id]="error",t&&D(Object(l.__)("The required merge tags","wp-marketing-automations")+" "+o.join(", ")+(o.length>1?" are ":" is ")+" "+Object(l.__)("missing in the email body.","wp-marketing-automations")))}else a[n.id]="error"})),t&&J(a),a},fe=function(){var t=at(regeneratorRuntime.mark((function t(a){var n,r,o,i,s=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=!(s.length>1&&void 0!==s[1])||s[1],r=[],r=n?pe(a):[],!Object(c.isEmpty)(r)){t.next=21;break}return X.sidebarValues=a,B(!0),t.prev=6,o={data:{data:{sidebarData:a}}},n||Object(c.isEmpty)(Z)||!Z.hasOwnProperty("slug")||"wp_sendemail"!==Z.slug||(i=pe(a,!1),Object(c.isEmpty)(i)||(o.updateStatus=2)),t.next=11,f()({path:Object(d.u)("/automation/".concat(h,"/step/").concat(se)),method:"POST",data:o}).then((function(t){if(200!==t.code)throw Error(Object(d.p)(null==t?void 0:t.message));var a="";t.hasOwnProperty("result")&&t.result.hasOwnProperty("desc_text")&&!Object(c.isEmpty)(t.result.desc_text)&&(a=t.result.desc_text),y(G.id,Ke(Ke({},X),{},{desc_text:a}),{step_status:o.hasOwnProperty("updateStatus")&&2===o.updateStatus?2:1}),t.hasOwnProperty("result")&&t.result.hasOwnProperty("meta")&&g("meta",Ke(Ke({},O),t.result.meta)),n&&(e(t.message),V||setTimeout((function(){v(!1)}),100)),B(!1),L(!1)})).catch((function(e){throw Error(Object(d.p)(null==e?void 0:e.message))}));case 11:t.next=18;break;case 13:t.prev=13,t.t0=t.catch(6),g("modalData",{status:!0,modalTitle:Object(l.__)("Update Action","wp-marketing-automations"),error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),B(!1),L(!1);case 18:Object(d.wb)(e,3e3),t.next=24;break;case 21:e(Object(l.__)("Validation failed. Please check the fields for error.","wp-marketing-automations")),Object(d.wb)(e,3e3),L(!1);case 24:case"end":return t.stop()}}),t,null,[[6,13]])})));return function(e){return t.apply(this,arguments)}}();return Object(n.createElement)(d.f.Provider,{value:{errorList:z,setErrorList:J,stepId:se}},Object(n.createElement)(d.c.Provider,{value:{isOpenTags:P,setOpenTags:C}},Object(n.createElement)("div",{className:"wr_header"},Object(n.createElement)("div",{className:"bwf-node-icon icon-action"},Object(n.createElement)(s.a,{size:22,icon:"charge"})),Object(n.createElement)("div",{className:"wr_event_title"},Z.hasOwnProperty("action_name")?Z.action_name:""),Object(n.createElement)("div",{className:"wr_event_variant"},ee.includes("link-trigger")&&Object(n.createElement)(Fe.a,{canCreate:!0,isLinkTriggerOpen:Y,setLinkTriggerOpen:Q,hideButton:!1}),ee.includes("merge-tag")&&Object(n.createElement)("span",{onClick:function(){C(!0)},className:"bwf-cursor-pointer bwf-modal-icon-link-trigger",key:"merge-tag"},Object(n.createElement)(Le.a,{icon:"merge-tag",iconSize:24,size:"auto",toolTipText:Object(n.createElement)("span",{className:"bwfan_tooltip_text bwf-w-120","data-position":"top"},Object(l.__)("Merge tags","wp-marketing-automations"))}))),Object(n.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return v(!1)}},Object(n.createElement)(s.a,{icon:"close"}))),Object(c.isEmpty)(re)?Object(n.createElement)("div",{className:"wr_content"},Object(n.createElement)("div",{className:"bwf-single-automation-notice is-info"},Object(l.__)("No settings to configure.","wp-marketing-automations"))):Object(n.createElement)(Me.a,{onSubmit:function(){var e=at(regeneratorRuntime.mark((function e(t){var a,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!(n.length>1&&void 0!==n[1])||n[1],e.next=3,fe(t,a);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),initialValues:Ke(Ke({},oe),te),validate:function(){return!1}},(function(e){var t,a=e.getInputProps,r=e.values,o=e.errors,s=e.handleSubmit;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:(t="wr_content",Z.hasOwnProperty("slug")&&(t=t+" wr_action_"+Z.slug),t),ref:k},Object(n.createElement)("div",null,!Object(c.isEmpty)(Z)&&Z.hasOwnProperty("slug")&&"wp_sendemail"===Z.slug&&""!==A&&Object(n.createElement)(Xe.a,{className:"bwf-error-notice",status:"error"},A),re.map((function(e,t){return Object(n.createElement)(n.Fragment,{key:t},(Object(c.isEmpty)(e.toggler)||be(r,e.toggler))&&e.wrap_before&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(n.createElement)(n.Fragment,null,!1!==e.show&&(Object(c.isEmpty)(e.toggler)||be(r,e.toggler))&&Object(n.createElement)(Te.a,{input:e,formProps:a(e.id),values:r,isOpenTemplate:I,setOpenTemplate:function(){Object(d.Jb)()?M(!I):g("showProModal",!0)},automationId:h,automationEvent:E,setMergeTagModal:C,saveNodeDataOnSubmit:s})):e.hint?Object(n.createElement)(n.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(c.isEmpty)(e.toggler)||be(r,e.toggler))&&e.wrap_after&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))),Object(n.createElement)("div",{className:"wr_footer"},Object(n.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return v(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),!Object(c.isEmpty)(Z)&&Z.hasOwnProperty("slug")&&"wp_sendemail"===Z.slug&&Object(n.createElement)(j.a,{isSecondary:!0,onClick:function(){W(!1),L(!0),setTimeout((function(){return s()}),100)},isBusy:F,disabled:Object.keys(o).length},Object(l.__)("Save & Close","wp-marketing-automations")),Object(n.createElement)(j.a,{isPrimary:!0,className:"bwf-no-ripple",onClick:function(){!Object(c.isEmpty)(Z)&&Z.hasOwnProperty("slug")&&"wp_sendemail"===Z.slug&&W(!0),setTimeout((function(){return s()}),100)},isBusy:q&&!F},Object(l.__)("Save","wp-marketing-automations"))))})),Object(n.createElement)(Qe,{isOpen:P,onRequestClose:C,automationID:h})))};a(1273);function ot(e){return function(e){if(Array.isArray(e))return st(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||lt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||lt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lt(e,t){if(e){if("string"==typeof e)return st(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?st(e,t):void 0}}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var mt=function(e){var t=e.options,a=e.selected,r=e.setSelected,o=e.selectedContent,i=void 0===o?"":o,l=e.liteDummyData,m=void 0===l?[]:l,b=it(Object(n.useState)([]),2),u=b[0],p=b[1];return Object(c.isEmpty)(t)?Object(n.createElement)(n.Fragment,null):Object(n.createElement)(n.Fragment,null,t.map((function(e,t){if(Object(c.isEmpty)(e)||!e.hasOwnProperty("value"))return!1;var o=e.value==a?"selected":"";return Object(n.createElement)("div",{className:"bwf-custom-radio-control",key:t},Object(n.createElement)("div",{className:"bwf-custom-radio-option",key:e.value,onClick:function(){return r(e.value)}},Object(n.createElement)("div",{className:"bwf-select-option-indicator "+o},e.hasOwnProperty("isProFeature")&&e.isProFeature&&!Object(d.Jb)()?Object(n.createElement)(s.a,{icon:"king"}):Object(n.createElement)("div",{className:"bwf-option-mark-outer"},Object(n.createElement)("div",{className:"bwf-option-mark-inner"}))),Object(n.createElement)("div",{className:"bwf-select-option-info"},Object(n.createElement)("div",{className:"bwf-bold"},e.hasOwnProperty("label")?e.label:""),Object(n.createElement)("div",{className:"bwf-desc"},e.hasOwnProperty("desc")?e.desc:"")),e.hasOwnProperty("isProFeature")&&e.isProFeature&&!Object(d.Jb)()&&Object(n.createElement)("a",{onClick:function(t){t.stopPropagation();var a=ot(u);a.includes(e.value)?a.pop(e.value):a.push(e.value),p(a)},className:"bwf-no-underline bwf-cursor-pointer"},"Explore")),u.includes(e.value)&&m.hasOwnProperty(e.value)&&Object(n.createElement)(n.Fragment,null,m[e.value]),o&&Object(n.createElement)("div",{className:"bwf-option-content"},i))})))},bt=a(336),ut=a(91);a(1274);function dt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function pt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(a),!0).forEach((function(t){ft(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):dt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ft(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ot(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return jt(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return jt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var wt=function(e){var t=Object(n.useRef)(null),a=e.mergetag,r=e.copyTagToClipBoard,o=e.automationId,s=Ot(Object(n.useState)({}),2),b=s[0],u=s[1],d=Ot(Object(n.useState)({}),2),p=d[0],f=d[1],O=a.schema,j=void 0===O?[]:O,w=a.tag_name,v=void 0===w?"":w,y=a.default_val,g=void 0===y?[]:y;Object(n.useEffect)((function(){var e=[];j.map((function(t){e[t.id]=t.type})),f(e)}),[j]);var _,E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!1,n=t.fields,r=t.relation,c=void 0===r?"OR":r;c=c.toUpperCase();try{var o=null;if("OR"===c){if(n&&Array.isArray(n))for(var i=0;i<n.length;i++){o=e[n[i].id];var l=void 0===n[i].value||n[i].value;if(""!=l&&o==l||""==l&&""!=o&&null!=o)return!0}}else"AND"==c&&n&&Array.isArray(n)&&(a=n.every((function(t){o=e[t.id];var a=void 0===t.value||t.value;return(""===a||o==a)&&(""!=a||""!=o&&null!=o)})))}catch(e){console.log(e)}return a},h=function(){var e=["{{"+v];if(!Object(c.isEmpty)(b))if("cart_recovery_link"===v){var t=b.coupon_type,a=void 0===t?"":t,n=b.dynamic_coupon,r=void 0===n?"":n,o=b.static_coupon,i=void 0===o?"":o;"static"===a&&""!==i?e.push("coupon='"+i+"'"):"dynamic"===a&&""!==r&&e.push("coupon='"+r+"'")}else Object.entries(b).map((function(t){var a=Ot(t,2),n=a[0],r=a[1];if("search"!=p[n]||Object(c.isEmpty)(r))""!==r&&e.push(n+"='"+r+"'");else{var o=[];r.map((function(e){o.push(e.id)})),e.push(n+"='"+o.join(",")+"'")}}));return e.join(" ")+"}}"},k=function(){var e=h();return j.map((function(t){!t.hasOwnProperty("required")||!t.required||b.hasOwnProperty(t.id)&&""!==b[t.id]||(e="")})),""!==e};return Object(n.createElement)("div",{className:"bwf-merge-tag-wrap bwf_w_full"},Object(n.createElement)(Me.a,{onChange:function(e){!function(e){var t=pt({},b);t[e.name]=e.value,u(t)}(e)},initialValues:pt(pt({},g),b),validate:function(){return!1}},(function(e){var a=e.getInputProps,r=e.values;e.errors,e.handleSubmit;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"wr_content",ref:t},Object(n.createElement)("div",null,j.map((function(e,t){return Object(n.createElement)(n.Fragment,{key:t},(Object(c.isEmpty)(e.toggler)||E(r,e.toggler,e))&&e.wrap_before&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(n.createElement)(n.Fragment,null,!1!==e.show&&(Object(c.isEmpty)(e.toggler)||E(r,e.toggler,e))&&Object(n.createElement)(Te.a,{input:e,formProps:a(e.id),values:r,automationId:o})):e.hint?Object(n.createElement)(n.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(c.isEmpty)(e.toggler)||E(r,e.toggler,e))&&e.wrap_after&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))))})),(_=h(),Object(n.createElement)("div",{className:"bwf-merge-tag-config-view"},Object(n.createElement)("span",{className:"bwf-merge-tag"},_),Object(n.createElement)("div",{className:"bwf-display-flex bwf-j-end"},Object(n.createElement)(m.Button,{isPrimary:!0,onClick:function(){r(_)},disabled:!k()},Object(l.__)("Select","wp-marketing-automations"))))))};function vt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function yt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?vt(Object(a),!0).forEach((function(t){gt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):vt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function gt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Et(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Et(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Et(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var ht=function(e){var t=Object(n.useContext)(He.a).setSelectedMergeTag,a=e.isOpen,r=e.onRequestClose,o=e.automationID,b=e.onSelect,d=_t(Object(n.useState)(""),2),p=d[0],f=d[1],O=_t(Object(n.useState)(""),2),j=O[0],w=O[1],v=_t(Object(n.useState)({}),2),y=v[0],g=v[1],_=(0,Object(u.a)().getDelayTagList)();Object(n.useEffect)((function(){a||(g({}),f(""),Object(c.isEmpty)(_)||w(Object.keys(_)[0]))}),[a]);var E=function(){r&&r()},h=function(e){t(e),b(e),E()},k=function(){var e,t=(e={},Object.entries(_).map((function(t){var a=_t(t,2),n=a[0],r=a[1];""!==j?j==n&&(e=r):""!==p?Object.entries(r).map((function(t){var a=_t(t,2),n=a[0],r=a[1];(n.includes(p)||r.hasOwnProperty("tag_name")&&r.tag_name.includes(p))&&(e[n]=r)})):e=yt(yt({},e),r)})),e);return Object(c.isEmpty)(t)?Object(n.createElement)("tr",null,Object(n.createElement)("td",{className:"bwf-no-merge-tag"},Object(l.__)("No Delay Tag Available","wp-marketing-automations"))):Object(n.createElement)(n.Fragment,null,Object.entries(t).map((function(e,t){var a=_t(e,2),r=(a[0],a[1]);return Object(n.createElement)("tr",{key:"row"+t},Object(n.createElement)("td",null,Object(n.createElement)("span",{className:"bwf-tag-label"},r.tag_description)),Object(n.createElement)("td",null,Object(n.createElement)("span",{className:"bwf-tag-slug"},"{{"+r.tag_name+"}}")),Object(n.createElement)("td",null,r.hasOwnProperty("schema")?Object(n.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return g(r)},title:Object(l.__)("Configure","wp-marketing-automations")},Object(n.createElement)(s.a,{color:"#353030",icon:"settings"})):Object(n.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){return h("{{"+r.tag_name+"}}")},title:Object(l.__)("Copy","wp-marketing-automations")},Object(n.createElement)(s.a,{color:"#353030",icon:"duplicate"}))))})))};return a?Object(n.createElement)(m.Modal,{className:"bwf-admin-modal bwf-event-search-modal bwf-event-search-delay-tag bwf-admin-modal-xl bwf-overflow-remove",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(n.createElement)("div",{className:"bwf-modal-search-header"},Object(n.createElement)("div",{className:"bwf-modal-title"},Object(c.isEmpty)(y)?Object(l.__)("Delay Tags","wp-marketing-automations"):Object(n.createElement)("div",{className:"bwf-display-flex"},Object(n.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){g({})}},Object(n.createElement)(s.a,{icon:Object(l.isRTL)()?"arrow-right":"arrow-left"})),y.hasOwnProperty("tag_description")?y.tag_description:"")),Object(n.createElement)("div",{className:"bwf-modal-search-wrap"},Object(c.isEmpty)(y)&&Object(n.createElement)("div",{className:"bwf-component-search-control"},Object(n.createElement)(s.a,{icon:"search",size:15}),Object(n.createElement)(m.TextControl,{value:p,onChange:function(e){""===e?Object(c.isEmpty)(_)||w(Object.keys(_)[0]):w(""),f(e)},placeholder:Object(l.__)("Search by name","wp-marketing-automations")}))),Object(n.createElement)("div",{className:"bwf-modal-close bwf-cursor-pointer",onClick:E},Object(n.createElement)(s.a,{icon:"close",size:20}))),Object(n.createElement)("div",{className:"bwf-event-modal-main"},Object(n.createElement)("div",{className:"bwf-event-modal-body bwf-merge-modal-content"+(Object(c.isEmpty)(y)&&!Object(c.isEmpty)(_)?"":" gridfull")},Object(c.isEmpty)(y)?Object(c.isEmpty)(_)?Object(n.createElement)("div",{className:"bwf-modal-content-content"},Object(n.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(n.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(n.createElement)("div",{className:"bwf-brick-content"},Object(n.createElement)("div",{className:"bwf-merge-tag-list"},Object(n.createElement)("div",{className:"bwf-no-merge-tag"},Object(l.__)("No Delay Tag Available","wp-marketing-automations"))))))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-modal-sidebar"},Object(n.createElement)("div",{className:"bwf-modal-filter-wrap"},Object.keys(_).map((function(e){return Object(n.createElement)("div",{key:e,className:i()("bwf-modal-filter",{active:j===e}),onClick:function(){f(""),w(e)}},e)})))),Object(n.createElement)("div",{className:"bwf-modal-content-content"},Object(n.createElement)("div",{className:"bwf-modal-content-brick no-padding set-height"},Object(n.createElement)("div",{className:"modal-brick-wrap bwfan_pb20"},Object(n.createElement)("div",{className:"bwf-brick-content"},Object(n.createElement)("div",{className:"bwf-merge-tag-list"},Object(n.createElement)("table",null,Object(n.createElement)("tbody",null,k())))))))):Object(n.createElement)(wt,{mergetag:y,copyTagToClipBoard:h,automationId:o})))):""},kt=a(41);function Nt(e){return function(e){if(Array.isArray(e))return Mt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||It(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ct(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(a),!0).forEach((function(t){St(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Pt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function St(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function At(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function Dt(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){At(c,n,r,o,i,"next",e)}function i(e){At(c,n,r,o,i,"throw",e)}o(void 0)}))}}function xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||It(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(e,t){if(e){if("string"==typeof e)return Mt(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Mt(e,t):void 0}}function Mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Tt=function(){var e=xt(Object(n.useState)({}),2),t=e[0],a=e[1],r=xt(Object(n.useState)({}),2),o=r[0],i=r[1],p=xt(Object(n.useState)(!0),2),O=p[0],w=p[1],v=xt(Object(n.useState)(!1),2),y=v[0],g=v[1],_=xt(Object(n.useState)(!1),2),E=_[0],h=_[1],k=Object(n.useContext)(d.h),N=Object(b.a)(),P=N.showSidebar,C=N.setNodeDatabyId,S=N.setAutomationData,A=N.fetchSplitPathNodes,D=xt(Object(n.useState)(!1),2),x=D[0],I=D[1],M=Object(u.a)(),T=M.getSidebarNodeData,F=M.getNodeDataByID,L=M.getAutomationId,R=M.getAutomationLinks,z=M.getAutomationSteps,J=M.getCount,U=M.getActionsList,q=M.getGoals,B=M.getDelayTagList,H=M.getautomationMeta,V=T(),W=L(),G=B(),$=z(),Y=R(),Q=J(),X=U(),Z=q(),K=H(),ee=A(),te=!Object(c.isEmpty)(V)&&V.hasOwnProperty("id")?F(V.id):{},ae=(te.id,te.stepId),ne=void 0===ae?0:ae,re=te.data,ce=(void 0===re?{}:re).sidebarValues,oe=function(){var e=Dt(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f()({path:Object(d.u)("/fields/?type=7&all=true"),method:"GET"}).then((function(e){200===e.code&&(Object(c.isEmpty)(e.result)||i(e.result),w(!1))}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){Object(d.Jb)()&&oe(),a({})}),[]);var ie=!Object(c.isEmpty)(V)&&V.hasOwnProperty("data")?V.data:{},le=!Object(c.isEmpty)(ie)&&ie.hasOwnProperty("sidebarValues")?ie.sidebarValues:{},se=xt(Object(n.useState)(1),2),be=se[0],de=se[1],pe=xt(Object(n.useState)({day_delay:{unit:"min",text:"0"}}),2),fe=pe[0],Oe=pe[1];Object(n.useEffect)((function(){le.hasOwnProperty("type")&&[1,2,3,4].includes(parseInt(le.type))&&de(parseInt(le.type)),le.hasOwnProperty("data")&&!Object(c.isEmpty)(le.data)&&Oe(le.data)}),[le]),Object(n.useEffect)((function(){if(!O){var e=Ct(Ct({},le),{},{type:be,data:fe});Object(c.isEqual)(ce,e)||Object(c.isEmpty)(ce)?g(!1):g(!0)}}),[be,fe]);var je=function(e){var t=e.type,n=void 0===t?0:t,r=e.data,o=void 0===r?{}:r,i={};switch(parseInt(n)){case 1:var s=o.day_delay,m=void 0===s?{}:s,b=o.enable_time_delay,u=void 0!==b&&b,d=o.time_delay,p=void 0===d?{}:d,f=o.enable_week_delay,O=void 0!==f&&f,j=o.week_delay,w=void 0===j?[]:j;(Object(c.isEmpty)(m)||m.hasOwnProperty("text")&&""==m.text)&&(i.day_delay=Object(l.__)("Select a specific period.","wp-marketing-automations")),u?(Object(c.isEmpty)(p)||p.hasOwnProperty("time")&&Object(c.isEmpty)(p.time))&&(i.time_delay=Object(l.__)("Select a specific time of day.","wp-marketing-automations")):o.time_delay={},O?Object(c.isEmpty)(w)&&(i.week_delay=Object(l.__)("Select a specific day of the week.","wp-marketing-automations")):o.week_delay=[];break;case 2:var v=o.date,y=void 0===v?"":v,g=o.time_delay,_=void 0===g?{time:""}:g,E=o.enable_step_skip,h=void 0!==E&&E,k=o.skip_to_step,N=void 0===k?{}:k;Object(c.isEmpty)(y)&&(i.specific_date=Object(l.__)("Select a specific date.","wp-marketing-automations")),Object(c.isEmpty)(_.time)&&(i.specific_time=Object(l.__)("Select a specific time.","wp-marketing-automations")),!h||N.hasOwnProperty("step")&&""!=N.step||(i.specific_date_time_step=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"));break;case 3:var P=o.custom_field,C=void 0===P?{}:P,S=o.enable_step_skip,A=void 0!==S&&S,D=o.skip_to_step,x=void 0===D?{}:D;if(!C.hasOwnProperty("field")||0==parseInt(C.field)||isNaN(parseInt(C.field))){i.custom_field=Object(l.__)("Please select custom field.","wp-marketing-automations");break}!A||x.hasOwnProperty("step")&&""!=x.step||(i.custom_field=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"));break;case 4:var I=o.variable_field,M=void 0===I?{}:I,T=o.enable_step_skip,F=void 0!==T&&T,L=o.skip_to_step,R=void 0===L?{}:L;if(!M.hasOwnProperty("variable")||""==M.variable){i.variable=Object(l.__)("Please select a delay variable.","wp-marketing-automations");break}!F||R.hasOwnProperty("step")&&""!=R.step||(i.variable=Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))}return!!Object(c.isEmpty)(i)||(a(i),!1)},we=function(){var e=Dt(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,a=Ct(Ct({},le),{},{type:be,data:fe}),je(a)){e.next=4;break}return e.abrupt("return");case 4:if(!Object(c.isEqual)(ce,a)){e.next=7;break}return P(!1),e.abrupt("return");case 7:return Object(c.isEmpty)(ce)||(t=!0),I(!0),n={data:{data:{sidebarData:a}},steps:Object(c.cloneDeep)($).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:Y,count:Q,optionUpdated:t,actionType:1},e.prev=10,e.next=13,f()({path:Object(d.u)("/automation/".concat(W,"/step/").concat(ne)),method:"POST",data:n}).then((function(e){if(200!==e.code)throw Error(Object(d.p)(null==e?void 0:e.message));k(e.message),C(V.id,Ct(Ct({},ie),{},{sidebarValues:a}),{step_status:1}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&S("meta",Ct(Ct({},K),e.result.meta)),setTimeout((function(){P(!1)}),100),I(!1)})).catch((function(e){throw Error(Object(d.p)(null==e?void 0:e.message))}));case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(10),S("modalData",{status:!0,modalTitle:Object(l.__)("Update Delay","wp-marketing-automations"),error:null===e.t0||void 0===e.t0?void 0:e.t0.message}),I(!1);case 19:Object(d.wb)(k,3e3);case 20:case"end":return e.stop()}}),e,null,[[10,15]])})));return function(){return e.apply(this,arguments)}}(),ve=[{value:1,label:Object(l.__)("Delay for a specific period","wp-marketing-automations"),desc:Object(l.__)("Wait for a specified number of hours, days, or week before continuing","wp-marketing-automations"),isProFeature:!1},{value:2,label:Object(l.__)("Delay until a specific date and time","wp-marketing-automations"),desc:Object(l.__)("Set a specific date and time","wp-marketing-automations"),isProFeature:!0},{value:3,label:Object(l.__)("Delay until a custom field date","wp-marketing-automations"),desc:Object(l.__)("Choose from contacts custom field","wp-marketing-automations"),isProFeature:!0}];Object(c.isEmpty)(G)||ve.push({value:4,label:Object(l.__)("Delay with events variable","wp-marketing-automations"),desc:Object(l.__)("Choose from event field value","wp-marketing-automations"),isProFeature:!0});var ye=[{value:"1",label:Object(l.__)("S","wp-marketing-automations")},{value:"2",label:Object(l.__)("M","wp-marketing-automations")},{value:"3",label:Object(l.__)("T","wp-marketing-automations")},{value:"4",label:Object(l.__)("W","wp-marketing-automations")},{value:"5",label:Object(l.__)("TH","wp-marketing-automations")},{value:"6",label:Object(l.__)("F","wp-marketing-automations")},{value:"7",label:Object(l.__)("SA","wp-marketing-automations")}],ge=function(e){return t.hasOwnProperty(e)},_e={1:Object(l.__)("Sun","wp-marketing-automations"),2:Object(l.__)("Mon","wp-marketing-automations"),3:Object(l.__)("Tue","wp-marketing-automations"),4:Object(l.__)("Wed","wp-marketing-automations"),5:Object(l.__)("Thu","wp-marketing-automations"),6:Object(l.__)("Fri","wp-marketing-automations"),7:Object(l.__)("Sat","wp-marketing-automations")},Ee=function(){var e=fe.day_delay,t=void 0===e?{}:e,a=fe.enable_time_delay,n=void 0!==a&&a,r=fe.enable_week_delay,o=void 0!==r&&r,i=fe.time_delay,s=void 0===i?{time:""}:i,m=fe.week_delay,b=void 0===m?[]:m;if(!Object(c.isEmpty)(t)&&t.hasOwnProperty("unit")&&t.hasOwnProperty("text")&&!Object(c.isEmpty)(t.unit)&&!Object(c.isEmpty)(t.text)){var u=t.text+" "+function(e,t){switch(e){case"min":return parseInt(t)>1?Object(l.__)("Minutes","wp-marketing-automations"):Object(l.__)("Minute","wp-marketing-automations");case"hours":return parseInt(t)>1?Object(l.__)("Hours","wp-marketing-automations"):Object(l.__)("Hour","wp-marketing-automations");case"days":return parseInt(t)>1?Object(l.__)("Days","wp-marketing-automations"):Object(l.__)("Day","wp-marketing-automations");case"weeks":return parseInt(t)>1?Object(l.__)("Weeks","wp-marketing-automations"):Object(l.__)("Week","wp-marketing-automations");case"months":return parseInt(t)>1?Object(l.__)("Months","wp-marketing-automations"):Object(l.__)("Month","wp-marketing-automations");default:return""}}(t.unit,t.text),d=[];return o&&!Object(c.isEmpty)(b)&&b.map((function(e){_e.hasOwnProperty(e)&&d.push(_e[e])})),n&&s.hasOwnProperty("time")&&!Object(c.isEmpty)(s.time)?(u+=" "+Object(l.__)("till","wp-marketing-automations")+" "+Object(me.format)(bwfcrm_contacts_data.time_format,ue()(s.time,"HH:mm:ss")),Object(c.isEmpty)(d)||(u+="  "+d.join("/")),s.hasOwnProperty("in_contact_timezone")&&s.in_contact_timezone&&(u+=" "+Object(l.__)("in Contact's Timezone","wp-marketing-automations"))):Object(c.isEmpty)(d)||(u+="  "+d.join("/")),Object(l.__)("Delay of","wp-marketing-automations")+" "+u+"."}return""},he=function(){var e=fe.custom_field,t=void 0===e?{field:"",time:"",in_contact_timezone:!1,custom_field_label:""}:e,a=fe.enable_time_delay,n=void 0!==a&&a,r=fe.time_delay,o=void 0===r?{duration:0,type:"days",timing:"after"}:r,i=fe.enable_step_skip,s=void 0!==i&&i,m=fe.skip_to_step,b=void 0===m?{step:0,name:""}:m;if(t.hasOwnProperty("field")&&""!==t.field){var u=Object(l.__)("Delay","wp-marketing-automations")+" ";return n?o.hasOwnProperty("duration")&&(u+="".concat(Object(l.__)("of","wp-marketing-automations")," ").concat(o.duration," ").concat(o.type," ").concat(o.timing," ")):u+=Object(l.__)("till","wp-marketing-automations")+" ",t.hasOwnProperty("custom_field_label")&&""!==t.custom_field_label?u+="'".concat(t.custom_field_label,"' ").concat(Object(l.__)("field","wp-marketing-automations")," "):u+="".concat(Object(l.__)("Custom Field","wp-marketing-automations")," ( ").concat(t.field," )"),t.hasOwnProperty("time")&&""!==t.time&&(u+=" ".concat(Object(l.__)("till","wp-marketing-automations")," ").concat(Object(me.format)(bwfcrm_contacts_data.time_format,ue()(t.time,"HH:mm:ss")))),t.hasOwnProperty("in_contact_timezone")&&t.in_contact_timezone?u+=" ".concat(Object(l.__)("in Contact's Timezone","wp-marketing-automations"),". "):u+=". ",s&&!Object(c.isEmpty)(b)&&b.hasOwnProperty("step")&&""!=b.step&&b.hasOwnProperty("name")&&""!=b.name&&(u+=" ".concat(Object(l.__)("Jump to","wp-marketing-automations")," ").concat(b.name,".")),u}return""},ke=function(){var e=fe.date,t=void 0===e?"":e,a=fe.time_delay,n=void 0===a?{time:"",in_contact_timezone:!1}:a,r=fe.enable_step_skip,o=void 0!==r&&r,i=fe.skip_to_step,s=void 0===i?{step:0,name:""}:i;if(!Object(c.isEmpty)(t)&&n.hasOwnProperty("time")&&!Object(c.isEmpty)(n.time)){var m=Object(l.__)("Delay till","wp-marketing-automations")+" ";return m+=Object(d.V)(t,!0,!1)+" ",n.hasOwnProperty("time")&&""!==n.time&&(m+="".concat(Object(l.__)("at","wp-marketing-automations")," ").concat(Object(me.format)(bwfcrm_contacts_data.time_format,ue()(n.time,"HH:mm:ss"))," ")),n.hasOwnProperty("in_contact_timezone")&&n.in_contact_timezone?m+="".concat(Object(l.__)("in Contact's Timezone","wp-marketing-automations"),". "):m+=". ",o&&!Object(c.isEmpty)(s)&&s.hasOwnProperty("step")&&""!=s.step&&s.hasOwnProperty("name")&&""!=s.name&&(m+="".concat(Object(l.__)("Jump to","wp-marketing-automations")," ").concat(s.name)),m}return""},Ne={action:Object(l.__)("Action","wp-marketing-automations"),wait:Object(l.__)("Delay","wp-marketing-automations"),conditional:Object(l.__)("Conditional","wp-marketing-automations"),exit:Object(l.__)("Exit","wp-marketing-automations"),benchmark:Object(l.__)("Goal","wp-marketing-automations")},Pe=Object(n.useMemo)((function(){var e={stepsOptArr:[],stepsOptions:[{value:"",label:Object(l.__)("Select Step","wp-marketing-automations")}]};return Object(c.isEmpty)($)||($.map((function(t){var a=t.stepId,n=void 0===a?0:a,r=t.id,c=void 0===r?0:r;if(!["yesNoNode","end","jump","start","exit","split","splitpath"].includes(t.type)&&!e.stepsOptArr.hasOwnProperty(c)&&n!=ne&&!ee.includes(c)){var o=[Object(l.__)("Step","wp-marketing-automations")];o.push(c),Ne.hasOwnProperty(t.type)&&o.push(" : "+Ne[t.type]),"action"==t.type&&t.hasOwnProperty("data")&&X.list.hasOwnProperty(t.data.selected)&&X.list[t.data.selected].hasOwnProperty("action_name")&&(X.list[t.data.selected].hasOwnProperty("integration_nicename")?o.push(" - "+X.list[t.data.selected].integration_nicename+" : "):o.push(" - "),o.push(X.list[t.data.selected].action_name)),"benchmark"==t.type&&t.hasOwnProperty("data")&&Z.list.hasOwnProperty(t.data.benchmark)&&Z.list[t.data.benchmark].hasOwnProperty("event_name")&&(Z.list[t.data.benchmark].hasOwnProperty("source_label")&&o.push(Z.list[t.data.benchmark].source_label+" : "),o.push(Z.list[t.data.benchmark].event_name)),e.stepsOptArr[n]=o.join(" "),e.stepsOptions.push({value:n,label:o.join(" ")})}})),e.stepsOptArr.end=Object(l.__)("End Automation","wp-marketing-automations"),e.stepsOptions.push({value:"end",label:Object(l.__)("End Automation","wp-marketing-automations")})),e}),[$]),Ce=xt(Object(n.useState)(!1),2),Se=Ce[0],Ae=Ce[1],De=xt(Object(n.useState)(!1),2),xe=De[0],Ie=De[1],Me=function(){var e=fe.day_delay,a=void 0===e?{unit:"min",text:"0"}:e,r=fe.enable_time_delay,o=void 0!==r&&r,i=fe.time_delay,b=void 0===i?{time:"",in_contact_timezone:!1}:i,u=fe.enable_week_delay,p=void 0!==u&&u,f=fe.week_delay,O=void 0===f?["sunday"]:f;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-delay-field "+(ge("day_delay")?"has-error":"")},Object(n.createElement)(bt.a,{units:[{value:"min",label:Object(l.__)("Minutes","wp-marketing-automations")},{value:"hours",label:Object(l.__)("Hours","wp-marketing-automations")},{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")},{value:"months",label:Object(l.__)("Months","wp-marketing-automations")}],onChange:function(e){Oe(Ct(Ct({},fe),{},{day_delay:e}))},value:a}),ge("day_delay")&&Object(n.createElement)("div",{className:"has-bwfan-error"},t.day_delay)),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(d.Jb)()?Object(n.createElement)(n.Fragment,null,Object(n.createElement)(kt.a,{checked:o,label:Object(l.__)("Delay until a specific time of day","wp-marketing-automations"),onChange:function(e){return Oe(Ct(Ct({},fe),{},{enable_time_delay:e}))}}),o&&Object(n.createElement)("div",{className:"bwf-delay-field "+(ge("time_delay")?"has-error":"")},Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(n.createElement)("input",{type:"time",value:b.time,className:"bwf-w-150 bwf-h-36",onChange:function(e){Oe(Ct(Ct({},fe),{},{time_delay:Ct(Ct({},fe.time_delay),{},{time:e.target.value})}))}}),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-display-flex "+(Object(d.Jb)()?"":"bwf-delay-no-pro")},Object(d.Jb)()?Object(n.createElement)(kt.a,{checked:b.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){Oe(Ct(Ct({},fe),{},{time_delay:Ct(Ct({},fe.time_delay),{},{in_contact_timezone:e})}))}}):Object(n.createElement)("div",{className:"bwf-cursor-pointer no-color",onClick:function(){S("proModalContent","This"),S("showProModal",!0)}},Object(l.__)("In Contact Timezone","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(s.a,{icon:"king",size:16})))),ge("time_delay")&&Object(n.createElement)("div",{className:"has-bwfan-error"},t.time_delay))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start"},Object(n.createElement)(s.a,{icon:"king",size:16}),Object(l.__)("Delay until a specific time of day","wp-marketing-automations"),Object(n.createElement)("a",{onClick:function(){return Ae(!Se)},className:"bwf-no-underline bwf-cursor-pointer"},"Explore")),Se&&Object(n.createElement)("div",{className:"bwf-p-15 bwf-mtb-10 bwf-lite-restrict-section"},Object(n.createElement)(kt.a,{checked:!1,disabled:!0,label:Object(l.__)("Delay until a specific time of day","wp-marketing-automations")}),Object(n.createElement)("div",{className:"bwf-delay-field "},Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-p-20 bwf-pt-0 bwf-pb-0"},Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(n.createElement)("input",{type:"time",value:"",disabled:!0,className:"bwf-w-150 bwf-h-36",onChange:function(){}}),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-display-flex "},Object(n.createElement)(kt.a,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(n.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(n.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(d.T)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(d.Jb)()?Object(n.createElement)(n.Fragment,null,Object(n.createElement)(kt.a,{checked:p,label:Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),onChange:function(e){return Oe(Ct(Ct({},fe),{},{enable_week_delay:e}))}}),p&&Object(n.createElement)("div",{className:"bwf-delay-field "+(ge("week_delay")?"has-error":"")},Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)(m.ButtonGroup,null,ye.map((function(e,t){return Object(n.createElement)(m.Button,{key:t,isPrimary:O.includes(e.value),isSecondary:!O.includes(e.value),onClick:function(){var t=Nt(O);t.includes(e.value)?t=t.filter((function(t){return t!==e.value})):t.push(e.value),Oe(Ct(Ct({},fe),{},{week_delay:t}))}},e.label)}))),ge("week_delay")&&Object(n.createElement)("div",{className:"has-bwfan-error"},t.week_delay))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start"},Object(n.createElement)(s.a,{icon:"king",size:16}),Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),Object(n.createElement)("a",{onClick:function(){return Ie(!xe)},className:"bwf-no-underline bwf-cursor-pointer"},Object(l.__)("Explore","wp-marketing-automations"))),xe&&Object(n.createElement)("div",{className:"bwf-p-15 bwf-mtb-10 bwf-lite-restrict-section"},Object(n.createElement)(kt.a,{checked:!1,disabled:!0,label:Object(l.__)("Delay until a specific day(s) of the week","wp-marketing-automations"),onChange:function(){}}),Object(n.createElement)("div",{className:"bwf-delay-field "},Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)(m.ButtonGroup,null,ye.map((function(e,t){return Object(n.createElement)(m.Button,{key:t,isPrimary:!1,isSecondary:!0,onClick:function(){},disabled:!0},e.label)})))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(n.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(n.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(d.T)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))),!Object(c.isEmpty)(Ee())&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-single-automation-notice is-info"},Ee())))},Te=function(e){var t=ue()().format("MM/DD/YYYY");return ue()(t).isSameOrBefore(ue()(e))},Fe=function(){return Object(n.createElement)("div",{className:"bwf-custom-date-delay"},Object(n.createElement)("div",{className:"bwf-delay-field "},O?Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf_w_full bwf-h-15"}):function(){var e=fe.custom_field,t=void 0===e?{field:0,time:"",in_contact_timezone:!1,custom_field_label:""}:e,a=fe.enable_time_delay,r=void 0!==a&&a,i=fe.time_delay,s=void 0===i?{duration:0,type:"days",timing:"after"}:i,b=fe.occurrence,u=void 0===b?"daymonth":b,p=fe.enable_step_skip,f=void 0!==p&&p,O=fe.skip_to_step,j=void 0===O?{step:0,name:""}:O,w=Pe.stepsOptArr,v=Pe.stepsOptions;if(Object(c.isEmpty)(o))return Object(n.createElement)(n.Fragment,null,Object(l.__)("No Custom Field with type Date found","wp-marketing-automations"));var y=[{value:"",label:Object(l.__)("Select Type","wp-marketing-automations")}];Object.keys(o).map((function(e){y.push({label:o[e].hasOwnProperty("name")?o[e].name:"",value:e})}));var g=he();return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(n.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(n.createElement)("div",{className:"bwf-delay-field-select bwf-w-210 "+(ge("custom_field")&&""==t.field?"has-error":"")},Object(n.createElement)(m.SelectControl,{value:t.field,className:"bwf_W_full",options:y,onChange:function(e){return Oe(Ct(Ct({},fe),{},{custom_field:Ct(Ct({},fe.custom_field),{},{field:e,custom_field_label:o[e].name})}))}}),ge("custom_field")&&""==t.field&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please select a custom field.","wp-marketing-automations")))),Object(n.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "+(ge("custom_field")&&""==u?"has-error":"")},Object(n.createElement)(m.SelectControl,{value:u,className:"bwf_w_full",options:[{value:"daymonth",label:Object(l.__)("Use Day & Month","wp-marketing-automations")},{value:"daymonthyear",label:Object(l.__)("Use Full Date","wp-marketing-automations")}],onChange:function(e){return Oe(Ct(Ct({},fe),{},{occurrence:e}))}}))),Object(n.createElement)("div",{className:"bwf-sidebar-hint"},Object(l.__)("Note: Contact would not pass this step if the value of custom field is blank.","wp-marketing-automations"),"daymonth"===u&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("br",null),Object(l.__)("It will pick the day and month from the selected field value and if the time is older than the current time it will increase by one year.","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(n.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(n.createElement)("input",{type:"time",value:t.time,className:"bwf-w-210 bwf-h-36",onChange:function(e){Oe(Ct(Ct({},fe),{},{custom_field:Ct(Ct({},fe.custom_field),{},{time:e.target.value})}))}})),Object(n.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(n.createElement)(kt.a,{checked:t.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){Oe(Ct(Ct({},fe),{},{custom_field:Ct(Ct({},fe.custom_field),{},{in_contact_timezone:e})}))}}))))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(n.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(n.createElement)("div",{className:"bwf-specific-date "+(Object(d.Jb)()?"":"bwf-delay-no-pro")},Object(n.createElement)(kt.a,{checked:r,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(e){Object(d.Jb)()?Oe(Ct(Ct({},fe),{},{enable_time_delay:e})):(S("proModalContent","This"),S("showProModal",!0))}}))),r&&Object(n.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(n.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "+(ge("custom_field")&&parseInt(s.duration)<0?"has-error":"")},Object(n.createElement)(m.TextControl,{className:"bwf-h-36",type:"number",value:s.duration,onChange:function(e){return Oe(Ct(Ct({},fe),{},{time_delay:Ct(Ct({},fe.time_delay),{},{duration:e})}))},min:1,placeholder:Object(l.__)("2","wp-marketing-automations")})),Object(n.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(n.createElement)(m.SelectControl,{value:s.type,className:"bwf_w_full",options:[{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")}],onChange:function(e){return Oe(Ct(Ct({},fe),{},{time_delay:Ct(Ct({},fe.time_delay),{},{type:e})}))}})),Object(n.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(n.createElement)(m.SelectControl,{value:s.timing,className:"bwf_w_full",options:[{value:"before",label:Object(l.__)("Before","wp-marketing-automations")},{value:"after",label:Object(l.__)("After","wp-marketing-automations")}],onChange:function(e){return Oe(Ct(Ct({},fe),{},{time_delay:Ct(Ct({},fe.time_delay),{},{timing:e})}))}}))))),Object(n.createElement)("div",{className:"bwf_clear_20"}),Object(n.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(n.createElement)("div",{className:"bwf-specific-date "+(Object(d.Jb)()?"":"bwf-delay-no-pro")},Object(n.createElement)(kt.a,{checked:f,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(d.Jb)()?Oe(Ct(Ct({},fe),{},{enable_step_skip:e})):(S("proModalContent","This"),S("showProModal",!0))}}))),f&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-delay-skip-step-select bwf-specific-date "+(ge("custom_field")&&""==j.step?"has-error":"")},Object(n.createElement)(m.SelectControl,{value:j.step,className:"bwf_w_full",options:v,onChange:function(e){return Oe(Ct(Ct({},fe),{},{skip_to_step:Ct(Ct({},fe.skip_to_step),{},{step:e,name:w[e]})}))}}),ge("custom_field")&&""==j.step&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))))),""!==g&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-single-automation-notice is-info"},g)))}()))};return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"wr_header"},Object(n.createElement)("div",{className:"bwf-node-icon icon-delay"},Object(n.createElement)(s.a,{size:28,icon:"time-left"})),Object(n.createElement)("div",{className:"wr_event_title"},Object(n.createElement)("span",null,Object(l.__)("Delay","wp-marketing-automations"))),Object(n.createElement)("div",{className:"wr_event_variant"}),Object(n.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){P(!1)}},Object(n.createElement)(s.a,{icon:"close"}))),Object(n.createElement)("div",{className:"wr_content"},Object(n.createElement)("div",{className:"bwf-delay-wrap"},Object(n.createElement)(mt,{selected:be,setSelected:function(e){if(!Object(d.Jb)()&&[2,3].includes(parseInt(e)))return S("proModalContent","This Type"),void S("showProModal",!0);Oe(function(e){switch(e){case 1:return{day_delay:{unit:"min",text:""},enable_time_delay:!1,time_delay:{time:"",in_contact_timezone:!1},enable_week_delay:!1,week_delay:[]};case 2:return{date:"",time_delay:{time:"",in_contact_timezone:!1},enable_step_skip:!1,skip_to_step:{step:0,name:""}};case 3:return{custom_field:{field:"",time:"",in_contact_timezone:!1,custom_field_label:""},time_delay:{duration:0,type:"days",timing:"before"},occurrence:"daymonth",enable_step_skip:!1,skip_to_step:{step:0,name:""}};case 4:return{variable_field:{variable:"",time:"",in_contact_timezone:!1},time_delay:{duration:0,type:"days",timing:"before"},occurrence:"daymonthyear",enable_step_skip:!1,skip_to_step:{step:0,name:""}};default:return{}}}(parseInt(e))),de(e)},options:ve,selectedContent:function(){switch(parseInt(be)){case 1:return Object(n.createElement)(n.Fragment,null,Me());case 2:return Object(n.createElement)(n.Fragment,null,Object(d.Jb)()?(e=fe.date,a=void 0===e?"":e,r=fe.time_delay,o=void 0===r?{time:"",in_contact_timezone:!1}:r,i=fe.enable_step_skip,b=void 0!==i&&i,u=fe.skip_to_step,p=void 0===u?{step:0,name:""}:u,f=Pe.stepsOptArr,O=Pe.stepsOptions,Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-specific-date-time-delay"},Object(n.createElement)("div",{className:"bwf-specific-date bwf_w_full bwf-h-36"},Object(n.createElement)("div",{className:"bwf-delay-field "+(ge("specific_date")?"has-error":"")},Object(n.createElement)(ut.a,{date:Object(c.isEmpty)(a)?null:ue()(a),dateFormat:"MM/DD/YYYY",isInvalidDate:function(e){return!Te(e)},onUpdate:function(e){Te(e.text)?Oe(Ct(Ct({},fe),{},{date:e.text})):(k(Object(l.__)("Invalid Date selected","wp-marketing-automations")),Object(d.wb)(k,3e3))},text:a,iconRight:!0}),ge("specific_date")&&Object(n.createElement)("div",{className:"has-bwfan-error"},t.specific_date))),Object(n.createElement)("div",{className:"bwf-specific-time bwf_w_full"},Object(n.createElement)("div",{className:"bwf-delay-field "+(ge("specific_time")?"has-error":"")},Object(n.createElement)("input",{type:"time",value:o.time,onChange:function(e){Oe(Ct(Ct({},fe),{},{time_delay:Ct(Ct({},fe.time_delay),{},{time:e.target.value})}))},className:"bwf-h-36"}),ge("specific_time")&&Object(n.createElement)("div",{className:"has-bwfan-error"},t.specific_time))),Object(n.createElement)("div",{className:"bwf-specific-date bwf-w-210 "+(Object(d.Jb)()?"":"bwf-delay-no-pro")},Object(d.Jb)()?Object(n.createElement)(kt.a,{checked:o.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){Oe(Ct(Ct({},fe),{},{time_delay:Ct(Ct({},fe.time_delay),{},{in_contact_timezone:e})}))}}):Object(n.createElement)("div",{className:"bwf-cursor-pointer",onClick:function(){S("proModalContent","This"),S("showProModal",!0)}},"In Contact TimeZone"),!Object(d.Jb)()&&Object(n.createElement)(s.a,{icon:"king",size:16}))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-specific-date"},Object(n.createElement)("div",{className:"bwf-specific-date "+(Object(d.Jb)()?"":"bwf-delay-no-pro")},Object(n.createElement)(kt.a,{checked:b,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(d.Jb)()?Oe(Ct(Ct({},fe),{},{enable_step_skip:e})):(S("proModalContent","This"),S("showProModal",!0))}}))),b&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-specific-date "+(ge("specific_date_time_step")?"has-error":"")},Object(n.createElement)(m.SelectControl,{value:p.step,className:"bwf_w_full",options:O,onChange:function(e){return Oe(Ct(Ct({},fe),{},{skip_to_step:Ct(Ct({},fe.skip_to_step),{},{step:e,name:f[e]})}))}}),ge("specific_date_time_step")&&Object(n.createElement)("div",{className:"has-bwfan-error"},t.specific_date_time_step))),!Object(c.isEmpty)(ke())&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-single-automation-notice is-info"},ke())))):Object(n.createElement)(n.Fragment,null));case 3:return Object(n.createElement)(n.Fragment,null,Object(d.Jb)()?Fe():Object(n.createElement)(n.Fragment,null));case 4:return Object(n.createElement)(n.Fragment,null,Object(d.Jb)()?function(){var e=fe.variable_field,t=void 0===e?{variable:"",time:"",in_contact_timezone:!1}:e,a=fe.enable_time_delay,r=void 0!==a&&a,c=fe.time_delay,o=void 0===c?{duration:0,type:"days",timing:"after"}:c,i=fe.occurrence,s=void 0===i?"daymonthyear":i,b=fe.enable_step_skip,u=void 0!==b&&b,p=fe.skip_to_step,f=void 0===p?{step:0,name:""}:p,O=Pe.stepsOptArr,j=Pe.stepsOptions,w=he();return Object(n.createElement)(n.Fragment,null,Object(n.createElement)(ht,{isOpen:E,onRequestClose:h,automationID:W,onSelect:function(e){Oe(Ct(Ct({},fe),{},{variable_field:Ct(Ct({},fe.variable_field),{},{variable:e})}))}}),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(n.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(n.createElement)("div",{className:"bwf-delay-field-select bwf-w-300 "+(ge("variable")&&""==t.variable?"has-error":""),onClick:function(){return h(!0)}},Object(n.createElement)(m.TextControl,{value:t.variable,disabled:!0}),ge("variable")&&""==t.variable&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please select a variable.","wp-marketing-automations")))),Object(n.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field ",onClick:function(){return h(!0)}},Object(n.createElement)(m.Button,{isSecondary:!0},"Select")),Object(n.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "},Object(n.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field "+(ge("variable")&&""==s?"has-error":"")},Object(n.createElement)(m.SelectControl,{value:s,className:"bwf_w_full",options:[{value:"daymonth",label:Object(l.__)("Use Day & Month","wp-marketing-automations")},{value:"daymonthyear",label:Object(l.__)("Use Full Date","wp-marketing-automations")}],onChange:function(e){return Oe(Ct(Ct({},fe),{},{occurrence:e}))}})))),Object(n.createElement)("div",{className:"bwf-sidebar-hint"},Object(l.__)("Note: If key value is not present it will run immediately.","wp-marketing-automations"),"daymonth"===s&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("br",null),Object(l.__)("It will pick the day and month from the selected field value and if the time is older than the current time it will increase by one year.","wp-marketing-automations"))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(n.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(n.createElement)("input",{type:"time",value:t.time,className:"bwf-w-210 bwf-h-36",onChange:function(e){Oe(Ct(Ct({},fe),{},{variable_field:Ct(Ct({},fe.variable_field),{},{time:e.target.value})}))}})),Object(n.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(n.createElement)(kt.a,{checked:t.in_contact_timezone,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(e){Oe(Ct(Ct({},fe),{},{variable_field:Ct(Ct({},fe.variable_field),{},{in_contact_timezone:e})}))}}))))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(n.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(n.createElement)("div",{className:"bwf-specific-date "+(Object(d.Jb)()?"":"bwf-delay-no-pro")},Object(n.createElement)(kt.a,{checked:r,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(e){Object(d.Jb)()?Oe(Ct(Ct({},fe),{},{enable_time_delay:e})):(S("proModalContent","This"),S("showProModal",!0))}}))),r&&Object(n.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(n.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "+(ge("custom_field")&&parseInt(o.duration)<0?"has-error":"")},Object(n.createElement)(m.TextControl,{className:"bwf-h-36",type:"number",value:o.duration,onChange:function(e){return Oe(Ct(Ct({},fe),{},{time_delay:Ct(Ct({},fe.time_delay),{},{duration:e})}))},min:1,placeholder:Object(l.__)("2","wp-marketing-automations")})),Object(n.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(n.createElement)(m.SelectControl,{value:o.type,className:"bwf_w_full",options:[{value:"days",label:Object(l.__)("Days","wp-marketing-automations")},{value:"weeks",label:Object(l.__)("Weeks","wp-marketing-automations")}],onChange:function(e){return Oe(Ct(Ct({},fe),{},{time_delay:Ct(Ct({},fe.time_delay),{},{type:e})}))}})),Object(n.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(n.createElement)(m.SelectControl,{value:o.timing,className:"bwf_w_full",options:[{value:"before",label:Object(l.__)("Before","wp-marketing-automations")},{value:"after",label:Object(l.__)("After","wp-marketing-automations")}],onChange:function(e){return Oe(Ct(Ct({},fe),{},{time_delay:Ct(Ct({},fe.time_delay),{},{timing:e})}))}}))))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(n.createElement)("div",{className:"bwf-specific-date "+(Object(d.Jb)()?"":"bwf-delay-no-pro")},Object(n.createElement)(kt.a,{checked:u,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(e){Object(d.Jb)()?Oe(Ct(Ct({},fe),{},{enable_step_skip:e})):(S("proModalContent","This"),S("showProModal",!0))}}))),u&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-delay-skip-step-select bwf-delay-field "+(ge("variable")&&""==f.step?"has-error":"")},Object(n.createElement)(m.SelectControl,{value:f.step,className:"bwf_w_full",options:j,onChange:function(e){return Oe(Ct(Ct({},fe),{},{skip_to_step:Ct(Ct({},fe.skip_to_step),{},{step:e,name:O[e]})}))}}),ge("variable")&&""==f.step&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("Please choose the target step if time passes.","wp-marketing-automations"))))),""!==w&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-single-automation-notice is-info"},w)))}():Object(n.createElement)(n.Fragment,null));default:return Object(n.createElement)(n.Fragment,null)}var e,a,r,o,i,b,u,p,f,O}(),liteDummyData:{2:Object(n.createElement)("div",{className:"bwf-pl-30 bwf-lite-restrict-section"},Object(n.createElement)("div",{className:"bwf-specific-date-time-delay"},Object(n.createElement)("div",{className:"bwf-specific-date bwf_w_full bwf-h-36"},Object(n.createElement)("div",{className:"bwf-delay-field ",style:{pointerEvents:"none"}},Object(n.createElement)(ut.a,{date:null,dateFormat:"MM/DD/YYYY",onUpdate:function(){},text:"",iconRight:!0,disabled:!0}))),Object(n.createElement)("div",{className:"bwf-specific-time bwf_w_full"},Object(n.createElement)("div",{className:"bwf-delay-field "},Object(n.createElement)("input",{type:"time",value:"",disabled:!0,onChange:function(){},className:"bwf-h-36"}))),Object(n.createElement)("div",{className:"bwf-specific-date bwf-w-210 "},Object(n.createElement)(kt.a,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-specific-date"},Object(n.createElement)("div",{className:"bwf-specific-date "},Object(n.createElement)(kt.a,{checked:!1,disabled:!0,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),onChange:function(){}}))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-specific-date "},Object(n.createElement)(m.SelectControl,{value:"",disabled:!0,className:"bwf_w_full",options:[],onChange:function(){}})),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(n.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(n.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(d.T)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations")))),3:Object(n.createElement)("div",{className:"bwf-pl-30 bwf-lite-restrict-section"},Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-delay-field bwf-delay-select-field-wrap"},Object(n.createElement)("div",{className:"bwf-pt-0 bwf-pb-0"},Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full align-start"},Object(n.createElement)("div",{className:"bwf-delay-field-select bwf-w-210 "},Object(n.createElement)(m.SelectControl,{value:"",className:"bwf_W_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0})),Object(n.createElement)("div",{className:"bwf-delay-occurrence bwf-delay-field bwf-w-210 "},Object(n.createElement)(m.SelectControl,{value:"",className:"bwf_w_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0}))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(n.createElement)("div",{className:"bwf-delay-select-field-time bwf-w-210"},Object(n.createElement)("input",{type:"time",value:"",disabled:!0,className:"bwf-w-210 bwf-h-36",onChange:function(){}})),Object(n.createElement)("div",{className:"bwf-delay-select-field-timezone bwf-w-210"},Object(n.createElement)(kt.a,{checked:!1,disabled:!0,label:Object(l.__)("In Contact Timezone","wp-marketing-automations"),onChange:function(){}}))))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-delay-field bwf-delay-sidebar-custom-field"},Object(n.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(n.createElement)("div",{className:"bwf-specific-date "},Object(n.createElement)(kt.a,{checked:!1,label:Object(l.__)("Delay for certain days from field date","wp-marketing-automations"),onChange:function(){},disabled:!0}))),Object(n.createElement)("div",{className:"bwf-pt-0 bwf-pb-0 bwf-delay-sidebar-custom-delay-wrap"},Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-display-flex bwf-flex-start bwf_w_full"},Object(n.createElement)("div",{className:"bwf-delay-duration bwf-w-210 "},Object(n.createElement)(m.TextControl,{className:"bwf-h-36",type:"number",disabled:!0,value:"",onChange:function(){},min:1,placeholder:Object(l.__)("Enter","wp-marketing-automations")})),Object(n.createElement)("div",{className:"bwf-delay-type bwf-w-210"},Object(n.createElement)(m.SelectControl,{value:"",className:"bwf_w_full",options:[{label:Object(l.__)("Select","wp-marketing-automations"),value:""}],onChange:function(){},disabled:!0})),Object(n.createElement)("div",{className:"bwf-delay-timing bwf-w-170"},Object(n.createElement)(m.SelectControl,{value:"",disabled:!0,className:"bwf_w_full",options:[],onChange:function(){}}))))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-delay-skip-step bwf-specific-date"},Object(n.createElement)("div",{className:"bwf-specific-date "},Object(n.createElement)(kt.a,{checked:!1,label:Object(l.__)("Jump to step if time has passed","wp-marketing-automations"),disabled:!0,onChange:function(){}}))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-single-automation-notice is-info no-icon"},Object(n.createElement)("b",null,Object(l.__)("This feature is only for licensed Pro users.","wp-marketing-automations"))," ",Object(n.createElement)("a",{target:"__blank",className:"bwf-a-no-underline",href:Object(d.T)("upgrade",{utm_medium:"Get+PRO+Delay+Step"})},Object(l.__)("Learn More","wp-marketing-automations"))))}}),y&&Object(n.createElement)("div",{className:"bwf-single-automation-notice"},Object(l.__)("There can be contacts queued at this step, new settings will apply to all of them.","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf_clear_24"}))),Object(n.createElement)("div",{className:"wr_footer"},Object(n.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return P(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(n.createElement)(j.a,{isPrimary:!0,onClick:we,isBusy:x,className:"bwf-no-ripple"},Object(l.__)("Save","wp-marketing-automations"))))},Ft=a(463),Lt=a(109);function Rt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function zt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(a),!0).forEach((function(t){Jt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Rt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Jt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ut(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function qt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Bt(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Bt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Ht=function(){var e=Object(n.useContext)(d.h),t=qt(Object(n.useState)(""),2),a=(t[0],t[1]),r=qt(Object(n.useState)(!1),2),o=r[0],i=r[1],m=qt(Object(n.useState)(!1),2),p=m[0],O=m[1],w=qt(Object(n.useState)(!1),2),v=w[0],y=w[1],g=qt(Object(n.useState)(""),2),_=g[0],E=g[1];Object(n.useEffect)((function(){i(!1)}),[]);var h,k,N=Object(b.a)(),P=N.showSidebar,C=N.setNodeDatabyId,S=N.setAutomationData,A=Object(u.a)(),D=A.getSidebarNodeData,x=A.getAutomationId,I=A.getNodeDataByID,M=A.getAutomationLinks,T=A.getAutomationSteps,F=A.getCount,L=A.getAutomationData,R=(0,A.getautomationMeta)(),z=T(),J=M(),q=F(),B=D(),H=x(),V=L(),G=V&&V.event?V.event:"",$=Object(W.a)(G,parseInt(H)),Y=($.isLoading,$.error,$.rules),Q=!Object(c.isEmpty)(B)&&B.hasOwnProperty("data")?B.data:{},X=!Object(c.isEmpty)(Q)&&Q.hasOwnProperty("sidebarValues")?(h=Q.sidebarValues,k=[],Object(c.isEmpty)(h)?[]:(Object.keys(h).map((function(e){var t=h[e],a=[];t.map((function(e){Y.hasOwnProperty(e.filter)&&a.push(e)})),Object(c.isEmpty)(a)||k.push(a)})),k)):[],Z=!Object(c.isEmpty)(B)&&B.hasOwnProperty("id")?I(B.id):{},K=Z.stepId,ee=void 0===K?0:K,te=Z.data,ae=(void 0===te?{}:te).sidebarValues,ne=function(){var t,n=(t=regeneratorRuntime.mark((function t(){var n,r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Object(d.Jb)()){t.next=4;break}return S("proModalContent",Object(l.__)("Conditional Step","wp-marketing-automations")),S("showProModal",!0),t.abrupt("return");case 4:if(n=Object(c.cloneDeep)(Q.sidebarValues),r=[],o=!1,Object(c.isEmpty)(n)||n.map((function(e){Object(c.isEmpty)(e)||(r.push(e),e.map((function(e){var t;(t=e).hasOwnProperty("rule")&&["is_blank","is_not_blank"].includes(t.rule)||!(!t.hasOwnProperty("data")||""==t.data||null==t.data||Array.isArray(t.data)&&Object(c.isEmpty)(t.data)||Y&&Y.hasOwnProperty(t.filter)&&"key-value"==Y[t.filter].input.component&&(""==t.data[0]||null==t.data[0]||Array.isArray(t.data[1])&&Object(c.isEmpty)(t.data[1])||""==t.data[1]||null==t.data[1]||Array.isArray(t.data[1])&&Object(c.isEmpty)(t.data[1]))||Y&&Y.hasOwnProperty(t.filter)&&["Date","Days","datetime"].includes(Y[t.filter].input.component)&&"between"===t.rule&&(!t.data.hasOwnProperty("to")||!t.data.hasOwnProperty("from")||Object(c.isEmpty)(t.data.to)||Object(c.isEmpty)(t.data.from)))||(i(!0),o=!0,a(Object(l.__)("Some condition(s) are empty please remove them or fill them.","wp-marketing-automations")))})))})),Object(c.isEmpty)(r)||o){t.next=27;break}if(!Object(c.isEqual)(ae,r)){t.next=13;break}return P(!1),O(!1),t.abrupt("return");case 13:return O(!0),s={data:{data:{sidebarData:r}},steps:Object(c.cloneDeep)(z).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:J,count:q},t.prev=15,t.next=18,f()({path:Object(d.u)("/automation/".concat(H,"/step/").concat(ee)),method:"POST",data:s}).then((function(t){if(200!==t.code)throw Error(Object(d.p)(null==t?void 0:t.message));e(t.message),Q.sidebarValues=r,C(B.id,Q,{step_status:1}),t.hasOwnProperty("result")&&t.result.hasOwnProperty("meta")&&S("meta",zt(zt({},R),t.result.meta)),setTimeout((function(){P(!1)}),100),O(!1)})).catch((function(e){throw Error(Object(d.p)(null==e?void 0:e.message))}));case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(15),S("modalData",{status:!0,modalTitle:Object(l.__)("Update Condition","wp-marketing-automations"),error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),O(!1);case 24:Object(d.wb)(e,3e3),t.next=28;break;case 27:!o&&a(Object(l.__)("Please select conditions to save.","wp-marketing-automations"));case 28:case"end":return t.stop()}}),t,null,[[15,20]])})),function(){var e=this,a=arguments;return new Promise((function(n,r){var c=t.apply(e,a);function o(e){Ut(c,n,r,o,i,"next",e)}function i(e){Ut(c,n,r,o,i,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}(),re=Object(n.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object.keys(X).length,a=Object(c.cloneDeep)(X);a[t]=[e];var n=zt(zt({},B),{},{data:zt(zt({},Q),{},{sidebarValues:a})});S("sidebarNodeData",n),setTimeout((function(){E(""),y(!1)}),1)}),[X]),ce=(Object(n.useCallback)((function(e){var t=zt({},X);delete t[e];var a=zt(zt({},B),{},{data:zt(zt({},Q),{},{sidebarValues:t})});S("sidebarNodeData",a)}),[X]),function(){return Object(n.createElement)("ul",{className:"bwf-popover-container bwf-group"},Object(n.createElement)("li",{className:"list-label"},Object(l.__)("Select Group","wp-marketing-automations")),function(){var e=[],t=[];Object.entries(Y).map((function(a){var n=qt(a,2),r=(n[0],n[1]);e.includes(r.group)||(e.push(r.group),t.push({priority:r.priority?r.priority:0,key:r.group,label:r.groupLabel}))}));return t.sort((function(e,t){return e.priority-t.priority})),t}().map((function(e,t){return Object(n.createElement)("li",{className:"list-values has-pointer",onClick:function(){return E(e.key)},key:t},e.label,Object(n.createElement)("span",{className:"bwf-svgtailf-arrow"},Object(n.createElement)(s.a,{icon:"tailless-arrow-forward",size:14,color:"#353030"})))})))}),oe=function(){return Object(n.createElement)("ul",{className:"bwf-popover-container bwf-filters"},Object(n.createElement)("li",{className:"list-label list-values has-pointer is-back-button",onClick:function(){return E("")}},Object(n.createElement)("span",{className:"bwf-svgtailb-arrow"},Object(n.createElement)(s.a,{icon:"tailless-arrow-forward",size:14,color:"#353030"})),Object(l.__)("Back","wp-marketing-automations")),(e=[],Object.entries(Y).map((function(t){var a=qt(t,2),n=a[0],r=a[1];(Object(c.isEmpty)(_)||_===r.group)&&e.push({key:n,label:r.labels.add})})),e).map((function(e,t){return Object(n.createElement)("li",{className:"list-values has-pointer",onClick:function(){re({filter:e.key,rule:"",data:""})},key:t},e.label)})));var e},ie=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e?"bwf-sidebar-empty-placeholder ":"";return Object(n.createElement)("div",{className:t},e&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-main-icon"},Object(n.createElement)(s.a,{icon:"conditional-placeholder",size:90})),Object(n.createElement)("div",{className:"bwf-h2"},Object(l.__)("No Condition","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf-h4 bwf-h4-grey bwf-mb-0"},Object(l.__)("Add a condition to segment and make contacts flow to different branches","wp-marketing-automations"))),e&&Object(n.createElement)("div",{className:"bwf_clear_24"}),!Object(c.isEmpty)(Y)&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)(j.a,{isPrimary:!0,className:"bwf-no-ripple "+(e?"":"bwf-conditional-btn conditional-or"),onClick:function(){return y(!0)},style:e?{}:{margin:"-38px 0px 0px 62px",position:"absolute"}},e?Object(l.__)("Add New Condition","wp-marketing-automations"):Object(l.__)("OR","wp-marketing-automations"),v&&Object(n.createElement)(U.a,{className:"bwf-conditioal-group-popup "+(e?"":"bwf-conditional-or"),focusOnMount:!0,onFocusOutside:function(){return y(!1)},onClose:function(){return y(!1)}},Object(c.isEmpty)(_)?ce():oe())),e&&Object(n.createElement)("div",{className:"bwf_clear_48"})))};return Object(n.createElement)(d.f.Provider,{value:{errorList:o,setErrorList:i,stepId:ee}},Object(n.createElement)("div",{className:"wr_header"},Object(n.createElement)("div",{className:"bwf-node-icon"},Object(n.createElement)(s.a,{size:26,icon:"condition"})),Object(n.createElement)("div",{className:"wr_event_title"},Object(l.__)("Condition","wp-marketing-automations"),!Object(d.Jb)()&&Object(n.createElement)(Lt.a,null)),Object(n.createElement)("div",{className:"wr_event_variant"}),Object(n.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){P(!1)}},Object(n.createElement)(s.a,{icon:"close"}))),Object(n.createElement)("div",{className:"wr_content wr-conditioal-sidebar"},Object(c.isEmpty)(X)||Object(c.isEmpty)(Y)?Object(n.createElement)(n.Fragment,null,ie()):Object(n.createElement)(n.Fragment,null,Object.keys(X).map((function(e,t){return Object(n.createElement)("div",{className:"bwf-conditional-wrap",key:t},Object(n.createElement)(Ft.a,{key:e,filters:Y,groupingEnabled:!0,value:X[e],setValue:function(t){var a=Object(c.cloneDeep)(X);a[e]=t,a=a.filter((function(e){return 0!==Object.keys(e).length}));var n=zt(zt({},B),{},{data:zt(zt({},Q),{},{sidebarValues:a})});S("sidebarNodeData",n)}}),t+1!==Object.keys(X).length&&Object(n.createElement)("div",{className:"bwf-conditional-rules-label-or"},Object(n.createElement)("span",{className:"bwf-line"}),Object(n.createElement)("span",{className:"bwf-rule-text"},Object(l.__)("OR","wp-marketing-automations"))))})),ie(!1)),Object(n.createElement)("div",{className:"bwf_clear_24"})),Object(n.createElement)("div",{className:"wr_footer"},Object(n.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return P(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(n.createElement)(j.a,{isPrimary:!0,className:"bwf-no-ripple",onClick:ne,isBusy:p},!Object(d.Jb)()&&Object(n.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),Object(l.__)("Save","wp-marketing-automations"))))};function Vt(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function Wt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Gt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Wt(Object(a),!0).forEach((function(t){$t(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Wt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function $t(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Qt(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Qt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Xt=function(){var e=Object(n.useContext)(d.h),t=Yt(Object(n.useState)(!1),2),a=t[0],r=t[1],o=Yt(Object(n.useState)(!1),2),m=o[0],p=o[1],O=Yt(Object(n.useState)(!1),2),w=O[0],v=O[1],y=Object(u.a)(),g=y.getSidebarNodeData,_=y.getNodeDataByID,E=y.getAutomationSteps,h=y.getAutomationLinks,k=y.getCount,N=y.getAutomationId,P=y.getGoals,C=y.getautomationMeta,S=Object(b.a)(),A=S.showSidebar,D=S.setNodeDatabyId,x=S.setAutomationData,I=Object(n.useRef)(null),M=Yt(Object(n.useState)([]),2),T=M[0],F=M[1],L=g(),R=P().list,z=void 0===R?{}:R,J=C(),U=L.data,q=L&&L.data&&L.data.benchmark&&z.hasOwnProperty(L.data.benchmark)?z[L.data.benchmark]:{},B=L&&L.data&&L.data.benchmark?L.data.benchmark:"",H=!Object(c.isEmpty)(L.data)&&L.data.hasOwnProperty("sidebarValues")?L.data.sidebarValues:{},V=q.fields,W=void 0===V?[]:V,G=q.default_values,$=void 0===G?{}:G,Y=N(),Q=E(),X=h(),Z=k(),K=!Object(c.isEmpty)(L)&&L.hasOwnProperty("id")?_(L.id):{},ee=K.stepId,te=void 0===ee?0:ee,ae=K.data,ne=(void 0===ae?{}:ae).sidebarValues;Object(n.useEffect)((function(){F([])}),[]);var re=Gt(Gt({},$),H),ce=function(e,t,a){var n=!1,r=t.fields,c=t.relation,o=void 0===c?"OR":c;o=o.toUpperCase();try{var i=null;if("OR"===o){if(r&&Array.isArray(r))for(var l=0;l<r.length;l++){i=e[r[l].id];var s=void 0===r[l].value||r[l].value;if(Array.isArray(s)&&s.includes(i))return!0;if(""!=s&&i==s||""==s&&""!=i&&null!=i)return!0}}else"AND"==o&&r&&Array.isArray(r)&&(n=r.every((function(t){i=e[t.id];var a=void 0===t.value||t.value;return!(!Array.isArray(a)||!a.includes(i))||(""===a||i==a)&&(""!=a||""!=i&&null!=i)})))}catch(e){console.log(e)}return n},oe=function(){var t,a=(t=regeneratorRuntime.mark((function t(a){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Object(d.Jb)()){t.next=4;break}return x("proModalContent",Object(l.__)("Goal Step","wp-marketing-automations")),x("showProModal",!0),t.abrupt("return");case 4:if(!Object(c.isEmpty)(le(a))){t.next=21;break}if(!Object(c.isEqual)(ne,a)){t.next=8;break}return A(!1),t.abrupt("return");case 8:return U.sidebarValues=a,r(!0),n={data:{data:{sidebarData:a}},steps:Object(c.cloneDeep)(Q).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:X,count:Z,optionUpdated:m,actionType:3},t.prev=11,t.next=14,f()({path:Object(d.u)("/automation/".concat(Y,"/step/").concat(te)),method:"POST",data:n}).then((function(t){if(200!==t.code)throw Error(Object(d.p)(null==t?void 0:t.message));e(t.message);var a="";t.hasOwnProperty("result")&&t.result.hasOwnProperty("desc_text")&&!Object(c.isEmpty)(t.result.desc_text)&&(a=t.result.desc_text),t.hasOwnProperty("result")&&t.result.hasOwnProperty("meta")&&x("meta",Gt(Gt({},J),t.result.meta)),D(L.id,Gt(Gt({},U),{},{desc_text:a}),{step_status:1}),setTimeout((function(){A(!1)}),100),r(!1)})).catch((function(e){throw Error(Object(d.p)(null==e?void 0:e.message))}));case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(11),x("modalData",{status:!0,modalTitle:Object(l.__)("Update Goal","wp-marketing-automations"),error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),r(!1);case 20:Object(d.wb)(e,3e3);case 21:case"end":return t.stop()}}),t,null,[[11,16]])})),function(){var e=this,a=arguments;return new Promise((function(n,r){var c=t.apply(e,a);function o(e){Vt(c,n,r,o,i,"next",e)}function i(e){Vt(c,n,r,o,i,"throw",e)}o(void 0)}))});return function(e){return a.apply(this,arguments)}}(),ie=[];Object(c.isEmpty)(W)||W.forEach((function(e){e.hasOwnProperty("required")&&e.required&&ie.push(e)}));var le=function(e){var t={};return ie.map((function(a){(!a.hasOwnProperty("toggler")||Object(c.isEmpty)(a.toggler)||ce(e,a.toggler))&&(Array.isArray(e[a.id])&&0===e[a.id].length||""===e[a.id]||void 0===e[a.id])&&(t[a.id]=a.hasOwnProperty("errorMsg")?a.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations")),"bwfan_email_data"===a.id&&(!e.hasOwnProperty("bwfan_email_data")||e.bwfan_email_data.hasOwnProperty("subject")&&Object(c.isEmpty)(e.bwfan_email_data.subject))&&(t[a.id]="error")})),F(t),t};return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"wr_header"},Object(n.createElement)("div",{className:"bwf-node-icon icon-goal"},Object(n.createElement)(s.a,{size:26,icon:"goal"})),Object(n.createElement)("div",{className:"wr_event_title"},q.event_name,!Object(d.Jb)()&&Object(n.createElement)(Lt.a,null)),Object(n.createElement)("div",{className:"wr_event_variant"},Object(d.Jb)()&&!Object(c.isEmpty)(B)&&"crm_link_trigger"===B&&Object(n.createElement)(Fe.a,{canCreate:!0,isLinkTriggerOpen:w,setLinkTriggerOpen:v,hideButton:!1})),Object(n.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return A(!1)}},Object(n.createElement)(s.a,{icon:"close"}))),Object(n.createElement)(d.f.Provider,{value:{errorList:T,setErrorList:F,stepId:te}},Object(n.createElement)(Me.a,{onSubmit:function(e){oe(e)},initialValues:re,validate:function(e){return p(function(e){var t=U.sidebarValues,a=void 0===t?{}:t;if(Object(c.isEmpty)(a))return!1;var n=re.bwfan_goal_run,r=void 0===n?"":n,o=e.bwfan_goal_run;return r!==(void 0===o?"":o)&&"wait"===r}(e)),!1}},(function(e){var t=e.getInputProps,r=e.values,o=e.errors,b=e.handleSubmit;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"wr_content",ref:I},Object(n.createElement)("div",null,W.map((function(e,a){return Object(n.createElement)(n.Fragment,{key:a},(Object(c.isEmpty)(e.toggler)||ce(r,e.toggler))&&e.wrap_before&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(n.createElement)(n.Fragment,null,!1!==e.show&&(Object(c.isEmpty)(e.toggler)||ce(r,e.toggler))&&Object(n.createElement)(Te.a,{input:e,formProps:t(e.id),values:r})):e.hint?Object(n.createElement)(n.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(c.isEmpty)(e.toggler)||ce(r,e.toggler))&&e.wrap_after&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))}))),m&&Object(n.createElement)("div",{className:"bwf-single-automation-notice"},Object(l.__)("There can be contacts queued at this step, new settings will apply to all of them.","wp-marketing-automations"))),Object(n.createElement)("div",{className:"wr_footer"},Object(n.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return A(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(n.createElement)(j.a,{isPrimary:!0,onClick:function(){b()},className:"bwf-no-ripple",isBusy:a,disabled:Object.keys(o).length},!Object(d.Jb)()&&Object(n.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),Object(l.__)("Save","wp-marketing-automations"))))}))))},Zt=a(189);function Kt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ea(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(a),!0).forEach((function(t){ta(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Kt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ta(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function aa(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function na(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ra(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ra(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ra(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var ca=function(){var e=Object(n.useContext)(d.h),t=na(Object(n.useState)(!1),2),a=t[0],r=t[1],o=Object(u.a)(),m=o.getSelectedEventData,p=o.getAutomationId,O=o.getautomationMeta,w=Object(b.a)(),v=w.showSidebar,y=w.setAutomationData,g=p(),_=Object(n.useRef)(null),E=na(Object(n.useState)(!1),2),h=E[0],k=E[1],N=na(Object(n.useState)([]),2),P=N[0],C=N[1],S=O(),A=m(),D=!Object(c.isEmpty)(S)&&S.hasOwnProperty("event_meta")?S.event_meta:{},x=Object(c.isEmpty)(A)?{}:A,I=x.fields,M=void 0===I?[]:I,T=x.default_values,F=void 0===T?{}:T,L=x.need_unique_key,R=void 0!==L&&L;Object(n.useEffect)((function(){C([]),k(!1)}),[]);var z=function(e,t,a){var n=!1,r=t.fields,c=t.relation,o=void 0===c?"OR":c;o=o.toUpperCase();try{var i=null;if("OR"===o){if(r&&Array.isArray(r))for(var l=0;l<r.length;l++){i=e[r[l].id];var s=void 0===r[l].value||r[l].value;if(Array.isArray(s)&&s.includes(i))return!0;if(""!=s&&i==s||""==s&&""!=i&&null!=i)return!0}}else"AND"==o&&r&&Array.isArray(r)&&(n=r.every((function(t){i=e[t.id];var a=void 0===t.value||t.value;return!(!Array.isArray(a)||!a.includes(i))||(""===a||i==a)&&(""!=a||""!=i&&null!=i)})))}catch(e){console.log(e)}return n},J=function(){var t,a=(t=regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Object(c.isEmpty)(q(a))){t.next=15;break}if(!Object(c.isEqual)(D,a)){t.next=4;break}return v(!1),t.abrupt("return");case 4:return r(!0),t.prev=5,t.next=8,f()({path:Object(d.u)("/automation/".concat(g,"/")),method:"POST",data:{data:{meta:{event_meta:a},isWebhook:R}}}).then((function(t){if(200!==t.code)throw Error(Object(d.p)(null==t?void 0:t.message));e(t.message);var n=ea({},a);R&&D.hasOwnProperty("webhook_data")&&(n.webhook_data=D.webhook_data),y("meta",ea(ea({},S),{},{event_meta:n})),setTimeout((function(){v(!1)}),100),r(!1)})).catch((function(e){throw Error(Object(d.p)(null==e?void 0:e.message))}));case 8:t.next=14;break;case 10:t.prev=10,t.t0=t.catch(5),y("modalData",{status:!0,modalTitle:Object(l.__)("Update Event","wp-marketing-automations"),error:null===t.t0||void 0===t.t0?void 0:t.t0.message}),r(!1);case 14:Object(d.wb)(e,3e3);case 15:case"end":return t.stop()}}),t,null,[[5,10]])})),function(){var e=this,a=arguments;return new Promise((function(n,r){var c=t.apply(e,a);function o(e){aa(c,n,r,o,i,"next",e)}function i(e){aa(c,n,r,o,i,"throw",e)}o(void 0)}))});return function(e){return a.apply(this,arguments)}}(),U=[];Object(c.isEmpty)(M)||M.forEach((function(e){e.hasOwnProperty("required")&&e.required&&U.push(e)}));var q=function(e){var t={};return U.map((function(a){(!a.hasOwnProperty("toggler")||Object(c.isEmpty)(a.toggler)||z(e,a.toggler))&&(Array.isArray(e[a.id])&&0===e[a.id].length||""===e[a.id]||void 0===e[a.id])&&(t[a.id]=a.hasOwnProperty("errorMsg")?a.errorMsg:Object(l.__)("This is required field.","wp-marketing-automations")),"bwfan_email_data"===a.id&&(!e.hasOwnProperty("bwfan_email_data")||e.bwfan_email_data.hasOwnProperty("subject")&&Object(c.isEmpty)(e.bwfan_email_data.subject))&&(t[a.id]="error"),"bwf_form_submit"===a.type&&(e.hasOwnProperty("bwfan-form-field-map")&&e["bwfan-form-field-map"].hasOwnProperty("bwfan_email_field_map")&&""!==e["bwfan-form-field-map"].bwfan_email_field_map||(t["bwfan-form-email-field-map"]="error"))})),C(t),t};return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"wr_header"},Object(n.createElement)("div",{className:"bwf-node-icon icon-start"},Object(n.createElement)(s.a,{size:22,icon:"rocket"})),Object(n.createElement)("div",{className:"wr_event_title"},A.hasOwnProperty("event_name")?A.event_name:""),Object(n.createElement)("div",{className:"wr_event_variant"}),Object(n.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){return v(!1)}},Object(n.createElement)(s.a,{icon:"close"}))),Object(n.createElement)(d.f.Provider,{value:{errorList:P,setErrorList:C}},Object(n.createElement)(Me.a,{onSubmit:function(e){J(e)},initialValues:ea(ea({},F),D),validate:function(){return!1}},(function(e){var t=e.getInputProps,r=e.values,o=e.errors,s=e.handleSubmit;return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"wr_content",ref:_},Object(n.createElement)("div",null,M.map((function(e,a){return Object(n.createElement)(n.Fragment,{key:a},(Object(c.isEmpty)(e.toggler)||z(r,e.toggler))&&e.wrap_before&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_before}}),e.type?Object(n.createElement)(n.Fragment,null,!1!==e.show&&(Object(c.isEmpty)(e.toggler)||z(r,e.toggler))&&Object(n.createElement)(Te.a,{input:e,formProps:t(e.id),values:r})):e.hint?Object(n.createElement)(n.Fragment,{dangerouslySetInnerHTML:{__html:e.hint},className:i()(e.class)}):null,(Object(c.isEmpty)(e.toggler)||z(r,e.toggler))&&e.wrap_after&&Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:e.wrap_after}}))})))),Object(n.createElement)("div",{className:"wr_footer"},Object(n.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return v(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(n.createElement)(j.a,{isPrimary:!0,onClick:function(){s()},className:"bwf-no-ripple",isBusy:a,disabled:Object.keys(o).length},Object(l.__)("Save","wp-marketing-automations"))))}))),Object(d.Jb)()&&Object(n.createElement)(Zt.a,{isOpen:h,setOpenTags:k}))};function oa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ia(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?oa(Object(a),!0).forEach((function(t){la(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):oa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function la(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function sa(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function ma(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ba(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ba(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var ua=function(){var e=ma(Object(n.useState)(!1),2),t=e[0],a=e[1],r=ma(Object(n.useState)(!1),2),o=r[0],i=r[1],p=ma(Object(n.useState)({step:"",name:""}),2),O=p[0],w=p[1],v=Object(n.useContext)(d.h),y=Object(b.a)(),g=y.showSidebar,_=y.setNodeDatabyId,E=y.fetchSplitPathNodes,h=y.setAutomationData,k=Object(u.a)(),N=k.getSidebarNodeData,P=k.getNodeDataByID,C=k.getAutomationId,S=k.getAutomationLinks,A=k.getAutomationSteps,D=k.getCount,x=k.getActionsList,I=k.getGoals,M=k.getautomationMeta,T=N(),F=C(),L=A(),R=S(),z=D(),J=x(),U=I(),q=M(),B=E(),H=!Object(c.isEmpty)(T)&&T.hasOwnProperty("id")?P(T.id):{},V=(H.id,H.stepId),W=void 0===V?0:V,G=H.data,$=(void 0===G?{}:G).sidebarValues;Object(n.useEffect)((function(){a({}),a(!1)}),[]);var Y=!Object(c.isEmpty)(T)&&T.hasOwnProperty("data")?T.data:{},Q=!Object(c.isEmpty)(Y)&&Y.hasOwnProperty("sidebarValues")?Y.sidebarValues:{};Object(n.useEffect)((function(){Q.hasOwnProperty("jump_to")&&!Object(c.isEmpty)(Q.jump_to)&&w(Q.jump_to)}),[Q]);var X={action:Object(l.__)("Action","wp-marketing-automations"),wait:Object(l.__)("Delay","wp-marketing-automations"),conditional:Object(l.__)("Conditional","wp-marketing-automations"),exit:Object(l.__)("Exit","wp-marketing-automations"),benchmark:Object(l.__)("Goal","wp-marketing-automations")},Z=Object(n.useMemo)((function(){var e={stepsOptArr:[],stepsOptions:[{value:"",label:Object(l.__)("Select Step","wp-marketing-automations")}]};return Object(c.isEmpty)(L)||(L.map((function(t){var a=t.stepId,n=void 0===a?0:a,r=t.id,c=void 0===r?0:r;if(!["yesNoNode","start","end","exit","jump","split","splitpath"].includes(t.type)&&!e.stepsOptArr.hasOwnProperty(c)&&!B.includes(c)){var o=[Object(l.__)("Step","wp-marketing-automations")];o.push(c),X.hasOwnProperty(t.type)&&o.push(" : "+X[t.type]),"action"==t.type&&t.hasOwnProperty("data")&&J.list.hasOwnProperty(t.data.selected)&&J.list[t.data.selected].hasOwnProperty("action_name")&&(J.list[t.data.selected].hasOwnProperty("integration_nicename")?o.push(" - "+J.list[t.data.selected].integration_nicename+" : "):o.push(" - "),o.push(J.list[t.data.selected].action_name)),"benchmark"==t.type&&t.hasOwnProperty("data")&&U.list.hasOwnProperty(t.data.benchmark)&&U.list[t.data.benchmark].hasOwnProperty("event_name")&&(U.list[t.data.benchmark].hasOwnProperty("source_label")&&o.push(U.list[t.data.benchmark].source_label+" : "),o.push(U.list[t.data.benchmark].event_name)),e.stepsOptArr[n]=o.join(" "),e.stepsOptions.push({value:n,label:o.join(" ")})}})),e.stepsOptArr.end=Object(l.__)("End Automation","wp-marketing-automations"),e.stepsOptions.push({value:"end",label:Object(l.__)("End Automation","wp-marketing-automations")})),e}),[L]),K=Z.stepsOptArr,ee=Z.stepsOptions,te=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(d.Jb)()){e.next=4;break}return h("proModalContent",Object(l.__)("Jump Step","wp-marketing-automations")),h("showProModal",!0),e.abrupt("return");case 4:if(O.hasOwnProperty("step")&&""!=O.step&&O.hasOwnProperty("name")&&""!=O.name){e.next=7;break}return a(!0),e.abrupt("return");case 7:if(a(!1),t=ia(ia({},Q),{},{jump_to:O}),!Object(c.isEqual)($,t)){e.next=12;break}return g(!1),e.abrupt("return");case 12:return e.prev=12,i(!0),n={data:{data:{sidebarData:t}},steps:Object(c.cloneDeep)(L).map((function(e){return e.hasOwnProperty("data")&&e.data.hasOwnProperty("sidebarValues")&&(e.data.sidebarValues={}),e})),links:R,count:z},e.next=17,f()({path:Object(d.u)("/automation/".concat(F,"/step/").concat(W)),method:"POST",data:n}).then((function(e){if(200!==e.code)throw Error(Object(d.p)(null==e?void 0:e.message));v(e.message),_(T.id,ia(ia({},Y),{},{sidebarValues:t}),{step_status:1}),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&h("meta",ia(ia({},q),e.result.meta)),setTimeout((function(){g(!1)}),100),i(!1)})).catch((function(e){throw Error(Object(d.p)(null==e?void 0:e.message))}));case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(12),h("modalData",{status:!0,modalTitle:Object(l.__)("Update Jump","wp-marketing-automations"),error:null===e.t0||void 0===e.t0?void 0:e.t0.message}),i(!1);case 23:Object(d.wb)(v,3e3);case 24:case"end":return e.stop()}}),e,null,[[12,19]])})),function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){sa(c,n,r,o,i,"next",e)}function i(e){sa(c,n,r,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"wr_header"},Object(n.createElement)("div",{className:"bwf-node-icon icon-jump"},Object(n.createElement)(s.a,{size:28,icon:"jump"})),Object(n.createElement)("div",{className:"wr_event_title"},Object(n.createElement)("span",null,Object(l.__)("Jump","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(Lt.a,null)),Object(n.createElement)("div",{className:"wr_event_variant"}),Object(n.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){g(!1)}},Object(n.createElement)(s.a,{icon:"close"}))),Object(n.createElement)("div",{className:"wr_content"},Object(n.createElement)("div",{className:"bwf-jump-wrap"},Object(n.createElement)("div",{className:"bwf-jump-skip-step-select "+(t?"has-error":"")},Object(n.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("Jump To","wp-marketing-automations")),Object(n.createElement)(m.SelectControl,{value:O.step,className:"bwf_w_full",options:ee,onChange:function(e){w({step:e,name:e?K[e]:""})}}),t&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("This is a required field.","wp-marketing-automations"))))),Object(n.createElement)("div",{className:"bwf_clear_24"})),Object(n.createElement)("div",{className:"wr_footer"},Object(n.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return g(!1)}},Object(l.__)("Cancel","wp-marketing-automations")),Object(n.createElement)(j.a,{isPrimary:!0,onClick:te,isBusy:o,className:"bwf-no-ripple"},!Object(d.Jb)()&&Object(n.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),Object(l.__)("Save","wp-marketing-automations"))))},da=a(75);function pa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function fa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?pa(Object(a),!0).forEach((function(t){Oa(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Oa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ja(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function wa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return va(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return va(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function va(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var ya=function(){var e=wa(Object(n.useState)(!1),2),t=e[0],a=e[1],r=wa(Object(n.useState)(!1),2),o=r[0],i=r[1],p=wa(Object(n.useState)(""),2),O=p[0],w=p[1],v=wa(Object(n.useState)(""),2),y=v[0],g=v[1],_=wa(Object(n.useState)(""),2),E=_[0],h=_[1],k=Object(n.useContext)(d.h),N=Object(b.a)(),P=N.showSidebar,C=N.setNodeDatabyId,S=N.setAutomationData,A=N.setSplitNodePath,D=N.fetchAutomationStat,x=Object(n.useRef)(new AbortController),I=Object(u.a)(),M=I.getSidebarNodeData,T=I.getNodeDataByID,F=I.getAutomationId,L=(0,I.getautomationMeta)(),R=M(),z=F(),J=!Object(c.isEmpty)(R)&&R.hasOwnProperty("id")?T(R.id):{},U=J.id,q=void 0===U?0:U,B=J.stepId,H=void 0===B?0:B,V=[{key:"",label:Object(l.__)("Select","wp-marketing-automations")},{key:"2",label:"2"},{key:"3",label:"3"}];Object(n.useEffect)((function(){return a({}),a(!1),function(){x.current.abort()}}),[]);var W=!Object(c.isEmpty)(R)&&R.hasOwnProperty("data")?R.data:{},G=!Object(c.isEmpty)(W)&&W.hasOwnProperty("sidebarValues")?W.sidebarValues:{};Object(n.useEffect)((function(){G.hasOwnProperty("split_path")&&!Object(c.isEmpty)(G.split_path)&&w(G.split_path),G.hasOwnProperty("title")&&!Object(c.isEmpty)(G.title)&&g(G.title),G.hasOwnProperty("desc")&&!Object(c.isEmpty)(G.desc)&&h(G.desc)}),[G]);var $=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,r,c,o,s,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(d.Jb)()){e.next=4;break}return S("proModalContent",Object(l.__)("Split Path Step","wp-marketing-automations")),S("showProModal",!0),e.abrupt("return");case 4:if(""!=O&&""!=y){e.next=7;break}return a(!0),e.abrupt("return");case 7:return i(!0),a(!1),t=fa(fa({},G),{},{split_path:O,title:y,desc:E}),n={data:{data:{sidebarData:t}}},r=[],G.hasOwnProperty("split_path")&&""!=G.split_path||(c=A(q,O),o=c.newStep,s=c.newLink,m=c.newCount,n=fa(fa({},n),{},{steps:o,links:s,count:m}),r=o,S("statLoading",!0)),e.prev=13,e.next=16,f()({path:Object(d.u)("/automation/".concat(z,"/step/").concat(H)),method:"POST",data:n}).then((function(e){if(200!==e.code)throw Error(Object(d.p)(null==e?void 0:e.message));k(e.message),G.hasOwnProperty("split_path")&&""!=G.split_path?C(R.id,fa(fa({},W),{},{sidebarValues:t}),{step_status:1}):C(R.id,fa(fa({},W),{},{sidebarValues:t}),{step_status:1},r),D(),e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&S("meta",fa(fa({},L),e.result.meta)),setTimeout((function(){P(!1)}),100),i(!1)})).catch((function(e){throw Error(Object(d.p)(null==e?void 0:e.message))}));case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(13),S("modalData",{status:!0,modalTitle:Object(l.__)("Update Split","wp-marketing-automations"),error:null===e.t0||void 0===e.t0?void 0:e.t0.message}),i(!1);case 22:Object(d.wb)(k,3e3);case 23:case"end":return e.stop()}}),e,null,[[13,18]])})),function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){ja(c,n,r,o,i,"next",e)}function i(e){ja(c,n,r,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"wr_header"},Object(n.createElement)("div",{className:"bwf-node-icon icon-split-test"},Object(n.createElement)(s.a,{size:28,icon:"split-test"})),Object(n.createElement)("div",{className:"wr_event_title"},Object(n.createElement)("span",null,Object(l.__)("Split Path","wp-marketing-automations")),!Object(d.Jb)()&&Object(n.createElement)(Lt.a,null)),Object(n.createElement)("div",{className:"wr_event_variant"}),Object(n.createElement)("div",{className:"wr_close bwf-cursor-pointer",onClick:function(){P(!1)}},Object(n.createElement)(s.a,{icon:"close"}))),Object(n.createElement)("div",{className:"wr_content "+(G.hasOwnProperty("split_path")&&""!=G.split_path?"":"split-full")},Object(n.createElement)("div",{className:"bwf-split-wrap"},Object(n.createElement)("div",{className:"bwf-split-title-text "+(t&&""===y?"has-error":"")},Object(n.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("Name","wp-marketing-automations")),Object(n.createElement)(m.TextControl,{className:"bwf-h-36",value:y,onChange:function(e){return g(e)},placeholder:Object(l.__)("Enter Name","wp-marketing-automations")}),t&&""===y&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("This is a required field.","wp-marketing-automations")))),(!G.hasOwnProperty("split_path")||""==G.split_path)&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-split-path-select "+(t&&""===O?"has-error":"")},Object(n.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("No of Paths","wp-marketing-automations")),Object(n.createElement)(da.b,{selected:O,className:"bwf_w_full",options:V,onChange:function(e){w(e)}}),t&&""===O&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"has-bwfan-error"},Object(l.__)("This is a required field.","wp-marketing-automations"))))),Object(n.createElement)("div",{className:"bwf_clear_24"}),Object(n.createElement)("div",{className:"bwf-split-title-desc "},Object(n.createElement)("div",{className:"bwf-w-120 bwf_bold bwf-mb-8"},Object(l.__)("Description","wp-marketing-automations")),Object(n.createElement)(m.TextareaControl,{placeholder:Object(l.__)("Type here …","wp-marketing-automations"),value:E,onChange:function(e){return h(e)},rows:4})),Object(n.createElement)("div",{className:"bwf_clear_24"}))),Object(n.createElement)("div",{className:"wr_footer"},Object(n.createElement)(j.a,{className:"bwf-cancel-btn",onClick:function(){return P(!1)},disabled:o},Object(l.__)("Cancel","wp-marketing-automations")),Object(n.createElement)(j.a,{isPrimary:!0,className:"bwf-no-ripple",onClick:$,isBusy:o,disabled:o},!Object(d.Jb)()&&Object(n.createElement)(s.a,{icon:"king",size:16,color:"#fff"}),G.hasOwnProperty("split_path")&&""!=G.split_path?Object(l.__)("Save","wp-marketing-automations"):Object(l.__)("Add","wp-marketing-automations"))))},ga=function(){var e=Object(u.a)(),t=e.openSidebar,a=e.getSidebarNodeData,r=t(),c=a(),o=c.type,i=void 0===o?"":o,s=c.data,m=(void 0===s?{}:s).selected,b=void 0===m?"":m;return r?Object(n.createElement)("div",{className:"bwf-wl-wrap"},Object(n.createElement)("div",{className:"wl-sidebar-overlay step-"+i+"-wrap ",onClick:function(e){return e.preventDefault()}}),Object(n.createElement)("div",{className:"wr wr-expanded step-"+i+"-wrap-content "+("wp_sendemail"==b?"bwf-mail-action":"")},function(){switch(i){case"start":return Object(n.createElement)(ca,null);case"action":return Object(n.createElement)(ct,null);case"conditional":return Object(n.createElement)(Ht,null);case"wait":return Object(n.createElement)(Tt,null);case"benchmark":return Object(n.createElement)(Xt,null);case"jump":return Object(n.createElement)(ua,null);case"split":return Object(n.createElement)(ya,null);default:return Object(n.createElement)(n.Fragment,null,Object(l.__)("Node Type not registered","wp-marketing-automations"))}}())):Object(n.createElement)(n.Fragment,null)},_a=a(74),Ea=a(121),ha=a(949),ka=a(1011);a(1005),a(1275);function Na(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pa(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Pa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Ca=function(e){var t=e.id,a=e.sourceX,c=e.sourceY,o=e.targetX,i=e.targetY,s=e.sourcePosition,m=e.targetPosition,d=e.style,p=void 0===d?{}:d,f=(e.data,e.arrowHeadType),O=e.markerEndId,j=e.source,w=e.sourceHandleId,v=Object(r.g)({sourceX:a,sourceY:c,sourcePosition:s,targetX:o,targetY:i,targetPosition:m}),y=Object(r.i)(f,O),g=Na(Object(r.h)({sourceX:a,sourceY:c,targetX:o,targetY:i}),2),_=g[0],E=g[1],h=Object(b.a)(),k=h.setNodeForAdd,N=h.copyNodeHere,P=h.setOpenStepModal,C=h.setModalAnchorNode,S=Object(u.a)(),A=S.getEnableCopy,D=S.getEnableMove,x=S.getNodeDataByID,I=A(),M=D(),T=x(j);return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("path",{id:t,style:p,className:"react-flow__edge-path",d:v,markerEnd:y}),Object(n.createElement)("foreignObject",{width:23,height:23,x:_-11.5,y:E-11.5,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml"},Object(n.createElement)("div",{className:"bwf-edge-body"},I||M?Object(n.createElement)("div",{className:"bwf-drag-area",onClick:function(){return N(T,"after",w||"")}},Object(n.createElement)("div",{className:"bwf-drag-node is-edge"},Object(n.createElement)("div",{className:"bwf-node-add"})),Object(n.createElement)("div",{className:"bwf-paste-label"},Object(l.__)("Paste Here","wp-marketing-automations"))):Object(n.createElement)("div",{className:"bwf-node-add",onClick:function(e){k(j,{option:w}),P(!0),C(e.target)}}))))},Sa=a(119),Aa=a(20),Da=(a(1276),a(33));function xa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ia(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ia(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ia(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var Ma=function(){var e=Object(u.a)(),t=e.getShowContactModalId,a=e.getAutomationData,r=e.getShowContactModalType,o=e.getContactModalExtraData,p=t(),O=r(),j=a().ID,v=o(),y=Object(c.isEmpty)(v)||Object(c.isNull)(v)?{}:v,g=y.split,_=void 0!==g&&g,E=y.path,h=void 0===E?"":E,k=y.pathCount,N=void 0===k?2:k,P=Object(b.a)().setAutomationData,C=xa(Object(n.useState)(!0),2),S=C[0],A=C[1],D=xa(Object(n.useState)({}),2),x=D[0],I=D[1],M=xa(Object(n.useState)(10),2),T=M[0],F=M[1],L=xa(Object(n.useState)(0),2),R=L[0],z=L[1],J=xa(Object(n.useState)(!1),2),U=J[0],q=J[1],B=xa(Object(n.useState)(h),2),H=B[0],V=B[1],W=Object(n.useRef)(new AbortController);Object(n.useEffect)((function(){return function(){P("contactModalData",{}),W.current.abort()}}),[]),Object(n.useEffect)((function(){A(!0),I({}),function(){try{var e={limit:T,offset:R,type:O};""!==H&&(e.path=H);var t=Object(Aa.stringify)(e),a="string"!=typeof p?parseInt(p):0;f()({path:Object(d.u)("/automation/".concat(j,"/step/").concat(a,"/contacts?").concat(t)),method:"GET",signal:W.current.signal}).then((function(e){200===e.code&&(Object(c.isEmpty)(e.result)||I(e.result)),A(!1)}))}catch(e){A(!1)}}()}),[p,R,T,H]);var G=i()("bwfcrm-contacts-list",{"has-search":!1}),$=[{key:"name",label:Object(l.__)("Name","wp-marketing-automations"),isLeftAligned:!0,required:!0,cellClassName:"bwf-w-150"},{key:"email",label:Object(l.__)("Email","wp-marketing-automations"),isLeftAligned:!0},{key:"date",label:function(){if(_)return Object(l.__)("Date","wp-marketing-automations");switch(O){case"completed":return Object(l.__)("Completed On","wp-marketing-automations");case"queued":return Object(l.__)("Queued On","wp-marketing-automations");case"failed":return Object(l.__)("Failed On","wp-marketing-automations");case"active":return Object(l.__)("Started On","wp-marketing-automations");case"skipped":return Object(l.__)("Skipped On","wp-marketing-automations");default:return Object(l.__)("Date","wp-marketing-automations")}}(),isLeftAligned:!0,cellClassName:"bwf-w-150"}];!_||""!=h&&"all"!=h||$.push({key:"path",label:Object(l.__)("Path","wp-marketing-automations"),isLeftAligned:!1}),$.push({key:"traillink",label:"",isLeftAligned:!0});var Y,Q,X,Z,K,ee,te=function(e){return Object(n.createElement)(Da.a,{href:"admin.php?page=autonami&path=/contact/"+e.id,type:"bwf-crm",className:"bwf-cursor-pointer bwf-a-no-underline",style:{color:"#0073aa"},key:e.id},e.hasOwnProperty("name")&&""!==e.name?e.name:"-")},ae=function(e){var t=[];return Object(c.isEmpty)(e)||e.map((function(e){var a=[{display:te(e),value:""},{display:e.email,value:""},{display:e.hasOwnProperty("time")&&""!==e.time?Object(d.V)(ue.a.unix(e.time).format("MM/DD/YYYY HH:mm:ss")):"-",value:""}];!_||""!=h&&"all"!=h||a.push({display:e.hasOwnProperty("path")&&le.hasOwnProperty(e.path)?Object(n.createElement)("div",{className:"bwf-splitpath bwfpathid-".concat(e.path)},Object(l.sprintf)(Object(l.__)("Path %s","wp-marketing-automations"),le[e.path])):"-",value:""}),a.push({display:e.hasOwnProperty("trail")&&""!==e.trail?Object(n.createElement)("div",{onClick:function(){Object(d.Jb)()?(P("customerSelected",e),P("showContactModalId",0),P("showContactModalType","")):q(!0)},className:"bwf-cursor-pointer bwf-display-flex bwf-flex-start gap-8",style:{color:"#0073aa"}},!Object(d.Jb)()&&Object(n.createElement)(s.a,{icon:"king",size:16}),Object(l.__)("View Journey","wp-marketing-automations")):"-",value:""}),t.push(a)})),t},ne=function(e){z((e-1)*T)},re=function(e){return"per_page"!==e?function(){}:ce},ce=function(e){e!==T&&F(e)},oe=Object(n.createElement)("div",{className:"bwf-contact-zero-state"},Object(n.createElement)(s.a,{icon:"contact-zero"}),Object(n.createElement)("div",{className:"bwf-heading"},Object(l.__)("No Contacts","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf-desc"},Object(l.__)("Once your customer start purchase or interact with the product. The contacts will appear here","wp-marketing-automations"))),ie=function(){var e=x.total,t=void 0===e?0:e,a=x.path_total,n=void 0===a?0:a;return""==H?parseInt(t):parseInt(n)},le=Object(d.kc)();return Object(n.createElement)(m.Modal,{className:"bwf-admin-modal bwf-admin-modal-large bwf-single-automation-contact-modal bwf-h--core-header",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(n.createElement)("div",{className:"bwf-modal-header"},Object(n.createElement)("div",{className:"bwf-modal-heading"},function(){var e="",t=ie();if(_)e=""==h||"all"==h?Object(l.__)("Split Path Contacts","wp-marketing-automations"):Object(l.sprintf)(Object(l.__)("Path %s Contacts","wp-marketing-automations"),le[h]);else switch(O){case"completed":e=Object(l.__)("Completed Contacts","wp-marketing-automations");break;case"queued":e=Object(l.__)("Queued Contacts","wp-marketing-automations");break;case"failed":e=Object(l.__)("Failed Contacts","wp-marketing-automations");break;case"skipped":e=Object(l.__)("Skipped Contacts","wp-marketing-automations");break;case"active":e=Object(l.__)("Active Contacts","wp-marketing-automations");break;default:e=Object(l.__)("Contacts","wp-marketing-automations")}return e+" "+(t>0?"("+t+")":"")}()),Object(n.createElement)("span",{onClick:function(){P("showContactModalId",0),P("showContactModalType","")},className:"bwf-modal-close"},Object(n.createElement)(s.a,{icon:"close",color:"#353030"}))),(Q=x.data,X=void 0===Q?[]:Q,Z=x.total,K=void 0===Z?0:Z,x.path_total,ee=parseInt(R)/parseInt(T)+1,S||0!==parseInt(K)?Object(n.createElement)(n.Fragment,null,_&&(""===h||"all"===h)&&Object(n.createElement)("div",{className:"bwf-path-selector"},Object(n.createElement)(m.SelectControl,{value:H,className:"bwf_w_full",options:(Y=[{label:Object(l.__)("Path: All","wp-marketing-automations"),value:""},{label:Object(l.__)("Path A","wp-marketing-automations"),value:"1"},{label:Object(l.__)("Path B","wp-marketing-automations"),value:"2"}],3===parseInt(N)&&Y.push({label:Object(l.__)("Path C","wp-marketing-automations"),value:"3"}),Y),onChange:function(e){V(e)}})),Object(n.createElement)(Sa.a,{className:G,title:"",rows:S?[]:ae(X),headers:$,query:{paged:ee},rowsPerPage:T,totalRows:ie(),isLoading:S,onPageChange:ne,onQueryChange:re,showMenu:!1,emptyMessage:Object(l.__)("No contacts found","wp-marketing-automations")}),!Object(d.Jb)()&&Object(n.createElement)(w.b,{isOpen:U,onRequestClose:function(){return q(!1)},modalContent:{isFeature:!0,featureTitle:Object(l.__)("Contact Journey","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Step+Contact+Journey+Upgrade+Modal"})}})):Object(n.createElement)(n.Fragment,null,oe)))},Ta=a(61);function Fa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function La(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Fa(Object(a),!0).forEach((function(t){Ra(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Fa(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ra(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function za(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function Ja(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ua(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ua(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var qa=function(e){var t=e.isProActive,a=void 0!==t&&t,r=Object(n.useContext)(d.h),o=Ja(Object(n.useState)(!1),2),i=o[0],p=o[1],f=Ja(Object(n.useState)(!1),2),O=f[0],j=f[1],w=Ja(Object(n.useState)(!1),2),v=w[0],y=w[1],g=Object(b.a)(),_=g.addNewStep,E=g.unsetCurrentNode,h=g.setOpenStepModal,k=g.setAutomationData,N=g.fetchSplitPathNodes,P=g.showSidebar,C=g.isInsideConditional,S=Object(u.a)(),A=S.getCurrentNode,D=S.getCurrentNodeAction,x=S.getOpenStepModal,I=S.getModalAnchorNode,M=x(),T=A(),F=D(),L=I();Object(n.useEffect)((function(){if(!Object(c.isEmpty)(T)&&T.hasOwnProperty("id")){var e=C(T.id);y(e),N().includes(T.id)?j(!0):j(!1)}}),[T]);var R=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,a,n,c,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:"action",p(!0),a=F.data&&F.data.option?F.data.option:"",n=F.data&&F.data.position?F.data.position:"after",c=La(La({},T),{},{xPos:T.position.x,yPos:T.position.y}),e.next=7,_(t,c,a,n,{}).then((function(e){Object(d.wb)(r,3e3),E(),p(!1),h(!1),"split"==t&&(k("sidebarNodeData",e),P(!0))}));case 7:case"end":return e.stop()}}),e)})),function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){za(c,n,r,o,i,"next",e)}function i(e){za(c,n,r,o,i,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}();return M&&Object(n.createElement)(U.a,{onFocusOutside:function(){E(),h(!1)},position:"center",className:"bwf-type-select-modal",onClick:function(e){return e.stopPropagation()},anchorRef:L},!i&&Object(n.createElement)("div",{className:"bwf-title-wrap"},Object(n.createElement)("div",{className:"bwf-title bwf_w_full"},Object(l.__)("Add Step","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf-cross bwf-cursor-pointer",onClick:function(){return h(!1)}},Object(n.createElement)(s.a,{icon:"cross",size:20})," ")),Object(n.createElement)("div",{className:"bwf-type-select-wrapper "+(i?"is-loading":"")},i?Object(n.createElement)("div",{className:"bwf-display-flex-column set-center is-loading"},Object(n.createElement)(Ta.a,{spaceClass:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-h3"},Object(l.__)("Please Wait…","wp-marketing-automations")),Object(n.createElement)("div",{className:"bwf_clear_10"}),Object(n.createElement)("div",{className:"bwf-p"},Object(l.__)("We are adding step in the flow","wp-marketing-automations"))):Object(n.createElement)(n.Fragment,null,Object(n.createElement)(m.Button,{isSecondary:!0,onClick:function(){R("action")}},Object(n.createElement)("span",{className:"bwf-type-select-icons"},Object(n.createElement)(s.a,{icon:"charge"})),Object(l.__)("Action","wp-marketing-automations")),Object(n.createElement)(m.Button,{isSecondary:!0,onClick:function(){R("wait")}},Object(n.createElement)("span",{className:"bwf-type-select-icons"},Object(n.createElement)(s.a,{icon:"time-left"})),Object(l.__)("Delay","wp-marketing-automations")),Object(n.createElement)(m.Button,{isSecondary:!0,onClick:function(){a?R("conditional"):(k("proModalContent",{featureTitle:Object(l.__)("Conditional Step","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Add+Step+Condition+Upgrade+Modal"}),image:Object(d.db)("conditional-step.png"),benefit:Object(l.__)("Use hundreds of conditions and advanced branching to create a highly tailored contact journey. Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))},style:{width:"100%"}},Object(n.createElement)("span",{className:"bwf-type-select-icons"},Object(n.createElement)(s.a,{icon:"condition"})),Object(l.__)("Condition","wp-marketing-automations"),!a&&Object(n.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(n.createElement)(s.a,{icon:"king",size:16}))),!O&&Object(n.createElement)(n.Fragment,null,!v&&Object(n.createElement)(m.Button,{isSecondary:!0,onClick:function(){a?R("split"):(k("proModalContent",{featureTitle:Object(l.__)("Split Path","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Add+Step+Split+Path+Upgrade+Modal"}),image:Object(d.db)("split-path.png"),benefit:Object(l.__)("Test the subject lines, frequency or different automation paths to uncover hidden profits.Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))},style:{width:"100%"}},Object(n.createElement)("span",{className:"bwf-type-select-icons"},Object(n.createElement)(s.a,{icon:"split-test"})),Object(l.__)("Split Path","wp-marketing-automations"),!a&&Object(n.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(n.createElement)(s.a,{icon:"king",size:16}))),Object(n.createElement)(m.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){a?R("benchmark"):(k("proModalContent",{featureTitle:Object(l.__)("Goal Step","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Add+Step+Goal+Upgrade+Modal"}),image:Object(d.db)("goal-step.png"),benefit:Object(l.__)("Never send unnecessary messages to users. Pull users to a specific step when a goal is achieved. Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))}},Object(n.createElement)("span",{className:"bwf-type-select-icons"},Object(n.createElement)(s.a,{icon:"goal"})),Object(l.__)("Goal","wp-marketing-automations"),!a&&Object(n.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(n.createElement)(s.a,{icon:"king",size:16}))),Object(n.createElement)(m.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){a?R("jump"):(k("proModalContent",{featureTitle:Object(l.__)("Jump Step","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Add+Step+Jump+Upgrade+Modal"}),image:Object(d.db)("jump-step.png"),benefit:Object(l.__)("Create advanced automations by letting contacts jump to any step in the journey.Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))}},Object(n.createElement)("span",{className:"bwf-type-select-icons"},Object(n.createElement)(s.a,{icon:"jump"})),Object(l.__)("Jump","wp-marketing-automations"),!a&&Object(n.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(n.createElement)(s.a,{icon:"king",size:16}))),Object(n.createElement)(m.Button,{isSecondary:!0,style:{width:"100%"},onClick:function(){a?R("exit"):(k("proModalContent",{featureTitle:Object(l.__)("Exit Automation","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Add+Step+Exit+Upgrade+Modal"}),image:Object(d.db)("exit-step.png"),benefit:Object(l.__)("Use this to make strategic decisions to end automation based on certain conditions.Unlock this and other awesome features.","wp-marketing-automations")}),k("showProModal",!0))}},Object(n.createElement)("span",{className:"bwf-type-select-icons"},Object(n.createElement)(s.a,{icon:"exit"})),Object(l.__)("Exit","wp-marketing-automations"),!a&&Object(n.createElement)("span",{className:"bwf-flex",style:{marginLeft:"auto"}},Object(n.createElement)(s.a,{icon:"king",size:16})))))))},Ba=a(49),Ha=(a(1031),a(25)),Va=a(36),Wa=a.n(Va),Ga=a(37),$a=a.n(Ga),Ya=a(60);function Qa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xa(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Xa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xa(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function Za(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ka(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Za(Object(a),!0).forEach((function(t){en(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Za(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function en(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function tn(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}var an=function(e){return{name:"contact-journey",className:"bwf-search-bwf-tags-result",options:function(t){return(a=regeneratorRuntime.mark((function t(a){var n,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={search:a,limit:10,offset:0},t.next=3,f()({path:Object(d.u)("/automation/".concat(e,"/contacts/journey?")+Object(Aa.stringify)(n)),method:"GET"});case 3:return r=t.sent,c=[],Wa()(r,"result")&&!$a()(r.result)&&(c=r.result.map((function(e){return Ka(Ka({},e),{},{key:String(e.trail),label:$a()(e.f_name)&&$a()(e.l_name)?e.email:e.f_name+" "+e.l_name})}))),t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})),n=function(){var e=this,t=arguments;return new Promise((function(n,r){var c=a.apply(e,t);function o(e){tn(c,n,r,o,i,"next",e)}function i(e){tn(c,n,r,o,i,"throw",e)}o(void 0)}))},function(e){return n.apply(this,arguments)})(t);var a,n},isDebounced:!0,getOptionIdentifier:function(e){return e.key},getOptionKeywords:function(e){return[e.label]},getOptionLabel:function(e,t){return Object(n.createElement)("span",{key:"name",className:"bwf-customer-journey-search-result-name","aria-label":e.label},Object(n.createElement)("div",{className:"bwf-search-wrap"},Object(n.createElement)("div",{className:"bwf-search-label"},e.label),Object(n.createElement)("div",{className:"bwf-search-date"},"On:"," ",e.hasOwnProperty("c_date")?Object(d.V)(e.c_date):"")))},getOptionCompletion:function(e){return e}}},nn=function(e){var t=Qa(Object(n.useState)(!1),2),a=t[0],r=t[1],o=e.automationId,i=Object(n.useRef)(),m=Object(b.a)().setAutomationData,p=Object(u.a)().getCustomerSelected;Object(d.lc)(i,(function(){return r(!1)}));var f=p(),O=function(e){if(Object(c.isArray)(e)&&!$a()(e)){if(!$a()(e)){var t=e[e.length-1];(e=[])[0]=t}var a=e.find((function(e){return Wa()(e,"key")}));m("customerSelected",a),r(!1)}else m("customerSelected",{})};return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{dangerouslySetInnerHTML:{__html:"<style>body{overflow-y: hidden !important;}</style>"}}),Object(n.createElement)("div",{className:"bwf-automation-customer-journey-wrap"},Object(n.createElement)("div",{className:"bwf-automation-customer-journey"},Object(n.createElement)("div",{className:"bwf-customer-journey-header"},Object(n.createElement)("div",{className:"bwf-section-header",onClick:function(){Object(d.Jb)()?!a&&$a()(f)&&r(!0):(m("proModalContent",{featureTitle:Object(l.__)("Contact Journey","wp-marketing-automations"),proLink:Object(d.T)("upgrade",{utm_medium:"Automation+Workflow+Contact+Journey+Upgrade+Modal"})}),m("showProModal",!0))}},Object(n.createElement)(s.a,{icon:Object(d.Jb)()?"split-path":"king",width:16,height:18}),Object(n.createElement)("span",null,Object(l.__)("View Contact Journey","wp-marketing-automations")))),Object(d.Jb)()&&Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-customer-journey-popover-wrap"},a&&Object(n.createElement)(U.a,{ref:i,onFocusOutside:function(){return r(!1)},className:"bwf-customer-journey-popover",focusOnMount:!1,placement:"bottom"},Object(n.createElement)("div",{className:"bwf-customer-journey-popover-content"},Object(n.createElement)(Ha.a,{autocompleter:an(o),className:"bwf-customer-journey-search",placeholder:Object(l.__)("Search by Name, Email and Phone","wp-marketing-automations"),multiple:!1,inlineTags:!1,selected:[],onChange:O,bwfEnableEmptySearch:!0})))))),!$a()(f)&&Object(n.createElement)("div",{className:"bwf-customer-selected"},Object(n.createElement)(Ya.a,{id:f.trail,label:f.hasOwnProperty("label")&&!$a()(f.label.trim())?f.label:f.email,remove:function(){return m("customerSelected",{})}}))))},rn=a(995);function cn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function on(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?cn(Object(a),!0).forEach((function(t){ln(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):cn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ln(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function sn(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function mn(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){sn(c,n,r,o,i,"next",e)}function i(e){sn(c,n,r,o,i,"throw",e)}o(void 0)}))}}function bn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return un(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return un(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function un(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var dn=function(){var e=Object(b.a)(),t=e.setAutomationData,a=e.declareWinnerPath,r=Object(u.a)(),o=r.selectedWinner,i=r.getAutomationId,p=r.getautomationMeta,O=bn(Object(n.useState)(!1),2),w=O[0],v=O[1],y=bn(Object(n.useState)(!1),2),g=y[0],_=y[1],E=bn(Object(n.useState)(!1),2),h=E[0],k=E[1],N=bn(Object(n.useState)(!1),2),P=N[0],C=N[1],S=bn(Object(n.useState)(!0),2),A=S[0],D=S[1],x=bn(Object(n.useState)(""),2),I=x[0],M=x[1],T=bn(Object(n.useState)(!1),2),F=T[0],L=T[1],R=Object(d.kc)(),z=o(),J=z.nodeId,U=void 0===J?"":J,q=z.stepID,B=void 0===q?"":q,H=z.title,V=void 0===H?"":H,W=Object(n.useRef)(new AbortController),G=p(),$=i(),Y=function(){t("declareWinner",{}),t("showSplitWinner",!1)};Object(n.useEffect)((function(){!function(){try{C(!0),f()({path:Object(d.u)("/automation/".concat($,"/analytics/").concat(B,"?mode=split")),method:"GET"}).then((function(e){200===e.code&&e.result.hasOwnProperty("data")&&!Object(c.isEmpty)(e.result.data)&&D(e.result.data),C(!1)}))}catch(e){C(!1)}}()}),[]);var Q=function(){var e=mn(regeneratorRuntime.mark((function e(n,r,c){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.prev=1,e.next=4,f()({path:Object(d.u)("/automation/".concat($,"/step/").concat(r,"/declare-winner")),method:"POST",signal:W.current.signal,data:{node_id:n,path_num:c}}).then(function(){var e=mn(regeneratorRuntime.mark((function e(o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.result){e.next=4;break}return L(!0),e.next=4,a(n,c).then((function(e){k(!0);var a=e.targetElemt,n=e.newStep,c=e.newLink,o=e.newCount;try{f()({path:Object(d.u)("/automation/".concat($,"/step/").concat(r,"/")),method:"POST",signal:W.current.signal,data:{steps:n,links:c,count:o}}).then((function(e){200===e.code&&(e.hasOwnProperty("result")&&e.result.hasOwnProperty("meta")&&t("meta",on(on({},G),e.result.meta)),t("targetNode",a),t("flowCenter",!0)),k(!1)}))}catch(e){k(!1)}}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),v(!1);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,a,n){return e.apply(this,arguments)}}(),X=function(){var e,t,a=(e=A.paths,t=[],(void 0===e?[]:e).map((function(e){var a=e.path,n=void 0===a?"":a,r=e.stats,c=void 0===r?[]:r;parseInt(n)===parseInt(I)&&(t=c)})),t);return Object(n.createElement)("div",{className:"bwf-declare-winner-confirm-wrap"},Object(n.createElement)(s.a,{icon:"declare-winner"}),Object(n.createElement)("div",{className:"bwf-declare-winner-confirm-content"},Object(n.createElement)("div",{className:"bwf-declare-winner-confirm-header"},Object(l.sprintf)(Object(l.__)("Congratulations! You have declared Path %s as winner","wp-marketing-automations"),R[I])),Object(n.createElement)("div",{className:"bwf-declare-winner-confirm-stat-wrap"},a.map((function(e,t){return Object(n.createElement)("div",{className:"bwf-declare-winner-confirm-stat",key:t},Object(n.createElement)("div",{className:"bwf-split-node-value"},e.v),Object(n.createElement)("div",{className:"bwf-split-node-label"},e.l))}))),Object(n.createElement)("div",{className:"bwf-declare-winner-confirm-footer"},Object(n.createElement)(j.a,{isPrimary:!0,isBusy:h,disabled:h,onClick:Y},h?Object(l.__)("Updating Automation","wp-marketing-automations"):Object(l.__)("Close","wp-marketing-automations")))))};return Object(n.createElement)(m.Modal,{className:"bwf-admin-modal bwf-admin-modal-no-header bwf-declare-winner-modal "+(!g||F?"bwf-admin-modal-1024":"bwf-admin-modal-480"),shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(n.createElement)("div",{className:"bwf-declare-winner-header-wrap"},Object(n.createElement)("div",{className:"bwf-declare-winner-header"},function(){if(P)return Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-210 bwf-h-20"}),Object(n.createElement)("div",{className:"bwf_clear_5"}),Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-w-150 bwf-h-15"}));var e=A.started_at,t=void 0===e?"":e;return g?Object(n.createElement)(n.Fragment,null,F?"":Object(l.sprintf)(Object(l.__)("Declare Path %s as Winner","wp-marketing-automations"),R[I])):Object(n.createElement)("div",{className:"bwf-declarewinner-step-title"},Object(n.createElement)("div",{className:"bwf-title-wrap"},Object(n.createElement)("div",{className:"bwf-split-title"},Object(l.sprintf)(Object(l.__)("Result of %s","wp-marketing-automations"),V))),Object(n.createElement)("div",{className:"bwf-split-date"},Object(n.createElement)("span",null,Object(l.__)("Started On ","wp-marketing-automations")+" : "),Object(d.W)(t)))}()),Object(n.createElement)("div",{className:"bwf-close-modal",onClick:Y},Object(n.createElement)(s.a,{icon:"close",size:20}))),Object(n.createElement)("div",{className:"bwf-declare-winner-content"},function(){if(P)return Object(n.createElement)("div",{className:"bwf-declare-winner-analytics-wrap"},[1,2].map((function(e){return Object(n.createElement)("div",{className:"bwf-declare-winner-analytics-row",key:e},Object(n.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-60"})),[1,2,3,4,5,6,7,8].map((function(e){return Object(n.createElement)("div",{className:"bwf-declare-winner-analytics-col",key:e},Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-30"}),Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-h-15 bwf-w-70"}))})),Object(n.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(n.createElement)("div",{className:"bwf-placeholder-temp bwf-h-30 bwf-w-120"})))})));var e=A.paths,t=void 0===e?[]:e;return g?Object(n.createElement)(n.Fragment,null,F?X():Object(l.sprintf)(Object(l.__)("You are about to declare Path %s as winner. All other paths will be removed from the automation. This action cannot be undone.","wp-marketing-automations"),R[I])):Object(n.createElement)("div",{className:"bwf-declare-winner-analytics-wrap"},t.map((function(e,t){var a=e.path,r=void 0===a?1:a,c=e.stats,o=void 0===c?[]:c;return Object(n.createElement)("div",{className:"bwf-declare-winner-analytics-row",key:t},Object(n.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(n.createElement)("span",{className:"bwf-split-path-title splitpath-".concat(r)},Object(l.__)("Path","wp-marketing-automations")+" "+R[r])),o.map((function(e,t){return Object(n.createElement)("div",{className:"bwf-declare-winner-analytics-col",key:t},Object(n.createElement)("span",{className:"bwf-split-test-value"},e.v),Object(n.createElement)("span",{className:"bwf-split-test-label"},e.l))})),Object(n.createElement)("div",{className:"bwf-declare-winner-analytics-col"},Object(n.createElement)("div",{className:"bwf-declare-winner-btn",onClick:function(){_(!0),M(r)}},Object(l.__)("Declare Winner","wp-marketing-automations"))))})))}()),g&&!F&&Object(n.createElement)("div",{className:"bwf-declare-winner-footer",key:"footer"},Object(n.createElement)(j.a,{className:"bwf-cancel-btn",onClick:Y,disabled:!1},Object(l.__)("Cancel","wp-marketing-automations")),Object(n.createElement)(j.a,{isPrimary:!0,onClick:function(){Q(U,B,I)},isBusy:w,disabled:w},Object(l.__)("Declare Winner","wp-marketing-automations"))))};function pn(e,t,a,n,r,c,o){try{var i=e[c](o),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(n,r)}function fn(e){return function(e){if(Array.isArray(e))return wn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||jn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function On(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],n=!0,r=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,c=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}return a}(e,t)||jn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(e,t){if(e){if("string"==typeof e)return wn(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?wn(e,t):void 0}}function wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function vn(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function yn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?vn(Object(a),!0).forEach((function(t){gn(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):vn(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function gn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var _n=function(e){var t=e.id,a=Object(_a.a)(),o=a.setL2Title,p=a.setPageCountData,j=Object(Ea.a)().getPageCountData,v=Object(n.useContext)(d.h),y=Object(r.n)().setCenter,g=Object(r.l)(),_=Object(r.m)((function(e){return e.setSelectedElements})),E=Object(He.b)(),h=E.mergeTag,k=E.setMergeTag,N=E.reset,P=E.identifier,C=E.setIdentifier,S=Object(u.a)(),A=j(),D=S.getLoading,x=S.getAutomationSteps,I=S.getAutomationLinks,M=S.getEnableCopy,T=S.getEnableMove,F=S.getAutomationData,L=S.getError,R=S.getShowContactModalId,z=S.getOpenStartSidebar,U=S.getCustomerSelected,q=S.isProModal,B=S.getautomationMeta,H=(S.getListData,S.getModalData),V=S.getFlowCenter,W=S.getTargetNode,G=S.showSplitWinnerModal,$=S.getProModalContent,Y=S.getSingleAutomationFailedCount,Q=H(),Z=Object(b.a)(),K=Z.setAutomationData,ee=Z.fetchAutomationStat,te=I(),ae=x(),ne=M(),oe=T(),ie=D(),le=L(),me=F(),be=R(),ue=me.title,de=void 0===ue?"":ue,pe=z(),fe=U(),Oe=q(),je=$(),ye=B(),ge=ye.tips,_e=void 0===ge?[]:ge,he=V(),ke=W(),Ne=G(),Pe=Y();Object(n.useEffect)((function(){ie||p(yn(yn({},A),{},{single_a_contacts:Pe}))}),[Pe]),Object(ha.a)("workflow",de,"admin.php?page=autonami&path=/automations",!1,null,t,!1,!0,!1),Object(n.useEffect)((function(){K("isNewAutomation",0)}),[me]);var Se=Object(n.useRef)();Object(n.useEffect)((function(){return window.addEventListener("keyup",(function(e){"Escape"!==e.key&&"27"!==e.keyCode||null!==document.querySelector(".bwf-escape-note")&&(K("enableCopy",!1),K("enableMove",!1),K("isProcessingCopyPaste",!1),K("copyData",{}),K("moveID",0),Object(d.wb)(v,100))})),K("enableCopy",!1),K("enableMove",!1),K("copyData",{}),function(){document.body.style.overflow="",o(""),K("statLoading",!0),K("statData",[]),K("isLoading",!0)}}),[]),Object(n.useEffect)((function(){Object(c.isNull)(document.querySelector("#bwf-single-automation-wrap"))||(Se.current=document.querySelector("#bwf-single-automation-wrap").getBoundingClientRect()),ie||ee()}),[ie]);var Ae={start:J,action:re,conditional:X,end:ce,benchmark:se,wait:we,yesNoNode:ve,exit:Ee,jump:Ce,split:xe,splitpath:Ie},De={"bwf-default":Ca},Me=te.map((function(e){return e.id&&(e.id.includes("yesedge")||e.id.includes("noedge")||e.hasOwnProperty("sourceHandle")&&"split-edge"===e.sourceHandle)?e:yn(yn({},e),{},{type:"bwf-default"})})),Te=On(Object(n.useState)([]),2),Fe=Te[0],Le=Te[1],Re=On(Object(n.useState)(!1),2),ze=Re[0],Je=Re[1],Ue=On(Object(n.useState)("bwf-automation-wrap"),2),qe=Ue[0],Be=Ue[1],Ve=On(Object(n.useState)(!1),2),We=Ve[0],Ge=Ve[1],$e=On(Object(n.useState)(!0),2),Ye=$e[0],Qe=$e[1];if(Object(n.useEffect)((function(){if(!ze||he){var e=0,t=0,a=g.getState(),n=a.nodes,r=a.selectedElements;if(Object(c.isEmpty)(r)||pe||he)if(K("openStartSidebar",!1),he&&!Object(c.isEmpty)(r)){var o=n.filter((function(e){return e.id===ke}));(Object(c.isEmpty)(o)||Object(c.isNull)(o)||""===o||Object(c.isUndefined)(o))&&(o=r[0]),o.hasOwnProperty("__rf")?(e=o.__rf.position.x,t=o.__rf.position.y):(e=o.position.x,t=o.position.y),t=parseFloat(t)+parseFloat(Se.current.height)*(We?.5:.4),Je(!0),y(e,t,1),K("flowCenter",!1)}else if(n.length&&Se.current){var i=n[0];i.hasOwnProperty("__rf")?(e=i.__rf.position.x+140,t=i.__rf.position.y):(e=i.position.x+140,t=i.position.y),t=parseFloat(t)+parseFloat(Se.current.height)*(We?.5:.4),Je(!0),y(e,t,1),K("flowCenter",!1)}}}),[Fe,ze,he]),Object(n.useEffect)((function(){Je(!1),ae.length>1?Le(Object(ka.a)([].concat(fn(ae),fn(Me)),!0,ne||oe?20:0)):Le(ae)}),[ae,ie,We,fe]),Object(n.useEffect)((function(){_([])}),[fe]),ie)return Object(n.createElement)(Ta.a,null);var Xe=function(){var e,a=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f()({path:Object(d.u)("/automation/".concat(t,"/delete_meta")),method:"DELETE",data:{meta_key:"tips"}}).then((function(e){200===e.code&&K("meta",yn(yn({},ye),{},{tips:[]}))}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})),function(){var t=this,a=arguments;return new Promise((function(n,r){var c=e.apply(t,a);function o(e){pn(c,n,r,o,i,"next",e)}function i(e){pn(c,n,r,o,i,"throw",e)}o(void 0)}))});return function(){return a.apply(this,arguments)}}();return Object(n.createElement)(He.a.Provider,{value:{selectedMergeTag:h,setSelectedMergeTag:k,resetSelection:N,selectedIdentifier:P,setSelectedIdentifier:C}},Object(c.isEmpty)(le)?Object(n.createElement)(n.Fragment,null,Object(n.createElement)(Ba.a,null),Object(n.createElement)("div",{className:i()(qe,{"full-screen":We}),id:"bwf-single-automation-wrap"},Object(n.createElement)("div",{className:"automation-title"}," ",de," "),Object(n.createElement)(nn,{automationId:t}),(ne||oe)&&Object(n.createElement)("div",{className:"bwf-escape-note"},Object(l.__)("Press ESC to skip paste step","wp-marketing-automations")),Object(c.isEmpty)(fe)?Object(n.createElement)(r.f,{defaultZoom:1,minZoom:.5,maxZoom:4,nodeTypes:Ae,nodesConnectable:!1,nodesDraggable:!1,zoomOnScroll:!1,zoomOnDoubleClick:!1,paneMoveable:!0,panOnScroll:!0,elements:Fe,edgeTypes:De,onSelectionChange:function(e){if(!Object(c.isNull)(e)&&e.length>0){var t=e[0];if(Object(r.k)(t))return void Be("bwf-automation-wrap bwf-node-selected");if(Object(r.j)(t))return void Be("bwf-automation-wrap bwf-edge-selected");Be("bwf-automation-wrap")}}},Object(n.createElement)(qa,{isProActive:Object(d.Jb)()}),Object(n.createElement)(r.c,{showInteractive:!1},Object(n.createElement)(r.b,{onClick:function(){Ge(!We),document.body.style.overflow=We?"":"hidden",_([])}},We?Object(n.createElement)("span",{className:"dashicons dashicons-fullscreen-exit-alt custom-control-icon"}):Object(n.createElement)("span",{className:"dashicons dashicons-fullscreen-alt custom-control-icon"}))),Object(n.createElement)(r.a,null)):Object(n.createElement)(rn.a,{setFullScreen:Ge,fullScreen:We}),!Object(c.isEmpty)(_e)&&Object(n.createElement)("div",{className:"bwfan-automation-tips"},Object(n.createElement)("span",{className:"bwf-close-tip",onClick:Xe},Object(n.createElement)(s.a,{icon:"close",size:12})),_e.map((function(e,t){return Object(n.createElement)("div",{className:"bwfan-automation-tip",key:t},Object(n.createElement)("div",null,Object(n.createElement)(s.a,{icon:"tip"}),Object(n.createElement)("strong",null,"Tip")),Object(n.createElement)("div",null,e))})))),Object(n.createElement)(ga,null),""!==be&&0!==be&&Object(n.createElement)(Ma,null)):Object(n.createElement)(n.Fragment,null,Object(n.createElement)(n.Fragment,null,Ye&&Object(n.createElement)(m.Modal,{title:Object(l.__)("Failed","wp-marketing-automations"),onRequestClose:function(){return Qe(!1)},className:"bwf-admin-modal bwf-admin-modal-small bwf-single-automation-error-modal",shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1},Object(n.createElement)("div",{className:"bwf-error-content"},Object(n.createElement)(n.Fragment,null,Object(n.createElement)("p",null,Object(l.__)("There has been a critical error on this website.","wp-marketing-automations")),Object(n.createElement)("p",null,Object(l.__)("For quick help, contact FunnelKit","wp-marketing-automations")," ",Object(n.createElement)("a",{href:"https://funnelkit.com/support/?utm_source=WordPress&utm_medium=Automation+Error&utm_campaign=Lite+Plugin",target:"_blank",rel:"noopener noreferrer"},Object(l.__)("support ","wp-marketing-automations"))))),Object(n.createElement)("div",{className:"bwf-footer"},Object(n.createElement)(m.Button,{isPrimary:!0,onClick:function(){return Qe(!1)}},Object(l.__)("Close","wp-marketing-automations")))))),!Object(d.Jb)()&&Object(n.createElement)(w.b,{isOpen:Oe,onRequestClose:function(){return K("showProModal",!1)},modalContent:yn({isFeature:!0,proLink:Object(d.T)("upgrade")},je)}),Object(n.createElement)(O.a,{modalTitle:Q.modalTitle,deleteEntityName:Q.deleteEntityName,confirmText:Q.confirmText,confirmButtonText:Q.buttonConfirm,cancelButtonText:Q.buttonCancel,onConfirm:Q.onConfirm,isLoading:Q.loading,successMessage:Q.success,errorMessage:Q.error,content:Q.content,onRequestClose:function(){K("modalData",{loading:!1,status:!1})},confirmDescription:Q.hasOwnProperty("confirmDescription")?Q.confirmDescription:"",isOpen:Q.status,isDelete:Q.isDelete}),Ne&&Object(n.createElement)(dn,null))};t.default=function(e){var t=e.match.params.id;Object(d.k)("Automation #"+t);var a=Object(b.a)(),c=a.fetchAutomation,o=a.setAutomationData,i=a.clearAutomationError;return Object(n.useEffect)((function(){o("statLoading",!0),o("statData",[]),o("isLoading",!0),i(),c(t)}),[t]),Object(n.createElement)(n.Fragment,null,Object(n.createElement)("div",{className:"bwf-single-automation-body-header",style:{paddingBottom:"8px"}},Object(n.createElement)("div",{className:"bwf-content-header-left"},Object(n.createElement)("div",{className:"bwf-content-header-title2"},Object(l.__)("Workflow","wp-marketing-automations")))),Object(n.createElement)(r.e,null,Object(n.createElement)(_n,{id:t})))}},949:function(e,t,a){"use strict";var n=a(74),r=a(0),c=a(1),o=a(4),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a={workflow:{name:Object(c.__)("Workflow","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e):"admin.php?page=autonami-automations&edit=".concat(e),redirect:!t}};return t&&(a.single_a_contacts={name:Object(c.__)("Contacts","wp-marketing-automations"),link:"admin.php?page=autonami&path=/automation/".concat(e,"/contacts"),showOnClick:!0},a.analytics={name:Object(c.__)("Analytics","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/analytics"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/analytics"),isPro:!0,showOnClick:!0}),a.engagement={name:Object(c.__)("Engagements","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/engagements"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/engagements"),isPro:!0,showOnClick:!0},Object(o.Tb)()&&(a.orders={name:Object(c.__)("Orders","wp-marketing-automations"),link:t?"admin.php?page=autonami&path=/automation/".concat(e,"/orders"):"admin.php?page=autonami&path=/automation-v1/".concat(e,"/orders"),isPro:!0,showOnClick:!0}),a};t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,m=arguments.length>6&&void 0!==arguments[6]&&arguments[6],b=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=bwfcrm_contacts_data&&bwfcrm_contacts_data.header_data?bwfcrm_contacts_data.header_data:{},p=(d.automation_nav,d.automationv2_nav),f=Object(n.a)(),O=f.setActiveMultiple,j=f.resetHeaderMenu,w=f.setL2NavType,v=f.setL2Nav,y=f.setBackLink,g=f.setL2Title,_=f.setL2Content,E=f.setBackLinkLabel,h=f.setL2NavAlign,k=f.setPageHeader,N=f.setTabHeader;return Object(r.useEffect)((function(){j(!0),!o&&w("menu");var n=i(s,b);u||v(s?n:p),e&&n.hasOwnProperty(e)&&n[e].hasOwnProperty("name")&&N(n[e].name),O({leftNav:"automations-v2",rightNav:e}),a&&y(a),s&&y(a&&!b?"admin.php?page=autonami&path=/automations-v1":"admin.php?page=autonami&path=/automations"),o||b&&s&&E(Object(c.__)("All Automations","wp-marketing-automations")),!b&&s&&E(Object(c.__)("All Automations","wp-marketing-automations")),s&&h("left"),t&&""!==t&&g(t),!a&&l&&_(l),k(Object(c.__)("Automations","wp-marketing-automations")),m&&v({})}),[e,b,u]),!0}}}]);