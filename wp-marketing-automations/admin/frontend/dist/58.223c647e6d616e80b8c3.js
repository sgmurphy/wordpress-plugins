(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{1263:function(e,t,n){},1331:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(49),o=n(1),c=n(119),i=n(52);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var m=function(){var e=Object(i.a)("taskHistoryList"),t=e.getStateProp;return u(u({},b(e,["getStateProp"])),{},{getTaskHistory:function(){return t("tasks")},getPageNumber:function(){return parseInt(t("offset"))/parseInt(t("limit"))+1},getPerPageCount:function(){return parseInt(t("limit"))},getOffset:function(){return parseInt(t("offset"))},getTotalCount:function(){return parseInt(t("total"))},getLoadingStatus:function(){return t("isLoading")},getCompletedCount:function(){return t("completed")},getScheduledCount:function(){return t("scheduled")},getPausedCount:function(){return t("paused")},getFailedCount:function(){return t("failed")},getPageCountData:function(){return t("countData")}})},f=n(51),p=n(4);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var y=function(){var e=Object(f.a)("taskHistoryList"),t=e.fetch,n=e.setStateProp;return d(d({},j(e,["fetch","setStateProp"])),{},{fetch:function(e,n,r,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",c=n.s,i=void 0===c?"":c,s=n.automation,u=n.action,l={offset:r,limit:a,status:e,action_slug:u,automation_id:s,search:""!=o?o:i};t("GET",Object(p.u)("/automations/task-history"),l)},setTaskListValues:function(e,t){n(e,t)}})},w=n(3),v=n(57),k=n(58),h=n(18),_=n(5),E=n(66),S=n(9),P=n.n(S),C=n(6),T=n.n(C),x=(n(1263),n(14)),N=n(8),D=n(177),A=n(25);function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L=function(e){var t=e.onSearch,n=I(Object(r.useState)([]),2),a=n[0],c=n[1];return Object(r.createElement)(A.a,{autocompleter:D.d,multiple:!1,allowFreeTextSearch:!0,inlineTags:!0,selected:a,onChange:function(e){c(e),t(Object(w.isEmpty)(e)?"":e[0].key)},placeholder:Object(o.__)("Search","wp-marketing-automations"),showClearButton:!0,disabled:!1,bwfMaintainSingleTerm:!0})},M=n(122),B=n(944);function F(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}var q=function(e){var t=e.isOpen,n=e.tasks,a=e.onSuccess,c=e.onError,i=e.onRequestClose,s=n?n.length:0,u=Object(B.a)(function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P()({path:Object(p.u)("/automations/tasks/"),method:"DELETE",data:{task_ids:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){F(o,r,a,c,i,"next",e)}function i(e){F(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),{onSuccess:function(){setTimeout((function(){return u.reset()}),2500),a&&a()},onError:function(){c&&c()}});return Object(r.createElement)(E.a,{modalTitle:Object(o._n)("Delete Task","Delete Tasks",s,"wp-marketing-automations"),deleteDescriptionText:Object(r.createElement)(r.Fragment,null,Object(o.__)("You are about to delete ","wp-marketing-automations"),Object(o._n)("task","tasks",s,"wp-marketing-automations"),Object(o.__)(". This action cannot be undone. Cancel to stop, Delete to proceed.","wp-marketing-automations")),confirmButtonText:Object(o.__)("Delete","wp-marketing-automations"),cancelButtonText:Object(o.__)("Cancel","wp-marketing-automations"),onConfirm:function(){return u.mutate(n.map((function(e){return e.id})))},isLoading:u.isLoading,successMessage:u.isSuccess&&Object(o.__)("Tasks Deleted!","wp-marketing-automations"),errorMessage:u.isError&&(u.error&&u.error.message?u.error.message:Object(o.__)("Unable to delete tasks","wp-marketing-automations")),onRequestClose:function(){return!!i&&i()},isOpen:t,confirmDescription:Object(o.__)("This action is irreversible","wp-marketing-automations"),isDelete:!0})};function H(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}var U=function(e){var t=e.isOpen,n=e.tasks,a=e.onSuccess,c=e.onError,i=e.onRequestClose,s=e.screenType,u=Object(B.a)(function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P()({path:Object(p.u)("/automations/execute-tasks/"),method:"POST",data:{task_ids:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){H(o,r,a,c,i,"next",e)}function i(e){H(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),{onSuccess:function(){setTimeout((function(){return u.reset()}),2500),a&&a()},onError:function(){c&&c()}});return Object(r.createElement)(E.a,{modalTitle:"failed"===s?Object(o.__)("Reschedule Task","wp-marketing-automations"):Object(o.__)("Execute Task","wp-marketing-automations"),deleteDescriptionText:"failed"===s?Object(o.__)("You are about to reschedule selected task. This action cannot be undone. Cancel to stop, Reschedule to proceed.","wp-marketing-automations"):Object(o.__)("You are about to execute selected task. This action cannot be undone. Cancel to stop, Execute to proceed.","wp-marketing-automations"),confirmButtonText:"failed"===s?Object(o.__)("Reschedule","wp-marketing-automations"):Object(o.__)("Execute","wp-marketing-automations"),cancelButtonText:Object(o.__)("Cancel","wp-marketing-automations"),onConfirm:function(){return u.mutate(n.map((function(e){return e.id})))},successMessage:u.isSuccess&&("failed"===s?Object(o.__)("Tasks Rescheduled!","wp-marketing-automations"):Object(o.__)("Tasks Executed!","wp-marketing-automations")),errorMessage:u.isError&&(u.error&&u.error.message?u.error.message:"failed"===s?Object(o.__)("Unable to reschedule tasks","wp-marketing-automations"):Object(o.__)("Unable to execute tasks","wp-marketing-automations")),onRequestClose:function(){return!!i&&i()},isOpen:t,isDelete:!0})};function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $=function(e){var t=e.floatingBarProps,n=void 0===t?{}:t,a=e.resetSelection,c=e.onSuccess,i=e.screenType,s=e.screenTypeId,u=G(Object(r.useState)([]),2),l=u[0],b=u[1],m=G(Object(r.useState)(!1),2),f=m[0],p=m[1],O=G(Object(r.useState)(!1),2),d=O[0],g=O[1],j=function(){a&&a(),b([])};Object(r.useEffect)((function(){j()}),[i]);var y,w,v=Object(r.useCallback)((function(e,t){switch(e){case"delete":b(t),p(!0);break;case"execute":b(t),g(!0)}}),[]);return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(M.a,Y({actions:(y=i,w=[{id:"delete",icon:"trash",hint:Object(o.__)("Delete Tasks","wp-marketing-automations")}],"completed"!==y&&w.push({id:"execute",icon:"play",hint:"failed"===y?Object(o.__)("Reschedule","wp-marketing-automations"):Object(o.__)("Execute","wp-marketing-automations")}),w),onAction:v},n)),Object(r.createElement)(q,{tasks:l,isOpen:f,onSuccess:function(){c&&c("delete",l),j()},onError:j,onRequestClose:function(){return p(!1)}}),Object(r.createElement)(U,{tasks:l,isOpen:d,onSuccess:function(){c&&c("execute",l),j()},onError:j,onRequestClose:function(){return g(!1)},screenType:i,screenTypeId:s}))},J=n(41);function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){W(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function Z(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){X(o,r,a,c,i,"next",e)}function i(e){X(o,r,a,c,i,"throw",e)}c(void 0)}))}}function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}(e,t)||te(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){if(e){if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var re=function(e){var t=e.type,n=e.query,a=n.automation,i=n.action,s=y(),u=m(),l=Object(r.useContext)(p.h),b=s.fetch,f=s.setTaskListValues,O=u.getTaskHistory,d=u.getPageNumber,g=u.getPerPageCount,j=u.getTotalCount,S=u.getOffset,C=u.getLoadingStatus,D=u.getCompletedCount,A=u.getFailedCount,I=u.getPausedCount,R=u.getScheduledCount,B=Object(r.useRef)(new AbortController),F=ee(Object(r.useState)({loading:!1,status:!1}),2),q=F[0],H=F[1],U=ee(Object(r.useState)([]),2),Y=U[0],G=U[1],V=ee(Object(r.useState)([]),2),z=V[0],W=V[1],X=ee(Object(r.useState)(!1),2),ne=X[0],re=X[1],ae=ee(Object(r.useState)({}),2),oe=ae[0],ce=ae[1],ie=ee(Object(r.useState)(""),2),se=ie[0],ue=ie[1],le=[],be=ee(Object(r.useState)([]),2),me=(be[0],be[1]),fe=O(),pe=g(),Oe=S(),de=j(),ge=d(),je=C(),ye=R(),we=A(),ve=D(),ke=I(),he="t_0";Object(w.isEmpty)(t)||("paused"===t?he="t_1":"completed"===t?he="l_1":"failed"===t&&(he="l_0")),Object(r.useEffect)((function(){me([]),b(he,n,Oe,pe,se)}),[Oe,pe,t,a,i]);var _e=function(){var e=Z(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P()({path:Object(p.u)("/automations/task-filters"),method:"GET",signal:B.current.signal}).then((function(e){200==e.code&&(e.result.hasOwnProperty("automations")&&G(Object.entries(e.result.automations).map((function(e){var t=ee(e,2),n=t[0];return{label:t[1],value:n}}))),e.result.hasOwnProperty("actions")&&W(e.result.actions&&Object.entries(e.result.actions).map((function(e){var t=ee(e,2),n=t[0];return{label:t[1],value:n}}))))})).catch((function(e){console.log(e)}));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){return _e(),function(){B.current.abort()}}),[]);var Ee=function(e){e!==pe&&f("limit",e)},Se=function(){var e=Z(regeneratorRuntime.mark((function e(t,r){var a,c,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="",c="",i="","delete"===r?(a=Object(p.u)("/automations/tasks"),c="DELETE",i="Deleting..."):"execute"===r?(a=Object(p.u)("/automations/execute-tasks"),c="POST",i="Executing..."):"run"===r&&(a=Object(p.u)("/automations/run-tasks"),c="POST",i="Running..."),l(i),!(Array.isArray(t)&&!Object(w.isEmpty)(t)||"run"===r&&parseInt(t)>0)){e.next=18;break}return e.prev=6,e.next=9,P()({path:a,method:c,data:{task_ids:t}}).then((function(e){if(200===e.code)H({status:!1}),b(he,n,0,pe,se),l(e.message);else{var t=e&&e.message&&e.message.msg?e.message.msg:"";t=!t&&e&&e.message?e.message:t,l(t)}}));case 9:e.next=16;break;case 11:e.prev=11,e.t0=e.catch(6),s=!(s=e.t0&&e.t0.message&&e.t0.message.msg?e.t0.message.msg:"")&&e.t0&&e.t0.message?e.t0.message:s,l(s);case 16:e.next=19;break;case 18:l(Object(o.__)("No Task Selected","wp-marketing-automations"));case 19:Object(p.wb)(l,3e3);case 20:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(t,n){return e.apply(this,arguments)}}(),Pe=Object(r.useMemo)((function(){var e={};if(Array.isArray(fe)){var t,n=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=te(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw o}}}}(fe);try{for(n.s();!(t=n.n()).done;){var r=t.value;e[r.id]=r}}catch(e){n.e(e)}finally{n.f()}}return e}),[fe]),Ce=Object(M.b)(Pe),Te=Ce.singleSelectProps,xe=Ce.selectAllProps,Ne=Ce.floatingBarProps,De=Ce.resetSelection,Ae=fe?fe.map((function(e){var t,n=[{display:Object(r.createElement)(J.a,Q({type:"checkbox",checked:!1,onChange:function(){}},Te[e.id])),value:e.id},{display:(t=e,Object(r.createElement)(v.a,{label:Object(o.__)("Quick Actions","wp-marketing-automations"),menuPosition:"bottom right",renderContent:function(e){var n=e.onToggle;return Object(r.createElement)(r.Fragment,null,["t_0","t_1"].includes(he)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(k.a,{isClickable:!0,onInvoke:function(){Se(t.id,"run"),n()}},Object(r.createElement)(h.a,{justify:"flex-start"},Object(r.createElement)(h.c,null,Object(r.createElement)(N.a,{icon:"play"})),Object(r.createElement)(h.c,null,Object(o.__)("Run now","wp-marketing-automations"))))),Object(r.createElement)(k.a,{isClickable:!0,onInvoke:function(){var e={status:!0,deleteDescriptionText:Object(o.__)("You are about to delete task. This action cannot be undone. Cancel to stop, Delete to proceed.","wp-marketing-automations"),buttonConfirm:Object(o.__)("Delete","wp-marketing-automations"),buttonCancel:Object(o.__)("Cancel","wp-marketing-automations"),modalTitle:Object(o.__)("Delete Task","wp-marketing-automations")};H(K(K({},e),{},{onConfirm:function(){return Se([t.id],"delete",e)}})),n()}},Object(r.createElement)(h.a,{justify:"flex-start"},Object(r.createElement)(h.c,null,Object(r.createElement)(N.a,{icon:"trash"})),Object(r.createElement)(h.c,null,Object(o.__)("Delete","wp-marketing-automations")))))}})),value:""},{display:"#"+e.id,value:""},{display:e.task_integration+" : "+e.task_integration_action,value:e.task_integration},{display:e.task_details?Object(r.createElement)("ul",{dangerouslySetInnerHTML:{__html:e.task_details}}):"-",value:""},{display:e.automation_name?Object(r.createElement)("a",{href:e.automation_url,className:"bwf-a-no-underline"},e.automation_name):"-",value:e.automation_name},{display:e.task_date?Object(r.createElement)("div",{dangerouslySetInnerHTML:{__html:e.task_date}}):"-",value:""},{display:Object(r.createElement)(_.Button,{isSecondary:!0,className:"bwf-btn-small is-light bwf-btn-gray",onClick:function(){ce(e),re(!0)}},Object(o.__)("View","wp-marketing-automations")),value:""}];return le.push(e.id),n})):[],Ie=Object(r.createElement)(r.Fragment,null,Object(o.__)("Scheduled","wp-marketing-automations"),parseInt(ye)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},ye):""),Re=Object(r.createElement)(r.Fragment,null,Object(o.__)("Completed","wp-marketing-automations"),parseInt(ve)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},ve):""),Le=Object(r.createElement)(r.Fragment,null,Object(o.__)("Failed","wp-marketing-automations"),parseInt(we)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},we):""),Me=Object(r.createElement)(r.Fragment,null,Object(o.__)("Paused","wp-marketing-automations"),parseInt(ke)>0?Object(r.createElement)("span",{className:"bwf-crm-btn-group-count"},ke):""),Be=T()("bwfcrm-task-list-table",{"has-search":!0}),Fe=[{key:"id",label:Object(r.createElement)(J.a,Q({type:"checkbox",checked:!1,onChange:function(){},"aria-label":Object(o.__)("Select","wp-marketing-automations")},xe)),required:!0,cellClassName:"bwf-col-action bwf-w-30 bwf-table-col-sticky bwf-sticky-left"},{key:"action",label:"",isLeftAligned:!0,required:!0,cellClassName:"bwf-col-action bwf-w-30 bwf-table-col-sticky bwf-sticky-left"},{key:"task",label:Object(o.__)("Task","wp-marketing-automations"),isLeftAligned:!0,required:!0,cellClassName:"bwf-w-100"},{key:"actions",label:Object(o.__)("Action","wp-marketing-automations"),isLeftAligned:!0},{key:"data",label:Object(o.__)("Data","wp-marketing-automations"),isLeftAligned:!0},{key:"automation",label:Object(o.__)("Automation","wp-marketing-automations"),isLeftAligned:!0},{key:"date",label:Object(o.__)("Date","wp-marketing-automations"),isLeftAligned:!0},{key:"view",label:"",isLeftAligned:!0,cellClassName:"bwf-w-60"}],qe=Object(r.createElement)("div",{className:"bwf-page-filters bwf-display-flex bwf-flex"},Object(r.createElement)(_.SelectControl,{className:"bwf-w-300 bwf-mr-10",value:a||"",options:[{label:Object(o.__)("Select Automation","wp-marketing-automations"),value:""}].concat(Y),onChange:function(e){if(e)Object(x.k)({automation:e},"/",n);else{var t=n;delete t.automation,Object(x.k)({},"/",t)}}}),Object(r.createElement)(_.SelectControl,{className:"bwf-w-300 bwf-mr-10",value:i||"",options:[{label:Object(o.__)("Select Action","wp-marketing-automations"),value:""}].concat(z),onChange:function(e){if(e)Object(x.k)({action:e},"/",n);else{var t=n;delete t.action,Object(x.k)({},"/",t)}}}));return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-content-header-new"},Object(r.createElement)("div",{className:"bwf-content-header-left"},Object(r.createElement)("span",{className:"bwf-cursor-pointer bwf-display-flex",onClick:function(){return Object(x.k)({page:"autonami",path:"/automations-v1"},"/",{})}},Object(r.createElement)(N.a,{icon:"arrow-left",size:20})),Object(r.createElement)("div",{className:"bwf-content-header-title"},Object(o.__)("Task History","wp-marketing-automations")),parseInt(de)>0&&Object(r.createElement)("div",{className:"bwf-content-header-count"},Object(o.sprintf)(Object(o.__)("(%s Results)","wp-marketing-automations"),de)))),Object(r.createElement)(_.ButtonGroup,{className:"bwf-btn-group-tabs"},Object(r.createElement)(_.Button,{isPrimary:!t||"scheduled"===t,isSecondary:t&&"scheduled"!==t,onClick:function(){return Object(x.k)({path:"/automations-v1/task-history/scheduled"},"/",n)}},Ie),Object(r.createElement)(_.Button,{isPrimary:t&&"paused"===t,isSecondary:t&&"paused"!==t,onClick:function(){return Object(x.k)({path:"/automations-v1/task-history/paused"},"/",n)}},Me),Object(r.createElement)(_.Button,{isPrimary:t&&"completed"===t,isSecondary:t&&"completed"!==t,onClick:function(){return Object(x.k)({path:"/automations-v1/task-history/completed"},"/",n)}},Re),Object(r.createElement)(_.Button,{isPrimary:t&&"failed"===t,isSecondary:t&&"failed"!==t,onClick:function(){return Object(x.k)({path:"/automations-v1/task-history/failed"},"/",n)}},Le)),Object(r.createElement)("div",{className:"bwf_clear_20"}),Object(r.createElement)(c.a,{rows:Ae,className:Be,headers:Fe,query:{paged:ge},rowsPerPage:pe,totalRows:de,isLoading:je,onPageChange:function(e,t){f("offset",(e-1)*pe)},onQueryChange:function(e){return"per_page"!==e?function(){}:Ee},rowHeader:!0,showMenu:!1,actions:[Object(r.createElement)("div",{className:"bwf-flex",key:"bwf-an-task-history-filters"},qe),Object(r.createElement)(L,{query:n,onSearch:function(e){ue(e||""),b(he,n,0,pe,e)},key:"bwf-an-task-history-search"})],emptyMessage:Object(o.__)("No tasks found","wp-marketing-automations")}),ne&&Object(r.createElement)(_.Modal,{className:"bwf-message-preview-modal bwf-admin-modal bwf-admin-modal-large bwf-task-model bwf-h--core-header",shouldCloseOnClickOutside:!1,shouldCloseOnEsc:!1},Object(r.createElement)("div",{className:"bwf-modal-header"},Object(r.createElement)("div",{className:"bwf-modal-heading"},Object(o.__)("Details","wp-marketing-automations")),Object(r.createElement)("span",{onClick:function(){return re(!1)},className:"bwf-modal-close"},Object(r.createElement)(N.a,{icon:"close",color:"#353030"}))),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-150 bwf_bold bwf_align_center"},Object(o.__)("Automation","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},oe.automation_name)),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-150 bwf_bold bwf_align_center"},Object(o.__)("Event","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},oe.automation_source+" : "+oe.automation_event)),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey"},Object(r.createElement)("div",{className:"bwf-w-150 bwf_bold bwf_align_center"},Object(o.__)("Action","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf_align_center"},oe.task_integration+(oe.task_integration_action?" : ".concat(oe.task_integration_action):""))),Object(r.createElement)("div",{className:"bwf-p-15 bwf-bb-grey bwf-task-details"},Object(r.createElement)("ul",{className:"bwf_align_center",dangerouslySetInnerHTML:{__html:oe.task_details}})),!Object(w.isEmpty)(oe.task_message)&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-h3 bwf-pt-15"},Object(o.__)("Notes","wp-marketing-automations")),Object.entries(oe.task_message).map((function(e,t){var n=ee(e,2),a=n[0],o=n[1];return Object(r.createElement)("div",{className:"bwf-p-15",key:t},Object(r.createElement)("div",{className:"bwfcrm-task_notes_card"},o),Object(r.createElement)("div",{className:"bwfcrm-task_notes_time"},Object(r.createElement)("i",null,a)))}))))),Object(r.createElement)(E.a,{modalTitle:q.modalTitle,deleteDescriptionText:q.deleteDescriptionText,confirmButtonText:q.buttonConfirm,cancelButtonText:q.buttonCancel,onConfirm:q.onConfirm,isLoading:q.loading,successMessage:q.success,errorMessage:q.error,onRequestClose:function(){return H({status:!1})},isOpen:q.status,content:q.content,isDelete:!0}),Object(r.createElement)($,{floatingBarProps:Ne,resetSelection:De,onSuccess:function(){return b(he,n,0,pe)},screenType:t,screenTypeId:he}))},ae=n(949),oe=n(121),ce=n(74);function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.default=function(e){var t=(0,m().getPageCountData)(),n=Object(oe.a)().getPageCountData,c=Object(ce.a)().setPageCountData,i=n();Object(r.useEffect)((function(){c(se(se({},i),t))}),[t]),Object(ae.a)("automations-v1","","","","",0),Object(p.k)(Object(o.__)("Task History","wp-marketing-automations"));var s=e.match.params.type,u=Object(x.i)();return Object(r.createElement)(a.a,null,Object(r.createElement)("div",{className:"bwfcrm-task-list"},Object(r.createElement)(re,{query:u,type:s})))}}}]);