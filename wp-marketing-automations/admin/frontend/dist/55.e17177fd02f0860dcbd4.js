(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{1009:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(79),a={"am-AM":/^(\+?374|0)((10|[9|7][0-9])\d{6}$|[2-4]\d{7}$)/,"ar-AE":/^((\+?971)|0)?5[024568]\d{7}$/,"ar-BH":/^(\+?973)?(3|6)\d{7}$/,"ar-DZ":/^(\+?213|0)(5|6|7)\d{8}$/,"ar-LB":/^(\+?961)?((3|81)\d{6}|7\d{7})$/,"ar-EG":/^((\+?20)|0)?1[0125]\d{8}$/,"ar-IQ":/^(\+?964|0)?7[0-9]\d{8}$/,"ar-JO":/^(\+?962|0)?7[789]\d{7}$/,"ar-KW":/^(\+?965)[569]\d{7}$/,"ar-LY":/^((\+?218)|0)?(9[1-6]\d{7}|[1-8]\d{7,9})$/,"ar-MA":/^(?:(?:\+|00)212|0)[5-7]\d{8}$/,"ar-SA":/^(!?(\+?966)|0)?5\d{8}$/,"ar-SY":/^(!?(\+?963)|0)?9\d{8}$/,"ar-TN":/^(\+?216)?[2459]\d{7}$/,"az-AZ":/^(\+994|0)(5[015]|7[07]|99)\d{7}$/,"bs-BA":/^((((\+|00)3876)|06))((([0-3]|[5-6])\d{6})|(4\d{7}))$/,"be-BY":/^(\+?375)?(24|25|29|33|44)\d{7}$/,"bg-BG":/^(\+?359|0)?8[789]\d{7}$/,"bn-BD":/^(\+?880|0)1[13456789][0-9]{8}$/,"ca-AD":/^(\+376)?[346]\d{5}$/,"cs-CZ":/^(\+?420)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"da-DK":/^(\+?45)?\s?\d{2}\s?\d{2}\s?\d{2}\s?\d{2}$/,"de-DE":/^(\+49)?0?[1|3]([0|5][0-45-9]\d|6([23]|0\d?)|7([0-57-9]|6\d))\d{7}$/,"de-AT":/^(\+43|0)\d{1,4}\d{3,12}$/,"de-CH":/^(\+41|0)(7[5-9])\d{1,7}$/,"de-LU":/^(\+352)?((6\d1)\d{6})$/,"el-GR":/^(\+?30|0)?(69\d{8})$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-GB":/^(\+?44|0)7\d{9}$/,"en-GG":/^(\+?44|0)1481\d{6}$/,"en-GH":/^(\+233|0)(20|50|24|54|27|57|26|56|23|28)\d{7}$/,"en-HK":/^(\+?852[-\s]?)?[456789]\d{3}[-\s]?\d{4}$/,"en-MO":/^(\+?853[-\s]?)?[6]\d{3}[-\s]?\d{4}$/,"en-IE":/^(\+?353|0)8[356789]\d{7}$/,"en-IN":/^(\+?91|0)?[6789]\d{9}$/,"en-KE":/^(\+?254|0)(7|1)\d{8}$/,"en-MT":/^(\+?356|0)?(99|79|77|21|27|22|25)[0-9]{6}$/,"en-MU":/^(\+?230|0)?\d{8}$/,"en-NG":/^(\+?234|0)?[789]\d{9}$/,"en-NZ":/^(\+?64|0)[28]\d{7,9}$/,"en-PK":/^((\+92)|(0092))-{0,1}\d{3}-{0,1}\d{7}$|^\d{11}$|^\d{4}-\d{7}$/,"en-PH":/^(09|\+639)\d{9}$/,"en-RW":/^(\+?250|0)?[7]\d{8}$/,"en-SG":/^(\+65)?[689]\d{7}$/,"en-SL":/^(?:0|94|\+94)?(7(0|1|2|5|6|7|8)( |-)?\d)\d{6}$/,"en-TZ":/^(\+?255|0)?[67]\d{8}$/,"en-UG":/^(\+?256|0)?[7]\d{8}$/,"en-US":/^((\+1|1)?( |-)?)?(\([2-9][0-9]{2}\)|[2-9][0-9]{2})( |-)?([2-9][0-9]{2}( |-)?[0-9]{4})$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-ZM":/^(\+?26)?09[567]\d{7}$/,"en-ZW":/^(\+263)[0-9]{9}$/,"es-AR":/^\+?549(11|[2368]\d)\d{8}$/,"es-BO":/^(\+?591)?(6|7)\d{7}$/,"es-CO":/^(\+?57)?([1-8]{1}|3[0-9]{2})?[2-9]{1}\d{6}$/,"es-CL":/^(\+?56|0)[2-9]\d{1}\d{7}$/,"es-CR":/^(\+506)?[2-8]\d{7}$/,"es-DO":/^(\+?1)?8[024]9\d{7}$/,"es-HN":/^(\+?504)?[9|8]\d{7}$/,"es-EC":/^(\+?593|0)([2-7]|9[2-9])\d{7}$/,"es-ES":/^(\+?34)?[6|7]\d{8}$/,"es-PE":/^(\+?51)?9\d{8}$/,"es-MX":/^(\+?52)?(1|01)?\d{10,11}$/,"es-PA":/^(\+?507)\d{7,8}$/,"es-PY":/^(\+?595|0)9[9876]\d{7}$/,"es-UY":/^(\+598|0)9[1-9][\d]{6}$/,"et-EE":/^(\+?372)?\s?(5|8[1-4])\s?([0-9]\s?){6,7}$/,"fa-IR":/^(\+?98[\-\s]?|0)9[0-39]\d[\-\s]?\d{3}[\-\s]?\d{4}$/,"fi-FI":/^(\+?358|0)\s?(4(0|1|2|4|5|6)?|50)\s?(\d\s?){4,8}\d$/,"fj-FJ":/^(\+?679)?\s?\d{3}\s?\d{4}$/,"fo-FO":/^(\+?298)?\s?\d{2}\s?\d{2}\s?\d{2}$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"fr-GF":/^(\+?594|0|00594)[67]\d{8}$/,"fr-GP":/^(\+?590|0|00590)[67]\d{8}$/,"fr-MQ":/^(\+?596|0|00596)[67]\d{8}$/,"fr-RE":/^(\+?262|0|00262)[67]\d{8}$/,"he-IL":/^(\+972|0)([23489]|5[012345689]|77)[1-9]\d{6}$/,"hu-HU":/^(\+?36)(20|30|70)\d{7}$/,"id-ID":/^(\+?62|0)8(1[123456789]|2[1238]|3[1238]|5[12356789]|7[78]|9[56789]|8[123456789])([\s?|\d]{5,11})$/,"it-IT":/^(\+?39)?\s?3\d{2} ?\d{6,7}$/,"it-SM":/^((\+378)|(0549)|(\+390549)|(\+3780549))?6\d{5,9}$/,"ja-JP":/^(\+81[ \-]?(\(0\))?|0)[6789]0[ \-]?\d{4}[ \-]?\d{4}$/,"ka-GE":/^(\+?995)?(5|79)\d{7}$/,"kk-KZ":/^(\+?7|8)?7\d{9}$/,"kl-GL":/^(\+?299)?\s?\d{2}\s?\d{2}\s?\d{2}$/,"ko-KR":/^((\+?82)[ \-]?)?0?1([0|1|6|7|8|9]{1})[ \-]?\d{3,4}[ \-]?\d{4}$/,"lt-LT":/^(\+370|8)\d{8}$/,"ms-MY":/^(\+?6?01){1}(([0145]{1}(\-|\s)?\d{7,8})|([236789]{1}(\s|\-)?\d{7}))$/,"nb-NO":/^(\+?47)?[49]\d{7}$/,"ne-NP":/^(\+?977)?9[78]\d{8}$/,"nl-BE":/^(\+?32|0)4?\d{8}$/,"nl-NL":/^(((\+|00)?31\(0\))|((\+|00)?31)|0)6{1}\d{8}$/,"nn-NO":/^(\+?47)?[49]\d{7}$/,"pl-PL":/^(\+?48)? ?[5-8]\d ?\d{3} ?\d{2} ?\d{2}$/,"pt-BR":/^((\+?55\ ?[1-9]{2}\ ?)|(\+?55\ ?\([1-9]{2}\)\ ?)|(0[1-9]{2}\ ?)|(\([1-9]{2}\)\ ?)|([1-9]{2}\ ?))((\d{4}\-?\d{4})|(9[2-9]{1}\d{3}\-?\d{4}))$/,"pt-PT":/^(\+?351)?9[1236]\d{7}$/,"ro-RO":/^(\+?4?0)\s?7\d{2}(\/|\s|\.|\-)?\d{3}(\s|\.|\-)?\d{3}$/,"ru-RU":/^(\+?7|8)?9\d{9}$/,"sl-SI":/^(\+386\s?|0)(\d{1}\s?\d{3}\s?\d{2}\s?\d{2}|\d{2}\s?\d{3}\s?\d{3})$/,"sk-SK":/^(\+?421)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"sq-AL":/^(\+355|0)6[789]\d{6}$/,"sr-RS":/^(\+3816|06)[- \d]{5,9}$/,"sv-SE":/^(\+?46|0)[\s\-]?7[\s\-]?[02369]([\s\-]?\d){7}$/,"th-TH":/^(\+66|66|0)\d{9}$/,"tr-TR":/^(\+?90|0)?5\d{9}$/,"uk-UA":/^(\+?38|8)?0\d{9}$/,"uz-UZ":/^(\+?998)?(6[125-79]|7[1-69]|88|9\d)\d{7}$/,"vi-VN":/^(\+?84|0)((3([2-9]))|(5([2689]))|(7([0|6-9]))|(8([1-6|89]))|(9([0-9])))([0-9]{7})$/,"zh-CN":/^((\+|00)86)?1([3568][0-9]|4[579]|6[67]|7[01235678]|9[012356789])[0-9]{8}$/,"zh-TW":/^(\+?886\-?|0)?9\d{8}$/};function o(e,t,n){if(Object(r.a)(e),n&&n.strictMode&&!e.startsWith("+"))return!1;if(Array.isArray(t))return t.some((function(t){if(a.hasOwnProperty(t)&&a[t].test(e))return!0;return!1}));if(t in a)return a[t].test(e);if(!t||"any"===t){for(var o in a){if(a.hasOwnProperty(o))if(a[o].test(e))return!0}return!1}throw new Error("Invalid locale '".concat(t,"'"))}a["en-CA"]=a["en-US"],a["fr-CA"]=a["en-CA"],a["fr-BE"]=a["nl-BE"],a["zh-HK"]=a["en-HK"],a["zh-MO"]=a["en-MO"],a["ga-IE"]=a["en-IE"];Object.keys(a)},1283:function(e,t,n){},1293:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(5),o=n(16),i=n(1),c=n(152),s=n(946),u=n(953),l=n(9),m=n.n(l),d=n(14),b=n(4),f=n(3),p=n(181),g=n(145),O=n(51),y=n(52),w=n(317);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var E=function(e){if(!e||!e.editor||!e.editor.design)return!1;var t=JSON.parse(e.editor.design);return!!t&&!!t.body&&Array.isArray(t.body.rows)&&t.body.rows.length>0},S=function(){var e=Object(y.a)(w.a.campaignContent),t=e.getStateProp,n=h(e,["getStateProp"]),r=s.a.getCampaignData(),a=parseInt(r.type);return v(v({},n),{},{getEmailContent:function(){var e=parseInt(t("currentEmail")),n=t("data");return n&&e in n?n[e]:{}},getCurrentEmail:function(){return parseInt(t("currentEmail"))},getEmails:function(){return t("emails")},getAllEmailContent:function(){return t("data")},getShowValidationFlag:function(){return t("showValidation")},emailsValidToSubmit:function(){var e=t("data");return!!t("emails").map((function(t){var n=e[t];if(!n)return!1;var r=!!n.utmEnabled,o=n.utm?n.utm:{},i={subject:1!==a||n.subject&&n.subject.length>0,content:"editor"!==n.type?n.body&&n.body.length>0:E(n),type:1!==a||n.type&&n.type.length>0,utmSource:!r||o.source&&o.source.length>0,utmMedium:!r||o.medium&&o.medium.length>0};return!!Object.keys(i).map((function(e){return i[e]})).reduce((function(e,t){return e&&t}),!0)})).reduce((function(e,t){return e&&t}),!0)&&e},getValidEmails:function(){var e=t("data"),n=t("emails"),r={};return n.map((function(t){var n=e[t];if(n){var o=!!n.utmEnabled,i=n.utm?n.utm:{},c={subject:1!==a||n.subject&&n.subject.length>0,content:"editor"!==n.type?n.body&&n.body.length>0:E(n),type:1!==a||n.type&&n.type.length>0,utmSource:!o||i.source&&i.source.length>0,utmMedium:!o||i.medium&&i.medium.length>0};r[t]=!!Object.keys(c).map((function(e){return c[e]})).reduce((function(e,t){return e&&t}),!0)}})),r},getEmailsToSubmit:function(){var e=t("data");return t("emails").map((function(t){var n=e[t];return n||!1})).filter(Boolean)},getCurrentEmailIndex:function(){var e=parseInt(t("currentEmail")),n=t("emails");return Array.isArray(n)&&n.includes(e)?n.indexOf(e):1},validateCurrentEmail:function(){var e=t("data"),n=parseInt(t("currentEmail"));if(!e||!e[n])return!1;var r=e[n];if(r){var o=!!r.utmEnabled,i=r.utm?r.utm:{};return{subject:1!==a||r.subject&&r.subject.length>0,content:"editor"!==r.type?r.body&&r.body.length>0:E(r),type:1!==a||r.type&&r.type.length>0,utmSource:!o||i.source&&i.source.length>0,utmMedium:!o||i.medium&&i.medium.length>0}}},getSmartSendSettings:function(){return t("smartSend")},getSaveContentStatus:function(){return t("saveContentStatus")},getSendTestEmailStatus:function(){return t("sendTestEmailStatus")},getUploadImageStatus:function(){return t("uploadImageStatus")},getUploadImageURL:function(){return t("uploadImageURL")},getLastUpdatedTime:function(){return t("lastUpdatedTime")}})},k=n(10),C=n.n(k);function A(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function T(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var L=function(){var e,t,n=Object(O.a)(w.a.campaignContent),r=n.fetch,a=n.setStateProp,o=$(n,["fetch","setStateProp"]),i=Object(O.a)(w.a.campaign).setStateProp,c=S(),u=c.getAllEmailContent,l=c.getCurrentEmail,d=c.getEmails,p=c.getSmartSendSettings,g=c.getCurrentEmailIndex,y=c.getEmailsToSubmit,j=c.getEmailContent,v=u(),_=l(),h=g(),E=d(),k=p(),I=j(),x=y(),L=s.a.getCampaignId(),M=s.a.getCampaignData(),R=M.type,U=function(e){return"type"in e?e:N(N({},e),{},{type:"block"})};return N(N({},o),{},{setEmailContentByKey:function(e,t){var n=U(_ in v?N(N({},v[_]),{},P({},e,t)):P({},e,t));"type"!=e||"editor"!=t||n.hasOwnProperty("editor")||(n.editor={body:Object(b.sb)(),design:Object(b.rb)()});var r=N(N({},v),{},P({},_,n));a("data",r)},setEmailUtmByKey:function(e,t){var n=U(_ in v?N({},v[_]):{}),r="utm"in n?N(N({},n.utm),{},P({},e,t)):P({},e,t),o=N(N({},v),{},P({},_,N(N({},n),{},{utm:N(N({},r),{},P({},e,t))})));a("data",o)},setMultipleUtm:function(e){if(e){var t=U(_ in v?N({},v[_]):{}),n=N(N({},v),{},P({},_,N(N({},t),{},{utm:N(N({},t.utm),e)})));a("data",n)}},setCurrentEmail:function(e){E.includes(e)&&a("currentEmail",e)},addEmail:function(){if(Array.isArray(E)&&E.length<3){var e=Math.max.apply(Math,T(E))+1;a("emails",[].concat(T(E),[e])),a("currentEmail",e),a("showValidation",!1),a("data",N(N({},v),{},P({},e,E[0]in v?v[E[0]]:{})))}},showValidation:function(e){return a("showValidation",e)},deleteEmail:function(e){if(E.length>1){var t=E.filter((function(t){return t!==e}));a("emails",t),a("currentEmail",t[t.length-1])}},initContent:function(e,t){if(!Array.isArray(e)||0===Object(f.size)(e))return a("data",{1:{}}),a("emails",[1]),void a("currentEmail",1);var n={};for(var r in e){var o=parseInt(r)+1;n[o]=v[o]?N(N({},U(v[o])),e[r]):e[r]}a("data",n),a("emails",Object.keys(n).map((function(e){return parseInt(e)}))),t&&0!==Object.keys(t).length&&a("smartSend",t)},fetchCurrentMailEditorContent:function(){r("GET",Object(b.u)("/broadcast/".concat(L,"/content/").concat(h)),{},{email:_})},sendTestEmail:(e=regeneratorRuntime.mark((function e(t,n){var r,o,i,c,s,u,l,d,p,g,O,y,w,j,v,_,h,E,S=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=S.length>2&&void 0!==S[2]?S[2]:"",o=S.length>3&&void 0!==S[3]?S[3]:"",i=S.length>4&&void 0!==S[4]?S[4]:"",c="",s="",u="block",l="",I&&(d=I.body?I.body:"",p=I.editor?I.editor:{},g=p.body?p.body:"",u=I.type?I.type:u,c="editor"===u?g:d,s=I.subject?I.subject:"FunnelKit Automations - Test email subject",l=I.preheader?I.preheader:""),O=o||c,y=r||s,w=i||u,j="",v={},1==R?(j=Object(b.u)("/send-test-email"),v={email:t,content:{subject:y,body:O,type:w,preheader:l,mail_data:n}}):2==R?(n.reply_to,n.senders_email,n.senders_name,_=$(n,["reply_to","senders_email","senders_name"]),j=Object(b.u)("/send-test-sms"),v={phone:t,sms_body:O,sms_data:_}):3==R&&(n.reply_to,n.senders_email,n.senders_name,h=$(n,["reply_to","senders_email","senders_name"]),j=Object(b.u)("/send-test-whatsapp-message"),v={phone:t,sms_body:I,sms_data:h}),Object(f.isEmpty)(v)||Object(f.isEmpty)(j)){e.next=19;break}return e.next=17,m()({method:"POST",path:j,data:v}).then((function(e){return 200===e.code&&e.message?(a("sendTestEmailStatus",2),2):(a("sendTestEmailStatus",3),3)}));case 17:return E=e.sent,e.abrupt("return",E);case 19:case"end":return e.stop()}}),e)})),t=function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){A(o,r,a,i,c,"next",e)}function c(e){A(o,r,a,i,c,"throw",e)}i(void 0)}))},function(e,n){return t.apply(this,arguments)}),setSmartSendByKey:function(e,t){return a("smartSend",N(N({},k),{},P({},e,t)))},saveBroadcastContent:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a("saveContentStatus",1);var n=Array.isArray(e)&&e.length>0?e.map((function(e){if("editor"===e.type&&e.hasOwnProperty("editor")&&e.editor.hasOwnProperty("body")&&(e.body=e.editor.body),"block"===e.type&&e.hasOwnProperty("block")){var t=e.block,n=t.template,r=void 0===n?"":n,a=$(t,["template"]);""!==r&&(e.body=e.block.template),e.block=a}return e})):x,r={content:JSON.stringify(n),saveBroadcastContent:!0};m()({method:"POST",path:Object(b.u)("/broadcast/".concat(L,"/save-content")),data:r}).then((function(){t&&i("data",N(N({},M),{},{data:N(N({},M.data),{},{content:n})})),a("saveContentStatus",2),Array.isArray(e)&&e.length>0&&a("lastUpdatedTime",C()().utc().format("YYYY-MM-DD HH:mm:ss"))}))},uploadImage:function(e){if(e){a("uploadImageStatus",1);var t=new FormData;t.append("image",e),r("POST",Object(b.u)("/upload-image"),t,{uploadImage:!0,isFormData:!0})}},resetSaveContentStatus:function(){return a("saveContentStatus",null)},resetSendTestEmailStatus:function(){return a("sendTestEmailStatus",null)},resetUploadImageStatus:function(){a("uploadImageStatus",null),a("uploadImageStatusURL","")},overrideCurrentContent:function(e){var t=U(_ in v?N({},v[_]):{}),n=t.preheader,r=void 0===n?"":n,o=t.subject,i=void 0===o?"":o,c=N(N({},t),e);""!==r&&(c.preheader=r),""!==i&&(c.subject=i);var s=N(N({},v),{},P({},_,N(N({},t),c)));a("data",s)}})},M=n(61);function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var B=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},D=function(e){var t=L().sendTestEmail,n=(0,S().getSendTestEmailStatus)(),a=R(Object(r.useState)("http://app.getautonami.com"),2),o=a[0],c=a[1],s=Object(r.useRef)();Object(r.useEffect)((function(){s.current=e}),[e]);var u=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"send_test_email"===e.data.action&&e.data.token===B.editor_nonce&&e.data.data){var n=e.data.data,r=n.email,a=n.body,o=n.subject,u=void 0===o?"":o;r&&a&&(c(e.origin),t(r,s.current,u||Object(i.__)("FunnelKit Automations - Test email subject","wp-marketing-automations"),a))}};return Object(r.useEffect)((function(){return window.addEventListener("message",u),function(){return window.removeEventListener("message",u)}}),[]),Object(r.useEffect)((function(){if(n&&1!==n){var e=2===n,t=document.getElementById("bwf_email_editor_frame");t&&t.contentWindow.postMessage({token:B.editor_nonce,action:"send_test_email",data:{isSent:e}},o)}}),[n]),!0};function F(e){return function(e){if(Array.isArray(e))return J(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||W(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||W(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var z=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},K=function(e){var t=L().saveBroadcastContent,n=S(),a=n.getSaveContentStatus,o=n.getEmailsToSubmit,i=n.getCurrentEmailIndex,c=a(),s=o(),u=i(),l=Object(r.useRef)(s),m=Object(r.useRef)(u);Object(r.useEffect)((function(){l.current=s,m.current=u}),[s,u]);var d=V(Object(r.useState)("http://app.getautonami.com"),2),b=d[0],f=d[1],p=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"save_design"===e.data.action&&e.data.token===z.editor_nonce&&e.data.data){var n=e.data.data,r=n.body,a=n.design;if(r&&a){f(e.origin);var o=F(l.current);o[m.current].editor={body:r,design:a},t(o,!0)}}};return Object(r.useEffect)((function(){return window.addEventListener("message",p),function(){return window.removeEventListener("message",p)}}),[]),Object(r.useEffect)((function(){if(c&&1!==c&&e){var t=2===c,n=document.getElementById("bwf_email_editor_frame");n&&n.contentWindow.postMessage({token:z.editor_nonce,action:"save_design",data:{isSaved:t}},b)}}),[c]),!0};function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Z=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Y=function(){var e=G(Object(r.useState)("http://app.getautonami.com"),2),t=e[0],n=e[1],a=function(e){-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"wp_image_upload"===e.data.action&&e.data.token===Z.editor_nonce&&e.data.data&&(n(e.origin),l())},o=Object(r.useRef)(),c=G(Object(r.useState)(""),2),s=c[0],u=c[1],l=function(){if(!wp||!wp.media)return"";o.current||(o.current=wp.media({title:Object(i.__)("Select or Upload Media","wp-marketing-automations"),button:{text:"Select Image"},multiple:!1}),o.current.on("select",(function(){var e=o.current.state().get("selection").first().toJSON();u(e.url)}))),o.current.open()};return Object(r.useEffect)((function(){return window.addEventListener("message",a),function(){return window.removeEventListener("message",a)}}),[]),Object(r.useEffect)((function(){if(s){var e=document.getElementById("bwf_email_editor_frame");e&&e.contentWindow.postMessage({token:Z.editor_nonce,action:"wp_image_upload",data:{isUploaded:!0,imageURL:s}},t)}}),[s]),!0},q=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Q=function(e){var t=(0,S().getEmailContent)(),n=Object(r.useRef)(),a=Object(r.useRef)();Object(r.useEffect)((function(){n.current=t,a.current=function(e){var t={};for(var n in e){var r=e[n];if(r){var a={};for(var o in r)a[o]={name:r[o]&&r[o].hasOwnProperty("tag_description")?r[o].tag_description:"",value:"{{".concat(o,"}}")};t[n]={name:n,mergeTags:a}}}return t}(e)}),[t,e]);var o=function(e){if(-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"get_design"===e.data.action&&e.data.token===q.editor_nonce){var t=Object(b.rb)(),r=n.current&&n.current.editor&&n.current.editor.design?n.current.editor.design:t,o=document.getElementById("bwf_email_editor_frame");o&&o.contentWindow.postMessage({token:q.editor_nonce,action:"get_design",data:{gotDesign:!0,json:r,subject:n.current&&n.current.subject?n.current.subject:"",mergeTags:a.current,enableLinkTrigger:!0,textDirection:Object(b.Kb)()?"rtl":""}},e.origin)}};return Object(r.useEffect)((function(){return window.addEventListener("message",o),function(){return window.removeEventListener("message",o)}}),[]),!0},X=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},ee=function(e){var t=function(t){-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"open_merge_tags"===t.data.action&&t.data.token===X.editor_nonce&&t.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}}),[]),!0},te=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},ne=function(e){var t=function(t){-1!==t.origin.indexOf("app.getautonami.com")&&t.data&&t.data.action&&"close_editor"===t.data.action&&t.data.token===te.editor_nonce&&t.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",t),function(){return window.removeEventListener("message",t)}}),[]),!0},re=n(375),ae=function(e){var t=function(){e&&e()};return Object(r.useEffect)((function(){return window.history.pushState(null,null,window.location.href),window.addEventListener("popstate",t),function(){return window.removeEventListener("popstate",t)}}),[]),!0},oe=n(8),ie=n(39);function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ue=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},le=function(){return Object(r.createElement)("div",{className:"bwf-c-save-content-loading"},Object(r.createElement)(M.a,null),Object(r.createElement)("h3",null,Object(i.__)("Loading Visual Builder","wp-marketing-automations")))},me=function(e){var t=e.iframeRef,n=e.editorSrc;return Object(r.createElement)("iframe",{ref:t,title:Object(i.__)("Email Editor","wp-marketing-automations"),src:n,id:"bwf_email_editor_frame",style:{width:"100%",height:"100%"}})},de=function(e){var t=ce(Object(r.useState)(!1),2),n=t[0],o=t[1],c=ce(Object(r.useState)(!1),2),s=c[0],u=c[1],l=e.broadcastId,m=e.contentNumber,d=e.openMergeTags,f=e.mailData,p=e.mergeTags,g=e.openLinkTrigger,O=ue.license,y=ue.editor_nonce,w=ue.url,j=L(),v=j.fetchCurrentMailEditorContent,_=j.saveBroadcastContent,h=j.resetSaveContentStatus,E=S().getSaveContentStatus(),k=ce(Object(r.useState)(!1),2),C=k[0],A=k[1];Object(r.useEffect)((function(){C||2!==E&&3!==E||(A(!0),h())}),[E]);var T=Object(r.useCallback)((function(){o(!1),v()}));Q(p||[]),D(f),K(C),Y(),ee(d),ne(T),Object(re.a)(g),ae(T);var I="//app.getautonami.com/get/".concat(O,"/").concat(y,"/").concat(w,"/crm.broadcast.").concat(l,".content.").concat(m),x=Object(r.useRef)();return Object(r.useEffect)((function(){n?(_(),document.body.classList.add("bwf-c-modal-open")):(A(!1),document.body.classList.remove("bwf-c-modal-open"))}),[n]),Object(r.createElement)(r.Fragment,null,n&&Object(r.createElement)("div",{className:"bwf-c-editor-modal-wrapper"},Object(r.createElement)("div",{className:"bwf-c-editor-modal bwf-c-editor-modal-full-width"},!C&&Object(r.createElement)(le,null),!!C&&Object(r.createElement)(me,{iframeRef:x,editorSrc:I}))),Object(r.createElement)("div",{className:"bwf-c-editor-button-wrapper"},Object(r.createElement)(oe.a,{icon:"launch-editor",size:40}),Object(r.createElement)("div",{className:"bwf-heading5-new"},Object(i.__)("Visually get email with drop & drop builder.","wp-marketing-automations")),Object(r.createElement)(a.Button,{isTertiary:!0,onClick:function(){Object(b.Jb)()?o(!0):u(!0)}},!Object(b.Jb)()&&b.e,Object(i.__)("Edit","wp-marketing-automations"))),!Object(b.Jb)()&&Object(r.createElement)(ie.b,{isOpen:s,onRequestClose:function(){return u(!1)},modalContent:{isFeature:!0,featureTitle:Object(i.__)("Visual Builder","wp-marketing-automations"),proLink:Object(b.T)("upgrade",{utm_medium:"Visual+Builder+Upgrade+Modal"})}}))},be=n(189),fe=n(41),pe=n(6),ge=n.n(pe),Oe=n(71);function ye(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function we(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){ye(o,r,a,i,c,"next",e)}function c(e){ye(o,r,a,i,c,"throw",e)}i(void 0)}))}}function je(e){return function(e){if(Array.isArray(e))return he(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||_e(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||_e(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _e(e,t){if(e){if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?he(e,t):void 0}}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ee=/\S+@\S+\.\S+/,Se=function(e){var t=e.value,n=void 0===t?"":t,a=e.onUpdate,o=void 0===a?function(){}:a,i=e.label,c=void 0===i?"":i,s=e.placeholder,u=void 0===s?"":s,l=ve(Object(r.useState)(""),2),m=l[0],d=l[1],b=Object(r.useRef)(null),p=""!==n?n.split(","):[],g=function(e){return!(!e.match(Ee)||p.includes(e))};return Object(r.createElement)(r.Fragment,null,""!==c&&Object(r.createElement)("div",{className:"bwf-add-mail-input-label"},c),Object(r.createElement)("div",{className:"bwf-add-mail-input-wrap",onClick:function(){return b.current.focus()}},function(){if(""!==n)return Object(r.createElement)(r.Fragment,null,p.map((function(e,t){return""!==e.trim()&&Object(r.createElement)("span",{key:t,className:"bwf-search__selected-tag",onClick:function(e){return e.stopPropagation()}},e,Object(r.createElement)("span",{onClick:function(t){t.stopPropagation();var n=je(p).filter((function(t){return t!=e}));o(n.join(","))}},Object(r.createElement)(oe.a,{size:16,icon:"cross-circle"})))})))}(),p.length<10&&Object(r.createElement)("input",{type:"text",ref:b,value:m,onChange:function(e){return d(e.target.value)},onKeyDown:function(e){if(["Enter"," "].includes(e.key)&&(e.preventDefault(),g(m))){var t=Object(f.cloneDeep)(p);t.push(m),o(t.join(",")),d("")}},onBlur:function(e){if(e.preventDefault(),g(m)){var t=Object(f.cloneDeep)(p);t.push(m),o(t.join(",")),d("")}},autoComplete:"off",placeholder:u})))},ke=function(e){var t=e.setPreview,n=e.content,c=e.type,s=e.maildata,u=ve(Object(r.useState)(Object(b.nb)()),2),l=u[0],d=u[1],p=ve(Object(r.useState)(!0),2),g=p[0],O=p[1],y=ve(Object(r.useState)(Object(b.nb)()),2),w=y[0],j=y[1],v=ve(Object(r.useState)(""),2),_=v[0],h=v[1],E=ve(Object(r.useState)(!1),2),k=E[0],C=E[1],A=ve(Object(r.useState)("desktop"),2),T=A[0],I=A[1],x=L(),N=S().validateCurrentEmail(),P=Object(r.useContext)(b.h),$=x.sendTestEmail;Object(r.useEffect)((function(){R()}),[]);var R=function(){var e=we(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=4;break}return d(""),O(!1),e.abrupt("return");case 4:return e.prev=4,t={content:n,type:c},e.next=8,m()({path:Object(b.u)("/broadcast/email-preview"),method:"POST",data:t}).then((function(e){d(e.result.body.replace(/\\/g,"")),O(!1)}));case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(4);case 12:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=we(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C(!0),n=void 0,n=!1,!Object(f.isEmpty)(w)&&N.content&&N.type&&N.utmMedium&&N.utmSource||(n=!0),n){e.next=7;break}return h(""),e.next=5,$(w,s,"","").then((function(e){setTimeout((function(){C(!1),Object(f.isInteger)(e)&&2===parseInt(e)?P(Object(i.__)("Test mail sent successfully.","wp-marketing-automations")):P(Object(i.__)("Test mail failed to send.","wp-marketing-automations")),Object(b.wb)(P,3e3)}),1e3)}));case 5:e.next=12;break;case 7:t="",Object(f.isEmpty)(w)&&(t=Object(i.__)("Email is required field.","wp-marketing-automations")),Object(f.isEmpty)(t)&&!N.content&&(t=Object(i.__)("Mail content is required field.","wp-marketing-automations")),h(t),C(!1);case 12:case"end":return e.stop()}var n}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.createElement)(a.Modal,{className:"bwf-admin-modal bwf-admin-modal-no-header bwf-admin-modal-fullscreen bwf-fullsc-modal",shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1},Object(r.createElement)("div",{className:"bwf-stretch-header-single"},Object(r.createElement)("div",{className:"bwf-left-section"},Object(r.createElement)("div",{className:"bwf-editable-title"},Object(i.__)("Preview & Test","wp-marketing-automations"))),Object(r.createElement)("div",{className:"bwfan-responsive-toggle"},["desktop","mobile"].map((function(e){return Object(r.createElement)(o.a,{key:e,className:ge()("bwf-responsive-toggle-icon",{"active-screen":T===e}),onClick:function(){void 0!==I&&I(e)},showTooltip:!1,size:20,title:Object(f.capitalize)(e)},Object(r.createElement)(oe.a,{icon:e,size:20,color:T===e?"#353030":"#82838e"}))}))),Object(r.createElement)("div",{className:"bwf-right-section"},Object(r.createElement)("div",{className:"bwf-back-button bwf-display-flex bwf-cursor-pointer",onClick:function(){return t(!1)}},Object(r.createElement)(oe.a,{icon:"cross"})))),Object(r.createElement)("div",{className:"bwf-preview-model-content"},Object(r.createElement)("div",{className:"bwf-preview-model-c-sidebar"},Object(r.createElement)("div",{className:ge()("bwf-send-test-email",{"bwf-has-error":!!_})},Object(r.createElement)("div",{className:"bwf-send-test-email-header"},Object(i.__)("Send to Test Email","wp-marketing-automations")),Object(r.createElement)(Se,{value:w,onUpdate:function(e){Object(b.Yb)(e),j(e)},label:Object(i.__)("Send email upto 10 email addresses","wp-marketing-automations"),placeholder:Object(i.__)("Type hereâ€¦","wp-marketing-automations")}),""!==_&&Object(r.createElement)("div",{className:"bwf-send-email-err"},_),Object(r.createElement)("div",{className:"bwf-send-test-email-hint"},Object(i.__)("You can add new email addresses by pressing enter or spacebar on your keyboard","wp-marketing-automations")),Object(r.createElement)(o.a,{variant:"primary",className:"bwf-test-email-btn bwf-no-ripple "+(k?"isloading":""),onClick:U},k?Object(r.createElement)(Oe.a,{color:"#ffffff"}):Object(i.__)("Send Email","wp-marketing-automations")))),Object(r.createElement)("div",{className:"bwf-preview-model-c-preview"},Object(r.createElement)("div",{className:"bwf-iframe bwf-preview-screen-"+T},g?Object(r.createElement)(M.a,null):Object(r.createElement)("iframe",{srcDoc:l})))))},Ce=n(1009),Ae=n(391),Te=n(187),Ie=function(e){var t=e.enable,n=e.position,o=e.imageURL,c=e.setData;return Object(r.createElement)("div",{className:"bwf-c-campaign-email"},Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)(a.ToggleControl,{label:Object(i.__)("Enable Image Sending","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",checked:t,onChange:function(e){return c("enable",e)}}),t&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)(a.RadioControl,{className:"bwfcrm-inline-option",selected:n,label:Object(i.__)("Select Image Position","wp-marketing-automations"),options:[{value:"after",label:Object(i.__)("After","wp-marketing-automations")},{value:"before",label:Object(i.__)("Before","wp-marketing-automations")}],onChange:function(e){return c("position",e)}}),Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)(Te.a,{image:o?{url:o}:"",onChange:function(e){!Object(f.isNull)(e)&&e.hasOwnProperty("url")?c("imageURL",e.url):c("imageURL","")}})))},xe=n(212),Ne=n(50);function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){Le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Re(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ue=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Be=function(){var e=Me(Object(r.useState)(!1),2),t=e[0],n=e[1],a=Me(Object(r.useState)(!1),2),o=a[0],i=a[1],c=Object(Ne.a)(Object(b.kb)()).formatAmount,s=Object(r.useCallback)((function(e){var t=document.getElementById("bwf_email_editor_frame");t&&t.contentWindow.postMessage({token:Ue.editor_nonce,action:"select_product_for_tool",data:{product:$e($e({},e),{},{formattedPrice:c(e.price)})}},o),n(!1)}),[o]),u=Object(r.useCallback)((function(e){-1!==e.origin.indexOf("app.getautonami.com")&&e.data&&e.data.action&&"select_product_for_tool"===e.data.action&&e.data.token===Ue.editor_nonce&&(i(e.origin),n(!0))}),[n]);return Object(r.useEffect)((function(){return window.addEventListener("message",u),function(){return window.removeEventListener("message",u)}}),[]),t&&Object(r.createElement)(xe.a,{onRequestClose:function(){return n(!1)},onProductSelected:s})},De=n(332),Fe=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Ve=function(e,t,n){var a=e.mergeTags,o=(e.enableConditional,S()),c=o.getEmailContent,u=o.getCurrentEmailIndex,l=o.getLastUpdatedTime,m=c(),d=(u(),Object(r.useRef)()),p=Object(r.useRef)(),g=s.a.getCampaignData().last_modified,O=void 0===g?"":g,y=l();Object(r.useEffect)((function(){d.current=m,p.current=function(e){var t={group:[],data:{}};for(var n in e){var r=e[n];if(r){var a="";switch(n){case"contact":a={label:Object(i.__)("Contact","wp-marketing-automations"),value:"contact"};break;case"contact_fields":a={label:Object(i.__)("Fields","wp-marketing-automations"),value:"contact_fields"};break;case"general":a={label:Object(i.__)("General","wp-marketing-automations"),value:"general"};break;case"affwp":a={label:Object(i.__)("Affiliate WP","wp-marketing-automations"),value:"affwp"}}t.group.push(a),t.data[n]=r}}return t}(a)}),[m,a]);var w=Fe.license,j=void 0===w?"":w,v=function(e){if(-1!==e.origin.indexOf(t)&&e.data&&e.data.action&&"getEditorContent"===e.data.action){var n,r,a,o=d.current&&d.current.block&&d.current.block.body?d.current.block.body:"",c=d.current&&d.current.block&&d.current.block.settings&&!Object(f.isEmpty)(d.current.block.settings)?d.current.block.settings:{},s=document.getElementById("bwf_block_editor_frame");s&&s.contentWindow.postMessage({token:Fe.editor_nonce,action:"editorContent",data:{title:d.current&&d.current.subject?d.current.subject:"",previewText:d.current&&d.current.preheader?d.current.preheader:"",content:o,siteSettings:Object(b.X)(),last_updated:y||O,editorSettings:c,disableTitleHeader:!1,enableTemplate:!0,enableMergeTags:!Object(f.isEmpty)(p.current),mergeTagData:p.current,enableConditions:!1,enableMediaUpload:!0,blockSupported:[],isWCActive:Object(b.Tb)(),isPro:Object(b.Jb)(),proModalData:{heading:Object(i.__)("This is a Pro Feature","wp-marketing-automations"),content:Object(i.__)("We're sorry, this feature is not available on your plan. Please upgrade to the PRO plan to unlock all these awesome features.","wp-marketing-automations"),cta_text:Object(i.__)("Go Pro","wp-marketing-automations"),link:"#"},client_id:"e682ca5385e5cbd92e285aae974f73cf",client_secret:"5ab88daa93c6279318ea6fbaae56ee69",license:(a=j,a?a.split("").filter((function(e,t){return t%2!=0})).reverse().join(""):a),support:(r={},Object(b.Tb)()&&(r.wc=[]),r),integrations:{wc:{blocks:[],api:{get_products:Object(b.hb)()+"/wp-json/".concat(b.g,"/bwf-products"),get_product:Object(b.hb)()+"wp-json/".concat(b.g,"/bwf-product")}}},apiEndpoints:(n={get_templates:Object(b.hb)()+"/wp-json/".concat(b.g,"/templates/?get_template=true&mode=5"),get_template:Object(b.hb)()+"/wp-json/".concat(b.g,"/template/"),get_layouts:Object(b.hb)()+"/wp-json/".concat(b.g,"/layouts/"),get_pages:Object(b.hb)()+"/wp-json/wp/v2/search"},Object(b.Tb)()&&(n.get_wc_coupon=Object(b.hb)()+"/wp-json/".concat(b.g,"/wc-coupons/"),n.get_category=Object(b.hb)()+"/wp-json/".concat(b.g,"/wc-category/")),n),siteDomain:Object(b.hb)(),blockNavigationToolbar:[{name:"merge-tag",title:"Merge Tag",icon:'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <g> <path d="M3.375 4.3125C3.375 3.17341 4.29841 2.25 5.4375 2.25C5.74816 2.25 6 2.50184 6 2.8125C6 3.12316 5.74816 3.375 5.4375 3.375C4.91973 3.375 4.5 3.79473 4.5 4.3125V7.54386C4.5 8.10258 4.27499 8.62185 3.89825 9C4.27499 9.37815 4.5 9.89742 4.5 10.4561V13.6875C4.5 14.2053 4.91973 14.625 5.4375 14.625C5.74816 14.625 6 14.8768 6 15.1875C6 15.4982 5.74816 15.75 5.4375 15.75C4.29841 15.75 3.375 14.8266 3.375 13.6875V10.4561C3.375 10.0526 3.11678 9.69436 2.73396 9.56675L2.63462 9.53363C2.40493 9.45707 2.25 9.24212 2.25 9C2.25 8.75788 2.40493 8.54293 2.63462 8.46637L2.73396 8.43325C3.11678 8.30564 3.375 7.94739 3.375 7.54386V4.3125ZM14.625 4.3125C14.625 3.17341 13.7016 2.25 12.5625 2.25C12.2518 2.25 12 2.50184 12 2.8125C12 3.12316 12.2518 3.375 12.5625 3.375C13.0803 3.375 13.5 3.79473 13.5 4.3125V7.54386C13.5 8.10258 13.725 8.62185 14.1017 9C13.725 9.37815 13.5 9.89742 13.5 10.4561V13.6875C13.5 14.2053 13.0803 14.625 12.5625 14.625C12.2518 14.625 12 14.8768 12 15.1875C12 15.4982 12.2518 15.75 12.5625 15.75C13.7016 15.75 14.625 14.8266 14.625 13.6875V10.4561C14.625 10.0526 14.8832 9.69436 15.266 9.56675L15.3654 9.53363C15.5951 9.45707 15.75 9.24212 15.75 9C15.75 8.75788 15.5951 8.54293 15.3654 8.46637L15.266 8.43325C14.8832 8.30564 14.625 7.94739 14.625 7.54386V4.3125Z" fill="#0073AA"/> </g> </svg>',clickAction:"openMergeTags",visibility:{show:["email-block/heading","email-block/button","email-block/text","email-block/list","email-block/menu"],hide:[]}},{name:"link-trigger",title:"Link Trigger",icon:'<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <g> <path d="M8.38495 4.85271C8.17288 5.0012 8.12134 5.29349 8.26983 5.50555C8.40182 5.69405 8.64743 5.75572 8.84932 5.66281L8.92267 5.62067L10.4586 4.54521C11.731 3.65427 13.4847 3.9635 14.3756 5.23589C15.2309 6.45738 14.9802 8.12248 13.833 9.04197L13.685 9.15294L12.149 10.2284C11.937 10.3769 11.8854 10.6692 12.0339 10.8812C12.1659 11.0697 12.4115 11.1314 12.6134 11.0385L12.6868 10.9964L14.2227 9.92089C15.9192 8.73298 16.3315 6.39468 15.1436 4.69816C13.9953 3.05819 11.772 2.61825 10.0926 3.66379L9.92086 3.77725L8.38495 4.85271ZM3.77722 8.07908C2.0807 9.26699 1.66839 11.6053 2.85631 13.3018C4.00463 14.9418 6.22791 15.3817 7.90731 14.3362L8.07904 14.2227L9.61495 13.1473C9.82701 12.9988 9.87855 12.7065 9.73006 12.4944C9.59807 12.3059 9.35246 12.2443 9.15057 12.3372L9.07722 12.3793L7.54131 13.4548C6.26892 14.3457 4.5152 14.0365 3.62426 12.7641C2.76896 11.5426 3.01974 9.8775 4.1669 8.958L4.31494 8.84703L5.85085 7.77158C6.06292 7.62309 6.11446 7.3308 5.96597 7.11874C5.83398 6.93023 5.58837 6.86857 5.38648 6.96148L5.31313 7.00362L3.77722 8.07908ZM11.8029 6.4651L5.65926 10.7669C5.4472 10.9154 5.39566 11.2077 5.54415 11.4198C5.67614 11.6083 5.92175 11.6699 6.12364 11.577L6.19699 11.5349L12.3406 7.23305C12.5527 7.08456 12.6042 6.79228 12.4557 6.58021C12.3238 6.39171 12.0781 6.33004 11.8763 6.42295L11.8029 6.4651L5.65926 10.7669L11.8029 6.4651Z" fill="#0073AA"/> </g> </svg>',clickAction:"openLinkTrigger",visibility:{show:["email-block/heading","email-block/button","email-block/text","email-block/list","email-block/menu"],hide:[]}}],isRTL:Object(b.Kb)(),testEmails:Object(b.nb)(),footer:bwfanParams.bwfan_global_settings.bwfan_email_footer_setting,webFonts:b.ub,version:1===Object(b.l)(bwfcrm_contacts_data.bwf_pro_version,"3.0.1")?"1.0.1":"1.0"}},e.origin)}};return Object(r.useEffect)((function(){return window.addEventListener("message",v),function(){return window.removeEventListener("message",v)}}),[]),!0},We=function(e,t,n){var a=function(n){-1!==n.origin.indexOf(t)&&n.data&&n.data.action&&"closeEditor"===n.data.action&&n.data.data&&e&&e()};return Object(r.useEffect)((function(){return window.addEventListener("message",a),function(){return window.removeEventListener("message",a)}}),[]),!0};function Je(e){return function(e){if(Array.isArray(e))return Ge(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ke(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||Ke(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ke(e,t){if(e){if("string"==typeof e)return Ge(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ge(e,t):void 0}}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var He=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Ze=function(e,t,n,a){var o=L().saveBroadcastContent,i=S(),c=i.getSaveContentStatus,s=i.getEmailsToSubmit,u=i.getCurrentEmailIndex,l=c(),m=s(),d=u(),b=Object(r.useRef)(m),p=Object(r.useRef)(d);Object(r.useEffect)((function(){b.current=m,p.current=d}),[m,d]);var g=ze(Object(r.useState)(a),2),O=g[0],y=g[1],w=function(e){if(-1!==e.origin.indexOf(n)&&e.data&&e.data.action&&"saveEditorContent"===e.data.action&&e.data.data){var t=e.data.data,r=t.block,a=void 0===r?{}:r,i=t.subject,c=void 0===i?"":i,s=t.preheader,u=void 0===s?"":s;if(!Object(f.isEmpty)(a)||!Object(f.isEmpty)(c)){y(e.origin);var l=Je(b.current);Object(f.isEmpty)(a)||(l[d].block=a),a.hasOwnProperty("template")&&(l[d].body=a.template),""!==c&&(l[d].subject=c),""!==u&&(l[d].preheader=u),o(l,!0)}}};return Object(r.useEffect)((function(){return window.addEventListener("message",w),function(){return window.removeEventListener("message",w)}}),[]),Object(r.useEffect)((function(){if(l&&1!==l&&e&&!t){var n=2===l,r=document.getElementById("bwf_block_editor_frame");r&&r.contentWindow.postMessage({token:He.editor_nonce,action:"contentSaved",isSaved:n},O)}}),[l]),!0};function Ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Qe=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Xe=function(e,t,n){var a=L().sendTestEmail,o=(0,S().getSendTestEmailStatus)(),c=Ye(Object(r.useState)(n),2),s=c[0],u=c[1],l=Object(r.useRef)();Object(r.useEffect)((function(){l.current=e}),[e]);var m=function(e){if(-1!==e.origin.indexOf(t)&&e.data&&e.data.action&&"sendTestMail"===e.data.action&&e.data.data){var n=e.data.data,r=n.email,o=n.body,c=n.subject,s=void 0===c?"":c;r&&o&&(u(e.origin),a(r,l.current,s||Object(i.__)("Autonami - Test email subject","wp-marketing-automations"),o))}};return Object(r.useEffect)((function(){return window.addEventListener("message",m),function(){return window.removeEventListener("message",m)}}),[]),Object(r.useEffect)((function(){if(o&&1!==o){var e=2===o,t=document.getElementById("bwf_block_editor_frame");t&&t.contentWindow.postMessage({token:Qe.editor_nonce,action:"testMessageConfirmation",isSent:e},s)}}),[o]),!0};function et(e){return function(e){if(Array.isArray(e))return rt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||nt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||nt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nt(e,t){if(e){if("string"==typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(e,t):void 0}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings&&bwfcrm_contacts_data.editor_settings;var at=function(e,t,n,a,o,i){var c=L().saveBroadcastContent,s=S(),u=s.getSaveContentStatus,l=s.getEmailsToSubmit,m=s.getCurrentEmailIndex,d=u(),b=l(),p=m(),g=Object(r.useRef)(b),O=Object(r.useRef)(p);Object(r.useEffect)((function(){g.current=b,O.current=p}),[b,p]);var y=tt(Object(r.useState)(o),2),w=(y[0],y[1]),j=function(e){if(-1!==e.origin.indexOf(a)&&e.data&&e.data.action&&"importTemplate"===e.data.action&&e.data.data){var t=e.data.data,r=t.block,o=void 0===r?{}:r,i=t.subject,s=void 0===i?"":i,u=t.preheader,l=void 0===u?"":u;t.utmEnable,t.utm;if(!Object(f.isEmpty)(o)||!Object(f.isEmpty)(s)){w(e.origin),w(e.origin);var m=et(g.current);m[p].block=o,""!==s&&(m[p].subject=s,m[p].preheader=l),n(!0),c(m)}}};return Object(r.useEffect)((function(){return window.addEventListener("message",j),function(){return window.removeEventListener("message",j)}}),[]),Object(r.useEffect)((function(){d&&1!==d&&e&&t&&(n(!0),document.getElementById("bwf_block_editor_frame").src=i,setTimeout((function(){n(!1)}),2e3))}),[d]),!0};function ot(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function it(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ct(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var st=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},ut=function(e,t){var n=it(Object(r.useState)(t),2),a=n[0],o=n[1],i=function(e,t){var n=document.getElementById("bwf_block_editor_frame");n&&n.contentWindow.postMessage({token:st.editor_nonce,action:"layoutSaved",isSaved:e,id:t},a)},c=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==n.origin.indexOf(e)&&n.data&&n.data.action&&"saveLayout"===n.data.action&&n.data.data){t.next=2;break}return t.abrupt("return");case 2:return o(n.origin),t.prev=3,t.next=6,m()({path:Object(b.u)("/layout"),method:"POST",data:n.data.data}).then((function(e){200===e.code&&e.result&&e.result.id?i(!0,e.result.id):i(!1)}));case 6:t.next=10;break;case 8:t.prev=8,t.t0=t.catch(3);case 10:case"end":return t.stop()}}),t,null,[[3,8]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){ot(o,r,a,i,c,"next",e)}function c(e){ot(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}();return Object(r.useEffect)((function(){return window.addEventListener("message",c),function(){return window.removeEventListener("message",c)}}),[]),!0};function lt(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function mt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bt=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},ft=function(e,t){var n=mt(Object(r.useState)(t),2),a=n[0],o=n[1],i=function(e,t){var n=document.getElementById("bwf_block_editor_frame");n&&n.contentWindow.postMessage({token:bt.editor_nonce,action:"layoutDeleted",isDeleted:e,id:t},a)},c=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==n.origin.indexOf(e)&&n.data&&n.data.action&&"deleteLayout"===n.data.action&&n.data.data){t.next=2;break}return t.abrupt("return");case 2:return r=n.data.data.id,o(n.origin),t.prev=4,t.next=7,m()({path:Object(b.u)("/layout/".concat(parseInt(r))),method:"POST"}).then((function(e){200===e.code?i(!0,r):i(!1,r)}));case 7:t.next=11;break;case 9:t.prev=9,t.t0=t.catch(4);case 11:case"end":return t.stop()}}),t,null,[[4,9]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){lt(o,r,a,i,c,"next",e)}function c(e){lt(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}();return Object(r.useEffect)((function(){return window.addEventListener("message",c),function(){return window.removeEventListener("message",c)}}),[]),!0};function pt(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function gt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ot(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yt=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},wt=function(e,t){var n=gt(Object(r.useState)(t),2),a=n[0],o=n[1],i=function(e){var t=document.getElementById("bwf_block_editor_frame");t&&t.contentWindow.postMessage({token:yt.editor_nonce,action:"templateData",data:e},a)},c=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==n.origin.indexOf(e)&&n.data&&n.data.action&&"getTemplates"===n.data.action&&n.data.data){t.next=2;break}return t.abrupt("return");case 2:return o(n.origin),t.prev=3,t.next=6,fetch(Object(b.hb)()+"/wp-json/".concat(b.g,"/templates/?get_template=true")).then((function(e){i(e||[])}));case 6:t.next=10;break;case 8:t.prev=8,t.t0=t.catch(3);case 10:case"end":return t.stop()}}),t,null,[[3,8]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){pt(o,r,a,i,c,"next",e)}function c(e){pt(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}();return Object(r.useEffect)((function(){return window.addEventListener("message",c),function(){return window.removeEventListener("message",c)}}),[]),!0};function jt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _t=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},ht=function(e,t){var n=jt(Object(r.useState)(t),2),a=n[0],o=n[1],c=function(t){-1!==t.origin.indexOf(e)&&t.data&&t.data.action&&"openMediaUpload"===t.data.action&&t.data.data&&(o(t.origin),p())},s=Object(r.useRef)(),u=jt(Object(r.useState)(""),2),l=u[0],m=u[1],d=jt(Object(r.useState)(!1),2),b=d[0],f=d[1],p=function(){return wp&&wp.media?s.current?(f(!1),void s.current.open()):(s.current=wp.media({title:Object(i.__)("Select or Upload Media","wp-marketing-automations"),button:{text:Object(i.__)("Select Image","wp-marketing-automations")},multiple:!1}),s.current.on("select",(function(){var e=s.current.state().get("selection").first().toJSON();m(e.url)})),s.current.on("close",(function(){f(!0)})),void s.current.open()):""};return Object(r.useEffect)((function(){return window.addEventListener("message",c),function(){return window.removeEventListener("message",c)}}),[]),Object(r.useEffect)((function(){if(l){var e=document.getElementById("bwf_block_editor_frame");e&&e.contentWindow.postMessage({token:_t.editor_nonce,action:"mediaUploadDone",data:{isUploaded:!0,imageURL:l}},a)}}),[l]),Object(r.useEffect)((function(){var e=document.getElementById("bwf_block_editor_frame");e&&e.contentWindow.postMessage({token:_t.editor_nonce,action:"mediaUploadClose",data:{isUploaded:!1}},a)}),[b]),!0},Et=(bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings&&bwfcrm_contacts_data.editor_settings,function(e,t,n){var a=function(n){-1!==n.origin.indexOf(t)&&n.data&&n.data.action&&"openMergeTags"===n.data.action&&n.data.data&&e&&e(!0)};return Object(r.useEffect)((function(){return window.addEventListener("message",a),function(){return window.removeEventListener("message",a)}}),[]),!0}),St=(bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings&&bwfcrm_contacts_data.editor_settings,function(e,t,n){var a=function(n){-1!==n.origin.indexOf(t)&&n.data&&n.data.action&&"openLinkTrigger"===n.data.action&&n.data.data&&e&&e(!0)};return Object(r.useEffect)((function(){return window.addEventListener("message",a),function(){return window.removeEventListener("message",a)}}),[]),!0});function kt(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function Ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return At(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return At(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Tt=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},It=function(e,t){var n=Ct(Object(r.useState)(t),2),a=n[0],o=n[1],i=function(e){var t=document.getElementById("bwf_block_editor_frame");t&&t.contentWindow.postMessage({token:Tt.editor_nonce,action:"layoutData",data:e},a)},c=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(-1!==n.origin.indexOf(e)&&n.data&&n.data.action&&"getLayouts"===n.data.action&&n.data.data){t.next=2;break}return t.abrupt("return");case 2:return o(n.origin),t.prev=3,t.next=6,fetch(Object(b.hb)()+"/wp-json/autonami-app/layouts/").then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("result")?i(e.result):i([])}));case 6:t.next=10;break;case 8:t.prev=8,t.t0=t.catch(3);case 10:case"end":return t.stop()}}),t,null,[[3,8]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){kt(o,r,a,i,c,"next",e)}function c(e){kt(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return n.apply(this,arguments)}}();return Object(r.useEffect)((function(){return window.addEventListener("message",c),function(){return window.removeEventListener("message",c)}}),[]),!0},xt=(bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings&&bwfcrm_contacts_data.editor_settings,function(e,t,n,a,o){var i=function(r){-1!==r.origin.indexOf(a)&&r.data&&r.data.action&&"openConditionalModal"===r.data.action&&r.data.data&&(n&&n(r.data.data),t&&t(r.origin),e&&e(!0))};return Object(r.useEffect)((function(){return window.addEventListener("message",i),function(){return window.removeEventListener("message",i)}}),[]),!0}),Nt=function(e){var t=function(){e&&e()};return Object(r.useEffect)((function(){return window.history.pushState(null,null,window.location.href),window.addEventListener("popstate",t),function(){return window.removeEventListener("popstate",t)}}),[]),!0},Pt=n(269),$t=n.n(Pt),Lt=n(282),Mt=n(388);function Rt(){return(Rt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ut(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Bt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Dt=bwfcrm_contacts_data&&bwfcrm_contacts_data.editor_settings?bwfcrm_contacts_data.editor_settings:{},Ft=function(){return Object(r.createElement)("div",{className:"bwf-c-save-content-loading"},Object(r.createElement)($t.a,{options:{loop:!0,autoplay:!0,animationData:Lt,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},height:480,width:480}),Object(r.createElement)("div",{style:{marginTop:"-60px",fontSize:"21px",fontWeight:"400",paddingLeft:"40px"}},Object(i.__)("Launching Editor","wp-marketing-automations")))},Vt=function(e){var t=e.iframeRef,n=e.editorSrc,a=e.isImport;return Object(r.createElement)("iframe",{ref:t,title:Object(i.__)("Block Editor","wp-marketing-automations"),src:n,id:"bwf_block_editor_frame",style:{width:"100%",height:"100%",display:a?"none":"block"}})},Wt=function(){return Object(r.createElement)("div",{className:"bwf-c-save-content-loading"},Object(r.createElement)($t.a,{options:{loop:!0,autoplay:!0,animationData:Lt,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},height:480,width:480}),Object(r.createElement)("div",{style:{marginTop:"-60px",fontSize:"21px",fontWeight:"400",paddingLeft:"40px"}},Object(i.__)("Importing Template","wp-marketing-automations")))},Jt=function(e){e.broadcastId,e.contentNumber;var t=e.openMergeTags,n=e.mailData,a=e.mergeTags,o=e.openLinkTrigger,i=e.setOpen,c=e.setConditionalModal,s=e.setConditionalEventOrigin,u=e.setConditionalData,l=e.enableConditional,m=(Dt.license,Dt.editor_nonce,Dt.url,L()),d=m.fetchCurrentMailEditorContent,f=m.saveBroadcastContent,p=m.resetSaveContentStatus,g=S().getSaveContentStatus(),O=Ut(Object(r.useState)(!1),2),y=O[0],w=O[1],j=Ut(Object(r.useState)(!1),2),v=j[0],_=j[1];Object(r.useEffect)((function(){y||2!==g&&3!==g||(w(!0),p())}),[g]);var h=Object(r.useCallback)((function(){i(!1),d()})),E=Object(b.J)(),k=E.iframeOrigin,C=E.iframeURL,A=E.editorSrc;Ve({mergeTags:a||[],enableConditional:l},k,C),Ze(y,v,k,C),We(h,k,C),Xe(n,k,C),at(y,v,_,k,C,A),ut(k,C),ft(k,C),wt(k,C),It(k,C),Et(t,k,C),St(o,k,C),ht(k,C),xt(c,s,u,k,C),Nt(h),Object(Mt.a)(k,C);var T=Object(r.useRef)();return Object(r.useEffect)((function(){return f(),document.body.classList.add("bwf-c-modal-open"),w(!1),function(){document.body.classList.remove("bwf-c-modal-open")}}),[]),Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-editor-modal-wrapper"},Object(r.createElement)("div",{className:"bwf-c-editor-modal bwf-c-editor-modal-full-width"},!y&&Object(r.createElement)(Ft,null),v&&Object(r.createElement)(Wt,null),!!y&&Object(r.createElement)(Vt,{iframeRef:T,editorSrc:A,isImport:v}))))},zt=function(e){var t=Ut(Object(r.useState)(!1),2),n=t[0],o=t[1],c=Ut(Object(r.useState)(!1),2),s=c[0],u=c[1];return n?Object(r.createElement)(Jt,Rt({},e,{setOpen:o})):Object(r.createElement)("div",{className:"bwf-c-editor-button-wrapper"},Object(r.createElement)(oe.a,{icon:"launch-editor",size:40}),Object(r.createElement)("div",{className:"bwf-heading5-new"},Object(i.__)("Utilize our drag & drop builder to craft elegant email templates including WooCommerce Blocks.","wp-marketing-automations")),Object(r.createElement)(a.Button,{isTertiary:!0,onClick:function(){Object(b.Jb)()?o(!0):u(!0)}},!Object(b.Jb)()&&b.e,Object(i.__)("Edit","wp-marketing-automations")),!Object(b.Jb)()&&Object(r.createElement)(ie.b,{isOpen:s,onRequestClose:function(){return u(!1)},modalContent:{isFeature:!0,featureTitle:Object(i.__)("New Visual Builder","wp-marketing-automations"),proLink:Object(b.T)("upgrade",{utm_medium:"New+Visual+Builder+Upgrade+Modal"})}}))},Kt=n(464),Gt=n(53);function Ht(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){qt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var en=Object(b.lb)(),tn=[{label:Object(i.__)("Visual Builder","wp-marketing-automations"),value:"block",className:"bwf-display-flex bwf-campaign-template-type"},{label:Object(i.__)("Rich Text","wp-marketing-automations"),value:"rich",className:"bwf-display-flex bwf-campaign-template-type "},en.includes("wc")&&{label:Object(i.__)("WooCommerce","wp-marketing-automations"),value:"wc",className:"bwf-display-flex bwf-campaign-template-type "},{label:Object(i.__)("Raw HTML","wp-marketing-automations"),value:"html",className:"bwf-display-flex bwf-campaign-template-type"},{label:Object(i.__)("Visual Builder","wp-marketing-automations"),value:"editor",className:"bwf-display-flex bwf-campaign-template-type"}].filter(Boolean),nn=function(e){var t=e.maildata,n=e.setTemplateModal,o=s.a.getCampaignData(),c=parseInt(o.type),u=Object(b.C)(),l=L(),m=l.setEmailContentByKey,d=l.setEmailUtmByKey,O=l.setMultipleUtm,y=l.resetSendTestEmailStatus,w=l.sendTestEmail,j=Qt(Object(r.useState)(!1),2),v=j[0],_=j[1],h=Qt(Object(r.useState)(""),2),E=h[0],k=h[1],C=Qt(Object(r.useState)(!1),2),A=C[0],T=C[1],I=S(),x=I.getEmailContent()?I.getEmailContent():{},N=Qt(Object(r.useState)(!1),2),P=N[0],$=N[1],M="utm"in x?x.utm:{},R=Qt(Object(r.useState)(!1),2),U=R[0],B=R[1],D=Qt(Object(r.useState)(""),2),F=D[0],V=D[1],W=Qt(Object(r.useState)([]),2),J=W[0],z=W[1],K="subject"in x?x.subject:"",G="preheader"in x?x.preheader:"",H="type"in x?x.type:"block",Z="utmEnabled"in x&&x.utmEnabled,Y=Qt(Object(r.useState)({message:"",type:1}),2),q=Y[0],Q=Y[1],X="whatsAppImage"in x&&x.whatsAppImage,ee="whatsAppImageSetting"in x?x.whatsAppImageSetting:{},te="position"in ee?ee.position:"after",ne="imageURL"in ee?ee.imageURL:"",re="source"in M?M.source:"",ae="medium"in M?M.medium:"",ce="name"in M?M.name:"",se="content"in M?M.content:"",ue="term"in M?M.term:"",le=Qt(Object(r.useState)(!1),2),me=le[0],pe=le[1],Oe=I.getShowValidationFlag(),ye=Qt(Object(r.useState)(!1),2),we=ye[0],je=ye[1],ve=Qt(Object(r.useState)("content"),2),_e=ve[0],he=ve[1],Ee=Qt(Object(r.useState)([]),2),Se=Ee[0],Te=Ee[1],xe=Qt(Object(r.useState)(!1),2),Ne=xe[0],Pe=xe[1],$e=I.getCurrentEmailIndex(),Le=x&&x.body?x.body:"",Me="editor"in x?x.editor:{},Re=Me&&Me.body?Me.body:"",Ue="editor"===H?Re:Le,Fe="<p>Hi {{contact_first_name}},</p><p></p>"+bwfanParams.bwfan_global_settings.bwfan_email_footer_setting;Object(r.useEffect)((function(){Object(f.isEmpty)(Le)&&m("body",1==c?Fe:"Hi {{contact_first_name}},")}),[Le]);var Ve=Z?Yt(Yt({},t),{},{utmName:ce,utmMedium:ae,utmContent:se,utmSource:re,utmTerm:ue}):t;Object(r.useEffect)((function(){if(Z){var e={};!re&&(e.source=Object(i.__)("Newsletter","wp-marketing-automations")),!ae&&(e.medium=u[c].label),!ce&&(e.name=Object(f.trim)(o.title).replace(/\s/g,"-")),O(e)}}),[Z]);var We=I.validateCurrentEmail(),Je={1:Object(i.__)("Place your HTML here","wp-marketing-automations"),2:Object(i.__)("Enter the SMS Body","wp-marketing-automations"),3:Object(i.__)("Place your message here","wp-marketing-automations")},ze=function(){return"editor"==x.type?x.hasOwnProperty("editor")&&x.editor.hasOwnProperty("body")?x.editor.body:"":x.body},Ke=I.getSendTestEmailStatus();Object(r.useEffect)((function(){null!==Ke&&setTimeout((function(){y(),Q({message:"",type:1})}),2e3),2===Ke&&Q({message:1==c?Object(i.__)("Test email sent","wp-marketing-automations"):Object(i.__)("Test message sent","wp-marketing-automations"),type:1}),3===Ke&&Q({message:1==c?Object(i.__)("Unable to send mail","wp-marketing-automations"):Object(i.__)("Unable to send message","wp-marketing-automations"),type:1})}),[Ke]);var Ge=Oe&&!We.subject?" bwf-field-error":"",He=Oe&&!We.content?" bwf-field-error-textarea":"",Ze=Oe&&!We.utmSource?" bwf-field-error":"",Ye=Oe&&!We.utmMedium?" bwf-field-error":"";return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf-c-campaign-body"},1===c&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.TextControl,{value:K,onChange:function(e){return m("subject",e)},label:Object(i.__)("Subject","wp-marketing-automations"),placeholder:Object(i.__)("Enter subject","wp-marketing-automations"),className:"bwf-field-m0"+Ge}),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-campaign-mail-headers-wrap"},Object(r.createElement)(a.TextControl,{value:G,placeholder:Object(i.__)("Enter preview text","wp-marketing-automations"),label:Object(i.__)("Preview Text","wp-marketing-automations"),onChange:function(e){return m("preheader",e)}})),Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)("div",{className:"bwf-heading7-new bwf-mb-8"},Object(i.__)("Template Type","wp-marketing-automations")),Object(r.createElement)("div",{className:"bwf-select-template-type"},tn.map((function(e){return Object(r.createElement)("label",{key:e.value,className:ge()({"is-selected":H===e.value})},Object(r.createElement)("input",{type:"radio",value:e.value,onChange:function(){l.showValidation(!1),m("type",e.value)},checked:H===e.value&&"checked"}),Object(r.createElement)("span",null,e.label),"block"===e.value&&Object(r.createElement)("span",{className:"bwf-tags bwf-tag-green"},Object(i.__)("New","wp-marketing-automations")))}))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.Flex,{gap:3,justify:"flex-start"},!["editor","block"].includes(H)&&Object(r.createElement)(a.FlexItem,null,Object(r.createElement)(a.Button,{isSecondary:!0,className:"bwf-btn-small bwf-btn-gray btn-svg-none is-light",onClick:function(){if(Object(b.Jb)())return he("content"),void je(!0);$(!0)}},Object(r.createElement)(oe.a,{icon:Object(b.Jb)()?"merge-tag":"king",size:16}),Object(i.__)("Merge Tags","wp-marketing-automations"))),Object(r.createElement)(a.FlexItem,null,Object(r.createElement)("div",null,Object(r.createElement)(De.a,{canCreate:!0,isLinkTriggerOpen:Ne,onClose:function(){return Pe(!1)},setLinkTriggerOpen:function(e){Object(b.Jb)()?Pe(e):$(!0)},modelOpenContent:Object(r.createElement)(a.Button,{isSecondary:!0,className:"bwf-btn-small bwf-btn-gray btn-svg-none is-light"},Object(r.createElement)(oe.a,{icon:Object(b.Jb)()?"link-trigger":"king",size:16}),Object(i.__)("Link Triggers","wp-marketing-automations")),hideButton:["editor","block"].includes(H)}))))),Object(r.createElement)(a.FlexItem,null,Object(r.createElement)(a.Button,{isSecondary:!0,className:"bwf-btn-small bwf-btn-gray is-light",onClick:function(){Object(b.Jb)()?n(!0):$(!0)}},Object(r.createElement)(oe.a,{icon:Object(b.Jb)()?"templates":"king",size:16}),Object(i.__)("Templates","wp-marketing-automations"))))),Object(r.createElement)("div",{className:"bwf_clear_24"})),Object(r.createElement)("div",{className:He},1===c&&("rich"===H||"wc"===H)&&Object(r.createElement)(g.a,{content:Ue,keyid:"bwf-campaign-email-editor",setContent:function(e){return m("body",e)}}),("html"===H||2===c||3===c)&&Object(r.createElement)(a.TextareaControl,{value:Ue,onChange:function(e){return m("body",e)},label:2===c||3===c?Object(i.__)("Message","wp-marketing-automations"):"",placeholder:Je[c],rows:[2,3].includes(c)?5:24,className:"bwf-email-raw-html"}),1===c&&"editor"===H&&Object(r.createElement)(de,{broadcastId:o.id,contentNumber:parseInt($e),openMergeTags:function(){return je(!0)},mailData:Ve,mergeTags:Se,openLinkTrigger:Pe}),1===c&&"block"===H&&Object(r.createElement)(zt,{objectId:"emialblock",contentNumber:parseInt($e),openMergeTags:function(){return je(!0)},mailData:t,mergeTags:Se,openLinkTrigger:Pe,enableConditional:!!Object(b.Jb)(),setConditionalModal:B,setConditionalEventOrigin:V,setConditionalData:z})),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexItem,null,Object(r.createElement)("div",{className:"bwf-display-flex gap-12"},1==c&&Object(r.createElement)(Ae.a,{templateData:x,type:1,checkIfValid:function(){return!!We.subject||(l.showValidation(!0),!1)}}),1!=c&&Object(r.createElement)("div",null,Object(r.createElement)(a.Button,{isTertiary:!0,className:"bwf-btn-grey bwf-btn-small",onClick:function(){_(!0)}},Object(i.__)("Send Test Message","wp-marketing-automations")),v&&Object(r.createElement)(Gt.a,{className:"bwf-campaign-test-mail-popup",onFocusOutside:function(){_(!1)},onClick:function(e){return e.stopPropagation()},focusOnMount:"no-focus"},Object(r.createElement)("div",{className:"bwf-campaign-test-mail-wrap"},Object(r.createElement)("div",{className:"bwf-p",style:{marginBottom:"16px"}},Object(r.createElement)(a.TextControl,{value:E,onChange:function(e){return k(e)},placeholder:Object(i.__)("Enter phone no.","wp-marketing-automations")})),Object(r.createElement)(a.Button,{isPrimary:!0,isBusy:A,onClick:function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),T(!0),r=void 0,r=!1,!(Object(f.isEmpty)(E)||![2,3].includes(c)&&!isEmail(E)||[2,3].includes(c)&&!Object(Ce.a)(E))&&We.content&&We.type&&We.utmMedium&&We.utmSource||(r=!0),r){e.next=7;break}return e.next=5,w(E,Ve,"","").then((function(){setTimeout((function(){T(!1),_(!1)}),1e3)}));case 5:e.next=13;break;case 7:n="",Object(f.isEmpty)(E)&&[2,3].includes(c)&&(n=Object(i.__)("Phone is required field.","wp-marketing-automations")),Object(f.isEmpty)(n)&&[2,3].includes(c)&&(Object(Ce.a)(E)||(n=Object(i.__)("Entered phone is not valid.","wp-marketing-automations"))),Object(f.isEmpty)(n)&&!We.content&&(n=Object(i.__)("Content is required field.","wp-marketing-automations")),Q({message:n,type:2}),T(!1);case 13:case"end":return e.stop()}var r}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Ht(o,r,a,i,c,"next",e)}function c(e){Ht(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}()},Object(i.__)("Send","wp-marketing-automations"))))),1==c&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(a.Button,{isTertiary:!0,className:"bwf-btn-grey bwf-btn-small",onClick:function(){Object(f.isEmpty)(ze())?Q({message:Object(i.__)("No content available for preview.","wp-marketing-automations"),status:2}):pe(!0)}},Object(i.__)("Preview and Test","wp-marketing-automations")),me&&Object(r.createElement)(ke,{setPreview:pe,content:ze(),type:H,maildata:t})))),Object(r.createElement)(a.FlexItem,null,!(1===c&&["editor","block"].includes(H))&&3!==c&&Object(r.createElement)(a.Button,{isTertiary:!0,className:"bwf-btn-grey bwf-btn-small",onClick:function(e){e.preventDefault(),he("content");var t=2===c?bwfanParams.bwfan_global_settings.bwfan_sms_unsubscribe_text:bwfanParams.bwfan_global_settings.bwfan_email_footer_setting;m("body","".concat(Ue||""," \n").concat(t))}},Object(i.__)("Add Unsubscribe Text","wp-marketing-automations")))),Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)(fe.a,{checked:Z,label:Object(i.__)("Automatically append UTM parameters to email links","wp-marketing-automations"),className:"bwf-crm-campaign-third-step-utm",onChange:function(e){return m("utmEnabled",e)}}),Z&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"bwf_clear_24"}),Object(r.createElement)("div",{className:"bwf-campaign-utm-section"},Object(r.createElement)(a.TextControl,{value:re,onChange:function(e){return d("source",e.replace(/\s/g,"+"))},label:Object(i.__)("Campaign Source","wp-marketing-automations"),placeholder:Object(i.__)("Enter UTM source","wp-marketing-automations"),help:Object(i.__)("Referrer: (e.g., google, newsletter)","wp-marketing-automations"),className:"bwf-field-comp-label-content"+Ze}),Object(r.createElement)(a.TextControl,{value:ae,onChange:function(e){return d("medium",e.replace(/\s/g,"+"))},label:Object(i.__)("Campaign Medium","wp-marketing-automations"),placeholder:Object(i.__)("Enter UTM medium","wp-marketing-automations"),help:Object(i.__)("Marketing medium: (e.g., CPC, banner, email)","wp-marketing-automations"),className:"bwf-field-comp-label-content"+Ye}),Object(r.createElement)(a.TextControl,{value:ce,onChange:function(e){return d("name",e.replace(/\s/g,"+"))},label:Object(i.__)("Campaign Name","wp-marketing-automations"),placeholder:Object(i.__)("Enter UTM name","wp-marketing-automations"),help:Object(i.__)("Product, promo code, or slogan (e.g., spring_sale)","wp-marketing-automations"),className:"bwf-field-comp-label-content"}),Object(r.createElement)(a.TextControl,{value:ue,onChange:function(e){return d("term",e.replace(/\s/g,"+"))},label:Object(i.__)("Campaign Term","wp-marketing-automations"),placeholder:Object(i.__)("Enter UTM term","wp-marketing-automations"),className:"bwf-field-comp-label-content"}),Object(r.createElement)(a.TextControl,{value:se,onChange:function(e){return d("content",e.replace(/\s/g,"+"))},label:Object(i.__)("Campaign Content","wp-marketing-automations"),placeholder:Object(i.__)("Enter UTM content","wp-marketing-automations"),className:"bwf-field-comp-label-content bwf-mb-0"}))),3==c&&Object(r.createElement)(Ie,{enable:X,position:te,imageURL:ne,setData:function(e,t){if("enable"==e)m("whatsAppImage",t);else if(["position","imageURL"].includes(e)){var n={position:te,imageURL:ne};n[e]=t,m("whatsAppImageSetting",n)}}}),Object(r.createElement)(p.a,{message:q.message,type:q.type,removeMessage:function(){return Q({message:"",type:1})}})),Object(r.createElement)(be.a,{isOpen:we,setOpenTags:je,onMergeTagSelected:function(e){"subject"===_e&&m("subject","".concat(K||""," ").concat(e)),"content"===_e&&m("body","".concat(Ue||""," ").concat(e)),je(!1)},onMergeTagsLoaded:function(e){return Te(e)}}),Object(b.Tb)()&&Object(r.createElement)(Be,null),Object(b.Jb)()&&Object(r.createElement)(Kt.a,{isConditionalModal:U,setConditionalModal:B,conditionalEventOrigin:F,setConditionalData:z,conditionalData:J}),!Object(b.Jb)()&&Object(r.createElement)(ie.b,{isOpen:P,onRequestClose:function(){return $(!1)},modalContent:{isFeature:!0,featureTitle:Object(i.__)("Broadcast","wp-marketing-automations")}}))},rn=n(443),an=(n(1283),n(49)),on=function(e){var t=L(),n=S(),o=n.getSmartSendSettings(),c=o.enable,s=o.percent,u=o.hours,l=t.setSmartSendByKey,m=n.getShowValidationFlag(),d=n.getEmails();return Array.isArray(d)&&d.length>1?Object(r.createElement)("div",{className:"bwf-c-campaign-email bwf-mt-24 bwf-campaign-smart-send-container"},Object(r.createElement)("div",{className:"bwf-heading3-new bwf-mb-16"},Object(i.__)("Smart Sending","wp-marketing-automations")),Object(r.createElement)(a.ToggleControl,{label:Object(i.__)("Enable Smart Sending","wp-marketing-automations"),className:"bwf-tooglecontrol-advance",checked:c,onChange:function(e){return l("enable",e)}}),c&&Object(r.createElement)("div",{className:"bwf-display-flex"},Object(r.createElement)("div",{className:"bwf-w-280"}),Object(r.createElement)("div",{className:"bwf-w-100p"},parseInt(s)>0&&parseInt(u)>0?Object(r.createElement)("div",{className:"bwf-campaign-smart-send-notice"},Object(r.createElement)("div",{className:"bwf-campaign-smart-s-svg"},Object(r.createElement)(oe.a,{icon:"icon-bulb",width:13,height:17})),Object(r.createElement)("div",{className:"bwf-campaign-smart-send-n-txt"},Object(r.createElement)("span",{className:"bwf-n-b"},Object(i.__)("How Smart Sending Works?","wp-marketing-automations")),Object(r.createElement)("span",null,Object(i.sprintf)(Object(i.__)("This broadcast will first go to %d percent of your contacts. After %d hours, the variant with the highest open rate will be sent to the rest.","wp-marketing-automations"),parseInt(s),parseInt(u))))):Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)(a.TextControl,{type:"number",value:s,onChange:function(e){return l("percent",e)},label:Object(i.__)("Sample size (in percent)","wp-marketing-automations"),placeholder:Object(i.__)("Enter percent","wp-marketing-automations"),className:ge()({"bwf-field-comp-label-content":!0,"bwf-field-error":m&&!parseInt(s)})}),Object(r.createElement)(a.TextControl,{type:"number",value:u,onChange:function(e){return l("hours",e)},label:Object(i.__)("Wait time (in hours)","wp-marketing-automations"),placeholder:Object(i.__)("Enter hour difference","wp-marketing-automations"),className:ge()({"bwf-field-comp-label-content":!0,"bwf-mb-0":!0,"bwf-field-error":m&&!parseInt(u)})})))):null},cn=n(31);function sn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return un(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return un(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function un(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ln="ABCDEFGHIJKLMNOPQRSTUVWXYZ",mn=function(e){var t=e.mailData,n=e.unsubscribeLink,a=e.errMsg,o=L(),c=S(),u=o.setCurrentEmail,l=o.addEmail,m=o.showValidation,d=o.deleteEmail,p=o.overrideCurrentContent,g=sn(Object(r.useState)(!1),2),O=g[0],y=g[1],w=c.getEmails(),j=c.getCurrentEmail(),v=c.getSmartSendSettings(),_=c.emailsValidToSubmit(),h=c.getShowValidationFlag(),E=s.a.getCampaignData(),k=!(E&&E.data&&E.data.ab_type)||"ab"===E.data.ab_type,C=Object(r.useRef)(!1),A=Object(r.useCallback)((function(e){return ge()({active:j===e})})),T=!![!v.enable||!!parseInt(v.hours)&&w.length>1,!v.enable||!!parseInt(v.percent)&&w.length>1].reduce((function(e,t){return e&&t}),!0),I=Object(r.useContext)(b.h);return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:""},(!_||!T||!n)&&h&&Object(r.createElement)(r.Fragment,null,Object(r.createElement)(an.a,null),Object(r.createElement)(cn.a,{className:"bwf-error-notice",status:"error",onRemove:function(){return m(!1)}},(!_||!T)&&Object(i.__)("Some required fields are not filled, check below","wp-marketing-automations"),!n&&Object(r.createElement)(r.Fragment,null,(!_||!T)&&Object(r.createElement)("br",null),Object(f.isEmpty)(a)?Object(i.__)("{{unsubscribe_link}} are required merge tags, they must be missing from the email body","wp-marketing-automations"):a))),k&&Object(r.createElement)("div",{className:"bwf-c-campaign-email-tabs bwf-mb-16"},Object(r.createElement)("ul",null,w.map((function(e,t){return Object(r.createElement)("li",{onClick:function(){return function(e){!C.current&&u(e),C.current=!1}(e)},className:A(e),key:"bwf-c-campaign-email-tabs-".concat(t)},0===t?Object(i.__)("Control","wp-marketing-automations"):Object(i.__)("Variant","wp-marketing-automations")," ",t>0&&ln[parseInt(t)%ln.length-1],t>0&&Object(r.createElement)("span",{className:"bwf-w-20 bwf-h-20 bwf-cursor-pointer bwf-ml-4 bwf-display-flex",onClick:function(){return function(e){C.current=!0,d(e)}(e)}},Object(r.createElement)(oe.a,{icon:"cross",size:16})))})),w.length<3&&Object(r.createElement)("li",{className:"bwf-c-campaign-email-variant"},Object(r.createElement)("div",{className:"bwf-display-flex bwf-h-20",onClick:function(){return l()}},Object(r.createElement)("span",{className:"bwf-rotate-45 bwf-p-0"},Object(r.createElement)(oe.a,{icon:"cross",size:16,color:"#353030"})),Object(r.createElement)("span",null,Object(i.__)("Add Variant","wp-marketing-automations")))))),1===parseInt(E.type)&&Object(r.createElement)("span",{className:"bwf-c-campaign-template-selector"},Object(r.createElement)(rn.a,{showText:!1,openTemplate:O,setTemplateModal:y,applyTemplate:function(e){p(e),I(Object(i.__)("Template Applied Successfully.","wp-marketing-automations")),setTimeout((function(){I("")}),2e3)}})),Object(r.createElement)(nn,{maildata:t,setTemplateModal:y}),Object(r.createElement)(on,null)))},dn=n(74);function bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bn(Object(n),!0).forEach((function(t){pn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gn(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function On(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return yn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.default=function(e){var t=Object(d.i)(),n=On(Object(r.useState)({message:"",type:1}),2),l=n[0],g=n[1],O=On(Object(r.useState)([]),2),y=O[0],w=O[1],j=On(Object(r.useState)([]),2),v=j[0],_=j[1],h=On(Object(r.useState)(Object(b.I)("from_name")),2),E=h[0],k=h[1],C=On(Object(r.useState)(Object(b.I)("from_email")),2),A=C[0],T=C[1],I=On(Object(r.useState)(Object(b.I)("reply_to_email")),2),x=I[0],N=I[1],P=On(Object(r.useState)(""),2),$=P[0],M=P[1],R=Object(u.a)().setCampaignValues,U=s.a.getCampaignId(),B=s.a.getCampaignData(),D=parseInt(B.type);Object(r.useEffect)((function(){B&&!Object(f.isNull)(B.data)&&(B.data.hasOwnProperty("content")&&!Object(f.isEmpty)(B.data.content)?w(B.data.content):w(1==D?[{subject:"",preheader:"",type:"block",body:"",utm:{}}]:[{body:"",utm:{}}]),B.data.hasOwnProperty("senders_name")&&k(B.data.senders_name),B.data.hasOwnProperty("senders_email")&&T(B.data.senders_email),B.data.hasOwnProperty("replyto")&&!Object(f.isEmpty)(B.data.replyto)&&N(B.data.replyto))}),[]);var F=Object(dn.a)().setL2Title;Object(r.useEffect)((function(){F("title"in B?Object(r.createElement)(r.Fragment,null,B.title):"")}),[B]);var V={name:1!==D||null===E||E.length>0,email:1!==D||null===A||Object(c.a)(A),content:null===y||y.length>0},W=S(),J=W.emailsValidToSubmit(),z=W.getEmails(),K=W.getAllEmailContent(),G=W.getSmartSendSettings(),H=L();Object(r.useEffect)((function(){if(B&&B.data){var e=!B.data.ab_type||"ab"===B.data.ab_type,t=B.data.content?Array.isArray(B.data.content)&&!e?[B.data.content[0]]:B.data.content:[],n=B.data.smart_send&&e?B.data.smart_send:{};H.initContent(t,n)}}),[U]);var Z=!![1!==D||E&&E.length>0,1!==D||A&&Object(c.a)(A),1!==D||Object(f.isEmpty)(x)||x&&Object(c.a)(x)].reduce((function(e,t){return e&&t}),!0),Y=!![!G.enable||!!parseInt(G.hours)&&z.length>1,!G.enable||!!parseInt(G.percent)&&z.length>1].reduce((function(e,t){return e&&t}),!0),q=function(){if(1!==D)return!0;var e=Object(b.y)();M("");var t=!0,n=[];return z.map((function(r){var a=K.hasOwnProperty(r)?K[r]:{},o="";a.hasOwnProperty("type")&&("editor"==a.type?a.hasOwnProperty("editor")&&a.editor.hasOwnProperty("body")&&(o=a.editor.body):a.hasOwnProperty("body")&&(o=a.body)),o.includes("{{mail_footer}}")||(t=(e.includes("unsubscribe_link")||o.includes("unsubscribe_link"))&&(e.includes("business_name")||o.includes("business_name"))&&(e.includes("business_address")||o.includes("business_address")))||(e.includes("unsubscribe_link")||o.includes("unsubscribe_link")||n.push("{{unsubscribe_link}}"),e.includes("business_name")||o.includes("business_name")||n.push("{{business_name}}"),e.includes("business_address")||o.includes("business_address")||n.push("{{business_address}}"))})),Object(f.isEmpty)(n)||M(Object(i.__)("The required merge tags","wp-marketing-automations")+" "+n.join(", ")+(n.length>1?" are ":" is ")+" "+Object(i.__)("missing in the email body","wp-marketing-automations")),_(t),t},Q=function(){var t,n=(t=regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=q(),H.showValidation(!1),!(Z&&J&&Y&&n)){t.next=17;break}return e.setPending(!0),t.prev=4,r=fn({content:z.map((function(e){return J[e]})),senders_name:E,senders_email:A,replyto:x,modified_by:Object(b.G)()},G.enable?{smart_send:{enable:G.enable,percent:G.percent,hours:G.hours}}:{}),a={content:JSON.stringify(r),step:3},t.next=9,m()({path:Object(b.u)("/broadcast/".concat(U)),method:"POST",data:a}).then((function(e){200===e.code?(R("data",e.result),R("step",4)):g({message:e.message,type:0})}));case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(4),g({message:t.t0.message,type:0});case 14:e.setPending(!1),t.next=18;break;case 17:H.showValidation(!0);case 18:case"end":return t.stop()}}),t,null,[[4,11]])})),function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(e){gn(o,r,a,i,c,"next",e)}function c(e){gn(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}(),X=V&&!V.email?" bwf-field-error":"",ee=V&&!V.name?" bwf-field-error":"";return Object(r.createElement)(r.Fragment,null,Object(r.createElement)(an.a,null),Object(r.createElement)("div",{className:"bwf-campaign-step-div bwf-card-wrap bwf-campaign-step-3"},Object(r.createElement)("div",{className:"bwf-card-header"},Object(r.createElement)("span",{className:"bwf-form-title"},Object(i.__)("Content","wp-marketing-automations"))),1===D&&Object(r.createElement)("div",{className:"bwf-p-gap"},Object(r.createElement)("div",{className:"bwf-c-campaign-email"},Object(r.createElement)(a.TextControl,{value:E,onChange:k,label:Object(i.__)("From Name","wp-marketing-automations"),placeholder:Object(i.__)("Enter From Name","wp-marketing-automations"),className:ee}),Object(r.createElement)("div",{className:"bwf_clear_16"}),Object(r.createElement)(a.Flex,null,Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:A,onChange:T,label:Object(i.__)("From Email","wp-marketing-automations"),placeholder:Object(i.__)("Enter From Email","wp-marketing-automations"),className:X})),Object(r.createElement)(a.FlexBlock,null,Object(r.createElement)(a.TextControl,{value:x,placeholder:Object(i.__)("Enter Reply-To Email","wp-marketing-automations"),label:Object(i.__)("Reply-To Email","wp-marketing-automations"),onChange:N}))))),Object(r.createElement)("div",{className:"bwf-p-gap "+(1===parseInt(D)?"bwf-pt-0":"")},Object(r.createElement)(mn,{mailData:{reply_to:x,senders_email:A,senders_name:E},unsubscribeLink:v,errMsg:$}),Object(r.createElement)(p.a,{message:l.message,type:l.type,removeMessage:function(){return g({message:"",type:1})}})),Object(r.createElement)("div",{className:"bwf-p-gap bwf-pt-0"},Object(r.createElement)("div",{className:"bwf-crm-campaign-navigation"},Object(r.createElement)(o.a,{className:"bwf-crm-navigation-previous",isSecondary:!0,onClick:function(){var e=B.data&&!Object(f.isNull)(B.data)&&B.data.hasOwnProperty("filters")?B.data.filters:{};Object(f.isEmpty)(e)||Object(d.k)(e,"/",t),R("step",2)}},Object(i.__)("Previous","wp-marketing-automations")),Object(r.createElement)(o.a,{isPrimary:!0,className:"bwf-crm-navigation-next",disabled:!Z,onClick:Q,isBusy:e.isPending},Object(i.__)("Next","wp-marketing-automations"))))))}}}]);