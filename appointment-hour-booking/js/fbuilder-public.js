fbuilderjQuery="undefined"!=typeof fbuilderjQuery?fbuilderjQuery:jQuery,fbuilderjQuery((function(){var e;(e=fbuilderjQuery).extend({stringifyXX:function(t){var i=function(e){var t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return t.lastIndex=0,t.test(e)?e.replace(t,(function(e){var t=i[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})):e},a=typeof t;if("object"!=a||null===t)return"string"==a&&(t='"'+t+'"'),String(t);var s,r,n=[],l=t&&t.constructor==Array;for(s in t)"function"!=(a=typeof(r=t[s]))&&("string"==a?r='"'+i(r)+'"':"object"==a&&null!==r&&(r=e.stringifyXX(r)),n.push((l?"":'"'+s+'":')+String(r)));return(l?"[":"{")+String(n)+(l?"]":"}")}})})),fbuilderjQuery="undefined"!=typeof fbuilderjQuery?fbuilderjQuery:jQuery,function(e){"function"==typeof define&&define.amd?define(["fbuilderjQuery"],e):"object"==typeof module&&module.exports?module.exports=e(require("fbuilderjQuery")):e(fbuilderjQuery)}((function(e){e.extend(e.fn,{validate:function(t){if(this.length){var i=e.data(this[0],"validator");return i||(this.attr("novalidate","novalidate"),i=new e.validator(t,this[0]),e.data(this[0],"validator",i),i.settings.onsubmit&&(this.on("click.validate",":submit",(function(t){i.submitButton=t.currentTarget,e(this).hasClass("cancel")&&(i.cancelSubmit=!0),void 0!==e(this).attr("formnovalidate")&&(i.cancelSubmit=!0)})),this.on("submit.validate",(function(t){function a(){var a,s;return i.submitButton&&(i.settings.submitHandler||i.formSubmitted)&&(a=e("<input type='hidden'/>").attr("name",i.submitButton.name).val(e(i.submitButton).val()).appendTo(i.currentForm)),!i.settings.submitHandler||(s=i.settings.submitHandler.call(i,i.currentForm,t),a&&a.remove(),void 0!==s&&s)}return i.settings.debug&&t.preventDefault(),i.cancelSubmit?(i.cancelSubmit=!1,a()):i.form()?i.pendingRequest?(i.formSubmitted=!0,!1):a():(i.focusInvalid(),!1)}))),i)}t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing.")},valid:function(){var t,i,a;return e(this[0]).is("form")?t=this.validate().form():(a=[],t=!0,i=e(this[0].form).validate(),this.each((function(){(t=i.element(this)&&t)||(a=a.concat(i.errorList))})),i.errorList=a),t},rules:function(t,i){var a,s,r,n,l,o,d=this[0];if(null!=d&&(!d.form&&d.hasAttribute("contenteditable")&&(d.form=this.closest("form")[0],d.name=this.attr("name")),null!=d.form)){if(t)switch(s=(a=e.data(d.form,"validator").settings).rules,r=e.validator.staticRules(d),t){case"add":e.extend(r,e.validator.normalizeRule(i)),delete r.messages,s[d.name]=r,i.messages&&(a.messages[d.name]=e.extend(a.messages[d.name],i.messages));break;case"remove":return i?(o={},e.each(i.split(/\s/),(function(e,t){o[t]=r[t],delete r[t]})),o):(delete s[d.name],r)}return(n=e.validator.normalizeRules(e.extend({},e.validator.classRules(d),e.validator.attributeRules(d),e.validator.dataRules(d),e.validator.staticRules(d)),d)).required&&(l=n.required,delete n.required,n=e.extend({required:l},n)),n.remote&&(l=n.remote,delete n.remote,n=e.extend(n,{remote:l})),n}}}),e.extend(e.expr.pseudos||e.expr[":"],{blank:function(t){return!e.trim(""+e(t).val())},filled:function(t){var i=e(t).val();return null!==i&&!!e.trim(""+i)},unchecked:function(t){return!e(t).prop("checked")}}),e.validator=function(t,i){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=i,this.init()},e.validator.format=function(t,i){return 1===arguments.length?function(){var i=e.makeArray(arguments);return i.unshift(t),e.validator.format.apply(this,i)}:(void 0===i||(arguments.length>2&&i.constructor!==Array&&(i=e.makeArray(arguments).slice(1)),i.constructor!==Array&&(i=[i]),e.each(i,(function(e,i){t=t.replace(new RegExp("\\{"+e+"\\}","g"),(function(){return i}))}))),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"cpefb_error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e){this.lastActive=e,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(e)))},onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(t,i){9===i.which&&""===this.elementValue(t)||-1!==e.inArray(i.keyCode,[16,17,18,20,35,36,37,38,39,40,45,144,225])||(t.name in this.submitted||t.name in this.invalid)&&this.element(t)},onclick:function(e){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,i,a){"radio"===t.type?this.findByName(t.name).addClass(i).removeClass(a):e(t).addClass(i).removeClass(a)},unhighlight:function(t,i,a){"radio"===t.type?this.findByName(t.name).removeClass(i).addClass(a):e(t).removeClass(i).addClass(a)}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:e.validator.format("Please enter no more than {0} characters."),minlength:e.validator.format("Please enter at least {0} characters."),rangelength:e.validator.format("Please enter a value between {0} and {1} characters long."),range:e.validator.format("Please enter a value between {0} and {1}."),max:e.validator.format("Please enter a value less than or equal to {0}."),min:e.validator.format("Please enter a value greater than or equal to {0}."),step:e.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:!1,prototype:{init:function(){this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var t,i=this.groups={};function a(t){!this.form&&this.hasAttribute("contenteditable")&&(this.form=e(this).closest("form")[0],this.name=e(this).attr("name"));var i=e.data(this.form,"validator"),a="on"+t.type.replace(/^validate/,""),s=i.settings;s[a]&&!e(this).is(s.ignore)&&s[a].call(i,this,t)}e.each(this.settings.groups,(function(t,a){"string"==typeof a&&(a=a.split(/\s/)),e.each(a,(function(e,a){i[a]=t}))})),t=this.settings.rules,e.each(t,(function(i,a){t[i]=e.validator.normalizeRule(a)})),e(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']",a).on("click.validate","select, option, [type='radio'], [type='checkbox']",a),this.settings.invalidHandler&&e(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){var i,a,s=this.clean(t),r=this.validationTargetFor(s),n=this,l=!0;return void 0===r?delete this.invalid[s.name]:(this.prepareElement(r),this.currentElements=e(r),(a=this.groups[r.name])&&e.each(this.groups,(function(e,t){t===a&&e!==r.name&&(s=n.validationTargetFor(n.clean(n.findByName(e))))&&s.name in n.invalid&&(n.currentElements.push(s),l=n.check(s)&&l)})),i=!1!==this.check(r),l=l&&i,this.invalid[r.name]=!i,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),e(t).attr("aria-invalid",!i)),l},showErrors:function(t){if(t){var i=this;e.extend(this.errorMap,t),this.errorList=e.map(this.errorMap,(function(e,t){return{message:e,element:i.findByName(t)[0]}})),this.successList=e.grep(this.successList,(function(e){return!(e.name in t)}))}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.invalid={},this.submitted={},this.prepareForm(),this.hideErrors();var t=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(t)},resetElements:function(e){var t;if(this.settings.unhighlight)for(t=0;e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,""),this.findByName(e[t].name).removeClass(this.settings.validClass);else e.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t,i=0;for(t in e)void 0!==e[t]&&null!==e[t]&&!1!==e[t]&&i++;return i},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(e){this.addWrapper(e).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var t=this.lastActive;return t&&1===e.grep(this.errorList,(function(e){return e.element.name===t.name})).length&&t},elements:function(){var t=this,i={};return e(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter((function(){var a=this.name||e(this).attr("name");return!a&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.hasAttribute("contenteditable")&&(this.form=e(this).closest("form")[0],this.name=a),!(a in i||!t.objectLength(e(this).rules()))&&(i[a]=!0,!0)}))},clean:function(t){return e(t)[0]},errors:function(){var t=this.settings.errorClass.split(" ").join(".");return e(this.settings.errorElement+"."+t,this.errorContext)},resetInternals:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([])},reset:function(){this.resetInternals(),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},elementValue:function(t){var i,a,s=e(t),r=t.type;return"radio"===r||"checkbox"===r?this.findByName(t.name).filter(":checked").val():"number"===r&&void 0!==t.validity?t.validity.badInput?"NaN":s.val():(i=t.hasAttribute("contenteditable")?s.text():s.val(),"file"===r?"C:\\fakepath\\"===i.substr(0,12)?i.substr(12):(a=i.lastIndexOf("/"))>=0||(a=i.lastIndexOf("\\"))>=0?i.substr(a+1):i:"string"==typeof i?i.replace(/\r/g,""):i)},check:function(t){t=this.validationTargetFor(this.clean(t));var i,a,s,r,n=e(t).rules(),l=e.map(n,(function(e,t){return t})).length,o=!1,d=this.elementValue(t);if("function"==typeof n.normalizer?r=n.normalizer:"function"==typeof this.settings.normalizer&&(r=this.settings.normalizer),r){if("string"!=typeof(d=r.call(t,d)))throw new TypeError("The normalizer should return a string value.");delete n.normalizer}for(a in n){s={method:a,parameters:n[a]};try{if("dependency-mismatch"===(i=e.validator.methods[a].call(this,d,t,s.parameters))&&1===l){o=!0;continue}if(o=!1,"pending"===i)return void(this.toHide=this.toHide.not(this.errorsFor(t)));if(!i)return this.formatAndAdd(t,s),!1}catch(e){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+t.id+", check the '"+s.method+"' method.",e),e instanceof TypeError&&(e.message+=".  Exception occurred when checking element "+t.id+", check the '"+s.method+"' method."),e}}if(!o)return this.objectLength(n)&&this.successList.push(t),!0},customDataMessage:function(t,i){return e(t).data("msg"+i.charAt(0).toUpperCase()+i.substring(1).toLowerCase())||e(t).data("msg")},customMessage:function(e,t){var i=this.settings.messages[e];return i&&(i.constructor===String?i:i[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(t,i){"string"==typeof i&&(i={method:i});var a=this.findDefined(this.customMessage(t.name,i.method),this.customDataMessage(t,i.method),!this.settings.ignoreTitle&&t.title||void 0,e.validator.messages[i.method],"<strong>Warning: No message defined for "+t.name+"</strong>"),s=/\$?\{(\d+)\}/g;return"function"==typeof a?a=a.call(this,i.parameters,t):s.test(a)&&(a=e.validator.format(a.replace(s,"{$1}"),i.parameters)),a},formatAndAdd:function(e,t){var i=this.defaultMessage(e,t);this.errorList.push({message:i,element:e,method:t.method}),this.errorMap[e.name]=i,this.submitted[e.name]=i},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){var e,t,i;for(e=0;this.errorList[e];e++)i=this.errorList[e],this.settings.highlight&&this.settings.highlight.call(this,i.element,this.settings.errorClass,this.settings.validClass),this.showLabel(i.element,i.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(e=0,t=this.validElements();t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map((function(){return this.element}))},showLabel:function(t,i){var a,s,r,n,l=this.errorsFor(t),o=this.idOrName(t),d=e(t).attr("aria-describedby");l.length?(l.removeClass(this.settings.validClass).addClass(this.settings.errorClass),l.html(i)):(a=l=e("<"+this.settings.errorElement+">").attr("id",o+"-error").addClass(this.settings.errorClass).html(i||""),this.settings.wrapper&&(a=l.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(a):this.settings.errorPlacement?this.settings.errorPlacement.call(this,a,e(t)):a.insertAfter(t),l.is("label")?l.attr("for",o):0===l.parents("label[for='"+this.escapeCssMeta(o)+"']").length&&(r=l.attr("id"),d?d.match(new RegExp("\\b"+this.escapeCssMeta(r)+"\\b"))||(d+=" "+r):d=r,e(t).attr("aria-describedby",d),(s=this.groups[t.name])&&(n=this,e.each(n.groups,(function(t,i){i===s&&e("[name='"+n.escapeCssMeta(t)+"']",n.currentForm).attr("aria-describedby",l.attr("id"))}))))),!i&&this.settings.success&&(l.text(""),"string"==typeof this.settings.success?l.addClass(this.settings.success):this.settings.success(l,t)),this.toShow=this.toShow.add(l)},errorsFor:function(t){var i=this.escapeCssMeta(this.idOrName(t)),a=e(t).attr("aria-describedby"),s="label[for='"+i+"'], label[for='"+i+"'] *";return a&&(s=s+", #"+this.escapeCssMeta(a).replace(/\s+/g,", #")),this.errors().filter(s)},escapeCssMeta:function(e){return e.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name)),e(t).not(this.settings.ignore)[0]},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(t){return e(this.currentForm).find("[name='"+this.escapeCssMeta(t)+"']")},getLength:function(t,i){switch(i.nodeName.toLowerCase()){case"select":return e("option:selected",i).length;case"input":if(this.checkable(i))return this.findByName(i.name).filter(":checked").length}return t.length},depend:function(e,t){return!this.dependTypes[typeof e]||this.dependTypes[typeof e](e,t)},dependTypes:{boolean:function(e){return e},string:function(t,i){return!!e(t,i.form).length},function:function(e,t){return e(t)}},optional:function(t){var i=this.elementValue(t);return!e.validator.methods.required.call(this,i,t)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,e(t).addClass(this.settings.pendingClass),this.pending[t.name]=!0)},stopRequest:function(t,i){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],e(t).removeClass(this.settings.pendingClass),i&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.submitButton&&e("input:hidden[name='"+this.submitButton.name+"']",this.currentForm).remove(),this.formSubmitted=!1):!i&&0===this.pendingRequest&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t,i){return i="string"==typeof i&&i||"remote",e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,{method:i})})},destroy:function(){this.resetForm(),e(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur")}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,i){t.constructor===String?this.classRuleSettings[t]=i:e.extend(this.classRuleSettings,t)},classRules:function(t){var i={},a=e(t).attr("class");return a&&e.each(a.split(" "),(function(){this in e.validator.classRuleSettings&&e.extend(i,e.validator.classRuleSettings[this])})),i},normalizeAttributeRule:function(e,t,i,a){/min|max|step/.test(i)&&(null===t||/number|range|text/.test(t))&&(/^\s*$/.test(a)||(a=Number(a)),isNaN(a)&&(a=void 0)),a||0===a?e[i]=a:t===i&&"range"!==t&&(e[i]=!0)},attributeRules:function(t){var i,a,s={},r=e(t),n=t.getAttribute("type");for(i in e.validator.methods)"required"===i?(""===(a=t.getAttribute(i))&&(a=!0),a=!!a):a=r.attr(i),this.normalizeAttributeRule(s,n,i,a);return s.maxlength&&/-1|2147483647|524288/.test(s.maxlength)&&delete s.maxlength,s},dataRules:function(t){var i,a,s={},r=e(t),n=t.getAttribute("type");for(i in e.validator.methods)a=r.data("rule"+i.charAt(0).toUpperCase()+i.substring(1).toLowerCase()),this.normalizeAttributeRule(s,n,i,a);return s},staticRules:function(t){var i={},a=e.data(t.form,"validator");return a.settings.rules&&(i=e.validator.normalizeRule(a.settings.rules[t.name])||{}),i},normalizeRules:function(t,i){return e.each(t,(function(a,s){if(!1!==s){if(s.param||s.depends){var r=!0;switch(typeof s.depends){case"string":r=!!e(s.depends,i.form).length;break;case"function":r=s.depends.call(i,i)}r?t[a]=void 0===s.param||s.param:(e.data(i.form,"validator").resetElements(e(i)),delete t[a])}}else delete t[a]})),e.each(t,(function(a,s){t[a]=e.isFunction(s)&&"normalizer"!==a?s(i):s})),e.each(["minlength","maxlength"],(function(){t[this]&&(t[this]=Number(t[this]))})),e.each(["rangelength","range"],(function(){var i;t[this]&&(e.isArray(t[this])?t[this]=[Number(t[this][0]),Number(t[this][1])]:"string"==typeof t[this]&&(i=t[this].replace(/[\[\]]/g,"").split(/[\s,]+/),t[this]=[Number(i[0]),Number(i[1])]))})),e.validator.autoCreateRanges&&(null!=t.min&&null!=t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),null!=t.minlength&&null!=t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t},normalizeRule:function(t){if("string"==typeof t){var i={};e.each(t.split(/\s/),(function(){i[this]=!0})),t=i}return t},addMethod:function(t,i,a){e.validator.methods[t]=i,e.validator.messages[t]=void 0!==a?a:e.validator.messages[t],i.length<3&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,i,a){if(!this.depend(a,i))return"dependency-mismatch";if("select"===i.nodeName.toLowerCase()){var s=e(i).val();return s&&s.length>0}return this.checkable(i)?this.getLength(t,i)>0:t.length>0},email:function(e,t){return this.optional(t)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)},url:function(e,t){return this.optional(t)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(e).toString())},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)},number:function(e,t){return this.optional(t)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},minlength:function(t,i,a){var s=e.isArray(t)?t.length:this.getLength(t,i);return this.optional(i)||s>=a},maxlength:function(t,i,a){var s=e.isArray(t)?t.length:this.getLength(t,i);return this.optional(i)||s<=a},rangelength:function(t,i,a){var s=e.isArray(t)?t.length:this.getLength(t,i);return this.optional(i)||s>=a[0]&&s<=a[1]},min:function(e,t,i){return this.optional(t)||e>=i},max:function(e,t,i){return this.optional(t)||e<=i},range:function(e,t,i){return this.optional(t)||e>=i[0]&&e<=i[1]},step:function(t,i,a){var s,r=e(i).attr("type"),n="Step attribute on input type "+r+" is not supported.",l=new RegExp("\\b"+r+"\\b"),o=function(e){var t=(""+e).match(/(?:\.(\d+))?$/);return t&&t[1]?t[1].length:0},d=function(e){return Math.round(e*Math.pow(10,s))},c=!0;if(r&&!l.test(["text","number","range"].join()))throw new Error(n);return s=o(a),(o(t)>s||d(t)%d(a)!=0)&&(c=!1),this.optional(i)||c},equalTo:function(t,i,a){var s=e(a);return this.settings.onfocusout&&s.not(".validate-equalTo-blur").length&&s.addClass("validate-equalTo-blur").on("blur.validate-equalTo",(function(){e(i).valid()})),t===s.val()},remote:function(t,i,a,s){if(this.optional(i))return"dependency-mismatch";s="string"==typeof s&&s||"remote";var r,n,l,o=this.previousValue(i,s);return this.settings.messages[i.name]||(this.settings.messages[i.name]={}),o.originalMessage=o.originalMessage||this.settings.messages[i.name][s],this.settings.messages[i.name][s]=o.message,a="string"==typeof a&&{url:a}||a,l=e.param(e.extend({data:t},a.data)),o.old===l?o.valid:(o.old=l,r=this,this.startRequest(i),(n={})[i.name]=t,e.ajax(e.extend(!0,{mode:"abort",port:"validate"+i.name,dataType:"json",data:n,context:r.currentForm,success:function(e){var a,n,l,d=!0===e||"true"===e;r.settings.messages[i.name][s]=o.originalMessage,d?(l=r.formSubmitted,r.resetInternals(),r.toHide=r.errorsFor(i),r.formSubmitted=l,r.successList.push(i),r.invalid[i.name]=!1,r.showErrors()):(a={},n=e||r.defaultMessage(i,{method:s,parameters:t}),a[i.name]=o.message=n,r.invalid[i.name]=!0,r.showErrors(a)),o.valid=d,r.stopRequest(i,d)}},a)),"pending")}}});var t,i={};return e.ajaxPrefilter?e.ajaxPrefilter((function(e,t,a){var s=e.port;"abort"===e.mode&&(i[s]&&i[s].abort(),i[s]=a)})):(t=e.ajax,e.ajax=function(a){var s=("mode"in a?a:e.ajaxSettings).mode,r=("port"in a?a:e.ajaxSettings).port;return"abort"===s?(i[r]&&i[r].abort(),i[r]=t.apply(this,arguments),i[r]):t.apply(this,arguments)}),e})),fbuilderjQuery="undefined"!=typeof fbuilderjQuery?fbuilderjQuery:jQuery,fbuilderjQuery((function(){(function($){$.fbuilder=$.fbuilder||{},$.fbuilder.objName="fbuilderjQuery",$.fbuilder.controls=void 0!==$.fbuilder.controls?$.fbuilder.controls:{},$.fbuilder.forms=void 0!==$.fbuilder.forms?$.fbuilder.forms:{},$.fbuilder.htmlEncode=function(e){return e=(e=$("<div/>").text(e).html()).replace(/&/g,"&amp;").replace(/"/g,"&quot;")},$.fbuilder.configValidate=function(e){e.validate({ignore:".ignore,.ignorepb",errorElement:"div",errorClass:"cpefb_error",errorPlacement:function(e,t){t.parents(".dfield").find(".cpefb_error.message").not("[style]").length>0||(e.insertAfter(t.parents(".dfield").children().last()),e.addClass("message"))}})},$.fbuilder.htmlDecode=function(e){return/&(?:#x[a-f0-9]+|#[0-9]+|[a-z0-9]+);?/gi.test(e)&&(e=$("<div/>").html(e).text()),e},$.fbuilder.escape_symbol=function(e){return e.replace(/([\^\$\-\.\,\[\]\(\)\/\\\*\?\+\!\{\}])/g,"\\$1")},$.fbuilder.parseValStr=function(e){return'"'+e.replace(/'/g,"\\'").replace(/\$/g,"")+'"'},$.fbuilder.parseVal=function(e,t,i){if(""==e)return 0;e+="",t=new RegExp($.fbuilder.escape_symbol(void 0===t?",":t),"g"),i=new RegExp($.fbuilder.escape_symbol(void 0===i?".":i),"g");var a=e.replace(t,"").replace(i,".").replace(/\s/g,""),s=/[+-]?((\d+(\.\d+)?)|(\.\d+))/.exec(a);return s?1*s[0]:$.fbuilder.parseValStr(e)},$.fn.fbuilder=function(options){var opt=$.extend({},{pub:!1,identifier:"",title:""},options,!0);opt.messages=$.extend({previous:"Previous",next:"Next",pageof:"Page {0} of {0}",required:"This field is required.",email:"Please enter a valid email address.",datemmddyyyy:"Please enter a valid date with this format(mm/dd/yyyy)",dateddmmyyyy:"Please enter a valid date with this format(dd/mm/yyyy)",number:"Please enter a valid number.",digits:"Please enter only digits.",maxlength:$.validator.format("Please enter no more than {0} characters"),minlength:$.validator.format("Please enter at least {0} characters."),equalTo:"Please enter the same value again.",max:$.validator.format("Please enter a value less than or equal to {0}."),min:$.validator.format("Please enter a value greater than or equal to {0}.")},opt.messages),opt.messages.max=$.validator.format(opt.messages.max),opt.messages.min=$.validator.format(opt.messages.min),$.extend($.validator.messages,opt.messages);var items=[],reloadItemsPublic=function(){$("#fieldlist"+opt.identifier).closest("form").addClass(theForm.formtemplate),$("#fieldlist"+opt.identifier).html("").addClass(theForm.formlayout),$("#formheader"+opt.identifier).html(theForm.show());var e=0;$("#fieldlist"+opt.identifier).append('<div class="pb'+e+' pbreak" page="'+e+'"></div>');for(var t=0;t<items.length;t++)if(items[t].index=t,"fPageBreak"==items[t].ftype)e++,$("#fieldlist"+opt.identifier).append('<div class="pb'+e+' pbreak" page="'+e+'"></div>');else if($("#fieldlist"+opt.identifier+" .pb"+e).append(items[t].show()),items[t].predefinedClick&&($("#fieldlist"+opt.identifier+" .pb"+e).find("#"+items[t].name).attr("placeholder",items[t].predefined),$("#fieldlist"+opt.identifier+" .pb"+e).find("#"+items[t].name).attr("value","")),items[t].userhelpTooltip){var i=$("#fieldlist"+opt.identifier+" .pb"+e).find("#"+items[t].name).closest(".fields");i.find(".uh").css("display","none"),""!=i.find(".uh").text()&&i.attr("uh",i.find(".uh").text())}if(e>0?($("#fieldlist"+opt.identifier+" .pb"+e).addClass("pbEnd"),$("#fieldlist"+opt.identifier+" .pbreak").each((function(t){var i=$(this).html(),a="";t==e&&($("#cpcaptchalayer"+opt.identifier).length&&!/^\s*$/.test($("#cpcaptchalayer"+opt.identifier).html())&&(i+='<div class="captcha">'+$("#cpcaptchalayer"+opt.identifier).html()+'</div><div class="clearer"></div>',$("#cpcaptchalayer"+opt.identifier).html("")),$("#cp_subbtn"+opt.identifier).html()&&(a='<button type="button" class="pbSubmit">'+$("#cp_subbtn"+opt.identifier).html()+"</button>")),$(this).html("<fieldset><legend>"+opt.messages.pageof.replace(/\{\s*\d+\s*\}/,t+1).replace(/\{\s*\d+\s*\}/,e+1)+"</legend>"+i+'<div class="pbPrevious">'+opt.messages.previous+'</div><div class="pbNext">'+opt.messages.next+"</div>"+a+'<div class="clearer"></div></fieldset>')})),$("#fieldlist"+opt.identifier).find(".pbPrevious,.pbNext").bind("click",{identifier:opt.identifier},(function(e){var t=e.data.identifier;function i(){try{$("html, body").animate({scrollTop:$("#fieldlist"+t+" .pb"+a).find("fieldset").offset().top},100)}catch(e){}}if($(this).hasClass("pbPrevious")||$(this).hasClass("pbNext")&&$(this).parents("form").valid()){var a=parseInt($(this).parents(".pbreak").attr("page"));if($(this).hasClass("pbPrevious")?a--:a++,$("#fieldlist"+t+" .pbreak").css("display","none"),$("#fieldlist"+t+" .pbreak").find(".field").addClass("ignorepb"),$("#fieldlist"+t+" .pb"+a).css("display","block"),$("#fieldlist"+t+" .pb"+a).find(".field").removeClass("ignorepb"),$("#fieldlist"+t+" .pb"+a).find(".field").length>0)try{$("#fieldlist"+t+" .pb"+a).find(".field").is(":visible")?$("#fieldlist"+t+" .pb"+a).find(".field")[0].focus():i()}catch(e){i()}else i()}else $(this).parents("form").validate().focusInvalid();return!1}))):($("#cpcaptchalayer"+opt.identifier).length&&!/^\s*$/.test($("#cpcaptchalayer"+opt.identifier).html())&&($("#fieldlist"+opt.identifier+" .pb"+e).append('<div class="captcha">'+$("#cpcaptchalayer"+opt.identifier).html()+"</div>"),$("#cpcaptchalayer"+opt.identifier).html("")),$("#cp_subbtn"+opt.identifier).html()&&$("#fieldlist"+opt.identifier+" .pb"+e).append('<button type="button" class="pbSubmit">'+$("#cp_subbtn"+opt.identifier).html()+"</button>")),$(document).on("click","#fbuilder .captcha img",(function(){var e=$(this);e.attr("src",e.attr("src").replace(/&\d+$/,"")+"&"+Math.floor(1e3*Math.random()))})),$(document).on("click","#fieldlist"+opt.identifier+" .pbSubmit",(function(e){$("#fieldlist"+opt.identifier+" .pbSubmit").closest("form").submit()})),t>0){theForm.after_show(opt.identifier);for(t=0;t<items.length;t++)items[t].after_show();$.fbuilder.showHideDep({formIdentifier:opt.identifier,throwEvent:!0}),$("#fieldlist"+opt.identifier).find(".depItemSel,.depItem").bind("change",{identifier:opt.identifier},(function(e){$.fbuilder.showHideDep({formIdentifier:e.data.identifier,throwEvent:!0})}));try{$("#fbuilder"+opt.identifier).tooltip({show:!1,hide:!1,tooltipClass:"uh-tooltip",position:{my:"left top",at:"left bottom+5",collision:"none"},items:"[uh]",content:function(){return $(this).attr("uh")}})}catch(e){}}if($("#fieldlist"+opt.identifier+" .pbreak:not(.pb0)").find(".field").addClass("ignorepb"),theForm.autofocus){var a=$("#fieldlist"+opt.identifier+" .pbreak.pb0").find(":focusable:first");a&&"radio"!=a.attr("type")&&"checkbox"!=a.attr("type")&&0==a.closest("[uh]").length&&a.focus()}},fform=function(){};$.extend(fform.prototype,{title:"Untitled Form",description:"This is my form. Please fill it out. It's awesome!",formlayout:"top_aligned",formtemplate:"",evalequations:1,autocomplete:1,autofocus:!1,show:function(){return'<div class="fform" id="field">'+(""!=this.title?"<h1>"+this.title+"</h1>":"")+(""!=this.description?"<span>"+this.description+"</span>":"")+"</div>"},after_show:function(e){$("#cp_calculatedfieldsf_pform"+e).attr("data-evalequations",this.evalequations).attr("autocomplete",this.autocomplete?"on":"off")}});var theForm,ffunct={getItem:function(e){for(var t in items)if(items[t].name==e)return items[t];return!1},getItems:function(){return items},loadData:function(f){var d,e=$("#"+f);if(this.formId=e.parents("form").attr("id"),(d=$.parseJSON(e.val()))&&2==d.length){items=[];for(var i=0;i<d[0].length;i++){var obj=eval("new $.fbuilder.controls['"+d[0][i].ftype+"']();");obj=$.extend(!0,{},obj,d[0][i]),obj.name=obj.name+opt.identifier,obj.form_identifier=opt.identifier,obj.init(),items[items.length]=obj}theForm=new fform,theForm=$.extend(theForm,d[1][0]),reloadItemsPublic()}void 0!==window.cpcff_load_defaults&&window.cpcff_load_defaults()}};return $.fbuilder.forms[opt.identifier]=ffunct,this.fBuild=ffunct,this},$.fbuilder.showSettings={formlayoutList:[{id:"top_aligned",name:"Top Aligned"},{id:"left_aligned",name:"Left Aligned"},{id:"right_aligned",name:"Right Aligned"},{id:"center_aligned",name:"Center Aligned"}]},$.fbuilder.controls.ffields=function(){},$.extend($.fbuilder.controls.ffields.prototype,{form_identifier:"",name:"",shortlabel:"",index:-1,ftype:"",userhelp:"",userhelpTooltip:!1,csslayout:"",init:function(){},show:function(){return"Not available yet"},after_show:function(){},val:function(){var e=$("[id='"+this.name+"']:not(.ignore)");return e.length?$.fbuilder.parseVal($.trim(e.val())):0}}),$.fbuilder.showHideDep=function(e){if(void 0!==e.formIdentifier){var t=e.formIdentifier;if(void 0!==$.fbuilder.forms[t]){for(var i=[],a=[],s=$.fbuilder.forms[t].getItems(),r=0,n=s.length;r<n;r++)void 0!==s[r].showHideDep&&s[r].showHideDep(i,a);(void 0===e.throwEvent||e.throwEvent)&&$(document).trigger("showHideDepEvent",$.fbuilder.forms[t].formId)}}},$.fbuilder.controls.ftext=function(){},$.extend($.fbuilder.controls.ftext.prototype,$.fbuilder.controls.ffields.prototype,{title:"Untitled",ftype:"ftext",predefined:"",predefinedClick:!1,required:!1,size:"medium",minlength:"",maxlength:"",equalTo:"",show:function(){return'<div class="fields '+$.fbuilder.htmlEncode(this.csslayout)+'" id="field'+this.form_identifier+"-"+this.index+'"><label for="'+this.name+'">'+this.title+(this.required?"<span class='r'>*</span>":"")+'</label><div class="dfield"><input id="'+this.name+'" name="'+this.name+'" '+(""!=this.minlength?' minlength="'+parseInt(this.minlength)+'"':"")+" "+(""!=this.maxlength?' maxlength="'+parseInt(this.maxlength)+'"':"")+" "+(""!=this.equalTo?'equalTo="#'+$.fbuilder.htmlEncode(this.equalTo+this.form_identifier)+'"':"")+' class="field '+this.size+(this.required?" required":"")+'" type="text" value="'+$.fbuilder.htmlEncode(this.predefined)+'"/><span class="uh">'+this.userhelp+'</span></div><div class="clearer"></div></div>'}}),$.fbuilder.controls.femail=function(){},$.extend($.fbuilder.controls.femail.prototype,$.fbuilder.controls.ffields.prototype,{title:"Email",ftype:"femail",predefined:"",predefinedClick:!1,required:!1,size:"medium",equalTo:"",show:function(){return'<div class="fields '+$.fbuilder.htmlEncode(this.csslayout)+'" id="field'+this.form_identifier+"-"+this.index+'"><label for="'+this.name+'">'+this.title+(this.required?"<span class='r'>*</span>":"")+'</label><div class="dfield"><input id="'+this.name+'" name="'+this.name+'" '+(""!=this.equalTo?'equalTo="#'+$.fbuilder.htmlEncode(this.equalTo+this.form_identifier)+'"':"")+' class="field email '+this.size+(this.required?" required":"")+'" type="text" value="'+$.fbuilder.htmlEncode(this.predefined)+'"/><span class="uh">'+this.userhelp+'</span></div><div class="clearer"></div></div>'},val:function(){var e=$('[id="'+this.name+'"]:not(.ignore)');return e.length?$.fbuilder.parseValStr(e.val()):""}}),$.fbuilder.controls.fapp=function(){},$.extend($.fbuilder.controls.fapp.prototype,$.fbuilder.controls.ffields.prototype,{title:"Number",ftype:"fapp",services:new Array({name:"Service 1",price:1,capacity:1,duration:60,pb:0,pa:0,ohindex:0}),openhours:new Array,allOH:new Array({name:"Default",openhours:new Array({type:"all",d:"",h1:8,m1:0,h2:17,m2:0})}),usedSlots:new Array,dateFormat:"mm/dd/yy",showDropdown:!1,showTotalCost:!1,showTotalCostFormat:"$ {0}",showEndTime:!1,usedSlotsCheckbox:!1,avoidOverlaping:!0,emptySelectCheckbox:!1,emptySelect:"-- Please select service --",dropdownRange:"-10:+10",working_dates:[!0,!0,!0,!0,!0,!0,!0],numberOfMonths:1,maxNumberOfApp:0,showAllServices:!1,allowDifferentQuantities:!1,allowSelectSameSlot:!1,firstDay:0,minDate:"0",maxDate:"",defaultDate:"",invalidDates:"",required:!0,bSlotsCheckbox:!0,bSlots:30,militaryTime:1,cacheArr:new Array,getD:new Date,formId:0,getMinDate:"",getMaxDate:"",arr:new Array,allUsedSlots:new Array,service_selected:0,quantity_selected:1,tz:0,tzCache:[],loadOK:!1,ignoreUsedSlots:!1,initialapp:"",initialID:0,pctByDay:new Array,htmlUsedSlots:new Array,extras:0,sub_cost:0,percent:0,notShowBookedDate:!0,showWeek:!1,autonum:0,availableSlotsByService:[],slotsDate:[],allowTZCache:!0,getSplittedSlots:function(e,t){function i(e,t){for(var i=new Array,a=0;a<e.length;a++)i[i.length]=e[a].t1,i[i.length]=e[a].t2;i.sort((function(e,t){return e-t}));var s=new Array;for(a=0;a<i.length;a++)0!=a&&i[a]==i[a-1]||(s[s.length]=i[a]);var r=new Array;for(a=0;a<s.length-1;a++){for(var n=s[a],l=s[a+1],o=n%60,d=l%60,c={t1:n,t2:l,quantity:0,serviceindex:t,h1:(n-o)/60,m1:o,h2:(l-d)/60,m2:d},h=0;h<e.length;h++)(n>e[h].t1&&n<e[h].t2||l>e[h].t1&&l<e[h].t2||n==e[h].t1&&l==e[h].t2)&&(c.quantity+=e[h].quantity);c.quantity&&(r[r.length]=c)}return r}var a=new Array;e.sort((function(e,t){return void 0!==e.serviceindex&&void 0!==t.serviceindex?e.serviceindex-t.serviceindex:void 0===e.serviceindex?-1-t.serviceindex:e.serviceindex- -1}));for(var s=-2,r=[],n=0;n<e.length;n++)void 0!==e[n].serviceindex?(e[n].serviceindex!=s&&(0!=n&&(a=a.concat(i(r,s))),r=[],s=e[n].serviceindex),r[r.length]=jQuery.extend({},e[n])):a[a.length]=jQuery.extend({},e[n]);return 0!=r.length&&(a=a.concat(i(r,s))),a},getCompatSlots:function(e){for(var t=new Array,i=!1,a=0;a<e.length;a++){e[a].quantity||(e[a].quantity=1e3);var s=-1;void 0!==e[a].serviceindex&&(s=e[a].serviceindex),e[a].service=new Array,e[a].service[0]=s,i=!1;for(var r=0;r<t.length&&!i;r++)e[a].t1==t[r].t1&&e[a].t2==t[r].t2&&e[a].serviceindex==t[r].serviceindex&&(t[r].quantity+=e[a].quantity,t[r].currentSelection=t[r].currentSelection||e[r].currentSelection||!1,$.inArray(e[a].service[0],t[r].service)||(t[r].service[t[r].service.length]=e[a].service[0]),i=!0);i||(t[t.length]=jQuery.extend({},e[a]))}return t},normalizeSelectIndex:function(e){return this.emptySelectCheckbox&&e>0&&e--,e},show:function(){return'<div class="fields '+$.fbuilder.htmlEncode(this.csslayout)+'" id="field'+this.form_identifier+"-"+this.index+'"><label for="'+this.name+'">'+this.title+(this.required?"<span class='r'>*</span>":"")+'</label><div class="dfield fapp"><input class="field avoid_overlapping_before '+(this.required?" required":"")+'" id="'+this.name+'" name="'+this.name+'" type="hidden" value="" summary="usedSlots"/><input id="'+this.name+'_services" name="'+this.name+'_services" type="hidden" value="0"/><input id="'+this.name+'_capacity" name="'+this.name+'_capacity" type="hidden" value="0"/><input class="" id="tcost'+this.name+'" name="tcost'+this.name+'" type="hidden" value=""/><div class="fieldCalendarService fieldCalendarService'+this.name+'"></div><div class="fieldCalendar fieldCalendar'+this.name+'"></div><div class="slotsCalendar slotsCalendar'+this.name+'"></div><div class="usedSlots usedSlots'+this.name+'"></div><span class="uh">'+this.userhelp+'</span></div><div class="clearer"></div></div>'},tzf:function(e){return"undefined"!=typeof cp_hourbk_timezone?void 0!==this.tzCache[e]&&this.allowTZCache?this.tzCache[e]:function(e,t){var i=-1*new Date($.datepicker.parseDate("yy-mm-dd",t).getTime()+432e5).getTimezoneOffset()/60-parseFloat(cp_hourbk_timezone);if("undefined"!=typeof cp_hourbk_observedaylight&&cp_hourbk_observedaylight)try{$.datepicker.parseDate("yy-mm-dd",cp_hourbk_daylightnextchange).getTime()<=$.datepicker.parseDate("yy-mm-dd",t).getTime()&&(i+=parseFloat(cp_hourbk_daylightnexaction))}catch(e){}return e.tzCache[t]=i,i}(this,e):this.tz},getSpecialDays:function(){var e=this,t=new Array;if(!e.emptySelectCheckbox||e.emptySelectCheckbox&&$(".fieldCalendarService"+e.name+" select option:selected").index()>0)for(var i=e.services[e.normalizeSelectIndex($(".fieldCalendarService"+e.name+" select option:selected").index())].ohindex,a=0;a<e.allOH[i].openhours.length;a++)"special"==e.allOH[i].openhours[a].type&&(t[t.length]=e.allOH[i].openhours[a].d);return t},getServiceInd:function(e){var t=this;if(void 0===t.getServiceIndArr){t.getServiceIndArr=[];for(var i=0;i<t.services.length;i++)t.getServiceIndArr["idx"+t.services[i].idx]=i}return void 0!==t.getServiceIndArr["idx"+e]?t.getServiceIndArr["idx"+e]:-1},normalizeRanges:function(e){for(var t=0;t<e.length;t++)e[t].t1=60*e[t].h1+1*e[t].m1,e[t].t2=60*e[t].h2+1*e[t].m2,e[t].t1>=e[t].t2&&(e[t].t2+=1440)},initcacheOpenHours:function(){var e=this;for(j=0;j<e.allOH.length;j++)e.normalizeRanges(e.allOH[j].openhours);for(e.cacheOpenHours=[],j=0;j<e.services.length;j++){for(var t=e.services[j].ohindex,i=[],a=0;a<e.allOH[t].openhours.length;a++)"special"==e.allOH[t].openhours[a].type?(i[e.allOH[t].openhours[a].d]=i[e.allOH[t].openhours[a].d]||[],i[e.allOH[t].openhours[a].d][i[e.allOH[t].openhours[a].d].length]=jQuery.extend({capacity:e.services[j].capacity},e.allOH[t].openhours[a])):(i[e.allOH[t].openhours[a].type]=i[e.allOH[t].openhours[a].type]||[],i[e.allOH[t].openhours[a].type][i[e.allOH[t].openhours[a].type].length]=jQuery.extend({capacity:e.services[j].capacity},e.allOH[t].openhours[a]));e.cacheOpenHours[j]=i}},getAvailablePartialSlots:function(e,t,i){var a=this;if(-1==$.inArray(e,a.special_days)){var s=$.datepicker.parseDate("yy-mm-dd",e);if(0==a.working_dates[s.getDay()])return new Array;for(var r=0,n=a.invalidDates.length;r<n;r++)if(s.getTime()===a.invalidDates[r].getTime())return new Array}var l=a.services[i].capacity,o=[];if(a.cacheOpenHours[i][e]?o=a.cacheOpenHours[i][e].slice(0):a.cacheOpenHours[i]["d"+$.datepicker.parseDate("yy-mm-dd",e).getDay()]?o=a.cacheOpenHours[i]["d"+$.datepicker.parseDate("yy-mm-dd",e).getDay()].slice(0):a.cacheOpenHours[i].all&&(o=a.cacheOpenHours[i].all.slice(0)),a.arr[e]=o,!a.duration)return h=new Array;var d=a.cacheArr[e];d||(d=new Array);var c=parseFloat(a.services[i].duration);a.duration=c,a.bduration=a.duration,a.bSlotsCheckbox||(a.bduration=1*a.bSlots);var h=new Array;for(r=0;r<a.arr[e].length;r++)h[r]=jQuery.extend({},a.arr[e][r]);for(r=0;r<h.length;r++)h[r].t1=60*h[r].h1+1*h[r].m1,h[r].t2=60*h[r].h2+1*h[r].m2,h[r].t1>=h[r].t2&&(h[r].t2+=1440);if(a.ignoreUsedSlots)var f=$.merge(d.slice(0),[]);else{a.usedSlots[e]=a.usedSlots[e]||[];f=$.merge(d.slice(0),a.usedSlots[e]);var u=$.datepicker.parseDate("yy-mm-dd",e);u.setDate(u.getDate()-1);var m=$.datepicker.formatDate("yy-mm-dd",u);a.usedSlots[m]=a.usedSlots[m]||[];for(r=0;r<a.usedSlots[m].length;r++)if(a.usedSlots[m][r].h1>a.usedSlots[m][r].h2&&0!=a.usedSlots[m][r].h2||a.usedSlots[m][r].h2>24){a.usedSlots[m][r].h1>a.usedSlots[m][r].h2&&(a.usedSlots[m][r].h2+=24);var p=jQuery.extend({},a.usedSlots[m][r]);p.h2=a.usedSlots[m][r].h2-24,p.h1=0,p.m1=0,p.d=e,f[f.length]=p}}for(r=0;r<f.length;r++)if(f[r].t1=60*f[r].h1+1*f[r].m1,f[r].t2=60*f[r].h2+1*f[r].m2,void 0!==f[r].serviceindex&&void 0===f[r].nopadding)try{f[r].t1==f[r].t2&&(f[r].t2+=1440),f[r].t1-=a.services[f[r].serviceindex].pb,f[r].t2+=a.services[f[r].serviceindex].pa}catch(e){}var v=$.merge(f,t);for(r=0;r<v.length;r++)v[r].t1=v[r].t1||60*v[r].h1+1*v[r].m1,v[r].t2=v[r].t2||60*v[r].h2+1*v[r].m2,v[r].t1>v[r].t2&&(v[r].t2+=1440);"undefined"!=typeof cp_hourbk_cmpublic&&(v=a.getSplittedSlots(v,i)),v=a.getCompatSlots(v);for(r=0;r<v.length;r++)if(a.avoidOverlaping&&(v[r].quantity+a.quantity_selected>l||0==v[r].service.length||v[r].service.length&&v[r].service[0]!=i)||!a.avoidOverlaping&&(v[r].quantity+a.quantity_selected>l&&v[r].serviceindex==i||void 0===v[r].serviceindex))for(var g=0;g<h.length;g++)if(v[r].t1>h[g].t1&&v[r].t1<h[g].t2&&v[r].t2>h[g].t1&&v[r].t2<h[g].t2){var b={t1:h[g].t1,t2:v[r].t1,h1:h[g].h1,h2:v[r].h1,m1:h[g].m1,m2:v[r].m1},y={t1:v[r].t2,t2:h[g].t2,h1:v[r].h2,h2:h[g].h2,m1:v[r].m2,m2:h[g].m2};h.splice(g,1,b,y),g--}else v[r].t1>h[g].t1&&v[r].t1<h[g].t2?(h[g].t2=v[r].t1,h[g].h2=v[r].h1,h[g].m2=v[r].m1):v[r].t2>h[g].t1&&v[r].t2<h[g].t2?(h[g].t1=v[r].t2,h[g].h1=v[r].h2,h[g].m1=v[r].m2):v[r].t1<=h[g].t1&&v[r].t2>=h[g].t2&&(h.splice(g,1),g--);for(r=0;r<h.length;r++)h[r].day=e;if(""!==a.minDate&&""!=a.getMinDate){var _=a.getMinDate.getTime()-60*a.tzf(e)*60*1e3;for(r=h.length-1;r>=0;r--)if($.datepicker.parseDate("yy-mm-dd",h[r].day).getTime()+60*h[r].t2*1e3<=_)h.splice(r,1);else if($.datepicker.parseDate("yy-mm-dd",h[r].day).getTime()+60*h[r].t1*1e3<=_){for(var S=h[r].t1;$.datepicker.parseDate("yy-mm-dd",h[r].day).getTime()+60*S*1e3<_;)a.bSlotsCheckbox?S+=c+a.pb+a.pa:S+=a.bduration;var x=S%60,D=(S-x)/60;h[r].t1=S,h[r].h1=D,h[r].m1=x}}if(""!==a.maxDate&&""!=a.getMaxDate)for(_=a.getMaxDate.getTime()+60*a.tzf(e)*60*1e3,r=h.length-1;r>=0;r--)if($.datepicker.parseDate("yy-mm-dd",h[r].day).getTime()+60*h[r].t1*1e3>=_)h.splice(r,1);else if($.datepicker.parseDate("yy-mm-dd",h[r].day).getTime()+60*h[r].t2*1e3>=_){for(var k=h[r].t1;$.datepicker.parseDate("yy-mm-dd",h[r].day).getTime()+60*(k+c)*1e3<=_;)k+=c;var w=k%60,C=(k-w)/60;h[r].t2=k,h[r].h2=C,h[r].m2=w}for(r=h.length-1;r>=0;r--)(h[r].t1+c+a.pb+a.pa>h[r].t2||h[r].t1>1440)&&h.splice(r,1);return h},formattime:function(e,t){e<0&&(e+=1440),e%=1440;var i=Math.floor(e/60),a=e%60,s="";return 0==t&&(i>12?(i-=12,s=" PM"):12==i?s=" PM":(0==i&&2!=t&&(i=12),s=" AM")),(i<10?"0":"")+i+":"+(a<10?"0":"")+a+s},formatString:function(e,t,i){var a=this;i*=60,void 0===e.st&&(e.st=60*e.h1+1*e.m1),void 0===e.et&&(e.et=60*e.h2+1*e.m2);var s="";if(t){var r=$.datepicker.parseDate("yy-mm-dd",e.d);0!=i&&(e.st+i<0?r.setDate(r.getDate()-1):e.st+i>1440&&r.setDate(r.getDate()+1)),s+='<span class="d">'+$.datepicker.formatDate(a.dateFormat,r)+"</span> "}return s+=t?'<span class="t">':"",s+=a.formattime(e.st+i,a.militaryTime)+(a.showEndTime?"-"+a.formattime(e.et+i,a.militaryTime):""),s+=t?"</span>":""},getCurrentSlots:function(e,t,i){for(var a=this,s=parseFloat(a.services[i].duration),r="",n=new Array,l=0,o=0,d=!1,c=a.services[i].capacity,h=a.getCompatSlots(a.htmlUsedSlots[t]),f=0;f<h.length;f++)if(h[f].serviceindex==i){h[f].st=60*h[f].h1+h[f].m1,h[f].t=$.datepicker.parseDate("yy-mm-dd",h[f].d).getTime()+60*h[f].st*1e3,h[f].html="";d=!1;if(""!==a.minDate&&""!=a.getMinDate){var u=a.getMinDate.getTime()-60*a.tzf(t)*60*1e3;h[f].t>u&&(d=!0)}else d=!0;d&&((h[f].quantity>=c||h[f].currentSelection)&&(h[f].html='<div s="'+i+'" h1="'+h[f].h1+'" m1="'+h[f].m1+'" h2="'+h[f].h2+'" m2="'+h[f].m2+'" style="'+(a.usedSlotsCheckbox?"":"display:none")+'" class="htmlUsed  '+(void 0!==h[f].s?h[f].s.replace(/ /g,"").toLowerCase()+" old":" choosen")+'"><a '+(void 0!==h[f].e?'title="'+h[f].e+'"':"")+">"+a.formatString(h[f],!1,a.tzf(t))+"</a>"+(void 0!==h[f].e?'<div class="ahbmoreinfo">'+h[f].e+"</div>":"")+"</div>"),h[f].availableslot=!1,n[n.length]=h[f])}"undefined"==typeof specialPadding&&(l=a.pb,o=a.pa);for(f=0;f<e.length;f++)for(st=e[f].t1||60*e[f].h1+1*e[f].m1,et=e[f].t2||60*e[f].h2+1*e[f].m2,st>=et&&(et+=1440),st+=a.pb;st+s+a.pa<=et&&st<1440;)r='<div class="availableslot"><a  s="'+i+'"  href="" d="'+e[f].day+'" h1="'+Math.floor(st/60)+'" m1="'+st%60+'" h2="'+Math.floor((st+s)/60)+'" m2="'+(st+s)%60+'">'+a.formatString({st:st,et:st+s},!1,a.tzf(t))+("undefined"!=typeof cp_hourbk_cmpublic?'<span class="ahb_slot_availability"><span class="p">ahbslotavailabilityP</span><span class="t">ahbslotavailabilityT</span></span>':"")+"</a></div>",n[n.length]={availableslot:!0,st:st,serviceindex:i,h1:Math.floor(st/60),m1:st%60,h2:Math.floor((st+s)/60),m2:(st+s)%60,html:r,t:$.datepicker.parseDate("yy-mm-dd",e[f].day).getTime()+60*st*1e3},a.bSlotsCheckbox?st+=a.bduration+o+l:st+=a.bduration;if(n.sort((function(e,t){return"undefined"!=typeof cp_hourbk_cmpublic&&e.t==t.t&&(void 0!==e.quantity&&void 0===t.quantity?(t.html=t.html.replace("ahbslotavailabilityP",c-e.quantity),t.quantity=e.quantity):void 0!==t.quantity&&void 0===e.quantity&&(e.html=e.html.replace("ahbslotavailabilityP",c-t.quantity),e.quantity=t.quantity)),e.t-t.t})),n=(n=n.reduce((function(e,t){return 0==e.filter((function(e){return t.html==e.html})).length&&e.push(t),e}),[])).reduce((function(e,t){if(0==e.filter((function(e){return t.t==e.t})).length)e.push(t);else for(var i=0;i<e.length;i++)if(e[i].t==t.t&&!e[i].availableslot&&(t.availableslot||t.currentSelection)){e[i]=t;break}return e}),[]),a.usedSlots[t]=a.usedSlots[t]||[],a.usedSlots[t].length>0&&n.length>0)for(f=0;f<a.usedSlots[t].length;f++)for(var m=0;m<n.length;m++)n[m].serviceindex==a.usedSlots[t][f].serviceindex&&n[m].h1==a.usedSlots[t][f].h1&&n[m].m1==a.usedSlots[t][f].m1&&n[m].h2==a.usedSlots[t][f].h2&&n[m].m2==a.usedSlots[t][f].m2&&(-1==n[m].html.indexOf("currentSelection")&&(n[m].html=n[m].html.replace("htmlUsed","htmlUsed currentSelection")),-1==n[m].html.indexOf("currentSelection")&&(n[m].html=n[m].html.replace("availableslot","availableslot currentSelection")));return n},getAvailableSlotsByService:function(e,t){var i=this,a="s"+t+"q"+i.quantity_selected+"d"+e;if(0==i.tzf(e)&&void 0!==i.slotsDate[a])return i.slotsDate[a];function s(e,t,a){t*=60,a*=60;var s=new Array;i.cacheArr[e]=i.cacheArr[e]||[];for(var r=0;r<i.cacheArr[e].length;r++)i.cacheArr[e][r].t1=i.cacheArr[e][r].t1||60*i.cacheArr[e][r].h1+1*i.cacheArr[e][r].m1,i.cacheArr[e][r].t2=i.cacheArr[e][r].t2||60*i.cacheArr[e][r].h2+1*i.cacheArr[e][r].m2,i.cacheArr[e][r].t1>=i.cacheArr[e][r].t2&&(i.cacheArr[e][r].t2+=1440),t<=i.cacheArr[e][r].t1&&a>=i.cacheArr[e][r].t1&&(s[s.length]=jQuery.extend({},i.cacheArr[e][r]));for(r=0;i.usedSlots[e]&&r<i.usedSlots[e].length;r++)i.usedSlots[e][r].t1=i.usedSlots[e][r].t1||60*i.usedSlots[e][r].h1+1*i.usedSlots[e][r].m1,i.usedSlots[e][r].t2=i.usedSlots[e][r].t2||60*i.usedSlots[e][r].h2+1*i.usedSlots[e][r].m2,i.usedSlots[e][r].t1>=i.usedSlots[e][r].t2&&(i.usedSlots[e][r].t2+=1440),t<=i.usedSlots[e][r].t1&&a>=i.usedSlots[e][r].t1&&(s[s.length]=jQuery.extend({},i.usedSlots[e][r]));return s}var r=$.datepicker.parseDate("yy-mm-dd",e);if(0==this.tzf(e)){i.htmlUsedSlots[e]=s(e,0,24);var n=this.getAvailablePartialSlots(e,[{h1:0,m1:0,h2:0,m2:0}],t)}else if(this.tzf(e)>0){r.setDate(r.getDate()-1);var l=$.datepicker.formatDate("yy-mm-dd",r);n=$.merge(this.getAvailablePartialSlots(l,[{h1:0,m1:0,h2:24-this.tzf(e),m2:0}],t),this.getAvailablePartialSlots(e,[{h1:24-this.tzf(e),m1:0,h2:24,m2:0}],t));i.htmlUsedSlots[e]=$.merge(s(l,24-this.tzf(e),24),s(e,0,24-this.tzf(e)))}else{r.setDate(r.getDate()+1);l=$.datepicker.formatDate("yy-mm-dd",r),n=$.merge(this.getAvailablePartialSlots(e,[{h1:0,m1:0,h2:-1*this.tzf(e),m2:0}],t),this.getAvailablePartialSlots(l,[{h1:-1*this.tzf(e),m1:0,h2:24,m2:0}],t));i.htmlUsedSlots[e]=$.merge(s(e,-1*this.tzf(e),24),s(l,0,-1*this.tzf(e)))}return i.slotsDate[a]=n,n},getAvailableSlots:function(e){var t=this,i="s"+(t.showAllServices?"":t.service_selected)+"q"+t.quantity_selected+"d"+e;if(0==t.tzf(e)&&void 0!==t.slotsDate[i])return t.slotsDate[i];var a=[];if(t.showAllServices){t.availableSlotsByService[e]=[];for(var s=0;s<t.services.length;s++)t.availableSlotsByService[e][s]=this.getAvailableSlotsByService(e,s),t.availableSlotsByService[e][s].length>a.length&&(a=t.availableSlotsByService[e][s].slice(0))}else a=this.getAvailableSlotsByService(e,t.service_selected);return t.slotsDate[i]=a,a},rC:function(e){var t=this,i=$.datepicker.formatDate("yy-mm-dd",e),a=new Array(i,"d"+i);0==t.working_dates[e.getDay()]&&-1==$.inArray(i,t.special_days)&&a.push("nonworking","ui-datepicker-unselectable","ui-state-disabled");for(var s=0,r=t.invalidDates.length;s<r;s++)e.getTime()===t.invalidDates[s].getTime()&&-1==$.inArray(i,t.special_days)&&a.push("nonworking","ui-datepicker-unselectable","ui-state-disabled","invalidDate");if(""!==t.minDate&&""!=t.getMinDate&&i<$.datepicker.formatDate("yy-mm-dd",t.getMinDate)&&a.push("nonworking","ui-datepicker-unselectable","ui-state-disabled","beforemindate"),""!==t.maxDate&&""!=t.getMaxDate&&i>$.datepicker.formatDate("yy-mm-dd",new Date(t.getMaxDate.getTime()-1))&&a.push("nonworking","ui-datepicker-unselectable","ui-state-disabled","aftermaxdate"),-1==$.inArray("ui-datepicker-unselectable",a)&&!t.emptySelectCheckbox||t.emptySelectCheckbox&&$(".fieldCalendarService"+t.name+" select option:selected").index()>0){var n=t.getAvailableSlots(i);if(0==n.length&&t.notShowBookedDate&&a.push("nonworking","ui-datepicker-unselectable","ui-state-disabled","notavailslot"),"undefined"!=typeof cp_hourbk_cmpublic){var l=0,o=a.join(" "),d=0,c=0;if(t.showAllServices)for(var h=0;h<t.services.length;h++){d=0;for(f=t.getCurrentSlots(n,i,h),s=0;s<f.length;s++)""!=f[s].html&&(d++,l+=void 0!==f[s].quantity?f[s].quantity:0);c+=t.services[h].capacity*d}else{for(var f=t.getCurrentSlots(n,i,t.service_selected),s=0;s<f.length;s++)""!=f[s].html&&(d++,l+=void 0!==f[s].quantity?f[s].quantity:0);c+=t.services[t.service_selected].capacity*d}-1==o.indexOf("nonworking")&&(o+=" ahb_booked"+Math.floor(10*l/c))}}if(void 0===o)o=a.join(" ");return[-1==o.indexOf("nonworking"),o]},after_show:function(){setTimeout((function(){$("#ui-datepicker-div").css("display","none")}),100);try{$.fn.datepicker.noConflict()}catch(t){}for(var e=this,t=$("#field"+e.form_identifier+"-"+e.index+" .fieldCalendar"+e.name),i=$("#field"+e.form_identifier+"-"+e.index+" .fieldCalendarService"+e.name),a="",s="",r=0;r<e.services.length;r++)s+=(0!=r?";":"")+e.services[r].capacity;if($("#field"+e.form_identifier+"-"+e.index+" #"+e.name+"_capacity").val(s),$("#field"+e.form_identifier+"-"+e.index).parents("form").bind("invalid-form.validate",(function(){setTimeout((function(){$("#field"+e.form_identifier+"-"+e.index+" #"+e.name).hasClass("cpefb_error")&&$("#field"+e.form_identifier+"-"+e.index).parents("form").find(".field.cpefb_error").attr("id")==$("#field"+e.form_identifier+"-"+e.index+" #"+e.name).attr("id")&&$("html, body").animate({scrollTop:$("#field"+e.form_identifier+"-"+e.index+" #"+e.name).parents(".dfield").find(".ahbfield_service").offset().top},100)}),100)})),t.addClass("notranslate"),e.openhours.length>0){if(!e.openhours[0].name){var n={name:"Default",openhours:e.openhours.slice(0)};e.openhours=new Array,e.openhours[0]=n}e.allOH=new Array,e.allOH=e.openhours.slice(0),e.openhours=new Array}var l="";if(""!=e.initialapp)try{var o=e.initialapp.split(";"),d="",c=0;for(r=0;r<o.length;r++)if(""!=o[r]){var h=(d=o[r].split(" "))[1].split("/"),u=h[0].split(":"),m=h[1].split(":"),p=(c=1*d[2],1*d[3]);l=d[0],e.usedSlots[l]=e.usedSlots[l]||[],n={h1:1*u[0],m1:1*u[1],h2:1*m[0],m2:1*m[1],d:l,serviceindex:c,price:parseFloat(e.services[c].price)*parseFloat(p),quantity:p},e.usedSlots[l][e.usedSlots[l].length]=n,e.allUsedSlots[e.allUsedSlots.length]=n}e.initialServiceInd=c}catch(t){}for(r=0;r<e.services.length;r++)e.services[r].ohindex=e.services[r].ohindex||0;if(0==e.autonum)for(r=0;r<e.services.length;r++)e.autonum++,e.services[r].idx=e.autonum;function v(i){!e.emptySelectCheckbox||e.emptySelectCheckbox&&$(".fieldCalendarService"+e.name+" select option:selected").index()>0?(!function(i){e.cacheArr[i],e.duration,e.bduration=e.duration,e.bSlotsCheckbox||(e.bduration=1*e.bSlots);var a=e.getAvailableSlots(i),s=$.datepicker.parseDate("yy-mm-dd",i),r=(e.showAllServices||e.service_selected,e.quantity_selected,$("#field"+e.form_identifier+"-"+e.index+" .slotsCalendar"+e.name)),l=0;if(!e.notShowBookedDate||!(0==e.maxNumberOfApp||e.allUsedSlots.length<e.maxNumberOfApp)||0!=a.length||e.usedSlots[i]&&0!=e.usedSlots[i].length&&!e.service_change){e.service_change=!1;var o="";if(e.showAllServices)for(l=0;l<e.services.length;l++)str_s=u(e.availableSlotsByService[i][l],i,l),""!=str_s&&(o+='<div class="service service'+l+'"><div class="service_title">'+e.services[l].name+"</div>"+str_s+"</div>");else o=u(a,i,e.service_selected);""==o&&(o=cp_hourbk_nomore_label);var d="";r.find(".slots").length>0&&(d=r.find(".slots").attr("d")),r.html('<div class="slots" d="'+i+'"><span>'+$.datepicker.formatDate(e.dateFormat,$.datepicker.parseDate("yy-mm-dd",i))+"</span><br />"+o+"</div>"),""!=d&&d!=i&&r.find(".slots span:first").hide().show(200);var c="",h="";e.allUsedSlots=e.allUsedSlots||[],e.allUsedSlots.sort((function(e,t){return $.datepicker.parseDate("yy-mm-dd",e.d).getTime()+60*(60*e.h1+e.m1)*1e3-($.datepicker.parseDate("yy-mm-dd",t.d).getTime()+60*(60*t.h1+t.m1)*1e3)})),w=0;var f=0;for(l=0;l<e.allUsedSlots.length;l++)f+=e.allUsedSlots[l].price,c+='<div class="ahb_list" d="'+e.allUsedSlots[l].d+'" quantity="'+e.allUsedSlots[l].quantity+'" s="'+e.allUsedSlots[l].serviceindex+'" h1="'+e.allUsedSlots[l].h1+'" m1="'+e.allUsedSlots[l].m1+'" h2="'+e.allUsedSlots[l].h2+'" m2="'+e.allUsedSlots[l].m2+'" ><span class="ahb_list_time">'+e.formatString(e.allUsedSlots[l],!0,e.tzf(i))+'</span><span class="ahb_list_service">'+e.services[e.allUsedSlots[l].serviceindex].name+'</span><span class="ahb_list_quantity ahb_list_quantity'+e.allUsedSlots[l].quantity+'">('+e.allUsedSlots[l].quantity+')</span><a href="" class="cancel" d="'+i+'" i="'+w+'" iall="'+l+'">['+(cp_hourbk_cancel_label||"cancel")+"]</a>"+("undefined"!=typeof cp_hourbk_repeat?showrepeat(e,l):"")+"</div>",h+=(""==h?"":";")+e.allUsedSlots[l].d+" "+e.formattime(60*e.allUsedSlots[l].h1+1*e.allUsedSlots[l].m1,2)+"/"+e.formattime(60*e.allUsedSlots[l].h2+1*e.allUsedSlots[l].m2,2)+" "+e.allUsedSlots[l].serviceindex+" "+e.allUsedSlots[l].quantity,e.allUsedSlots[l].d==i&&w++;e.sub_cost=f,f=e.sub_cost+e.extras,f=(f*=1+e.percent/100).toFixed(2),e.showTotalCost&&""!=c&&(c+='<div class="totalCost"><span>'+cp_hourbk_cost_label+'</span><span class="n"> '+e.showTotalCostFormat.replace("{0}",f)+"</span></div>"),$(".usedSlots"+e.name).html(c),$("#field"+e.form_identifier+"-"+e.index+" #"+e.name).val(h),$("#field"+e.form_identifier+"-"+e.index+" #tcost"+e.name).val(f),$("#field"+e.form_identifier+"-"+e.index+" #"+e.name).change();try{$("#fbuilder .slots div a").tooltip({position:{my:"left top+10"},open:function(e,t){$(this).tooltip("option","content",$(this).parent().find(".ahbmoreinfo").html())},tooltipClass:"ahbtooltip"})}catch(e){}$(".slotsCalendar"+e.name+" .slots a").off("click").on("click",(function(){var t=parseFloat($(".fieldCalendarService"+e.name+" select.ahbfield_quantity option:selected").val());if(1==e.maxNumberOfApp&&e.allUsedSlots.length==e.maxNumberOfApp||e.allUsedSlots.length>0&&e.allUsedSlots[0].quantity!=t&&!e.allowDifferentQuantities){for(var i=0;i<e.allUsedSlots.length;i++){var a="s"+e.allUsedSlots[i].serviceindex+"q"+e.allUsedSlots[i].quantity+"d"+e.allUsedSlots[i].d,s="sq"+e.allUsedSlots[i].quantity+"d"+e.allUsedSlots[i].d;delete e.slotsDate[a],delete e.slotsDate[s],e.avoidOverlaping&&(e.slotsDate=[]),e.usedSlots[e.allUsedSlots[i].d]=[]}e.allUsedSlots=[]}if($(this).parents("fieldset").hasClass("ahbgutenberg_editor"))return!1;if($("#field"+e.form_identifier+"-"+e.index+" div.cpefb_error").remove(),$(this).parent().hasClass("htmlUsed"))return!1;if($(this).parent().hasClass("currentSelection")&&!e.allowSelectSameSlot)return!1;if(e.allUsedSlots=e.allUsedSlots||[],0==e.maxNumberOfApp||e.allUsedSlots.length<e.maxNumberOfApp){var r=$(this).attr("d");e.usedSlots[r]=e.usedSlots[r]||[];var l=1*$(this).attr("s");n={currentSelection:!0,h1:1*$(this).attr("h1"),m1:1*$(this).attr("m1"),h2:1*$(this).attr("h2"),m2:1*$(this).attr("m2"),d:r,serviceindex:l,price:parseFloat(e.services[l].price)*t,quantity:t},e.usedSlots[r][e.usedSlots[r].length]=n,e.allUsedSlots[e.allUsedSlots.length]=n,$(document).trigger("beforeClickSlot",{name:e.name,d:r});a="s"+l+"q"+t+"d"+r,s="sq"+t+"d"+r;delete e.slotsDate[a],delete e.slotsDate[s],e.avoidOverlaping&&(e.slotsDate=[]),v($.datepicker.formatDate("yy-mm-dd",e.getD))}else alert($.validator.messages.maxapp.replace("{0}",e.maxNumberOfApp));return!1})),$(".usedSlots"+e.name+" a.cancel").off("click").on("click",(function(){var i=$(this).parents(".ahb_list").attr("d"),a=$(this).parents(".ahb_list").attr("h1"),s=$(this).parents(".ahb_list").attr("m1"),r=$(this).parents(".ahb_list").attr("h2"),n=$(this).parents(".ahb_list").attr("m2"),l=$(this).parents(".ahb_list").attr("s");e.usedSlots[i]=e.usedSlots[i]||[];for(var o=!1,d=0;d<e.usedSlots[i].length&&!o;d++)e.usedSlots[i][d].d==i&&e.usedSlots[i][d].h1==a&&e.usedSlots[i][d].m1==s&&e.usedSlots[i][d].h2==r&&e.usedSlots[i][d].m2==n&&e.usedSlots[i][d].serviceindex==l&&(o=!0,e.usedSlots[i].splice(d,1));for(o=!1,d=0;d<e.allUsedSlots.length&&!o;d++)e.allUsedSlots[d].d==i&&e.allUsedSlots[d].h1==a&&e.allUsedSlots[d].m1==s&&e.allUsedSlots[d].h2==r&&e.allUsedSlots[d].m2==n&&e.allUsedSlots[d].serviceindex==l&&(o=!0,e.allUsedSlots.splice(d,1));var c="s"+l+"q"+e.quantity_selected+"d"+i,h="sq"+e.quantity_selected+"d"+i;return delete e.slotsDate[c],delete e.slotsDate[h],e.avoidOverlaping&&(e.slotsDate=[]),t.datepicker("setDate",e.getD),v($.datepicker.formatDate("yy-mm-dd",e.getD)),!1}))}else{for(e.service_change=!1;(!E(s)||0==a.length)&&l<400;)l++,s.setDate(s.getDate()+1),a=e.getAvailableSlots($.datepicker.formatDate("yy-mm-dd",s));a.length>0?(t.datepicker("setDate",s),e.getD=s,v($.datepicker.formatDate("yy-mm-dd",s))):(t.datepicker("setDate",e.getMinDate),r.html('<div class="slots">'+cp_hourbk_nomore_label+"</div>"))}function u(t,i,a){for(var s="",r=e.getCurrentSlots(t,i,a),n=e.services[a].capacity,l=0;l<r.length;l++)"undefined"!=typeof cp_hourbk_cmpublic&&(r[l].html=r[l].html.replace("ahbslotavailabilityP",n),r[l].html=r[l].html.replace("ahbslotavailabilityT",n)),s+=r[l].html;return s}}(i),$(document).trigger("afterOnChange",{name:e.name,me:e})):$("#field"+e.form_identifier+"-"+e.index+" .slotsCalendar"+e.name).html("")}e.initcacheOpenHours(),"undefined"!=typeof cpapphourbk_in_admin&&(e.minDate="",e.maxDate="",e.maxNumberOfApp=0),e.loadOK||(e.formId=$(".fieldCalendarService"+e.name).parents("form").find('input[type="hidden"][name$="cp_appbooking_id"]').val(),$.ajax({dataType:"json",type:"POST",url:document.location.href,cache:!0,data:{cp_app_action:"get_slots",formid:e.formId,initialID:e.initialID,formfield:e.name.replace(e.form_identifier,"")},success:function(t){for(var i=0;i<t.length;i++){var a=t[i].d;if((void 0===t[i].sid||(t[i].serviceindex=e.getServiceInd(t[i].sid),-1!=t[i].serviceindex))&&(-1==t[i].serviceindex&&delete t[i].serviceindex,e.cacheArr[a]=e.cacheArr[a]||[],e.cacheArr[a][e.cacheArr[a].length]=t[i],t[i].h1>t[i].h2&&0!=t[i].h2||t[i].h2>24)){t[i].h1>t[i].h2&&(t[i].h2+=24);var s=jQuery.extend({},t[i]);s.h2=t[i].h2-24,s.h1=0,s.m1=0;var r=$.datepicker.parseDate("yy-mm-dd",a);r.setDate(r.getDate()+1),s.d=$.datepicker.formatDate("yy-mm-dd",r),t[i].h2=24,e.cacheArr[s.d]=e.cacheArr[s.d]||[],e.cacheArr[s.d][e.cacheArr[s.d].length]=s}}e.slotsDate=[],e.loadOK=!0}})),this.invalidDates=this.invalidDates.replace(/\s+/g,"");try{var g="mm/dd/yy";if(-1!=this.invalidDates.indexOf(".")&&(g=e.dateFormat),!/^\s*$/.test(this.invalidDates)){var b=0,y=this.invalidDates.split(",");this.invalidDates=[];r=0;for(var _=y.length;r<_;r++){var S=y[r].split("-");if(2==S.length){for(var x=$.datepicker.parseDate(g,S[0]),D=$.datepicker.parseDate(g,S[1]);x<=D;)if(null!==x){this.invalidDates[b]=x;var k=new Date(x.valueOf());k.setDate(k.getDate()+1),x=k,b++}}else for(var w=0,C=S.length;w<C;w++)null!==$.datepicker.parseDate(g,S[w])&&(this.invalidDates[b]=$.datepicker.parseDate(g,S[w]),b++)}}}catch(t){}$.validator.messages.date_format&&""!=$.validator.messages.date_format&&(e.dateFormat=$.validator.messages.date_format);for(s=1,r=0;r<e.services.length;r++)a+='<option value="'+e.services[r].duration+'">'+e.services[r].name+"</option>",e.services[r].capacity=parseFloat(e.services[r].capacity)>0?e.services[r].capacity:1,s<e.services[r].capacity&&(s=e.services[r].capacity);e.emptySelectCheckbox&&(a='<option value="">'+e.emptySelect+"</option>"+a);var A="";for(r=1;r<=e.services[0].capacity;r++)A+='<option value="'+r+'">'+r+"</option>";i.html('<select class="ahbfield_service">'+a+'</select><div class="ahbfield_quantity_div" '+(e.showQuantity?"":"style='display:none'")+'><label class="ahbfield_quantity_label">'+("undefined"!=typeof cp_hourbk_quantity_label?cp_hourbk_quantity_label:"Quantity")+'</label><br /><select class="ahbfield_quantity" autocomplete="off">'+A+"</select></div>"),e.service_selected=e.normalizeSelectIndex($(".fieldCalendarService"+e.name+" select.ahbfield_service option:selected").index()),e.quantity_selected=parseFloat($(".fieldCalendarService"+e.name+" select.ahbfield_quantity option:selected").val()),e.duration=parseFloat(e.services[e.service_selected].duration),e.pa=1*e.services[e.service_selected].pa||0,e.pb=1*e.services[e.service_selected].pb||0,$(".fieldCalendarService"+e.name+" select.ahbfield_service").bind("change",(function(){e.service_change=!0,e.service_selected=e.normalizeSelectIndex($(".fieldCalendarService"+e.name+" select.ahbfield_service option:selected").index()),e.duration=parseFloat(e.services[e.service_selected].duration),e.pa=1*e.services[e.service_selected].pa||0,e.pb=1*e.services[e.service_selected].pb||0,e.special_days=e.getSpecialDays();for(var t="",i=1;i<=e.services[e.service_selected].capacity;i++)t+='<option value="'+i+'">'+i+"</option>";$(".fieldCalendarService"+e.name+" select.ahbfield_quantity").html(t),e.quantity_selected=parseFloat($(".fieldCalendarService"+e.name+" select.ahbfield_quantity option:selected").val()),void 0!==e.getDMin&&(e.getD=e.getDMin),$("#field"+e.form_identifier+"-"+e.index+" .fieldCalendar"+e.name).datepicker("option","beforeShowDay",(function(t){return e.rC(t)})),v($.datepicker.formatDate("yy-mm-dd",e.getD))})),$(".fieldCalendarService"+e.name+" select.ahbfield_quantity").bind("change",(function(){if(!e.allowDifferentQuantities){e.quantity_selected=parseFloat($(".fieldCalendarService"+e.name+" select.ahbfield_quantity option:selected").val()),e.allUsedSlots=e.allUsedSlots||[];for(var t=0;t<e.allUsedSlots.length;t++){var i=!1,a=e.allUsedSlots[t],s=e.getAvailableSlotsByService(a.d,a.serviceindex);for(r=0;r<s.length&&!i;r++)60*a.h1+1*a.m1>=s[r].t1&&60*a.h2+1*a.m2<=s[r].t2&&(i=!0);e.usedSlots[a.d]=e.usedSlots[a.d]||[],f=!1;for(var r=0;r<e.usedSlots[a.d].length&&!f;r++)e.usedSlots[a.d][r].h1==a.h1&&e.usedSlots[a.d][r].m1==a.m1&&e.usedSlots[a.d][r].h2==a.h2&&e.usedSlots[a.d][r].m2==a.m2&&e.usedSlots[a.d][r].serviceindex==a.serviceindex&&(f=!0,i?(e.allUsedSlots[t].quantity=e.quantity_selected,e.usedSlots[a.d][r].quantity=e.quantity_selected,e.allUsedSlots[t].price=parseFloat(e.services[a.serviceindex].price)*e.quantity_selected,e.usedSlots[a.d][r].price=e.allUsedSlots[t].price):(e.usedSlots[a.d].splice(r,1),e.allUsedSlots.splice(t,1),t--))}}$("#field"+e.form_identifier+"-"+e.index+" .fieldCalendar"+e.name).datepicker("option","beforeShowDay",(function(t){return e.rC(t)})),v($.datepicker.formatDate("yy-mm-dd",e.getD))})),$("#"+e.name).bind("change",(function(){"reload"==$(this).attr("reload")&&($(this).attr("reload",""),v($.datepicker.formatDate("yy-mm-dd",e.getD)),$("#field"+e.form_identifier+"-"+e.index+" .fieldCalendar"+e.name).datepicker("option","beforeShowDay",(function(t){return e.rC(t)})))}));try{e.special_days=e.getSpecialDays()}catch(t){}var q=0,O="";if(e.getMinDate="",""!==e.minDate){if(-1!=e.minDate.indexOf("@")){var T=e.minDate.split("@");e.minDate=T[0],O=T[1]}if(e.minDate.length<6&&-1!=e.minDate.indexOf("h"))if(-1!=e.minDate.indexOf(" ")){T=e.minDate.split(" ");var U=!1;for(r=0;r<T.length&&!U;r++)-1!=T[r].indexOf("h")&&(U=!0,q=parseFloat(T[r].replace("h","")),e.minDate=e.minDate.replace(T[r],""))}else q=parseFloat(e.minDate.replace("h","")),e.minDate=0}if(""!==e.maxDate&&e.maxDate.length<6&&-1!=e.maxDate.indexOf("h"))if(-1!=e.maxDate.indexOf(" ")){for(T=e.maxDate.split(" "),U=!1,r=0;r<T.length&&!U;r++)if(-1!=T[r].indexOf("h")){U=!0;var F=parseFloat(T[r].replace("h",""));e.maxDate=e.maxDate.replace(T[r],"")}}else{var M=(F=parseFloat(e.maxDate.replace("h","")))%24;e.maxDate=(F-M)/24,F=M}if(t.datepicker({numberOfMonths:parseFloat(e.numberOfMonths),showWeek:e.showWeek,dateFormat:e.dateFormat,changeMonth:e.showDropdown,changeYear:e.showDropdown,yearRange:e.showDropdown?e.dropdownRange:"",onSelect:function(i,a){e.getD=t.datepicker("getDate"),v($.datepicker.formatDate("yy-mm-dd",e.getD)),$("#field"+e.form_identifier+"-"+e.index+" div.cpefb_error").remove()}}),t.datepicker("option",$.datepicker.regional[$.validator.messages.language]),$.datepicker.setDefaults($.datepicker.regional[$.validator.messages.language]),t.datepicker("option","firstDay",e.firstDay),t.datepicker("option","dateFormat",e.dateFormat),t.datepicker("option","minDate",e.minDate),t.datepicker("option","maxDate",e.maxDate),""!==e.minDate){e.getMinDate=t.datepicker("getDate");var j=new Date,z=1;try{$.datepicker.parseDate(e.dateFormat,e.minDate),z=0}catch(t){}if(e.getMinDate=new Date(e.getMinDate.getTime()+z*j.getHours()*60*60*1e3+z*j.getMinutes()*60*1e3+60*q*60*1e3),""!=O){T=O.split(":");parseFloat(T[0])>=0&&parseFloat(T[0])<24&&parseFloat(T[1])>=0&&parseFloat(T[1])<60&&(e.getMinDate=new Date(e.getMinDate.getFullYear(),e.getMinDate.getMonth(),e.getMinDate.getDate(),parseFloat(T[0]),parseFloat(T[1])))}t.datepicker("option","minDate",e.getMinDate),t.datepicker("setDate",e.getMinDate)}if(""!==e.maxDate)try{e.getMaxDate=$.datepicker._getMinMaxDate(t.data("datepicker"),"max"),e.getMaxDate.setHours(24,0,0,0)}catch(t){}if(void 0!==F){j=new Date;e.getMaxDate.setHours(j.getHours()-24,j.getMinutes(),j.getSeconds()),e.getMaxDate=new Date(e.getMaxDate.getTime()+60*F*60*1e3)}try{""!==e.defaultDate&&t.datepicker("setDate",e.defaultDate)}catch(t){}t.datepicker("option","maxDate",e.maxDate),""!=e.getMaxDate&&0!=e.tzf($.datepicker.formatDate("yy-mm-dd",e.getMaxDate))&&t.datepicker("option","maxDate",new Date(e.getMaxDate.getTime()+60*e.tzf($.datepicker.formatDate("yy-mm-dd",e.getMaxDate))*60*1e3)),e.tmpinvalidDatestime=new Array;try{for(r=0;r<e.tmpinvalidDates.length;r++)e.tmpinvalidDatestime[r]=e.invalidDates[r].getTime()}catch(t){}function E(t){for(var i=e.services[e.normalizeSelectIndex($(".fieldCalendarService"+e.name+" select option:selected").index())].ohindex,a=0;a<e.allOH[i].openhours.length;a++)if("special"==e.allOH[i].openhours[a].type&&e.allOH[i].openhours[a].d==$.datepicker.formatDate("yy-mm-dd",t))return!0;var s=t.getTime();return!($.inArray(s,e.tmpinvalidDatestime)>-1)&&0!=e.working_dates[t.getDay()]}var I=0;for(r=0;r<e.working_dates.length;r++)I+=e.working_dates[r];for(var N in e.cacheOpenHours[e.service_selected])I++;if(I>0){var H=t.datepicker("getDate");for(r=0;!E(H)&&r<400;)H.setDate(H.getDate()+1),r++;t.datepicker("setDate",H),e.getD=H,function t(){e.loadOK?($("#field"+e.form_identifier+"-"+e.index+" .fieldCalendar"+e.name).datepicker("option","beforeShowDay",(function(t){return e.rC(t)})),v($.datepicker.formatDate("yy-mm-dd",e.getD)),$("#field"+e.form_identifier+"-"+e.index+" .fieldCalendar"+e.name).datepicker("option","beforeShowDay",(function(t){return e.rC(t)}))):setTimeout(t,100)}()}if(preselect_service=function(t){$(".fieldCalendarService"+e.name+" select.ahbfield_service").children().removeAttr("selected"),e.emptySelectCheckbox?$(".fieldCalendarService"+e.name+" select.ahbfield_service").children().eq(t+1).prop("selected","selected").change():$(".fieldCalendarService"+e.name+" select.ahbfield_service").children().eq(t).prop("selected","selected").change(),1==e.maxNumberOfApp&&e.allUsedSlots.length==e.maxNumberOfApp&&$(".fieldCalendarService"+e.name+" select.ahbfield_quantity").val(e.allUsedSlots[0].quantity)},"undefined"!=typeof cp_hourbk_preselect&&void 0!==cp_hourbk_preselect[e.form_identifier]&&""!=cp_hourbk_preselect[e.form_identifier])preselect_service(1*cp_hourbk_preselect[e.form_identifier]);else if(""!=e.initialapp&&""!=l)try{e.getD=$.datepicker.parseDate("yy-mm-dd",l),t.datepicker("setDate",e.getD),preselect_service(e.initialServiceInd),v(l)}catch(t){}if(getExtrasVisible=function(e){try{for(var t=e.attr("id").split("_"),i=$.fbuilder.forms["_"+t[t.length-1]].getItems(),a=0;a<i.length;a++)"fapp"==i[a].ftype&&($("#"+i[a].name).parent().is(":visible")||$("#"+i[a].name).parents(".fields").hasClass("cp_active"))&&getExtras(i[a],e)}catch(e){}},getExtras=function(e,t){var i,a=0,s=":checked:not(.ignore),[type=text]:not(.ignore)";(i=t.find(".ahb_service").find(s)).length&&(!0,i.each((function(){($(this).parents(".fields").hasClass("cp_active")||$(this).is(":visible")||"OPTION"==$(this).prop("tagName")&&$(this).parent().is(":visible"))&&$.isNumeric(this.value)&&(a+=1*this.value)}))),e.percent=0,(i=t.find(".ahb_service_percent").find(s)).length&&(!0,i.each((function(){($(this).parents(".fields").hasClass("cp_active")||$(this).is(":visible")||"OPTION"==$(this).prop("tagName")&&$(this).parent().is(":visible"))&&$.isNumeric(this.value)&&(e.percent+=1*this.value)}))),i=t.find(".ahb_service_per_slot").find(s),e.allUsedSlots=e.allUsedSlots||[];var r=e.allUsedSlots.length;i.length&&(!0,i.each((function(){($(this).parents(".fields").hasClass("cp_active")||$(this).is(":visible")||"OPTION"==$(this).prop("tagName")&&$(this).parent().is(":visible"))&&$.isNumeric(this.value)&&(a+=this.value*r)}))),i=t.find(".ahb_service_per_quantity_selection").find(s);var n=t.find(".ahbfield_quantity").val();parseFloat(n)||(n=1),i.length&&(!0,i.each((function(){($(this).parents(".fields").hasClass("cp_active")||$(this).is(":visible")||"OPTION"==$(this).prop("tagName")&&$(this).parent().is(":visible"))&&$.isNumeric(this.value)&&(a+=this.value*n)}))),t.find("#"+e.name+"_services").val(a),e.extras=a;var l=e.sub_cost+e.extras;l=(l*=1+e.percent/100).toFixed(2),$("#field"+e.form_identifier+"-"+e.index).find(".totalCost .n").html(" "+e.showTotalCostFormat.replace("{0}",l)),$("#field"+e.form_identifier+"-"+e.index+" #tcost"+e.name).val(l),e.changeAutomatic=!0,$("#field"+e.form_identifier+"-"+e.index+" #"+e.name).change()},$("#field"+e.form_identifier+"-"+e.index).parents("form").find(".ahb_service,.ahb_service_percent,.ahb_service_per_slot,.ahb_service_per_quantity_selection").on("click change keyup",(function(){getExtrasVisible($(this).parents("form"))})),$("#field"+e.form_identifier+"-"+e.index+" #"+e.name).change((function(){e.changeAutomatic||getExtrasVisible($(this).parents("form")),e.changeAutomatic=!1})),"undefined"!=typeof cp_hourbk_overlapping_label&&$.extend($.validator.messages,{avoid_overlapping:$.validator.format(cp_hourbk_overlapping_label)}),!("avoid_overlapping"in $.validator.methods)){$.validator.addMethod("avoid_overlapping",(function(e,t){var i=this,a=i.previousValue(t);if(a.old===e)return a.valid;a.old=e,i.startRequest(t);var s=t.id.split("_"),r=s.length>1?"_"+s[1]:"",n=void 0!==$.fbuilder.forms&&void 0!==$.fbuilder.forms[r]?$.fbuilder.forms[r].getItem(s[0]+"_"+s[1]):null;return null==n||($.ajax({dataType:"json",type:"POST",url:document.location.href,data:{cp_app_action:"get_slots",formid:n.formId,initialID:n.initialID,formfield:n.name.replace(n.form_identifier,"")},success:function(e){var s=!1,r=!1;n.ignoreUsedSlots=!0,n.cacheArr=new Array;for(var l=0;l<e.length;l++){var o=e[l].d;void 0!==e[l].sid&&(e[l].serviceindex=n.getServiceInd(e[l].sid)),n.cacheArr[o]=n.cacheArr[o]||[],n.cacheArr[o][n.cacheArr[o].length]=e[l]}n.slotsDate=[],n.loadOK=!0;var d="";for(l=0;l<n.allUsedSlots.length;l++){n.service_selected=n.allUsedSlots[l].serviceindex,n.quantity_selected=n.allUsedSlots[l].quantity,n.duration=parseFloat(n.services[n.service_selected].duration);var c=n.allUsedSlots[l].d,h=60*n.allUsedSlots[l].h1+n.allUsedSlots[l].m1,f=60*n.allUsedSlots[l].h2+n.allUsedSlots[l].m2;if(0!=n.tzf(c)){var u=$.datepicker.parseDate("yy-mm-dd",c),m=new Date(u.getTime()+60*h*1e3+60*n.tzf(c)*60*1e3);c=$.datepicker.formatDate("yy-mm-dd",m)}var p=n.getAvailableSlots(c);n.showAllServices&&(p=n.availableSlotsByService[c][n.service_selected]),r=!1;for(var v=0;v<p.length&&!r;v++)p[v].t1<=h&&p[v].t2>=f&&(r=!0);r||(s=!0,""==d&&(d='<div class="ahb_overlapping_detail"><div class="ahb_overlapping_title">Affected times:</div>'),d+='<div><span class="ahb_list_time">'+n.formatString(n.allUsedSlots[l],!0,n.tzf(c))+'</span><span class="ahb_list_service">'+n.services[n.allUsedSlots[l].serviceindex].name+"</span></div>")}n.ignoreUsedSlots=!1;var g=!s;if(!0===g){var b=i.formSubmitted;i.prepareElement(t),i.formSubmitted=b,i.successList.push(t),delete i.invalid[t.name],i.showErrors()}else{for(l=0;l<e.length;l++){o=e[l].d;n.cacheArr[o]=n.cacheArr[o]||[],n.cacheArr[o][n.cacheArr[o].length]=e[l]}n.slotsDate=[],n.loadOK=!0;var y={};""!=d&&(d+="</div>"),y[t.name]=i.defaultMessage(t,"avoid_overlapping")+d,i.invalid[t.name]=!0,i.showErrors(y),t.focus()}a.valid=g,i.stopRequest(t,g),cp_hourbk_avoid_overlapping--}}),"pending")}))}},val:function(){return 0}}),$.fbuilder.controls.facceptance=function(){},$.extend($.fbuilder.controls.facceptance.prototype,$.fbuilder.controls.ffields.prototype,{title:"Accept terms and conditions",ftype:"facceptance",value:"I accept",required:!0,url:"",message:"",show:function(){var e=this,t="",i=e.title;return/^\s*$/.test(e.url)?/^\s*$/.test(e.message)||(i='<a href="javascript:void(0);" class="cff-open-dlg">'+i+"</a>",t+='<div class="cff-dialog hide"><span class="cff-close-dlg"></span><div class="cff-dialog-content">'+e.message+"</div></div>"):i='<a href="'+$.fbuilder.htmlEncode($.trim(e.url))+'" target="_blank">'+i+"</a>",'<div class="fields '+$.fbuilder.htmlEncode(e.csslayout)+' cff-checkbox-field" id="field'+e.form_identifier+"-"+e.index+'"><div class="dfield"><div class="one_column"><label><input name="'+e.name+'" id="'+e.name+'" class="field required" value="'+$.fbuilder.htmlEncode(e.value)+'" vt="'+$.fbuilder.htmlEncode(/^\s*$/.test(e.value)?e.title:e.value)+'" type="checkbox" /> <span>'+$.fbuilder.htmlDecode(i)+(e.required?'<span class="r">*</span>':"")+"</span></label></div>"+t+'</div><div class="clearer"></div></div>'},after_show:function(){$(document).on("click",".cff-open-dlg",(function(){var e=$(this).closest(".fields").find(".cff-dialog"),t=e.data("width"),i=e.data("height");e.removeClass("hide"),void 0===t&&(t=Math.min($(this).closest("form").width(),$(window).width(),e.width())),void 0===i&&(i=Math.min($(this).closest("form").height(),$(window).height(),e.height())),e.data("width",t),e.data("height",i),e.css({width:t+"px",height:i+"px","margin-top":-1*i/2+"px","margin-left":-1*t/2+"px"})})),$(document).on("click",".cff-close-dlg",(function(){$(this).closest(".cff-dialog").addClass("hide")}))},val:function(){var e=$('[id="'+this.name+'"]:checked:not(.ignore)');if(e.length){var t=$.fbuilder.parseValStr(e[0].value);$.isNumeric(t)||(t=t.replace(/^"/,"").replace(/"$/,""))}return v?$.isNumeric(v)?v:'"'+v+'"':0}});for(var fcount=1,fcount_tags=1,fnum="_"+fcount,cp_avoid_hidden=!1;20>fcount||eval("typeof cp_appbooking_fbuilder_config"+fnum+" != 'undefined'");){try{for(var cp_appbooking_fbuilder_config=eval("cp_appbooking_fbuilder_config"+fnum);20>fcount_tags&&!$("#fbuilder_"+fcount_tags).length;)fcount_tags++;cp_appbooking_fbuilder_config=$.parseJSON(cp_appbooking_fbuilder_config.obj),cp_appbooking_fbuilder_config.identifier="_"+fcount_tags;var opt_identifier=$("#fieldlist_"+fcount_tags);opt_identifier.attr("fcount_tags",fcount_tags),opt_identifier.attr("fnum",fnum),opt_identifier.addClass("cp_avoid_hidden");var f=$("#fbuilder_"+fcount_tags).fbuilder(cp_appbooking_fbuilder_config);f.fBuild.loadData("form_structure_"+fcount_tags),$.fbuilder.configValidate($("#cp_appbooking_pform_"+fcount_tags)),void 0===opt_identifier.attr("fnum")||opt_identifier.is(":hidden")?cp_avoid_hidden=!0:$(opt_identifier).addClass("cp_v_v")}catch(e){}fcount++,fcount_tags++,fnum="_"+fcount}cp_avoid_hidden&&$(document).each((function(){new MutationObserver((function(mutationsList,observer){for(let k in mutationsList){var mutation=mutationsList[k];if("childList"===mutation.type&&mutation.addedNodes.length)try{$(".cp_avoid_hidden").each((function(){var opt_identifier=$("#"+$(this).attr("id"));if(void 0!==opt_identifier.attr("fnum")&&!opt_identifier.is(":hidden")&&!opt_identifier.hasClass("cp_v_v")){$(opt_identifier).addClass("cp_v_v");var fnum=opt_identifier.attr("fnum"),fcount_tags=opt_identifier.attr("fcount_tags"),cp_appbooking_fbuilder_config=eval("cp_appbooking_fbuilder_config"+fnum);cp_appbooking_fbuilder_config=$.parseJSON(cp_appbooking_fbuilder_config.obj),cp_appbooking_fbuilder_config.identifier="_"+fcount_tags;var f=$("#fbuilder_"+fcount_tags).fbuilder(cp_appbooking_fbuilder_config);f.fBuild.loadData("form_structure_"+fcount_tags),$.fbuilder.configValidate(opt_identifier.closest("form"))}}))}catch(e){}}})).observe(this,{childList:!0,subtree:!0})}))})(fbuilderjQuery)}));