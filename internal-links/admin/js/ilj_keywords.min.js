var __webpack_exports__={};__webpack_exports__={};!function(e){e.fn.ilj_keywords=function(r){var i=this,s=e.extend({inputField:"",errorMessage:"",requiresPro:!1,sortable:!0},r),t={width:"",maxWidth:"200",useTitle:!0,delay:100,speed:500,background:"#32373c",color:"#eeeeee",size:"small"};({keywords:[],init:function(){var r=this;return s.sortable&&i.find("ul.keyword-view").sortable({opacity:.5,helper:"clone",forceHelperSize:!0,forcePlaceholderSize:!0,cursor:"move",placeholder:"placeholder",update:function(e,i){r.reorderKeywords()}}),i.find("ul.keyword-view").disableSelection(),i.find(".tip").iljtipso(t),i.on("keypress","input.keywordInput",(function(e){return 13===e.keyCode&&i.find("a.add-keyword").click(),13!=e.keyCode})),i.on("click","a.add-keyword",(function(i){i.preventDefault();var s=e(this).siblings("input.keywordInput");if(-1!==s.val().indexOf(",")){s.val().split(",").forEach((function(e,i){keyword_value=r.sanitizeKeyword(e),valid=r.validateKeyword(keyword_value),valid.is_valid&&r.addKeyword(keyword_value)}))}else{if(keyword_value=r.sanitizeKeyword(s.val()),valid=r.validateKeyword(keyword_value),!valid.is_valid)return void r.setError(valid.message);r.addKeyword(keyword_value)}s.val(""),r.clearError(),r.syncGui(),r.syncField()})),this.initKeywords(),this.syncGui(),i.on("click",".keyword a.remove",(function(i){i.preventDefault();var s=e(this).parent(".keyword").data("id");r.keywords.splice(s,1),r.syncGui(),r.syncField()})),this.keywords},initKeywords:function(){that=this;var r=e("<textarea/>").text(s.inputField.val()).html();""!=r&&null!=r&&r.split(",").forEach((function(e,r){that.addKeyword(e)}))},addKeyword:function(e){that=this,this.keywords.push(e)},sanitizeKeyword:function(e){return e.replace(/\s*\{\s*/gu," {").replace(/\s*\}\s*/gu,"} ").replace(/\s{2,}/gu," ").replace(/^\s+|\s+$/gu,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")},validateKeyword:function(e){for(var r={is_valid:!1,message:"Unknown error"},i=e.replace(/\{.*?\}/gu,"").replace(/\s/gu,""),t=0;t<this.keywords.length;t++)if(e.toLowerCase()==this.keywords[t].toLowerCase())return r.message=ilj_editor_translation.message_keyword_exists,r;if(""===i)return r.message=ilj_editor_translation.message_no_keyword,r;if(i.length<2)return r.message=ilj_editor_translation.message_length_not_valid,r;if(/(\s?\{[+-]*\d+\}\s?){2,}/.test(e))return r.message=ilj_editor_translation.message_multiple_placeholder,r;var a=this.keywords.length;return 1==s.requiresPro&&1==ilj_editor_basic_restriction.is_active&&a>=ilj_editor_basic_restriction.blacklist_limit?(r.message="<p>"+ilj_editor_translation.message_limited_blacklist_keyword+"</p>",r.message+="<p>"+ilj_editor_translation.message_limited_blacklist_keyword_upgrade+".</p>",r):(r.is_valid=!0,r.message="",r)},syncGui:function(){var r=this;i.find("ul.keyword-view li").remove(),this.keywords.length>0?(this.keywords.forEach((function(s,t){i.find("ul.keyword-view").append(e(r.renderKeyword(s,t)))})),i.find(".tip").iljtipso(t)):i.find("ul.keyword-view").append(e("<li>"+ilj_editor_translation.no_keywords+"</li>"))},syncField:function(){s.inputField.val(this.keywords.join(","))},renderKeyword:function(e,r){return keyword_print=e.replace(/\{(\d+)\}/g,'<span class="exact tip" title="'+ilj_editor_translation.gap_hover_exact+' $1">$1</span>').replace(/\{\-(\d+)\}/g,'<span class="max tip" title="'+ilj_editor_translation.gap_hover_max+' $1">$1</span>').replace(/\{\+(\d+)\}/g,'<span class="min tip" title="'+ilj_editor_translation.gap_hover_min+' $1">$1</span>'),'<li class="keyword" data-id="'+r+'"><a class="dashicons dashicons-dismiss remove"></a>'+keyword_print+"</li>"},reorderKeywords:function(){order=[];var r=this;return i.find("li").each((function(){var r=e(this).data("id");void 0!==r&&order.push(r)})),new_keywords=[],e.each(order,(function(e,i){new_keywords.push(r.keywords[i])})),r.keywords=new_keywords,r.syncGui(),r.syncField(),!0},setError:function(e){s.errorMessage.html(e),s.errorMessage.show()},clearError:function(){s.errorMessage.html(""),s.errorMessage.hide()}}).init()}}(jQuery);
//# sourceMappingURL=ilj_keywords.min.js.map