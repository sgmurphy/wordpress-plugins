!function(){var e={875:function(e,t){var r;!function(){"use strict";var o={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var l=typeof r;if("string"===l||"number"===l)e.push(r);else if(Array.isArray(r)){if(r.length){var a=n.apply(null,r);a&&e.push(a)}}else if("object"===l){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){e.push(r.toString());continue}for(var i in r)o.call(r,i)&&r[i]&&e.push(i)}}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)}()},202:function(e){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var o,n,l;if(Array.isArray(t)){if((o=t.length)!=r.length)return!1;for(n=o;0!=n--;)if(!e(t[n],r[n]))return!1;return!0}if(t instanceof Map&&r instanceof Map){if(t.size!==r.size)return!1;for(n of t.entries())if(!r.has(n[0]))return!1;for(n of t.entries())if(!e(n[1],r.get(n[0])))return!1;return!0}if(t instanceof Set&&r instanceof Set){if(t.size!==r.size)return!1;for(n of t.entries())if(!r.has(n[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(r)){if((o=t.length)!=r.length)return!1;for(n=o;0!=n--;)if(t[n]!==r[n])return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((o=(l=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=o;0!=n--;)if(!Object.prototype.hasOwnProperty.call(r,l[n]))return!1;for(n=o;0!=n--;){var a=l[n];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var l=t[o]={exports:{}};return e[o](l,l.exports,r),l.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";var e=window.wp.element,t=window.React,o=r(875),n=r.n(o),l=window.wp.components,a=window.lodash;const i=(e,t)=>(0,a.mapKeys)({backgroundColor:e.backgroundColor||"#ffffff",buttonColor:e.buttonColor||t.accentColor,buttonTextColor:e.buttonTextColor||t.textColorInverted,textColor:e.textColor||t.textColor,textSize:t.textSize,triggerBackgroundColor:e.triggerBackgroundColor||t.accentColor,triggerTextColor:e.triggerTextColor||t.textColorInverted},((e,t)=>`--crowdsignal-forms-${(0,a.kebabCase)(t)}`));var s=r(202),c=r.n(s),d=window.wp.compose;const u=e=>{let t=window.getComputedStyle(e).backgroundColor;for(;"rgba(0, 0, 0, 0)"===t&&e.parentNode&&e.parentNode.nodeType===window.Node.ELEMENT_NODE;)e=e.parentNode,t=window.getComputedStyle(e).backgroundColor;return t},f=()=>(0,e.createElement)("div",{className:"crowdsignal-forms__style-probe"},(0,e.createElement)("p",null),(0,e.createElement)("h3",null,"Text"),(0,e.createElement)("div",{className:"wp-block-button"},(0,e.createElement)("div",{className:"wp-block-button__link"})),(0,e.createElement)("div",{className:"entry-content"},(0,e.createElement)("div",{className:"alignwide"}))),g=e=>{if(null===e)return{};const t=e.querySelector(".wp-block-button__link"),r=e.querySelector("p"),o=e.querySelector("h3"),n=e.querySelector(".alignwide");let l=u(t);const a=u(r),i=window.getComputedStyle(r).color;if(l===a){l=(s=t,"0px"!==window.getComputedStyle(s).borderBlockStartWidth?window.getComputedStyle(s).borderBlockStartColor:null)||i}var s;return{accentColor:l,backgroundColor:a,textColor:i,textColorInverted:window.getComputedStyle(t).color,textFont:window.getComputedStyle(r).fontFamily,textSize:window.getComputedStyle(r).fontSize,headingFont:window.getComputedStyle(o).fontFamily,contentWideWidth:window.getComputedStyle(n).maxWidth}};var m=window.wp.htmlEntities,p=window.wp.i18n,b=()=>(0,e.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("path",{d:"M17.7049 7.70504L16.2949 6.29504L11.9999 10.59L7.70492 6.29504L6.29492 7.70504L10.5899 12L6.29492 16.295L7.70492 17.705L11.9999 13.41L16.2949 17.705L17.7049 16.295L13.4099 12L17.7049 7.70504Z"}));const w="question",h="submit",y=(Object.freeze({OPEN:"open",CLOSED:"closed",CLOSED_AFTER:"closed-after"}),Object.freeze({CLICK:"click",HOVER:"hover",PAGE_LOAD:"load"}));var v=(0,t.forwardRef)((({attributes:r,className:o,isOpen:l,onClick:a,onToggle:i},s)=>{(0,t.useLayoutEffect)(i,[l]),(0,t.useEffect)((()=>{l||r.toggleOn!==y.PAGE_LOAD||a()}),[]);const c=(0,t.useCallback)((()=>{l||r.toggleOn!==y.HOVER||a()}),[r.toggleOn,l]),d=n()("crowdsignal-forms-feedback__trigger","wp-block-button__link",o,{"is-active":l});return(0,e.createElement)("div",{className:"wp-block-button crowdsignal-forms-feedback__trigger-wrapper"},!l&&(0,e.createElement)("button",{ref:s,className:d,onClick:a,onMouseEnter:c},(0,e.createElement)("div",{className:"crowdsignal-forms-feedback__trigger-text"},(0,m.decodeEntities)(r.triggerLabel))),l&&(0,e.createElement)("button",{ref:s,className:d,onClick:a},(0,e.createElement)(b,null),(0,p.__)("Close","crowdsignal-forms")))})),k=window.crowdsignalForms.apiFetch,E=r.n(k);var S=({attributes:r,onSubmit:o})=>{const[l,i]=(0,t.useState)(""),[s,c]=(0,t.useState)(""),[d,u]=(0,t.useState)({}),f=n()("crowdsignal-forms-feedback__input",{"is-error":d.feedback}),g=n()("crowdsignal-forms-feedback__input",{"is-error":d.email});return(0,e.createElement)("form",{onSubmit:async e=>{e.preventDefault();const t={feedback:(0,a.isEmpty)(l),email:r.emailRequired&&((0,a.isEmpty)(s)||s.match(/^\s+@\s+$/))};var n,i,c;u(t),t.feedback||t.email||(n=r.surveyId,i={nonce:r.nonce,feedback:l,email:s},c=E()({path:(0,a.trimEnd)(`/crowdsignal-forms/v1/feedback/${n||""}/response`),method:"POST",data:i}),new Promise(((e,t)=>{const r=setTimeout((()=>t(new Error("Request timed out"))),1e4);c.then(e,t).finally((()=>clearTimeout(r)))})),o())}},(0,e.createElement)("h3",{className:"crowdsignal-forms-feedback__header",style:{whiteSpace:"pre-wrap"}},(0,m.decodeEntities)(r.header).split("<br>").join("\n")),(0,e.createElement)("textarea",{className:f,rows:6,placeholder:r.feedbackPlaceholder,value:l,onChange:e=>i(e.target.value)}),(0,e.createElement)("input",{type:"email",className:g,placeholder:r.emailPlaceholder,value:s,onChange:e=>c(e.target.value)}),(0,e.createElement)("div",{className:"wp-block-button crowdsignal-forms-feedback__button-wrapper"},(0,e.createElement)("button",{className:"wp-block-button__link crowdsignal-forms-feedback__feedback-button",type:"submit"},r.submitButtonLabel)))},C=({attributes:t})=>(0,e.createElement)("h3",{className:"crowdsignal-forms-feedback__header",style:{whiteSpace:"pre-wrap"}},(0,m.decodeEntities)(t.submitText).split("<br>").join("\n")),_=({showLogo:t,children:r,message:o,trackRef:n="cs-forms-poll"})=>(0,e.createElement)("div",{className:"crowdsignal-forms__footer-branding"},(0,e.createElement)("a",{className:"crowdsignal-forms__footer-cs-link",href:"https://crowdsignal.com?ref="+n,target:"_blank",rel:"noopener noreferrer"},o||(0,p.__)("Create your own poll with Crowdsignal","crowdsignal-forms")),r,t&&(0,e.createElement)("a",{href:"https://crowdsignal.com?ref="+n,target:"_blank",rel:"noopener noreferrer"},(0,e.createElement)("img",{className:"crowdsignal-forms__footer-branding-logo",src:"https://app.crowdsignal.com/images/svg/cs-logo-dots.svg",alt:"Crowdsignal sticker"}))),O=({attributes:r})=>{const[o,n]=(0,t.useState)(w),[l,a]=(0,t.useState)("auto"),i=(0,t.useRef)(null),s={height:l};return(0,e.createElement)("div",{ref:i,className:"crowdsignal-forms-feedback__popover",style:s},o===w&&(0,e.createElement)(S,{attributes:r,onSubmit:()=>{a(i.current.offsetHeight),n(h)}}),o===h&&(0,e.createElement)(C,{attributes:r}),!r.hideBranding&&(0,e.createElement)(_,{trackRef:"cs-forms-feedback",showLogo:o===h,message:(0,p.__)("Collect your own feedback with Crowdsignal","crowdsignal-forms")}))};const x=(e,t,r)=>({left:"left"===e?r.left:null,right:"right"===e?r.right:null}),N=(e,t,r)=>"center"===e?{top:(window.innerHeight-t)/2,bottom:null}:{top:"top"===e?r.top:null,bottom:"bottom"===e?r.bottom:null};var L,R,j=(L=({attributes:r,fallbackStyles:o,renderStyleProbe:s})=>{const[c,d]=(0,t.useState)({}),u=(0,t.useRef)(null),f=(0,t.useCallback)((()=>{d(((e,t,r,o)=>"center"!==t?e:{...e,left:null!==e.left?e.left-r+o:null,right:null!==e.right?e.right-r+o:null})(((e,t,r,o,n,l=null)=>{let i={left:(0,a.isObject)(n)?n.left:n,right:(0,a.isObject)(n)?n.right:n,top:(0,a.isObject)(n)?n.top:n,bottom:(0,a.isObject)(n)?n.bottom:n};return l&&(i=((e,t)=>({left:e.left+t.x+window.scrollX,right:e.right+(window.innerWidth>t.left+t.width?window.innerWidth-t.left-t.width:0),top:e.top+t.y+window.scrollY,bottom:e.bottom+(window.innerHeight>t.top+t.height?window.innerHeight-t.top-t.height:0)}))(i,l.getBoundingClientRect())),{...x(e,0,i),...N(t,o,i)}})(r.x,r.y,u.current.offsetWidth,"center"===r.y?u.current.offsetWidth:u.current.offsetHeight,{top:20,bottom:20,left:"center"===r.y?0:20,right:"center"===r.y?0:20},document.body),r.y,u.current.offsetWidth,u.current.offsetHeight))}),[r.x,r.y,u.current]);(0,t.useLayoutEffect)((()=>{f()}),[r.x,r.y,f]);const g=n()("crowdsignal-forms-feedback",`align-${r.x}`,{"no-shadow":r.hideTriggerShadow,"is-vertical":"center"===r.y}),m={...c,...i(r,o)};return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:g,style:m},(0,e.createElement)(l.Dropdown,{popoverProps:{className:"crowdsignal-forms-feedback__popover-wrapper",position:(p=r.x,b=r.y,"center"!==b?"":"left"===p?"middle right":"middle left")},renderToggle:({isOpen:t,onToggle:o})=>(0,e.createElement)(v,{ref:u,isOpen:t,onClick:o,onToggle:f,attributes:r}),renderContent:()=>(0,e.createElement)(O,{attributes:r})})),s());var p,b},(R=e=>({fallbackStyles:g(e.querySelector(".crowdsignal-forms__style-probe"))}),(0,d.createHigherOrderComponent)((t=>class extends e.Component{constructor(e){super(e),this.nodeRef=this.props.node,this.state={fallbackStyles:void 0,grabStylesCompleted:!1},this.bindRef=this.bindRef.bind(this)}bindRef(e){e&&(this.nodeRef=e)}componentDidMount(){this.grabFallbackStyles()}componentDidUpdate(){this.grabFallbackStyles()}grabFallbackStyles(){const{grabStylesCompleted:e,fallbackStyles:t}=this.state;if(this.nodeRef&&!e){const e=R(this.nodeRef,this.props);c()(e,t)||this.setState({fallbackStyles:e,grabStylesCompleted:Object.values(e).every(Boolean)})}}render(){const r=(0,e.createElement)(t,{...this.props,...this.state.fallbackStyles});return this.props.node?r:(0,e.createElement)("div",{ref:this.bindRef}," ",r," ")}}),"withFallbackStyles"))((({fallbackStyles:t,...r})=>(0,e.createElement)(L,{fallbackStyles:t||{},renderStyleProbe:()=>t?null:(0,e.createElement)(f,null),...r})))),T=window.ReactDOM;const F=(e,t)=>(0,a.forEach)(document.querySelectorAll(`div[${e}]`),(r=>{try{const o=JSON.parse(r.dataset[(0,a.camelCase)(e.substr(5))]),n=t(o,r);r.removeAttribute(e),(0,T.render)(n,r)}catch(t){console.error("Crowdsignal Forms: Failed to parse block data for: %s",e)}})),M=(e,t)=>{((0,a.isEmpty)(window.CrowdsignalMutationObservers)||!0!==window.CrowdsignalMutationObservers[e])&&(new window.MutationObserver((()=>F(e,t))).observe(document.body,{attributes:!0,attributeFilter:[e],childList:!0,subtree:!0}),(0,a.isEmpty)(window.CrowdsignalMutationObservers)&&(window.CrowdsignalMutationObservers=[]),window.CrowdsignalMutationObservers[e]=!0,F(e,t))};((e,t)=>{if("complete"===document.readyState)return M(e,t);window.addEventListener("load",(()=>M(e,t)))})("data-crowdsignal-feedback",(t=>(0,e.createElement)(j,{attributes:t})))}()}();