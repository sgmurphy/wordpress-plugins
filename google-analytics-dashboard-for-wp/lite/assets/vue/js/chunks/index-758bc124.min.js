import{V as a,a as y,s as d,_ as s,h as f}from"./vendor-e2c2538e.min.js";import{b as n}from"./index-11983aa0.min.js";const E=(e,t,r,o)=>new Promise(l=>{let i=new FormData;i.append("action","exactmetrics_vue_get_report_data"),i.append("nonce",a.prototype.$mi.nonce),i.append("report",t),i.append("start",r),i.append("end",o),e.getters.date.compareReport&&(i.append("compare_report",!0),i.append("compare_end",e.getters.date.compareEnd),i.append("compare_start",e.getters.date.compareStart)),y.post(a.prototype.$mi.ajax,i).then(c=>{l(c.data)}).catch(function(c){e.dispatch("$_app/block",!1,{root:!0});const p=a.prototype.$getUrl("admin-notices","error-verifying-license","https://www.exactmetrics.com/my-account/support");if(c.response){const h=c.response;return a.prototype.$mi_error_toast({title:d(s("Can't load report data. Error: %1$s, %2$s. Please try again in a few minutes. If the issue persists, please %3$scontact our support%4$s team.","google-analytics-dashboard-for-wp"),h.status,h.statusText,'<a target="_blank" href="'+p+'">',"</a>")})}a.prototype.$swal.hideLoading(),a.prototype.$mi_error_toast({allowOutsideClick:!0,allowEscapeKey:!0,title:s("Error loading report data","google-analytics-dashboard-for-wp"),html:c.message})})}),A=e=>{if(typeof e<"u"){const t=parseInt(e.toString().replace(".",""),10);return t.toString().length===1?parseInt(t===1?t+"00":t+"0"):t}},T=e=>{if(typeof e<"u"){let t={};return Object.keys(e).forEach(function(r){let o=r.toString().split("-").join("_");t[o]=e[r]}),t}},v={fetchReportData:E,getFormattedScore:A,keysReplaceHyphensWithUnderscores:T},D=(e,t)=>!a.prototype.$isPro()&&t!=="overview"?null:new Promise(r=>{if(!a.prototype.$mi.authed)return r(!1),e.commit("ENABLE_BLUR"),e.commit("ENABLE_NOAUTH"),!1;if(e.state[t]&&e.state[t].reportcurrentrange&&!e.state.date.compareReport&&e.state[t].reportcurrentrange.startDate===e.state.date.start&&e.state[t].reportcurrentrange.endDate===e.state.date.end)return r(!1),e.commit("DISABLE_BLUR"),!1;a.prototype.$mi_loading_toast(),e.commit("ENABLE_BLUR"),e.dispatch("$_queue/add",()=>v.fetchReportData(e,t,e.state.date.start,e.state.date.end).then(function(o){if(e.commit("SET_IS_LOADED"),o.data.message==="license_level"){u(e),r(!1);return}if(o.success)u(e),e.commit("DISABLE_BLUR"),e.commit("UPDATE_REPORT_DATA",{report:t,data:o.data}),r(!0);else{if(o.data.message==="invalid_grant"){u(e),r(!1),e.commit("ENABLE_REAUTH");return}if(o.data.footer&&o.data.footer==="install_addon"){let l=e.state.required_addon?e.state.required_addon:t;b(e,l).then(function(i){e.rootState.$_widget&&(e.commit("DISABLE_BLUR"),e.commit("$_widget/UPDATE_LOADED",!0,{root:!0}));let c=i?s("activate","google-analytics-dashboard-for-wp"):s("install","google-analytics-dashboard-for-wp");a.prototype.$mi_error_toast({title:!1,html:d(o.data.message,c),footer:'<a href="'+a.prototype.$mi.addons_url+'">'+s("Visit addons page","google-analytics-dashboard-for-wp")+"</a>",report:t}),a.prototype.$swal({icon:"error",customClass:{container:"exactmetrics-swal"},title:s("Report Unavailable","google-analytics-dashboard-for-wp"),html:d(o.data.message,c),allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!1,showCancelButton:!0,confirmButtonText:d(s("%s Addon","google-analytics-dashboard-for-wp"),c.charAt(0).toUpperCase()+c.slice(1)),cancelButtonText:s("Dismiss","google-analytics-dashboard-for-wp")}).then(function(p){p.value&&(i?_(e,e.rootState.$_addons.addons[l]):w(e,l))})})}else o.data.footer&&o.data.footer.indexOf("#/ecommerce")>0?(r(!1),a.prototype.$mi_error_toast({title:!1,html:o.data.message,report:t,showCancelButton:!0,cancelButtonText:s("Go Back To Reports","google-analytics-dashboard-for-wp"),confirmButtonText:s("Enable Enhanced eCommerce","google-analytics-dashboard-for-wp")}).then(function(l){l.value&&(window.location=o.data.footer)})):o.data.type&&o.data.type==="expired_license"?(r(!1),a.prototype.$mi_error_toast({type:"",customClass:{container:"exactmetrics-expired-license-alert-toast"},confirmButtonText:"",title:!1,html:o.data.message,footer:o.data.footer,report:t})):(r(!1),a.prototype.$mi_error_toast({title:!1,html:o.data.message,footer:o.data.footer,report:t,onClose:()=>{if(!o.data.type||o.data.type!=="INVALID_DATE_RANGE"||e.state.date==="last30days")return;const l=a.prototype.$mi_intervals().last30days;e.commit("UPDATE_INTERVAL","last30days"),e.commit("UPDATE_DATE",{start:l.start.format("YYYY-MM-DD"),end:l.end.format("YYYY-MM-DD")}),e.dispatch("getReportData",e.state.activeReport)}}))}}),{root:!0})});function b(e,t){return new Promise(function(r){e.dispatch("$_addons/getAddons","",{root:!0}).then(function(){e.rootState.$_addons.addons[t]&&e.rootState.$_addons.addons[t].installed?r(!0):r(!1)}).catch(function(){r(!1),g()})})}function w(e,t){a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:s("Installing Addon","google-analytics-dashboard-for-wp"),html:s("Please wait","google-analytics-dashboard-for-wp"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading(),e.dispatch("$_addons/installAddon",e.rootState.$_addons.addons[t],{root:!0}).then(function(){_(e,e.rootState.$_addons.addons[t])}).catch(function(){g()})}})}function _(e,t){a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:s("Activating Addon","google-analytics-dashboard-for-wp"),html:s("Please wait","google-analytics-dashboard-for-wp"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading()}}),e.dispatch("$_addons/activateAddon",t,{root:!0}).then(function(){a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:s("Addon Activated","google-analytics-dashboard-for-wp"),html:s("Loading report data","google-analytics-dashboard-for-wp"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading(),setTimeout(function(){window.location.reload()},1e3)}})}).catch(function(r){g(r)})}function g(e){let t=s("Please activate manually","google-analytics-dashboard-for-wp");e.response&&(t=d(s("Error: %1$s, %2$s","google-analytics-dashboard-for-wp"),e.response.status,e.response.statusText)),a.prototype.$swal({icon:"error",customClass:{container:"exactmetrics-swal"},title:s("Error Activating Addon","google-analytics-dashboard-for-wp"),html:t,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,showCancelButton:!0,confirmButtonText:s("View Addons","google-analytics-dashboard-for-wp"),cancelButtonText:s("Dismiss","google-analytics-dashboard-for-wp")}).then(function(r){r.value&&(window.location=a.prototype.$mi.addons_url,a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:s("Redirecting","google-analytics-dashboard-for-wp"),html:s("Please wait","google-analytics-dashboard-for-wp"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading()}}))})}function u(e){e.rootState.$_widget||typeof a.prototype.$swal=="function"&&a.prototype.$swal.close()}const $={getReportData:D,installAddon:w,activateAddon:_},R=e=>e.yearinreview_data,L=e=>e.activeReport,B=e=>e.isLoaded,S=e=>e.blur,U=e=>e.mobileTableExpanded,C=e=>e.overview,P=e=>e.publisher,O=e=>e.ecommerce,Y=e=>e.ecommerce_coupons,I=e=>e.ecommerce_funnel,M=e=>e.queries,N=e=>e.dimensions,k=e=>e.forms,K=e=>e.realtime,q=e=>e.yearinreview,V=e=>e.sitespeed,H=e=>e.sitespeedmobile,F=e=>e.noauth,G=e=>e.reauth,X=e=>e.media,j=e=>e.traffic_overview,Q=e=>e.traffic_landing_pages,W=e=>e.traffic_technology,z=e=>e.traffic_campaign,J=e=>e.traffic_source_medium,Z=e=>e.traffic_social,x=e=>e.engagement_pages,ee=()=>n("overview"),te=()=>n("ecommerce"),ae=()=>n("ecommerce_coupons"),oe=()=>n("dimensions"),re=()=>n("traffic_overview"),se=()=>n("traffic_technology"),ne=()=>n("traffic_landing_pages"),ie=()=>n("traffic_campaign"),le=()=>n("traffic_source_medium"),ce=()=>n("traffic_social"),de=()=>n("publisher"),fe=()=>n("engagement_pages"),me=()=>n("queries"),pe=()=>n("forms"),ue=()=>n("realtime"),_e=()=>n("sitespeed"),ge=()=>n("media");function m(e,t){return e.format("YYYYMMDD")===t.format("YYYYMMDD")?e.format("MMMM D, YYYY"):e.format("MMMM D")+" - "+t.format("MMMM D, YYYY")}function he(e){let t=e.date,r=a.prototype.$mi_intervals();if(r[t.interval]){let o=r[t.interval];t.intervalText=m(o.start,o.end),t.intervalCompareText=m(o.compareStart,o.compareEnd)}else t.intervalText=m(f(t.start),f(t.end)),t.intervalCompareText=m(f(t.compareStart),f(t.compareEnd));return t}const we={yearinreview_data:R,date:he,activeReport:L,isLoaded:B,blur:S,mobileTableExpanded:U,overview:C,publisher:P,ecommerce:O,ecommerce_coupons:Y,ecommerce_funnel:I,queries:M,dimensions:N,forms:k,realtime:K,noauth:F,yearinreview:q,reauth:G,sitespeed:V,sitespeedmobile:H,media:X,traffic_overview:j,traffic_landing_pages:Q,traffic_technology:W,traffic_campaign:z,traffic_source_medium:J,traffic_social:Z,engagement_pages:x,demo_overview:ee,demo_ecommerce:te,demo_ecommerce_coupons:ae,demo_dimensions:oe,demo_traffic_overview:re,demo_traffic_technology:se,demo_traffic_landing_pages:ne,demo_traffic_campaign:ie,demo_traffic_source_medium:le,demo_traffic_social:ce,demo_publisher:de,demo_engagement_pages:fe,demo_queries:me,demo_forms:pe,demo_realtime:ue,demo_sitespeed:_e,demo_media:ge},ye=(e,t)=>{t.report&&t.data&&e[t.report]&&a.set(e,t.report,t.data)},Ee=(e,t)=>{t.start&&t.end&&(a.set(e.date,"start",t.start),a.set(e.date,"end",t.end))},Ae=(e,t)=>{a.set(e.date,"interval",t)},Te=(e,t)=>{a.set(e.date,"text",t)},ve=(e,t)=>{e.activeReport=t},De=e=>{e.isLoaded=!0},be=e=>{e.blur=!0},$e=e=>{e.blur=!1},Re=e=>{e.mobileTableExpanded=!0},Le=e=>{e.mobileTableExpanded=!1},Be=e=>{e.noauth=!0},Se=e=>{e.reauth=!0},Ue=(e,t)=>{e.required_addon=t},Ce=(e,t)=>{e.date={...e.date,...t}},Pe={UPDATE_REPORT_DATA:ye,UPDATE_DATE:Ee,UPDATE_ACTIVE_REPORT:ve,UPDATE_INTERVAL:Ae,UPDATE_DATE_TEXT:Te,SET_IS_LOADED:De,ENABLE_BLUR:be,DISABLE_BLUR:$e,EXPAND_TABLES:Re,CONTRACT_TABLES:Le,ENABLE_NOAUTH:Be,ENABLE_REAUTH:Se,UPDATE_REQUIRED_ADDON:Ue,UPDATE_DATE_STORE:Ce},Oe={yearinreview_data:window.exactmetrics.yearinreview,date:{start:"",end:"",interval:"last30days",text:"",compareText:"",compareReport:!1,compareStart:"",compareEnd:""},blur:!1,activeReport:"overview",mobileTableExpanded:!1,overview:{},publisher:{},ecommerce:{},ecommerce_coupons:{},ecommerce_funnel:{funnel_table:{none:[]},funnel_chart:[]},queries:{},dimensions:{},forms:{},realtime:{},yearinreview:{},sitespeed:{},sitespeedmobile:{},noauth:!1,reauth:!1,isLoaded:!1,media:{line_chart_report:{},video_details_rows:[]},traffic_overview:{},traffic_landing_pages:{},traffic_technology:{},traffic_campaign:{},traffic_source_medium:{},traffic_social:{sessions_chart:{}},engagement_pages:{},required_addon:null},Me={namespaced:!0,state:Oe,actions:$,getters:we,mutations:Pe};export{Me as R,_ as a,v as h,w as i};
