import{V as a,a as w,s as f,_ as s,h as o}from"./vendor-e2c2538e.min.js";import{b as i}from"./index-11983aa0.min.js";const E=(t,e,n,r)=>new Promise(c=>{let d=new FormData;d.append("action","exactmetrics_vue_get_report_data"),d.append("nonce",a.prototype.$mi.nonce),d.append("report",e),d.append("start",n),d.append("end",r),t.getters.date.compareReport&&(d.append("compare_report",!0),d.append("compare_end",t.getters.date.compareEnd),d.append("compare_start",t.getters.date.compareStart)),w.post(a.prototype.$mi.ajax,d).then(l=>{c(l.data)}).catch(function(l){t.dispatch("$_app/block",!1,{root:!0});const p=a.prototype.$getUrl("admin-notices","error-verifying-license","https://www.exactmetrics.com/my-account/support");if(l.response){const y=l.response;return a.prototype.$mi_error_toast({title:f(s("Can't load report data. Error: %1$s, %2$s. Please try again in a few minutes. If the issue persists, please %3$scontact our support%4$s team.","google-analytics-dashboard-for-wp"),y.status,y.statusText,'<a target="_blank" href="'+p+'">',"</a>")})}a.prototype.$swal.hideLoading(),a.prototype.$mi_error_toast({allowOutsideClick:!0,allowEscapeKey:!0,title:s("Error loading report data","google-analytics-dashboard-for-wp"),html:l.message})})}),b=t=>{if(typeof t<"u"){const e=parseInt(t.toString().replace(".",""),10);return e.toString().length===1?parseInt(e===1?e+"00":e+"0"):e}},A=t=>{if(typeof t<"u"){let e={};return Object.keys(t).forEach(function(n){let r=n.toString().split("-").join("_");e[r]=t[n]}),e}},v={fetchReportData:E,getFormattedScore:b,keysReplaceHyphensWithUnderscores:A},T=(t,e)=>!a.prototype.$isPro()&&e!=="overview"?null:new Promise(n=>{if(!a.prototype.$mi.authed)return n(!1),t.commit("ENABLE_BLUR"),t.commit("ENABLE_NOAUTH"),!1;if(t.state[e]&&t.state[e].reportcurrentrange&&!t.state.date.compareReport&&t.state[e].reportcurrentrange.startDate===t.state.date.start&&t.state[e].reportcurrentrange.endDate===t.state.date.end)return n(!1),t.commit("DISABLE_BLUR"),!1;a.prototype.$mi_loading_toast(),t.commit("ENABLE_BLUR"),t.dispatch("$_queue/add",()=>v.fetchReportData(t,e,t.state.date.start,t.state.date.end).then(function(r){if(t.commit("SET_IS_LOADED"),r.data.message==="license_level"){u(t),n(!1);return}if(r.success)u(t),t.commit("DISABLE_BLUR"),t.commit("UPDATE_REPORT_DATA",{report:e,data:r.data}),n(!0);else{if(r.data.message==="invalid_grant"){u(t),n(!1),t.commit("ENABLE_REAUTH");return}if(r.data.footer&&r.data.footer==="install_addon"){let c=t.state.required_addon?t.state.required_addon:e;D(t,c).then(function(d){t.rootState.$_widget&&(t.commit("DISABLE_BLUR"),t.commit("$_widget/UPDATE_LOADED",!0,{root:!0}));let l=d?s("activate","google-analytics-dashboard-for-wp"):s("install","google-analytics-dashboard-for-wp");a.prototype.$mi_error_toast({title:!1,html:f(r.data.message,l),footer:'<a href="'+a.prototype.$mi.addons_url+'">'+s("Visit addons page","google-analytics-dashboard-for-wp")+"</a>",report:e}),a.prototype.$swal({icon:"error",customClass:{container:"exactmetrics-swal"},title:s("Report Unavailable","google-analytics-dashboard-for-wp"),html:f(r.data.message,l),allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!1,showCancelButton:!0,confirmButtonText:f(s("%s Addon","google-analytics-dashboard-for-wp"),l.charAt(0).toUpperCase()+l.slice(1)),cancelButtonText:s("Dismiss","google-analytics-dashboard-for-wp")}).then(function(p){p.value&&(d?_(t,t.rootState.$_addons.addons[c]):h(t,c))})})}else r.data.footer&&r.data.footer.indexOf("#/ecommerce")>0?(n(!1),a.prototype.$mi_error_toast({title:!1,html:r.data.message,report:e,showCancelButton:!0,cancelButtonText:s("Go Back To Reports","google-analytics-dashboard-for-wp"),confirmButtonText:s("Enable Enhanced eCommerce","google-analytics-dashboard-for-wp")}).then(function(c){c.value&&(window.location=r.data.footer)})):r.data.type&&r.data.type==="expired_license"?(n(!1),a.prototype.$mi_error_toast({type:"",customClass:{container:"exactmetrics-expired-license-alert-toast"},confirmButtonText:"",title:!1,html:r.data.message,footer:r.data.footer,report:e})):(n(!1),a.prototype.$mi_error_toast({title:!1,html:r.data.message,footer:r.data.footer,report:e,onClose:()=>{if(!r.data.type||r.data.type!=="INVALID_DATE_RANGE"||t.state.date==="last30days")return;const c=a.prototype.$mi_intervals().last30days;t.commit("UPDATE_INTERVAL","last30days"),t.commit("UPDATE_DATE",{start:c.start.format("YYYY-MM-DD"),end:c.end.format("YYYY-MM-DD")}),t.dispatch("getReportData",t.state.activeReport)}}))}}),{root:!0})});function D(t,e){return new Promise(function(n){t.dispatch("$_addons/getAddons","",{root:!0}).then(function(){t.rootState.$_addons.addons[e]&&t.rootState.$_addons.addons[e].installed?n(!0):n(!1)}).catch(function(){n(!1),g()})})}function h(t,e){a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:s("Installing Addon","google-analytics-dashboard-for-wp"),html:s("Please wait","google-analytics-dashboard-for-wp"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading(),t.dispatch("$_addons/installAddon",t.rootState.$_addons.addons[e],{root:!0}).then(function(){_(t,t.rootState.$_addons.addons[e])}).catch(function(){g()})}})}function _(t,e){a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:s("Activating Addon","google-analytics-dashboard-for-wp"),html:s("Please wait","google-analytics-dashboard-for-wp"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading()}}),t.dispatch("$_addons/activateAddon",e,{root:!0}).then(function(){a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:s("Addon Activated","google-analytics-dashboard-for-wp"),html:s("Loading report data","google-analytics-dashboard-for-wp"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading(),setTimeout(function(){window.location.reload()},1e3)}})}).catch(function(n){g(n)})}function g(t){let e=s("Please activate manually","google-analytics-dashboard-for-wp");t.response&&(e=f(s("Error: %1$s, %2$s","google-analytics-dashboard-for-wp"),t.response.status,t.response.statusText)),a.prototype.$swal({icon:"error",customClass:{container:"exactmetrics-swal"},title:s("Error Activating Addon","google-analytics-dashboard-for-wp"),html:e,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,showCancelButton:!0,confirmButtonText:s("View Addons","google-analytics-dashboard-for-wp"),cancelButtonText:s("Dismiss","google-analytics-dashboard-for-wp")}).then(function(n){n.value&&(window.location=a.prototype.$mi.addons_url,a.prototype.$swal({icon:"info",customClass:{container:"exactmetrics-swal"},title:s("Redirecting","google-analytics-dashboard-for-wp"),html:s("Please wait","google-analytics-dashboard-for-wp"),allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:function(){a.prototype.$swal.showLoading()}}))})}function u(t){t.rootState.$_widget||typeof a.prototype.$swal=="function"&&a.prototype.$swal.close()}const $={getReportData:T,installAddon:h,activateAddon:_},L=t=>t.yearinreview_data,R=t=>t.activeReport,S=t=>t.isLoaded,O=t=>t.blur,B=t=>t.mobileTableExpanded,U=t=>t.overview,C=t=>t.publisher,P=t=>t.ecommerce,Y=t=>t.ecommerce_coupons,k=t=>t.ecommerce_funnel,I=t=>t.queries,M=t=>t.dimensions,N=t=>t.forms,K=t=>t.realtime,q=t=>t.yearinreview,V=t=>t.sitespeed,H=t=>t.sitespeedmobile,F=t=>t.noauth,G=t=>t.reauth,W=t=>t.media,X=t=>t.traffic_overview,j=t=>t.traffic_landing_pages,Q=t=>t.traffic_technology,z=t=>t.traffic_campaign,J=t=>t.traffic_source_medium,Z=t=>t.traffic_social,x=t=>t.engagement_pages,tt=()=>i("overview"),et=()=>i("ecommerce"),at=()=>i("ecommerce_coupons"),ot=()=>i("dimensions"),st=()=>i("traffic_overview"),rt=()=>i("traffic_technology"),nt=()=>i("traffic_landing_pages"),it=()=>i("traffic_campaign"),dt=()=>i("traffic_source_medium"),ct=()=>i("traffic_social"),lt=()=>i("publisher"),ft=()=>i("engagement_pages"),mt=()=>i("queries"),pt=()=>i("forms"),ut=()=>i("realtime"),_t=()=>i("sitespeed"),gt=()=>i("media");function m(t,e){return t.format("YYYYMMDD")===e.format("YYYYMMDD")?t.format("MMMM D, YYYY"):t.format("MMMM D")+" - "+e.format("MMMM D, YYYY")}function yt(t){let e=t.date,n=a.prototype.$mi_intervals();if(n[e.interval]){let r=n[e.interval];e.intervalText=m(r.start,r.end),e.intervalCompareText=m(r.compareStart,r.compareEnd)}else e.intervalText=m(o(e.start),o(e.end)),e.intervalCompareText=m(o(e.compareStart),o(e.compareEnd));return e}const ht={yearinreview_data:L,date:yt,activeReport:R,isLoaded:S,blur:O,mobileTableExpanded:B,overview:U,publisher:C,ecommerce:P,ecommerce_coupons:Y,ecommerce_funnel:k,queries:I,dimensions:M,forms:N,realtime:K,noauth:F,yearinreview:q,reauth:G,sitespeed:V,sitespeedmobile:H,media:W,traffic_overview:X,traffic_landing_pages:j,traffic_technology:Q,traffic_campaign:z,traffic_source_medium:J,traffic_social:Z,engagement_pages:x,demo_overview:tt,demo_ecommerce:et,demo_ecommerce_coupons:at,demo_dimensions:ot,demo_traffic_overview:st,demo_traffic_technology:rt,demo_traffic_landing_pages:nt,demo_traffic_campaign:it,demo_traffic_source_medium:dt,demo_traffic_social:ct,demo_publisher:lt,demo_engagement_pages:ft,demo_queries:mt,demo_forms:pt,demo_realtime:ut,demo_sitespeed:_t,demo_media:gt},wt=(t,e)=>{e.report&&e.data&&t[e.report]&&a.set(t,e.report,e.data)},Et=(t,e)=>{e.start&&e.end&&(a.set(t.date,"start",e.start),a.set(t.date,"end",e.end))},bt=(t,e)=>{a.set(t.date,"interval",e)},At=(t,e)=>{a.set(t.date,"text",e)},vt=(t,e)=>{t.activeReport=e},Tt=t=>{t.isLoaded=!0},Dt=t=>{t.blur=!0},$t=t=>{t.blur=!1},Lt=t=>{t.mobileTableExpanded=!0},Rt=t=>{t.mobileTableExpanded=!1},St=t=>{t.noauth=!0},Ot=t=>{t.reauth=!0},Bt=(t,e)=>{t.required_addon=e},Ut=(t,e)=>{t.date={...t.date,...e}},Ct={UPDATE_REPORT_DATA:wt,UPDATE_DATE:Et,UPDATE_ACTIVE_REPORT:vt,UPDATE_INTERVAL:bt,UPDATE_DATE_TEXT:At,SET_IS_LOADED:Tt,ENABLE_BLUR:Dt,DISABLE_BLUR:$t,EXPAND_TABLES:Lt,CONTRACT_TABLES:Rt,ENABLE_NOAUTH:St,ENABLE_REAUTH:Ot,UPDATE_REQUIRED_ADDON:Bt,UPDATE_DATE_STORE:Ut},Pt={yearinreview_data:window.exactmetrics.yearinreview,date:{start:"",end:"",interval:"last30days",text:"",compareText:"",compareReport:!1,compareStart:"",compareEnd:""},blur:!1,activeReport:"overview",mobileTableExpanded:!1,overview:{},publisher:{},ecommerce:{},ecommerce_coupons:{},ecommerce_funnel:{funnel_table:{none:[]},funnel_chart:[]},queries:{},dimensions:{},forms:{},realtime:{},yearinreview:{},sitespeed:{},sitespeedmobile:{},noauth:!1,reauth:!1,isLoaded:!1,media:{line_chart_report:{},video_details_rows:[]},traffic_overview:{},traffic_landing_pages:{},traffic_technology:{},traffic_campaign:{},traffic_source_medium:{},traffic_social:{sessions_chart:{}},engagement_pages:{},required_addon:null},It={namespaced:!0,state:Pt,actions:$,getters:ht,mutations:Ct},Mt={today:{text:s("Today","google-analytics-dashboard-for-wp"),start:o(),end:o(),interval:"today",compareStart:o().subtract(1,"days"),compareEnd:o().subtract(1,"days")},yesterday:{text:s("Yesterday","google-analytics-dashboard-for-wp"),start:o().subtract(1,"days"),end:o().subtract(1,"days"),interval:"yesterday",compareStart:o().subtract(2,"days"),compareEnd:o().subtract(2,"days")},lastweek:{text:s("Last Week","google-analytics-dashboard-for-wp"),end:o().startOf("week"),start:o().startOf("week").subtract(6,"days"),interval:"lastweek",compareStart:o().startOf("week").subtract(13,"days"),compareEnd:o().startOf("week").subtract(7,"days")},lastmonth:{text:s("Last Month","google-analytics-dashboard-for-wp"),end:o().startOf("month").subtract(1,"days"),start:o().startOf("month").subtract(1,"month"),interval:"lastmonth",compareStart:o().startOf("month").subtract(2,"month"),compareEnd:o().startOf("month").subtract(1,"month").subtract(1,"days")},last7days:{text:s("Last 7 days","google-analytics-dashboard-for-wp"),end:o().subtract(1,"days"),start:o().subtract(7,"days"),interval:"last7days",compareStart:o().subtract(14,"days"),compareEnd:o().subtract(8,"days")},last30days:{text:s("Last 30 days","google-analytics-dashboard-for-wp"),end:o().subtract(1,"days"),start:o().subtract(30,"days"),interval:"last30days",compareStart:o().subtract(60,"days"),compareEnd:o().subtract(31,"days")},last90days:{text:s("Last 90 days","google-analytics-dashboard-for-wp"),end:o().subtract(1,"days"),start:o().subtract(90,"days"),interval:"last90days",compareStart:o().subtract(180,"days"),compareEnd:o().subtract(91,"days")}};export{Mt as D,It as R,_ as a,v as h,h as i};
