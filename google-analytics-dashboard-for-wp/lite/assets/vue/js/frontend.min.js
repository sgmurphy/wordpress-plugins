import{V as o,a as g,n as i,_ as s,k as m,s as v,m as c,i as b,f as x}from"./chunks/vendor-e2c2538e.min.js";import{R as w,D as $}from"./chunks/date-intervals-153fd6db.min.js";import{W as y}from"./chunks/WidgetReportError-f0c116b2.min.js";import{M as C,s as r}from"./chunks/index-f4fe00a5.min.js";const D=e=>new Promise(t=>{let n=new FormData,l=o.prototype.$mi.page_id?o.prototype.$mi.page_id:window.location.pathname;n.append("action","exactmetrics_pageinsights_refresh_report"),n.append("security",o.prototype.$mi.nonce),n.append("report","pageinsights"),n.append("post_id",l),n.append("json",1),g.post(o.prototype.$mi.ajax,n).then(a=>{t(a.data)}).catch(function(a){e.dispatch("$_app/block",!1,{root:!0}),a.response})}),P={fetchReportData:D},R=e=>new Promise(t=>{e.dispatch("$_queue/add",()=>P.fetchReportData(e).then(function(n){if(n.data.message==="license_level"){t(!1);return}n.success?(e.commit("UPDATE_REPORT_DATA",{report:"pageinsights",data:n.data}),t(!0)):(o.prototype.$mi_error_toast(!1,n.data.message,n.data.footer),t(!1))}),{root:!0})}),T={getReportData:R},E=e=>e.date,A=e=>e.pageinsights,S=e=>e.loaded,U=e=>e.error,F=e=>e.noauth,M={date:E,pageinsights:A,loaded:S,error:U,noauth:F},O=(e,t)=>{t.report&&t.data&&e[t.report]&&o.set(e,t.report,t.data)},N=(e,t)=>{t.start&&t.end&&(o.set(e.date,"start",t.start),o.set(e.date,"end",t.end))},L=(e,t)=>{o.set(e.date,"interval",t)},I=(e,t)=>{e.loaded=t},V=(e,t)=>{e.error=t},k=e=>{e.noauth=!0,e.loaded=!0},H={UPDATE_REPORT_DATA:O,UPDATE_DATE:N,UPDATE_INTERVAL:L,UPDATE_LOADED:I,SET_ERROR:V,ENABLE_NOAUTH:k},W={loaded:!1,pageinsights:{},error:!1,noauth:!1},z={namespaced:!0,state:W,actions:T,getters:M,mutations:H},B={name:"FrontendStatsColumn",props:{extraClass:{type:String,default:""},label:String,value:[String,Number]},computed:{columnClass(){return"exactmetrics-stats-column "+this.extraClass}}};var G=function(){var t=this,n=t._self._c;return n("div",{class:t.columnClass},[t.label?n("div",{staticClass:"exactmetrics-stats-label",domProps:{textContent:t._s(t.label)}}):t._e(),t.value?n("div",{staticClass:"exactmetrics-stats-value",domProps:{innerHTML:t._s(t.value)}}):t._e(),t._t("default")],2)},K=[],Y=i(B,G,K,!1,null,null,null,null);const j=Y.exports,q={name:"FrontendUpsell",data(){return{text_button:s("Upgrade to PRO","google-analytics-dashboard-for-wp"),is_admin:this.$mi.is_admin,text_view_reports:s("View All Reports","google-analytics-dashboard-for-wp")}},computed:{upgradeUrl(){return this.$getUpgradeUrl("frontend-reports","admin-bar")},reportsUrl(){return this.$mi.reports_url},canManageOptions(){return!!(this.$mi.roles_manage_options&&this.$mi.roles_manage_options.length!==0)},buttonText(){return!this.$mi.is_admin&&this.canManageOptions?this.text_button:!this.$mi.is_admin&&!this.canManageOptions?this.text_view_reports:this.text_button},buttonLink(){return!this.$mi.is_admin&&this.canManageOptions?this.upgradeUrl:!this.$mi.is_admin&&!this.canManageOptions?this.reportsUrl:this.upgradeUrl}}};var Z=function(){var t=this,n=t._self._c;return n("a",{staticClass:"exactmetrics-button",attrs:{target:"_blank",rel:"noopener",href:t.buttonLink},domProps:{textContent:t._s(t.buttonText)}})},J=[],Q=i(q,Z,J,!1,null,null,null,null);const X=Q.exports,tt={name:"FrontendInfoboxChange",props:{value:String,days:Number,change:Number,color:{default:"green",type:String},direction:{default:"up",type:String}},computed:{compare(){return m("vs. Previous Day",v("vs. Previous %s Days",this.days),this.days,"google-analytics-dashboard-for-wp")},changeClass(){let e="exactmetrics-reports-infobox-prev";return this.change===0?e:e+" exactmetrics-"+this.color},changeText(){return this.change?this.direction===""?this.change+"%":'<span class="exactmetrics-arrow exactmetrics-'+this.direction+" exactmetrics-"+this.color+'"></span> '+this.change+"%":s("No change","google-analytics-dashboard-for-wp")}}};var nt=function(){var t=this,n=t._self._c;return n("div",{staticClass:"exactmetrics-frontend-infobox-change"},[n("div",{class:t.changeClass,domProps:{innerHTML:t._s(t.changeText)}}),t.days?n("div",{staticClass:"exactmetrics-reports-infobox-compare",domProps:{textContent:t._s(t.compare)}}):t._e()])},et=[],st=i(tt,nt,et,!1,null,null,null,null);const ot=st.exports,it={name:"NotificationsIndicator",data(){return{text_view_notifications:s("View notifications","google-analytics-dashboard-for-wp")}},computed:{...c({notifications:"$_notifications/notifications",view_url:"$_notifications/view_url",sidebar_url:"$_notifications/sidebar_url"}),has_notifications(){return this.notifications&&this.notifications.length>0}}};var at=function(){var t=this,n=t._self._c;return n("div",{staticClass:"exactmetrics-notifications-indicator"},[n("a",{attrs:{href:t.sidebar_url,title:t.text_view_notifications}},[n("svg",{attrs:{width:"35",height:"39",viewBox:"0 0 35 39",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"M17.6898 39C20.3431 39 22.4954 36.8177 22.4954 34.125H12.8841C12.8841 36.8177 15.0364 39 17.6898 39ZM33.8706 27.5963C32.4192 26.015 29.7035 23.6361 29.7035 15.8438C29.7035 9.9252 25.6108 5.18731 20.0922 4.02492V2.4375C20.0922 1.09154 19.0164 0 17.6898 0C16.3631 0 15.2873 1.09154 15.2873 2.4375V4.02492C9.76874 5.18731 5.67602 9.9252 5.67602 15.8438C5.67602 23.6361 2.96031 26.015 1.50893 27.5963C1.05818 28.0876 0.858356 28.6749 0.862112 29.25C0.870376 30.4992 1.83721 31.6875 3.27357 31.6875H32.1059C33.5423 31.6875 34.5099 30.4992 34.5174 29.25C34.5212 28.6749 34.3213 28.0869 33.8706 27.5963Z",fill:"#393F4C"}})]),t.has_notifications?n("span",{staticClass:"exactmetrics-notifications-unread",domProps:{textContent:t._s(t.notifications.length)}}):t._e()])])},rt=[],lt=i(it,at,rt,!1,null,null,null,null);const ct=lt.exports,dt={name:"FrontendStatsGeneral",components:{NotificationsIndicator:ct,FrontendInfoboxChange:ot,FrontendUpsell:X,FrontendStatsColumn:j},data(){return{text_insights_for:s("Last 30 Days Analytics for ","google-analytics-dashboard-for-wp"),text_your_website:s("Your Website","google-analytics-dashboard-for-wp"),text_sessions:s("Sessions","google-analytics-dashboard-for-wp"),text_pageviews:s("Pageviews","google-analytics-dashboard-for-wp"),text_session_duration:s("Avg. Duration","google-analytics-dashboard-for-wp"),text_total_users:s("Total Users","google-analytics-dashboard-for-wp")}},computed:{...c({overview:"$_reports/overview"}),text_upsell_title(){return this.$mi.is_admin?s("More data is available","google-analytics-dashboard-for-wp"):s("Want to see page-specific stats?","google-analytics-dashboard-for-wp")},infoboxRange(){return this.overview.infobox&&this.overview.infobox.range?this.overview.infobox.range:0},infoboxSessionsData(){return this.infoboxData("sessions")},infoboxPageviewsData(){return this.infoboxData("pageviews")},infoboxDurationData(){return this.infoboxData("duration")},hasTotalUsersData(){return typeof this.infoboxTotalUsersData.value<"u"},infoboxTotalUsersData(){return this.infoboxData("totalusers")}},methods:{infoboxData(e,t=!1){let n={};return this.overview.infobox&&this.overview.infobox[e]&&(n.change=this.overview.infobox[e].prev,n.value=this.overview.infobox[e].value.toString(),this.overview.infobox[e].prev===0?n.direction="":this.overview.infobox[e].prev>0?(n.direction="up",n.color="green"):(n.direction="down",n.color="red")),t&&(n.direction==="down"?n.color="green":n.color="red"),n}},mounted(){if(!this.$mi.authed){this.$store.commit("$_frontend/ENABLE_NOAUTH");return}this.$store.dispatch("$_reports/getReportData","overview").then(()=>{this.$store.commit("$_frontend/UPDATE_LOADED",!0)})}};var _t=function(){var t=this,n=t._self._c;return t.overview.infobox?n("div",{staticClass:"exactmetrics-frontend-stats-inner"},[n("h3",[n("span",{domProps:{textContent:t._s(t.text_insights_for)}}),n("span",{domProps:{textContent:t._s(t.text_your_website)}})]),n("div",{staticClass:"exactmetrics-frontend-stats-grey-area"},[n("frontend-stats-column",{attrs:{label:t.text_sessions,value:t.overview.infobox.sessions.value}},[n("frontend-infobox-change",{attrs:{change:t.infoboxSessionsData.change,color:t.infoboxSessionsData.color,direction:t.infoboxSessionsData.direction,days:t.infoboxRange}})],1),n("frontend-stats-column",{attrs:{label:t.text_pageviews,value:t.overview.infobox.pageviews.value}},[n("frontend-infobox-change",{attrs:{change:t.infoboxPageviewsData.change,color:t.infoboxPageviewsData.color,direction:t.infoboxPageviewsData.direction,days:t.infoboxRange}})],1),n("frontend-stats-column",{attrs:{label:t.text_session_duration,value:t.overview.infobox.duration.value}},[n("frontend-infobox-change",{attrs:{change:t.infoboxDurationData.change,color:t.infoboxDurationData.color,direction:t.infoboxDurationData.direction,days:t.infoboxRange}})],1),t.hasTotalUsersData?n("frontend-stats-column",{attrs:{label:t.text_total_users,value:t.infoboxTotalUsersData.value}},[n("frontend-infobox-change",{attrs:{change:t.infoboxTotalUsersData.change,color:t.infoboxTotalUsersData.color,direction:t.infoboxTotalUsersData.direction,days:t.infoboxRange}})],1):t._e(),n("frontend-stats-column",{staticClass:"exactmetrics-frontend-column-button"},[n("frontend-upsell")],1),n("frontend-stats-column",{staticClass:"exactmetrics-frontend-column-notifications"},[n("notifications-indicator")],1)],1)]):t._e()},ft=[],ut=i(dt,_t,ft,!1,null,null,null,null);const ht=ut.exports,pt={name:"FrontendStatsContent",components:{FrontendStatsGeneral:ht}};var gt=function(){var t=this,n=t._self._c;return n("div",{staticClass:"exactmetrics-content-lite"},[n("frontend-stats-general")],1)},mt=[],vt=i(pt,gt,mt,!1,null,null,null,null);const bt=vt.exports,xt={name:"FrontendNoAuth",data(){return{text_no_auth:s("Please Setup Website Analytics to See Audience Insights","google-analytics-dashboard-for-wp"),text_auth_label:s("ExactMetrics, the #1 WordPress Analytics Plugin, helps you connect your website with Google Analytics, so you can see how people find and use your website. Over 3 million website owners use ExactMetrics to see the stats that matter and grow their business.","google-analytics-dashboard-for-wp"),text_wizard:s("Connect ExactMetrics and Setup Website Analytics","google-analytics-dashboard-for-wp"),text_learn:s("Learn More","google-analytics-dashboard-for-wp"),wizard_url:this.$mi.wizard_url,learn_link:this.$mi.getting_started_url}}};var wt=function(){var t=this,n=t._self._c;return n("div",{staticClass:"exactmetrics-not-authenticated-notice"},[n("h3",{domProps:{textContent:t._s(t.text_no_auth)}}),n("div",{staticClass:"exactmetrics-settings-input exactmetrics-settings-input-authenticate"},[n("p",{domProps:{textContent:t._s(t.text_auth_label)}}),n("div",[n("a",{staticClass:"exactmetrics-wp-button exactmetrics-wp-button-primary",attrs:{href:t.wizard_url},domProps:{textContent:t._s(t.text_wizard)}}),n("a",{staticClass:"exactmetrics-wp-button",attrs:{href:t.learn_link},domProps:{textContent:t._s(t.text_learn)}})])])])},$t=[],yt=i(xt,wt,$t,!1,null,null,null,null);const Ct=yt.exports,Dt={name:"ModuleFrontendReports",components:{FrontendNoAuth:Ct,WidgetReportError:y,FrontendStatsContent:bt},data(){return{text_insights:"ExactMetrics",statsVisible:!1,page_id:this.$mi.page_id}},created(){const e="$_reports";e in this.$store._modules.root._children||this.$store.registerModule(e,w);const t="$_frontend";t in this.$store._modules.root._children||this.$store.registerModule(t,z)},computed:{...c({reportdata:"$_frontend/pageinsights",loaded:"$_frontend/loaded",error:"$_frontend/error",noauth:"$_frontend/noauth",notifications:"$_notifications/notifications"}),toggleButtonClass(){let e="ab-item ab-empty-item exactmetrics-toggle";return this.statsVisible&&(e+=" exactmetrics-toggle-active"),e},has_notifications(){return this.notifications&&this.notifications.length>0}},methods:{toggleStatsVisibility(){this.statsVisible=!this.statsVisible}}};var Pt=function(){var t=this,n=t._self._c;return n("li",{staticClass:"exactmetrics-adminbar-menu-item",attrs:{id:"wp-admin-bar-exactmetrics_frontend_button"}},[n("div",{class:t.toggleButtonClass,on:{click:t.toggleStatsVisibility}},[n("span",{staticClass:"ab-icon dashicons-before dashicons-chart-bar"}),n("span",{staticClass:"exactmetrics-admin-bar-handle-text",domProps:{textContent:t._s(t.text_insights)}}),t.has_notifications?n("span",{staticClass:"exactmetrics-menu-notification-indicator",domProps:{textContent:t._s(t.notifications.length)}}):t._e()]),t.statsVisible?n("div",{staticClass:"exactmetrics-frontend-stats"},[t.noauth?n("frontend-no-auth"):t.error?n("widget-report-error",{attrs:{error:t.error}}):n("frontend-stats-content"),t.loaded?t._e():n("div",{staticClass:"exactmetrics-frontend-stats-loading"},[t._m(0)])],1):t._e()])},Rt=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"exactmetrics-roller"},[t("div"),t("div"),t("div"),t("div"),t("div"),t("div"),t("div")])}],Tt=i(Dt,Pt,Rt,!1,null,null,null,null);const Et=Tt.exports;const At={install(e,{store:t}){e.prototype.$mi_loading_toast||(e.prototype.$mi_loading_toast=function(){}),e.prototype.$mi_error_toast||(e.prototype.$mi_error_toast=function(n){let{type:l="error",customContainerClass:a="exactmetrics-swal",allowOutsideClick:d=!1,allowEscapeKey:_=!1,allowEnterKey:f=!1,title:u=s("Error","google-analytics-dashboard-for-wp"),html:h=s("Please try again.","google-analytics-dashboard-for-wp"),footer:p=!1}=n;n={type:l,customContainerClass:a,allowOutsideClick:d,allowEscapeKey:_,allowEnterKey:f,title:u,html:h,footer:p},t.commit("$_frontend/SET_ERROR",{title:n.title,content:n.html,footer:n.footer})}),e.prototype.$mi_intervals=function(){return $}}};window.addEventListener("load",function(){const e=document.getElementById("wp-admin-bar-exactmetrics_frontend_button");o.config.productionTip=!1,e&&({}.NODE_ENV!=="production"&&(o.config.devtools=!0,o.config.performance=!0),b({ctrl:!0}),o.use(C),o.use(At,{store:r}),x(window.exactmetrics.translations,"google-analytics-dashboard-for-wp"),new o({store:r,mounted:()=>{window.pagenow&&window.pagenow!=="dashboard"&&window.pagenow!=="toplevel_page_exactmetrics_reports"&&r.dispatch("$_queue/add",()=>r.dispatch("$_notifications/getNotifications"))},render:t=>t(Et)}).$mount(e))});
