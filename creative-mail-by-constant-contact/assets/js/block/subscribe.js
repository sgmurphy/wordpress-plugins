(()=>{"use strict";const e=window.wp.blocks;function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function a(e,a){if(e){if("string"==typeof e)return t(e,a);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,a):void 0}}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var a=[],n=!0,l=!1,i=void 0;try{for(var c,s=e[Symbol.iterator]();!(n=(c=s.next()).done)&&(a.push(c.value),!t||a.length!==t);n=!0);}catch(e){l=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(l)throw i}}return a}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const l=window.wp.element,i=window.wp.i18n,c=window.wp.blockEditor,s=window.wp.components;function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){var n,l,i;n=e,l=t,i=a[t],l in n?Object.defineProperty(n,l,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[l]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m="notshow",u="optional",p="required",d="summary",b="message",y="redirect",N=function(e,t){var a=n(React.useState([]),2),l=a[0],i=a[1],c=n(React.useState(!1),2),s=c[0],r=c[1],o=n(React.useState(!1),2),m=o[0],u=o[1];return React.useEffect((function(){var a;s||m||(r(!0),jQuery.post(null===(a=ce4wp_form_submit_data)||void 0===a?void 0:a.url,{action:e,nonce:t}).done((function(e){r(!1),u(!0),null!=(null==e?void 0:e.data)&&i(e.data)})))}),[s,m,l]),{data:l,loading:s,hasLoaded:m}};(0,e.registerBlockType)("ce4wp/subscribe",{edit:function(e){var n=this,r=e.attributes,h=e.setAttributes,E=e.className,v=e.clientId;r.blockId||h({blockId:v});var f,g,w,_=function(){var e,t=N("ce4wp_get_all_custom_lists",null===(e=ce4wp_form_submit_data)||void 0===e?void 0:e.listNonce),a=t.data,n=t.loading,l=t.hasLoaded,i=[];return null!=a&&null!=a.length&&(i=a.map((function(e){return{label:e.name,value:e.id}}))),{customLists:i,loading:n,hasLoaded:l}}().customLists,k=[(g=N("ce4wp_creative_email_activated",null===(f=ce4wp_form_submit_data)||void 0===f?void 0:f.activatedNonce)).data,g.loading,g.hasLoaded][0];return(0,l.createElement)("div",{className:"wp-block-ce4wp-subscribe ".concat(E||"")},(0,l.createElement)(c.BlockControls,{key:"setting"},(0,l.createElement)(c.InspectorControls,{key:"setting"},(0,l.createElement)(s.Panel,{header:"Settings"},(0,l.createElement)(s.PanelBody,{title:"Contact Segmentation",initialOpen:!0},(0,l.createElement)(s.PanelRow,{className:"no-flex"},(0,l.createElement)("fieldset",null,(0,l.createElement)("i",{className:"subTitle sub-header"},(0,i.__)("Automatically assign a new contact to a list when they subscribe","ce4wp"),(0,l.createElement)("br",null),(0,l.createElement)(s.ExternalLink,{onClick:function(){return ce4wpNavigateToDashboard(n,"fbcd9606-288a-4d82-be7c-449eaf5a3792",{source:"ce4wp_form_menu"},ce4wpDashboardStartCallback,ce4wpDashboardFinishCallback)}},(0,l.createElement)("span",{id:"ce4wp-manage-lists","data-link_reference":"836b20fc-9ff1-41b2-912b-a8646caf05a4"},(0,i.__)("Manage your lists","ce4wp")))),(0,l.createElement)("br",null),(0,l.createElement)("br",null),(0,l.createElement)(s.SelectControl,{label:"list",value:r.customList,options:[{label:(0,i.__)("Don't assign to a list","cewp4"),value:""}].concat((w=_,function(e){if(Array.isArray(e))return t(e)}(w)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(w)||a(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),onChange:function(e){return h({customList:e})}})))),(0,l.createElement)(s.PanelBody,{title:"On submission",initialOpen:!0},(0,l.createElement)(s.PanelRow,null,(0,l.createElement)("fieldset",null,(0,l.createElement)(s.SelectControl,{label:"On submission",value:r.onSubmissionSetting,options:[{label:"Show a custom text message",value:b},{label:"Show a summary of submitted fields",value:d},{label:"Redirect",value:y}],onChange:function(e){return h({onSubmissionSetting:e})}}))),r.onSubmissionSetting===b&&(0,l.createElement)(s.PanelRow,null,(0,l.createElement)("fieldset",null,(0,l.createElement)(s.TextareaControl,{label:"Message text",value:r.onSubmission,onChange:function(e){return h({onSubmission:e})}}))),r.onSubmissionSetting===y&&(0,l.createElement)(s.PanelRow,null,(0,l.createElement)("fieldset",null,(0,l.createElement)(s.TextControl,{label:"Redirect link",value:r.redirectLink,onChange:function(e){return h({redirectLink:e})}})))),(0,l.createElement)(s.PanelBody,{title:"Disclaimer settings",initialOpen:!0},(0,l.createElement)(s.PanelRow,{className:"no-flex"},(0,l.createElement)("fieldset",null,(0,l.createElement)(s.SelectControl,{label:"Permission to mail",value:r.emailPermission,options:[{label:"message",value:"message"},{label:"checkbox",value:"checkbox"}],onChange:function(e){return h(o(o({},r),{},{emailPermission:e}))}})))),(0,l.createElement)(s.PanelBody,{title:"Field settings",initialOpen:!0},(0,l.createElement)(s.PanelRow,{className:"no-flex"},(0,l.createElement)("fieldset",null,(0,l.createElement)(s.SelectControl,{label:"First name field",value:r.displayFirstName,options:[{label:"Do not show",value:m},{label:"Optional",value:u},{label:"Required",value:p}],onChange:function(e){return h({displayFirstName:e})}}))),(0,l.createElement)(s.PanelRow,{className:"no-flex"},(0,l.createElement)("fieldset",null,(0,l.createElement)(s.SelectControl,{label:"Last name field",value:r.displayLastName,options:[{label:"Do not show",value:m},{label:"Optional",value:u},{label:"Required",value:p}],onChange:function(e){return h({displayLastName:e})}}))),(0,l.createElement)(s.PanelRow,{className:"no-flex"},(0,l.createElement)("fieldset",null,(0,l.createElement)(s.SelectControl,{label:"Telephone field",value:r.displayTelephone,options:[{label:"Do not show",value:m},{label:"Optional",value:u},{label:"Required",value:p}],onChange:function(e){return h({displayTelephone:e})}}))))))),(0,l.createElement)("form",{name:"contact-form"},(0,l.createElement)(c.RichText,{tagName:"h2",onChange:function(e){h({title:e})},value:r.title}),(0,l.createElement)(c.RichText,{tagName:"p",className:"subTitle",onChange:function(e){h({subTitle:e})},value:r.subTitle}),!1===k&&(0,l.createElement)("div",{className:"ce4wp-inline-notification ce4wp-inline-warning ce4wp-banner-clickable",onClick:function(){return ce4wpNavigateToDashboard(n,"d25f690a-217a-4d68-9c58-8693965d4673",{source:"ce4wp_form_menu"},ce4wpDashboardStartCallback,ce4wpDashboardFinishCallback)}},(0,l.createElement)(s.Dashicon,{className:"ce4wp-inline-warning-icon",icon:"warning"}),(0,l.createElement)("div",{className:"ce4wp-inline-warning-text"},(0,i.__)("Set up Creative Mail before you use this form on your website.")),(0,l.createElement)(s.Dashicon,{className:"ce4wp-inline-warning-arrow",icon:"arrow-right-alt2"})),r.displayFirstName!==m&&(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText,{tagName:"label",className:"firstNameLabel",onChange:function(e){h({firstNameLabel:e})},value:r.firstNameLabel}),r.displayFirstName===p&&(0,l.createElement)("p",{className:"required-text subTitle",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{name:"first_name",type:"text"})),r.displayLastName!==m&&(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText,{tagName:"label",className:"lastNameLabel",onChange:function(e){h({lastNameLabel:e})},value:r.lastNameLabel}),r.displayLastName===p&&(0,l.createElement)("p",{className:"required-text subTitle",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{name:"last_name",type:"text"})),r.displayTelephone!==m&&(0,l.createElement)("div",{class:"inputBlock"},(0,l.createElement)(c.RichText,{tagName:"label",className:"lastNameLabel",onChange:function(e){h({telephoneLabel:e})},value:r.telephoneLabel}),r.displayTelephone===p&&(0,l.createElement)("p",{className:"required-text subTitle",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{name:"telephone",type:"text"})),(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText,{tagName:"label",className:"emailLabel",onChange:function(e){h({emailLabel:e})},value:r.emailLabel}),(0,l.createElement)("p",{className:"required-text subTitle",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{className:"textwidget",name:"email",type:"text"})),"message"==r.emailPermission&&(0,l.createElement)("div",{className:"disclaimer"},(0,l.createElement)(c.RichText,{tagName:"label",className:"disclaimer-text",onChange:function(e){h({disclaimer:e})},value:r.disclaimer})),"checkbox"==r.emailPermission&&(0,l.createElement)("div",{className:"disclaimer"},(0,l.createElement)("input",{type:"checkbox",name:"consent_check_".concat(v),id:"consent_check_".concat(v)}),(0,l.createElement)(c.RichText,{htmlFor:"consent_check_".concat(v),tagName:"label",className:"consentLabel disclaimer-label",onChange:function(e){h({consentLabel:e})},value:r.consentLabel})),(0,l.createElement)("button",{className:"wp-block-button__link submit-button",type:"button"},(0,i.__)("Subscribe","cewp4"))))},save:function(e){var t=e.attributes,a=e.className;return(0,l.createElement)("div",{className:"wp-block-ce4wp-subscribe ".concat(a||"")},(0,l.createElement)("div",{className:"onSubmission",style:{display:"none"}},(0,l.createElement)("input",{className:"onSubmissionSetting",name:"onSubmissionSetting",type:"hidden",value:t.onSubmissionSetting}),t.onSubmissionSetting!==b&&(0,l.createElement)("div",null,(0,l.createElement)(c.RichText.Content,{className:"title",tagName:"h2",value:t.title})),t.onSubmissionSetting===b&&(0,l.createElement)("div",null,(0,l.createElement)(c.RichText.Content,{className:"title",tagName:"h2",value:t.title}),(0,l.createElement)("p",{className:"subTitle"},t.onSubmission)),t.onSubmissionSetting===d&&(0,l.createElement)("div",null,(0,l.createElement)("h3",null,"You have subscribed"),(0,l.createElement)("br",null),(t.displayFirstName!==m||t.displayLastName!==m)&&(0,l.createElement)("p",null,(0,l.createElement)("span",null,"Name: "),(0,l.createElement)("span",{className:"firstNameSummary"}),(0,l.createElement)("span",{className:"lastNameSummary"})),t.displayTelephone!==m&&(0,l.createElement)("p",null,(0,l.createElement)("span",null,"Telephone: "),(0,l.createElement)("span",{className:"telephoneSummary"})),(0,l.createElement)("p",null,(0,l.createElement)("span",null,"Email: "),(0,l.createElement)("span",{className:"emailSummary"}))),t.onSubmissionSetting===y&&(0,l.createElement)("input",{className:"redirect",name:"redirect",type:"hidden",value:t.redirectLink})),(0,l.createElement)("form",{className:"cm-contact-form",name:"contact-form"},(0,l.createElement)("input",{className:"list_id",name:"list_id",type:"hidden",value:t.customList}),(0,l.createElement)(c.RichText.Content,{className:"title",tagName:"h2",value:t.title})," ",(0,l.createElement)(c.RichText.Content,{className:"subTitle",tagName:"p",value:t.subTitle}),t.displayFirstName!==m&&(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText.Content,{tagName:"label",value:t.firstNameLabel}),t.displayFirstName===p&&(0,l.createElement)("span",{className:"wp-caption-text required-text",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{className:"firstName",name:"first_name",type:"text",required:t.displayFirstName===p})),t.displayLastName!==m&&(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText.Content,{tagName:"label",value:t.lastNameLabel}),t.displayLastName===p&&(0,l.createElement)("span",{className:"wp-caption-text required-text",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{className:"lastName",name:"last_name",type:"text",required:t.displayLastName===p})),t.displayTelephone!==m&&(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText.Content,{tagName:"label",value:t.telephoneLabel}),t.displayTelephone===p&&(0,l.createElement)("span",{className:"wp-caption-text required-text",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{className:"telephone",name:"telephone",type:"tel",pattern:"[+]?[0-9\\(\\)\\s+-]{5,20}",oninvalid:"setCustomValidity('".concat((0,i.__)("Please enter a valid phone number","creative-mail-by-constant-contact"),"')"),oninput:"setCustomValidity('')",required:t.displayTelephone===p})),(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText.Content,{tagName:"label",value:t.emailLabel}),(0,l.createElement)("span",{className:"wp-caption-text required-text",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{className:"email",name:"email",type:"email",oninvalid:"setCustomValidity('".concat((0,i.__)("Please enter a valid email address","creative-mail-by-constant-contact"),"')"),oninput:"setCustomValidity('')",required:!0})),"message"==t.emailPermission&&(0,l.createElement)("div",{className:"disclaimer"},(0,l.createElement)("input",{className:"consent_check",name:"consent",type:"hidden",checked:!0}),(0,l.createElement)(c.RichText.Content,{tagName:"label",value:t.disclaimer})),"checkbox"==t.emailPermission&&(0,l.createElement)("div",{className:"disclaimer"},(0,l.createElement)("input",{className:"consent_check",name:"consent_check_".concat(t.blockId),id:"consent_check_".concat(t.blockId),type:"checkbox"}),(0,l.createElement)(c.RichText.Content,{htmlFor:"consent_check_".concat(t.blockId),tagName:"label",value:t.consentLabel,className:"disclaimer-label"})),(0,l.createElement)("button",{className:"wp-block-button__link submit-button",type:"submit"},(0,i.__)("Subscribe","creative-mail-by-constant-contact"))))},supports:{alignWide:!1},keywords:[(0,i.__)("contact","creative-mail-by-constant-contact"),(0,i.__)("form","creative-mail-by-constant-contact"),(0,i.__)("email","creative-mail-by-constant-contact"),(0,i.__)("mail","creative-mail-by-constant-contact")],deprecated:[{attributes:{blockId:{type:"string"},title:{type:"string",default:"Subscribe"},subTitle:{type:"string",default:"Sign up for our newsletter and stay up to date"},firstNameLabel:{type:"string",default:"First name"},lastNameLabel:{type:"string",default:"Last name"},emailLabel:{type:"string",default:"Email"},telephoneLabel:{type:"string",default:"Telephone"},emailPermission:{type:"string",default:"checkbox"},displayTelephone:{type:"string",default:"notshow"},displayFirstName:{type:"string",default:"optional"},displayLastName:{type:"string",default:"optional"},onSubmission:{type:"string",selector:"div",default:"Thank you for subscribing!"},customList:{type:"string",default:null}},save:function(e){var t=e.attributes,a=e.className;return(0,l.createElement)("div",{className:"wp-block-ce4wp-subscribe ".concat(a||"")},(0,l.createElement)("div",{className:"onSubmission",style:{display:"none"}},(0,l.createElement)(c.RichText.Content,{className:"title",tagName:"h2",value:t.title}),(0,l.createElement)("p",{className:"subTitle"},t.onSubmission)),(0,l.createElement)("form",{className:"cm-contact-form",name:"contact-form"},(0,l.createElement)("input",{className:"list_id",name:"list_id",type:"hidden",value:t.customList}),(0,l.createElement)(c.RichText.Content,{className:"title",tagName:"h2",value:t.title})," ",(0,l.createElement)(c.RichText.Content,{className:"subTitle",tagName:"p",value:t.subTitle}),t.displayFirstName!==m&&(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText.Content,{tagName:"label",value:t.firstNameLabel}),t.displayFirstName===p&&(0,l.createElement)("span",{className:"wp-caption-text required-text",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{className:"firstName",name:"first_name",type:"text",required:t.displayFirstName===p})),t.displayLastName!==m&&(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText.Content,{tagName:"label",value:t.lastNameLabel}),t.displayLastName===p&&(0,l.createElement)("span",{className:"wp-caption-text required-text",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{className:"lastName",name:"last_name",type:"text",required:t.displayFirstName===p})),t.displayTelephone!==m&&(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText.Content,{tagName:"label",value:t.telephoneLabel}),t.displayTelephone===p&&(0,l.createElement)("span",{className:"wp-caption-text required-text",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{className:"telephone",name:"telephone",type:"tel",pattern:"[+]?[0-9\\(\\)\\s+-]{5,20}",oninvalid:"setCustomValidity('".concat((0,i.__)("Please enter a valid phone number","creative-mail-by-constant-contact"),"')"),oninput:"setCustomValidity('')",required:t.displayFirstName===p})),(0,l.createElement)("div",{className:"inputBlock"},(0,l.createElement)(c.RichText.Content,{tagName:"label",value:t.emailLabel}),(0,l.createElement)("span",{className:"wp-caption-text required-text",style:{color:"#ee0000"}},"*"),(0,l.createElement)("input",{className:"email",name:"email",type:"email",oninvalid:"setCustomValidity('".concat((0,i.__)("Please enter a valid email address","creative-mail-by-constant-contact"),"')"),oninput:"setCustomValidity('')",required:!0})),"message"==t.emailPermission&&(0,l.createElement)("span",{className:"disclaimer"},(0,l.createElement)("input",{className:"consent_check",name:"consent",type:"hidden",checked:!0}),(0,i.__)("By submitting your information, you are granting us permission to email you. You may unsubscribe at any time.","creative-mail-by-constant-contact")),"checkbox"==t.emailPermission&&(0,l.createElement)("span",null,(0,l.createElement)("input",{className:"consent_check",name:"consent_check_".concat(t.blockId),id:"consent_check_".concat(t.blockId),type:"checkbox"}),(0,l.createElement)("label",{htmlFor:"consent_check_".concat(t.blockId),className:"disclaimer"},(0,i.__)("Can we send you an email from time to time?","creative-mail-by-constant-contact"))),(0,l.createElement)("button",{className:"wp-block-button__link submit-button",type:"submit"},(0,i.__)("Subscribe","creative-mail-by-constant-contact"))))}}]})})();