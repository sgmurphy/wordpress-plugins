(()=>{"use strict";var t={d:(e,o)=>{for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{add_to_cart:()=>g,begin_checkout:()=>y,purchase:()=>h,remove_from_cart:()=>w,search:()=>b,select_content:()=>f,view_item:()=>k,view_item_list:()=>v});const o=wcgai.config,r=window.wp.i18n,n=window.wp.hooks,c=(t,e)=>{var o;const r={};return t.variation&&(r.item_variant=t.variation),{item_id:s(t),item_name:t.name,...l(t),quantity:null!==(o=t.quantity)&&void 0!==o?o:e,price:a(t.prices.price,t.prices.currency_minor_unit),...r}},i=(t,e)=>({item_id:s(t),item_name:t.name,item_list_name:e,...l(t),price:a(t.prices.price,t.prices.currency_minor_unit)}),a=(t,e=2)=>parseInt(t,10)/10**e,d=(t,e,o)=>{(0,n.removeAction)(t,e),(0,n.addAction)(t,e,o)},s=t=>{const e=t.extensions?.woocommerce_google_analytics_integration?.identifier;return void 0!==e?e:"product_sku"===o.identifier?t.sku?t.sku:"#"+t.id:t.id},u=t=>t.coupons[0]?.code?{coupon:t.coupons[0]?.code}:{},l=t=>"categories"in t&&t.categories.length?_(t.categories):{},_=t=>Object.fromEntries(t.slice(0,5).map(((t,e)=>[m(e),t.name]))),m=t=>"item_category"+(t>0?t+1:""),p=(t,e,o)=>{var r;return null!==(r=o?.items?.find((({id:e})=>e===t)))&&void 0!==r?r:e?.find((({id:e})=>e===t))},v=({products:t,listName:e=(0,r.__)("Product List","woocommerce-google-analytics-integration")})=>0!==t.length&&{item_list_id:"engagement",item_list_name:(0,r.__)("Viewing products","woocommerce-google-analytics-integration"),items:t.map(((t,o)=>({...i(t,e),index:o+1})))},g=({product:t,quantity:e=1})=>({items:t?[c(t,e)]:[]}),w=({product:t,quantity:e=1})=>({items:t?[c(t,e)]:[]}),y=({storeCart:t})=>({currency:t.totals.currency_code,value:a(t.totals.total_price,t.totals.currency_minor_unit),...u(t),items:t.items.map(c)}),f=({product:t})=>!!t&&{content_type:"product",content_id:s(t)},b=({searchTerm:t})=>({search_term:t}),k=({product:t,listName:e=(0,r.__)("Product List","woocommerce-google-analytics-integration")})=>!!t&&{items:[i(t,e)]},h=({order:t})=>void 0!==t&&{transaction_id:t.id,affiliation:t.affiliation,currency:t.totals.currency_code,value:a(t.totals.total_price,t.totals.currency_minor_unit),tax:a(t.totals.tax_total,t.totals.currency_minor_unit),shipping:a(t.totals.shipping_total,t.totals.currency_minor_unit),items:t.items.map(c)};let A;const $=Object.freeze(new class{constructor(){if(A)throw new Error("Cannot instantiate more than one Tracker");function t(){window.dataLayer.push(arguments)}A=this,window.dataLayer=window.dataLayer||[],window[o.tracker_function_name]=t;for(const e of o.consent_modes||[])t("consent","default",e);t("js",new Date),t("set",`developer_id.${o.developer_id}`,!0),t("config",o.gtag_id,{allow_google_signals:o.allow_google_signals,link_attribution:o.link_attribution,anonymize_ip:o.anonymize_ip,logged_in:o.logged_in,linker:o.linker,custom_map:o.custom_map})}eventHandler(t){const r=e[t];if("function"!=typeof r)throw new Error(`Event ${t} is not supported.`);return function(e){const n=r(e);o.events.includes(t)&&n&&window[o.tracker_function_name]("event",t,n)}}}),H="woocommerce-google-analytics",L="experimental__woocommerce_blocks";d(`${L}-product-render`,H,$.eventHandler("view_item")),d(`${L}-cart-remove-item`,H,$.eventHandler("remove_from_cart")),d(`${L}-checkout-render-checkout-form`,H,$.eventHandler("begin_checkout")),d(`${L}-cart-add-item`,H,(({product:t})=>{$.eventHandler("add_to_cart")({product:t})})),d(`${L}-product-list-render`,H,$.eventHandler("view_item_list")),d(`${L}-product-view-link`,H,$.eventHandler("select_content")),(0,n.removeAction)(`${L}-checkout-submit`,H),(0,n.removeAction)(`${L}-checkout-set-email-address`,H),(0,n.removeAction)(`${L}-checkout-set-phone-number`,H),(0,n.removeAction)(`${L}-checkout-set-billing-address`,H),(0,n.removeAction)(`${L}-cart-set-item-quantity`,H),(0,n.removeAction)(`${L}-product-search`,H),(0,n.removeAction)(`${L}-store-notice-create`,H),window.wcgai.trackClassicPages=function({events:t,cart:e,products:o,product:r,added_to_cart:n,order:c}){const i={storeCart:e,products:o,product:r,order:c};Object.values(null!=t?t:{}).forEach((t=>{"add_to_cart"===t?$.eventHandler(t)({product:n}):$.eventHandler(t)(i)})),document.body.onadded_to_cart=(t,n,c,i)=>{const a=parseInt(i[0].dataset.product_id||i[0].value),d=r?.id===a?r:p(parseInt(a),o,e);d&&$.eventHandler("add_to_cart")({product:d})};const a=()=>{document.querySelectorAll(".woocommerce-cart-form .woocommerce-cart-form__cart-item .remove[data-product_id]").forEach((t=>t.addEventListener("click",d)))};function d(t){$.eventHandler("remove_from_cart")({product:p(parseInt(t.target.dataset.product_id),o,e)})}a();const s=document.body.onupdated_wc_div;document.body.onupdated_wc_div=(...t)=>{"function"==typeof s&&s(...t),a()};const u=document.body.onremoved_from_cart;document.body.onremoved_from_cart=(...t)=>{"function"==typeof u&&u(...t),d({target:t[3][0]})},document.querySelectorAll(".products .product:not(.wp-block-post)")?.forEach((t=>{const r=t.querySelector("a[data-product_id]")?.getAttribute("data-product_id");r&&t.addEventListener("click",(t=>{const n=t.target.closest(".woocommerce-loop-product__link"),c=t.target.classList.contains("button")&&t.target.hasAttribute("data-product_id"),i=t.target.classList.contains("add_to_cart_button")&&!t.target.classList.contains("product_type_variable");(n||c&&!i)&&$.eventHandler("select_content")({product:p(parseInt(r),o,e)})}))})),document.querySelectorAll(".products-block-post-template .product, .wc-block-product-template .product")?.forEach((t=>{const r=t.querySelector("[data-product_id]")?.getAttribute("data-product_id");r&&t.addEventListener("click",(t=>{const n=t.target,c=n.closest(".wc-block-components-product-image a"),i=n.closest(".wp-block-post-title a"),a=n.closest(".wc-block-components-product-button [data-product_id]");a&&a.classList.contains("add_to_cart_button")&&!a.classList.contains("product_type_variable")?$.eventHandler("add_to_cart")({product:p(parseInt(r),o,e)}):(c||a||i)&&$.eventHandler("select_content")({product:p(parseInt(r),o,e)})}))}))}})();