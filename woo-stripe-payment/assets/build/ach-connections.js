(()=>{var e,t={705:(e,t,n)=>{var r=n(994),a=r(n(693)),o=r(n(383)),i=r(n(579)),c=r(n(452)),s=r(n(395)),u=r(n(72)),_=r(n(511)),l=r(n(428)),p=n(86);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t=(0,u.default)(t),(0,c.default)(e,m()?Reflect.construct(t,n||[],(0,u.default)(e).constructor):t.apply(e,n))}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(m=function(){return!!e})()}function y(e){p.BaseGateway.call(this,e),p.CheckoutGateway.call(this)}Object.assign(y.prototype,p.BaseGateway.prototype,p.CheckoutGateway.prototype),new(function(e){function t(e){var n;return(0,o.default)(this,t),(n=f(this,t,[e])).handle_create_account_change(),n}return(0,_.default)(t,e),(0,i.default)(t,[{key:"initialize",value:function(){window.addEventListener("hashchange",this.hashchange.bind(this)),(0,l.default)(document.body).on("payment_method_selected",this.payment_method_selected.bind(this)),(0,l.default)(document.body).on("click","#place_order",this.on_order_pay.bind(this)),(0,l.default)(document.body).on("change","#createaccount",this.handle_create_account_change.bind(this))}},{key:"updated_checkout",value:function(){this.handle_create_account_change()}},{key:"checkout_place_order",value:function(){return this.payment_token_received=!0,(0,s.default)((0,u.default)(t.prototype),"checkout_place_order",this).call(this)}},{key:"on_order_pay",value:function(e){var t=this;if(this.is_gateway_selected())if(this.is_change_payment_method()){var n=this.params,r=n.order_id,a=n.order_key;e.preventDefault(),this.create_setup_intent({order_id:r,order_key:a}).then((function(e){var n=e.setup_intent;t.handle_payment_method_setup({order_id:r,order_key:a,client_secret:n.client_secret})}))}else this.is_current_page("order_pay")&&(e.preventDefault(),this.process_order_pay())}},{key:"handle_next_action",value:function(e){var t=this,n=e.client_secret;this.stripe.collectBankAccountForPayment({clientSecret:n,params:{payment_method_type:"us_bank_account",payment_method_data:{billing_details:{name:this.get_customer_name(this.get_billing_prefix()),email:this.fields.get("billing_email",null)}}}}).then((function(n){var r=n.paymentIntent,a=n.error;if(a)return t.submit_error(a);"requires_confirmation"===r.status?t.do_payment_confirmation(e):t.cancel_payment_processing()}))}},{key:"handle_payment_method_setup",value:function(e){var t=this,n=e.client_secret;this.stripe.collectBankAccountForSetup({clientSecret:n,params:{payment_method_type:"us_bank_account",payment_method_data:{billing_details:{name:this.get_customer_name(this.get_billing_prefix()),email:this.fields.get("billing_email",null)}}}}).then((function(n){var r=n.setupIntent,a=n.error;if(a)return t.submit_error(a);"requires_confirmation"===r.status?t.do_setup_confirmation(e):t.cancel_payment_processing()}))}},{key:"do_payment_confirmation",value:function(e){var t=this,n=e.client_secret,r=e.order_id,a=e.order_key;this.stripe.confirmUsBankAccountPayment(n).then((function(e){var n=e.paymentIntent,o=e.error;if(o)return t.submit_error(o);if("requires_payment_method"===n.status)t.cancel_payment_processing();else{if("requires_action"===n.status)return t.cancel_payment_processing(),t.submit_error({code:"ach_instant_only"});"processing"===n.status&&(t.set_nonce(n.payment_method),t.is_current_page("order_pay")?t.get_form().trigger("submit"):t.process_payment(r,a))}}))}},{key:"do_setup_confirmation",value:function(e){var t=this,n=e.client_secret,r=e.order_id,a=e.order_key;this.stripe.confirmUsBankAccountSetup(n).then((function(e){var n=e.setupIntent,o=e.error;if(o)return t.submit_error(o);if("requires_payment_method"===n.status)t.cancel_payment_processing();else{if("requires_action"===n.status)return t.cancel_payment_processing(),t.submit_error({code:"ach_instant_only"});"succeeded"===n.status&&(t.set_nonce(n.payment_method),t.is_current_page("order_pay")||t.is_change_payment_method()?t.get_form().trigger("submit"):t.process_payment(r,a))}}))}},{key:"hide_place_order",value:function(){}},{key:"show_payment_button",value:function(){this.show_place_order()}},{key:"cancel_payment_processing",value:function(){var e;(0,l.default)(this.container).closest("form").removeClass("processing"),null===(e=(0,l.default)(this.container).closest("form"))||void 0===e||e.unblock()}},{key:"fees_enabled",value:function(){return"1"==this.params.fees_enabled}},{key:"payment_method_selected",value:function(){this.fees_enabled()&&(0,l.default)(document.body).trigger("update_checkout")}},{key:"create_setup_intent",value:function(e){var t=this;return new Promise((function(n,r){l.default.ajax({method:"POST",dataType:"json",data:h({payment_method:t.gateway_id},e),url:t.params.routes.base_path.replace("%s","wc-stripe/v1/subscriptions/setup-intent"),beforeSend:t.ajax_before_send.bind(t)}).done((function(e){e.code?r(e.message):n(e)})).fail((function(e,n,r){t.submit_error(r)}))}))}}])}(y))(wc_stripe_ach_connections_params)},428:e=>{"use strict";e.exports=window.jQuery},86:e=>{"use strict";e.exports=window.wc_stripe}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,n,a,o)=>{if(!n){var i=1/0;for(_=0;_<e.length;_++){for(var[n,a,o]=e[_],c=!0,s=0;s<n.length;s++)(!1&o||i>=o)&&Object.keys(r.O).every((e=>r.O[e](n[s])))?n.splice(s--,1):(c=!1,o<i&&(i=o));if(c){e.splice(_--,1);var u=a();void 0!==u&&(t=u)}}return t}o=o||0;for(var _=e.length;_>0&&e[_-1][2]>o;_--)e[_]=e[_-1];e[_]=[n,a,o]},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={681:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,o,[i,c,s]=n,u=0;if(i.some((t=>0!==e[t]))){for(a in c)r.o(c,a)&&(r.m[a]=c[a]);if(s)var _=s(r)}for(t&&t(n);u<i.length;u++)o=i[u],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(_)},n=self.webpackChunkwoo_stripe_payment=self.webpackChunkwoo_stripe_payment||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=r.O(void 0,[96],(()=>r(705)));a=r.O(a)})();
//# sourceMappingURL=ach-connections.js.map