!function(r,e){function i(t){e.BaseGateway.call(this,t),e.CheckoutGateway.call(this),r(document.body).on("click","#place_order",this.place_order.bind(this)),this.is_current_page("order_pay")&&r("#order_review").on("submit",this.process_order_pay.bind(this)),this.maybe_hide_gateway(),this.process_redirect_params()}function t(t){this.elementType="idealBank",this.confirmation_method="confirmIdealPayment",this.setupActionMethod="confirmIdealSetup",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function n(t){this.elementType="p24Bank",this.confirmation_method="confirmP24Payment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function o(t){this.elementType="iban",this.confirmation_method="confirmSepaDebitPayment",this.setupActionMethod="confirmSepaDebitSetup",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this)),r(document.body).on("change","#createaccount",this.handle_create_account_change.bind(this))}function a(t){this.confirmation_method="confirmKlarnaPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function s(t){this.elementType="fpxBank",this.confirmation_method="confirmFpxPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function h(t){this.confirmation_method="confirmWechatPayPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function p(t){this.elementType="auBankAccount",this.confirmation_method="confirmAuBecsDebitPayment",this.setupActionMethod="confirmAuBecsDebitSetup",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function c(t){this.confirmation_method="confirmGrabPayPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function d(t){this.confirmation_method="confirmAfterpayClearpayPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function m(t){this.confirmation_method="confirmBoletoPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function _(t){this.confirmation_method="confirmOxxoPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function y(t){this.confirmation_method="confirmGiropayPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function l(t){this.confirmation_method="confirmBancontactPayment",this.setupActionMethod="confirmBancontactSetup",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function u(t){this.elementType="epsBank",this.confirmation_method="confirmEpsPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function f(t){this.confirmation_method="confirmAlipayPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function g(t){this.confirmation_method="confirmSofortPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function b(t){this.confirmation_method="confirmAffirmPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function w(t){this.confirmation_method="confirmBlikPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this)),r(document.body).on("keydown",'[name^="blik_code_"]',this.handle_keydown.bind(this)),r(document.body).on("input",'[name^="blik_code_"]',this.handle_input.bind(this))}function v(t){this.confirmation_method="confirmKonbiniPayment",this.generateConfirmationNumber=!1,i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function k(t){this.confirmation_method="confirmPayNowPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function C(t){this.confirmation_method="confirmPromptPayPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function x(t){this.confirmation_method="confirmSwishPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}function E(t){this.confirmation_method="confirmMultibancoPayment",i.call(this,t),window.addEventListener("hashchange",this.hashChange.bind(this))}(i.prototype=r.extend({},e.BaseGateway.prototype,e.CheckoutGateway.prototype)).initialize=function(){this.mount_button()},i.prototype.process_redirect_params=function(){this.hashChange(null)},i.prototype.elementType=null,i.prototype.is_active=function(){return r("#wc_stripe_local_payment_"+this.gateway_id).data("active")},i.prototype.maybe_hide_gateway=function(){this.is_active()?r(this.container).show():(r(this.container).hide(),this.is_gateway_selected()&&r('li[class*="payment_method_stripe_"]').filter(":visible").eq(0).find('[name="payment_method"]').prop("checked",!0).trigger("click"))},i.prototype.createSource=function(){return new Promise(function(e,t){var n=function(t){t.error?this.submit_error(t.error):(this.payment_token_received=!0,this.set_nonce(t.source.id),this.get_form().trigger("submit")),e()}.bind(this);if(null!=this.elementType)if(this.confirmation_method)if(this.confirmation_obj)this.processConfirmation(this.confirmation_obj);else{if(!this.isValidElement())return this.submit_error({code:"empty_element_"+this.params.local_payment_type,message:wc_stripe_messages.empty_element});this.payment_token_received=!0,this.get_form().trigger("submit")}else this.stripe.createSource(this.element,this.getSourceArgs()).then(n)["catch"](function(t){this.submit_error(t.message)}.bind(this));else this.payment_token_received=!0,this.get_form().trigger("submit")}.bind(this))},i.prototype.place_order=function(t){!this.is_gateway_selected()||this.payment_token_received||this.is_saved_method_selected()||(t.preventDefault(),this.is_change_payment_method()?this.process_setup_intent({order_id:this.params.order_id,order_key:this.params.order_key,context:this.get_page()}):this.createSource())},i.prototype.process_setup_intent=function(t){this.block(),this.create_setup_intent(t).then(function(t){this.stripe[this.setupActionMethod](this.client_secret,this.get_confirmation_args(t)).then(function(t){if(t.error)return this.submit_error(t.error.message);this.set_nonce(t.setupIntent.payment_method),this.set_intent(t.setupIntent.id),this.payment_token_received=!0,this.get_form().trigger("submit")}.bind(this))}.bind(this))["catch"](function(t){this.submit_error(t)}.bind(this))["finally"](function(){this.unblock()}.bind(this))},i.prototype.checkout_place_order=function(t){return this.is_saved_method_selected()||this.payment_token_received?e.CheckoutGateway.prototype.checkout_place_order.apply(this,arguments):(this.place_order.apply(this,arguments),!1)},i.prototype.process_order_pay=function(t){this.is_gateway_selected()&&(t.preventDefault(),e.CheckoutGateway.prototype.process_order_pay.apply(this,arguments))},i.prototype.show_payment_button=function(){this.show_place_order()},i.prototype.hide_place_order=function(){},i.prototype.show_place_order=function(){e.CheckoutGateway.prototype.show_place_order.apply(this,arguments),this.payment_token_received&&r("#place_order").text(r("#place_order").data("value"))},i.prototype.getSourceArgs=function(){return{type:this.params.local_payment_type,amount:this.get_total_price_cents(),currency:this.get_currency(),owner:{name:this.get_customer_name(this.get_billing_prefix()),email:this.fields.get("billing_email",null)},redirect:{return_url:this.params.return_url}}},i.prototype.updated_checkout=function(){this.mount_button(),this.maybe_hide_gateway()},i.prototype.mount_button=function(){var t="#wc_stripe_local_payment_"+this.gateway_id;r(t).length&&null!=this.elementType&&(r(t).empty(),this.element||(this.element=this.elements.create(this.elementType,this.params.element_params),this.element.on("change",this.handleElementChange.bind(this))),this.elementEmpty=!0,this.element.mount(t))},i.prototype.handleElementChange=function(t){this.elementEmpty=t.empty},i.prototype.load_external_script=function(t){var e=document.createElement("script");e.type="text/javascript",e.src=t,e.onload=function(){this.script_loaded=!0}.bind(this),document.body.appendChild(e)},i.prototype.hashChange=function(t){var e;this.is_gateway_selected()&&(e=window.location.hash.match(/response=(.*)/))&&(history.pushState({},"",window.location.pathname),e=JSON.parse(window.atob(decodeURIComponent(e[1]))),this.processConfirmation(e))},i.prototype.handle_next_action=function(t){this.processConfirmation(t)},i.prototype.get_error_from_result=function(t){return t.error||(t.paymentIntent&&t.paymentIntent.last_payment_error?t.paymentIntent&&t.paymentIntent.last_payment_error:null)},i.prototype.processConfirmation=function(n){"payment_intent"===n.type?this.stripe[this.confirmation_method](n.client_secret,this.get_confirmation_args(n)).then(function(t){if(t.error||t.paymentIntent&&t.paymentIntent.last_payment_error)return this.after_confirmation_error(t,n),this.confirmation_obj=n,this.payment_token_received=!1,this.submit_error(this.get_error_from_result(t));var e=decodeURI(n.return_url);e+="&"+r.param({_stripe_payment_method:this.gateway_id,payment_intent:t.paymentIntent.id,payment_intent_client_secret:t.paymentIntent.client_secret}),("requires_action"===t.paymentIntent.status||"requires_payment_method"===t.paymentIntent.status)&&-1<["stripe_promptpay","stripe_swish"].indexOf(this.gateway_id)?this.get_form().unblock().removeClass("processing"):window.location.href=decodeURI(e)}.bind(this)):this.stripe[this.setupActionMethod](n.client_secret,this.get_confirmation_args(n)).then(function(t){return t.error?this.submit_error(t.error.message):(this.set_nonce(t.setupIntent.payment_method),this.set_intent(t.setupIntent.id),this.process_payment(n.order_id,n.order_key))}.bind(this))},i.prototype.after_confirmation_error=function(t,e){},i.prototype.get_confirmation_args=function(t){var e={payment_method:{},return_url:(t=void 0===t?{}:t).return_url};return this.elementType&&(e.payment_method[this.params.local_payment_type]=this.element),(e=t.confirmation_args&&Object.keys(t.confirmation_args).length?r.extend({},e,t.confirmation_args):e).payment_method.billing_details||(e.payment_method.billing_details=t.billing_details),e},i.prototype.isValidElement=function(){return!this.element||!this.elementEmpty},i.prototype.delete_order_source=function(){return new Promise(function(e,t){r.ajax({url:this.params.routes.delete_order_source,method:"DELETE",dataType:"json",beforeSend:this.ajax_before_send.bind(this)}).done(function(t){e(t)}.bind(this)).fail(function(){t()}.bind(this))}.bind(this))},i.prototype.update_source=function(n){return new Promise(function(e,t){this.updateSourceXhr&&this.updateSourceXhr.abort(),this.updateSourceXhr=r.ajax({url:this.params.routes.update_source,method:"POST",dataType:"json",data:{_wpnonce:this.params.rest_nonce,updates:n,source_id:this.source.id,client_secret:this.source.client_secret,payment_method:this.gateway_id}}).done(function(t){e(t.source)}.bind(this)).fail(function(){t()})}.bind(this))},h.prototype.processConfirmation=function(e){"payment_intent"===e.type?this.stripe[this.confirmation_method](e.client_secret,this.get_confirmation_args(e)).then(function(t){return t.error?(r("form.checkout").removeClass("processing"),this.submit_error(t.error)):"requires_action"===t.paymentIntent.status?(r("form.checkout").removeClass("processing"),this.unblock()):"requires_payment_method"===t.paymentIntent.status?(this.unblock(),this.submit_error({code:t.paymentIntent.last_payment_error.code})):void(window.location.href=decodeURI(e.confirmation_args.return_url))}.bind(this)):i.prototype.processConfirmation.apply(this,arguments)},o.prototype.updated_checkout=function(t){i.prototype.updated_checkout.apply(this,arguments);var e=r('[name="billing_country"]').val();e&&this.element&&this.element.update({placeholderCountry:e})},g.prototype.get_confirmation_args=function(){var t=i.prototype.get_confirmation_args.apply(this,arguments);return t.payment_method.sofort={country:t.payment_method.billing_details.address.country},t},w.prototype.get_confirmation_args=function(){this.render_timer();var t=i.prototype.get_confirmation_args.apply(this,arguments);return t.payment_method.blik={},t},w.prototype.get_blik_code=function(){var t=document.querySelectorAll('[name^="blik_code_"]'),n="";return t&&t.length&&r.each(t,function(t,e){n+=r(e).val()}),n},w.prototype.handle_keydown=function(t){this.keyCode=t.keyCode;var e=r(t.currentTarget).val();8===this.keyCode?e||this.handle_input(t,!0):e&&this.handle_input(t,!0)},w.prototype.handle_input=function(t,e){var t=r(t.currentTarget).data("blik_index"),t=parseInt(t),n=6;8===this.keyCode?0<t&&e&&(n=t-1):t<5&&(n=t+1),n<6&&r("#blik_code_"+n).focus(),this.keyCode=e?this.keyCode:null},w.prototype.render_timer=function(t,e,n){var i=Date.now()+6e4,o=60;r(".blik-timer-container").show().find("#blik_timer").text(o+"s"),r(".wc-stripe-blik-code-container").hide(),this.timer_id=setInterval(function(){Date.now()>i||0===o?(clearInterval(this.timer_id),r(".blik-timer-container").hide(),r(".wc-stripe-blik-code-container").show()):(o+=-1,r("#blik_timer").text(o+"s"))}.bind(this),1e3)},w.prototype.after_confirmation_error=function(t){clearInterval(this.timer_id),r(".blik-timer-container").hide(),r(".wc-stripe-blik-code-container").show()},v.prototype.get_confirmation_args=function(t){var e=i.prototype.get_confirmation_args.apply(this,arguments);return this.generateConfirmationNumber&&(e.payment_method_options.konbini.confirmation_number=t.confirmation_number),e},v.prototype.after_confirmation_error=function(t){t.error&&t.error.hasOwnProperty("code")&&"payment_intent_konbini_rejected_confirmation_number"===t.error.code&&(this.generateConfirmationNumber=!0)},k.prototype.processConfirmation=function(n){"payment_intent"===n.type?this.stripe[this.confirmation_method](n.client_secret,this.get_confirmation_args(n)).then(function(t){var e;return t.error?(r("form.checkout").removeClass("processing"),this.submit_error(t.error)):"requires_action"===t.paymentIntent.status?(r("form.checkout").removeClass("processing"),this.unblock()):"requires_payment_method"===t.paymentIntent.status?(r("form.checkout").removeClass("processing"),this.unblock(),this.submit_error({code:t.paymentIntent.last_payment_error.code})):(e=decodeURI(n.return_url),e+="&"+r.param({_stripe_payment_method:this.gateway_id,payment_intent:t.paymentIntent.id,payment_intent_client_secret:t.paymentIntent.client_secret}),void(window.location.href=e))}.bind(this)):i.prototype.processConfirmation.apply(this,arguments)},t.prototype=r.extend({},i.prototype,t.prototype),n.prototype=r.extend({},i.prototype,n.prototype),o.prototype=r.extend({},i.prototype,o.prototype),a.prototype=r.extend({},i.prototype,a.prototype),s.prototype=r.extend({},i.prototype,s.prototype),h.prototype=r.extend({},i.prototype,h.prototype),p.prototype=r.extend({},i.prototype,p.prototype),c.prototype=r.extend({},i.prototype,c.prototype),d.prototype=r.extend({},i.prototype,e.Afterpay.prototype,d.prototype),m.prototype=r.extend({},i.prototype,m.prototype),_.prototype=r.extend({},i.prototype,_.prototype),y.prototype=r.extend({},i.prototype,y.prototype),l.prototype=r.extend({},i.prototype,l.prototype),u.prototype=r.extend({},i.prototype,u.prototype),f.prototype=r.extend({},i.prototype,f.prototype),g.prototype=r.extend({},i.prototype,g.prototype),b.prototype=r.extend({},i.prototype,b.prototype),w.prototype=r.extend({},i.prototype,w.prototype),v.prototype=r.extend({},i.prototype,v.prototype),k.prototype=r.extend({},i.prototype,k.prototype),C.prototype=r.extend({},i.prototype,C.prototype),x.prototype=r.extend({},i.prototype,x.prototype),E.prototype=r.extend({},i.prototype,E.prototype);var P,I={ideal:t,p24:n,sepa_debit:o,klarna:a,fpx:s,wechat_pay:h,au_becs_debit:p,grabpay:c,afterpay_clearpay:d,boleto:m,oxxo:_,giropay:y,bancontact:l,eps:u,alipay:f,sofort:g,affirm:b,blik:w,konbini:v,paynow:k,promptpay:C,swish:x,multibanco:E};for(P in wc_stripe_local_payment_params.gateways){var L=wc_stripe_local_payment_params.gateways[P];new(I[L.local_payment_type]||i)(L)}}(jQuery,window.wc_stripe);