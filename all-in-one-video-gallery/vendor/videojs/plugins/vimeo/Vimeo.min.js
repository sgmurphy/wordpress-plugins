!function(e,t){if("object"==typeof exports&&"undefined"!=typeof module){var i=require("video.js");module.exports=t(i.default||i)}else"function"==typeof define&&define.amd?define(["videojs"],function(i){return e.Vimeo2=t(i)}):e.Vimeo2=t(e.videojs)}(this,function(e){"use strict";var t,i,s,a,r,o,h,n=e.getTech("Tech");class l extends n{constructor(e,t){super(e,t),this.vimeoState={state:"UNSTARTED",volume:1,muteVolume:1,muted:!!this.options_.muted,duration:0,buffered:0,currentTime:0,playbackRate:1},this.setPoster(e.poster),this.setSrc(this.options_.source),this.setTimeout((function(){this.el_&&(this.el_.parentNode.className+=" vjs-vimeo",l.isApiReady?this.initVimeoPlayer():l.apiReadyQueue.push(this))}).bind(this))}dispose(){if(this.vimeoPlayer)this.vimeoPlayer.unload&&this.vimeoPlayer.unload(),this.vimeoPlayer.destroy&&this.vimeoPlayer.destroy();else{var e=l.apiReadyQueue.indexOf(this);-1!==e&&l.apiReadyQueue.splice(e,1)}this.vimeoPlayer=null,this.el_.parentNode.className=this.el_.parentNode.className.replace(" vjs-vimeo",""),this.el_.parentNode.removeChild(this.el_),n.prototype.dispose.call(this)}createEl(){var e=document.createElement("div");e.setAttribute("id",this.options_.techId),e.setAttribute("class","vjs-tech");var t=document.createElement("div");if(t.appendChild(e),!this.options_.vimeoControls){var i=document.createElement("div");i.setAttribute("class","vjs-iframe-blocker"),i.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%"),t.appendChild(i)}return t}initVimeoPlayer(){var e={byline:!1,controls:!1,portrait:!1,title:!1,vimeo_logo:!1};if(void 0!==this.options_.byline&&(e.byline=this.options_.byline),void 0!==this.options_.color&&(e.color=this.options_.color.replace(/^#/,"")),void 0!==this.options_.vimeoControls&&(e.controls=this.options_.vimeoControls),void 0!==this.options_.muted&&(e.muted=this.options_.muted),void 0!==this.options_.loop&&(e.loop=this.options_.loop),void 0!==this.options_.playsinline&&(e.playsinline=this.options_.playsinline),void 0!==this.options_.portrait&&(e.portrait=this.options_.portrait),void 0!==this.options_.title&&(e.title=this.options_.title),void 0!==this.options_.vimeo_logo&&(e.vimeo_logo=this.options_.vimeo_logo),void 0!==this.options_.customVars){var t=this.options_.customVars;Object.keys(t).forEach(function(i){e[i]=t[i]})}this.activeVideoUrl=this.url||null,e.url=this.activeVideoUrl,this.vimeoPlayer=new Vimeo.Player(this.options_.techId,e),this.vimeoPlayer.ready().then(()=>{this.onPlayerReady(),["play","playing","pause","ended","bufferstart","waiting","progress","timeupdate","seeking","seeked","durationchange","volumechange","playbackratechange","error"].forEach(e=>{this.vimeoPlayer.on(e,t=>this.onPlayerStateChange(e,t))})})}onPlayerReady(){this.isReady_=!0,this.triggerReady(),this.vimeoState.state="READY",this.trigger("loadstart"),this.trigger("loadedmetadata"),this.trigger("loadeddata"),this.trigger("canplay"),this.trigger("canplaythrough"),this.trigger("volumechange"),this.trigger("ratechange"),this.playOnReady?this.play():this.cueOnReady&&this.activeVideoUrl!==this.url&&(this.cueVideoByUrl_(this.url),this.activeVideoUrl=this.url)}onPlayerStateChange(e,t){switch(e){case"play":this.vimeoState.state="PLAYING",this.trigger("play");break;case"playing":this.vimeoState.state="PLAYING",this.trigger("playing");break;case"pause":this.vimeoState.state="PAUSED",this.trigger("pause");break;case"ended":this.vimeoState.state="ENDED",this.trigger("ended");break;case"bufferstart":case"waiting":this.vimeoState.state="BUFFERING",this.trigger("play"),this.trigger("waiting");break;case"progress":this.vimeoState.buffered=t.percent,this.trigger("progress");break;case"timeupdate":this.vimeoState.currentTime=t.seconds,this.trigger("timeupdate");break;case"seeking":this.isSeeking=!0,this.trigger("seeking");break;case"seeked":this.isSeeking=!1,this.trigger("seeked");break;case"durationchange":this.vimeoState.duration=t.duration,this.trigger("durationchange");break;case"volumechange":this.trigger("volumechange");break;case"playbackratechange":this.vimeoState.playbackRate=t.playbackRate,this.trigger("ratechange");break;case"error":console.log(t)}}error(){return{code:null,message:null}}loadVideoByUrl_(e){this.vimeoPlayer&&this.vimeoPlayer.loadVideo(e).then(e=>{this.play()})}cueVideoByUrl_(e){this.vimeoPlayer&&this.vimeoPlayer.loadVideo(e)}src(e){return e&&this.setSrc({src:e}),this.source}poster(){return this.poster_}setPoster(e){this.poster_=e}setSrc(e){e&&e.src&&(this.source=e,this.url=e.src,this.options_.autoplay?this.isReady_?this.play():(this.trigger("waiting"),this.playOnReady=!0):this.activeVideoUrl!==this.url&&(this.isReady_?(this.cueVideoByUrl_(this.url),this.activeVideoUrl=this.url):this.cueOnReady=!0))}autoplay(){return this.options_.autoplay}setAutoplay(e){this.options_.autoplay=e}loop(){return this.options_.loop}setLoop(e){this.options_.loop=e}play(){this.url&&(this.isReady_?this.activeVideoUrl===this.url?this.vimeoPlayer.play().then(()=>{}).catch(e=>{}):(this.loadVideoByUrl_(this.url),this.activeVideoUrl=this.url):(this.trigger("waiting"),this.playOnReady=!0))}pause(){this.vimeoPlayer&&this.vimeoPlayer.pause().then(()=>{}).catch(e=>{})}paused(){return"PLAYING"!==this.vimeoState.state&&"BUFFERING"!==this.vimeoState.state}currentTime(){return this.vimeoState.currentTime}setCurrentTime(e){this.vimeoPlayer&&(this.vimeoState.currentTime=e,this.vimeoPlayer.setCurrentTime(e).then(()=>{this.vimeoState.currentTime=e}).catch(e=>{}))}seeking(){return this.isSeeking}seekable(){return e.time.createTimeRanges(0,this.vimeoState.duration)}playbackRate(){return this.vimeoState.playbackRate}setPlaybackRate(e){this.vimeoPlayer&&this.vimeoPlayer.setPlaybackRate(e).then(e=>{this.vimeoState.playbackRate=e}).catch(e=>{})}duration(){return this.vimeoState.duration}currentSrc(){return this.source&&this.source.src}ended(){return!!this.vimeoPlayer&&"ENDED"===this.vimeoState.state}volume(){return this.vimeoState.muted?this.vimeoState.muteVolume:this.vimeoState.volume}setVolume(e){this.vimeoPlayer&&("UNSTARTED"!=this.vimeoState.state||!this.vimeoState.muted)&&this.vimeoPlayer.setVolume(e).then(()=>{this.vimeoState.volume=e}).catch(e=>{})}muted(){return!!this.vimeoPlayer&&this.vimeoState.muted}setMuted(e){this.vimeoPlayer&&(e?(this.vimeoState.muteVolume=this.vimeoState.volume,this.setVolume(0)):this.setVolume(this.vimeoState.muteVolume),this.vimeoState.muted=e)}buffered(){return e.time.createTimeRanges(0,this.vimeoState.buffered*this.vimeoState.duration)}networkState(){if(!this.vimeoPlayer)return 0;switch(this.vimeoState.state){case"UNSTARTED":return 0;case"BUFFERING":return 2;default:return 1}}readyState(){if(!this.vimeoPlayer)return 0;switch(this.vimeoState.state){case"UNSTARTED":return 0;case"READY":return 1;case"BUFFERING":return 2;default:return 4}}supportsFullScreen(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled}}if(l.prototype.featuresPlaybackRate=!0,l.prototype.featuresProgressEvents=!0,l.prototype.featuresTimeupdateEvents=!0,l.isSupported=function(){return!0},l.canPlaySource=function(e){return l.canPlayType(e.type)},l.canPlayType=function(e){return"video/vimeo"===e},l.apiReadyQueue=[],"undefined"!=typeof document){t=function e(){l.isApiReady=!0;for(var t=0;t<l.apiReadyQueue.length;++t)l.apiReadyQueue[t].initVimeoPlayer()},i=!1,s=document.createElement("script"),(a=document.getElementsByTagName("script")[0]).parentNode.insertBefore(s,a),s.onload=function(){i||(i=!0,t())},s.onreadystatechange=function(){i||"complete"!==this.readyState&&"loaded"!==this.readyState||(i=!0,t())},s.src="https://player.vimeo.com/api/player.js",r=".vjs-vimeo iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }",o=document.head||document.getElementsByTagName("head")[0],(h=document.createElement("style")).type="text/css",h.styleSheet?h.styleSheet.cssText=r:h.appendChild(document.createTextNode(r)),o.appendChild(h)}void 0!==e.registerTech?e.registerTech("Vimeo2",l):e.registerComponent("Vimeo2",l)});