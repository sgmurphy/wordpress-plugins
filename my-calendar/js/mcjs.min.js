(()=>{(function(e){"use strict";if(e(function(){p(),g();let t=document.querySelectorAll(".mc-main");t&&t.forEach(r=>{r.classList.remove("mcjs")})}),my_calendar.mini==="true"&&(e(".mini .calendar-events").hide(),e(document).on("click",".mini .has-events .trigger",function(t){t.preventDefault();let r=e(this).parents(".has-events").children(".calendar-events");r.toggle(),e(".mini .has-events").children(".trigger").removeClass("active-toggle"),e(".mini .has-events").children().not(".mc-date-container").not(r).hide(),e(this).addClass("active-toggle"),t.stopImmediatePropagation()}),e(document).on("click",".calendar-events .close",function(t){t.preventDefault(),e(this).closest(".mini .has-events").children(".trigger").removeClass("active-toggle"),e(this).closest("div.calendar-events").toggle(),t.stopImmediatePropagation()})),my_calendar.list==="true"&&my_calendar.links==="false"&&(e("li .list-event").hide(),e("li.current-day .list-event").show(),e("li.current-day .event-date .mc-text-button").attr("aria-expanded",!0),e(document).on("click",".event-date button",function(t){return t.preventDefault(),e(this).closest(".mc-events").find(".mc-event").toggle(),e(this).closest(".mc-events").find(".mc-event").is(":visible")?e(this).attr("aria-expanded","true"):e(this).attr("aria-expanded","false"),t.stopImmediatePropagation(),!1})),my_calendar.grid==="true"||my_calendar.list==="true"&&my_calendar.links==="true"){let t=my_calendar.grid==="true"?".calendar-event":".list-event",r=my_calendar.links==="true"&&my_calendar.grid==="true"?".mc-events":t;e(r+" .single-details").hide(),e(document).on("click",r+" .event-title .open",function(s){let i=e(this).parents(".mc-event").children(".details").is(":visible"),a=e(this).attr("aria-controls"),o=e("#"+a);i?e(this).attr("aria-expanded","false"):e(this).attr("aria-expanded","true"),s.preventDefault();let n=e(this).parents(".mc-event").children();e(this).closest(".mc-main").toggleClass("grid-open"),o.toggle();let d=n.find("a, object, :input, iframe, [tabindex]"),m=d.last();return d.first().attr("data-action","shiftforward"),m.attr("data-action","shiftback"),e(r).children(".single-details").not(n).hide(),s.stopImmediatePropagation(),!1}),e(document).on("click",".calendar-event .close",function(s){s.preventDefault(),e(this).parents(".mc-event").find("a.open").attr("aria-expanded","false"),e(this).closest(".mc-main").removeClass("grid-open"),e(this).closest(".mc-event").find(".event-title a").trigger("focus"),e(this).closest("div.single-details").toggle(),s.stopImmediatePropagation()}),e(document).on("keydown",function(s){(s.keyCode?s.keyCode:s.which)==27&&(e(".mc-main ").removeClass("grid-open"),e(".calendar-event div.single-details").hide(),e(".mini .calendar-events").hide())}),e(document).on("keydown",".mc-event a, .mc-event object, .mc-event :input, .mc-event iframe, .mc-event [tabindex]",function(s){let i=s.keyCode?s.keyCode:s.which,a=e(":focus").attr("data-action");!s.shiftKey&&i==9&&a=="shiftback"&&(s.preventDefault(),e("[data-action=shiftforward]").trigger("focus")),s.shiftKey&&i==9&&a=="shiftforward"&&(s.preventDefault(),e("[data-action=shiftback]").trigger("focus"))})}my_calendar.ajax==="true"&&(y(),e(document).on("keydown",".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a)",function(t){t.which===32&&t.preventDefault()}),e(document).on("click keyup",".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a), .my-calendar-header input[type=submit], .my-calendar-footer input[type=submit], .my-calendar-header button:not(.mc-subscribe button), .my-calendar-footer button:not(.mc-subscribe button)",function(t){if(t.preventDefault(),t.type==="click"||t.type==="keyup"&&t.which===32){let r=e(this).attr("id"),s=e(this).closest(".mc-main"),i=s.attr("id"),a="",o="",n="",d="",m="",u="",f="",h="",l;if(this.nodeName==="INPUT"||this.nodeName==="BUTTON"){let c=e(this).parents("form");c.hasClass("mc-date-switcher")&&(a=c.find("select[name=month]").val(),o=c.find("select[name=dy]").val(),n=c.find("select[name=yr]").val()),c.hasClass("mc-categories-switcher")&&(d=c.find("select[name=mcat]").val()),c.hasClass("mc-locations-switcher")&&(m=c.find("select[name=loc]").val()),c.hasClass("mc-access-switcher")&&(u=c.find("select[name=access]").val()),f=c.find("input[name=mcs]").val(),h=e(this).attr("data-href")}else h=e(this).attr("href");try{l=new URL(h),l.searchParams.delete("embed"),l.searchParams.delete("source"),(this.nodeName==="INPUT"||this.nodeName==="BUTTON")&&(a!==""&&(l.searchParams.delete("month"),l.searchParams.delete("dy"),l.searchParams.delete("yr"),l.searchParams.append("month",parseInt(a)),typeof o<"u"&&l.searchParams.append("dy",parseInt(o)),l.searchParams.append("yr",parseInt(n))),d!==""&&(l.searchParams.delete("mcat"),l.searchParams.append("mcat",d)),m!==""&&(l.searchParams.delete("loc"),l.searchParams.delete("ltype"),l.searchParams.append("ltype","id"),l.searchParams.append("loc",m)),u!==""&&(l.searchParams.delete("access"),l.searchParams.append("access",parseInt(u))),l.searchParams.delete("mcs"),f!==""&&typeof f<"u"&&l.searchParams.append("mcs",encodeURIComponent(f)),h=l.toString()),window.history.pushState({},"",l)}catch(c){l=!1}let _=s.height();e("#"+i).html('<div class="mc-loading"></div><div class="loading" style="height:'+_+'px"><span class="screen-reader-text">Loading...</span></div>'),e("#"+i).load(h+" #"+i+" > *",function(c,w,b){w=="error"&&e("#"+i).html(b.status+" "+b.statusText),typeof my_calendar<"u"&&my_calendar.list=="true"&&(my_calendar.links==="false"?(e("li.mc-events").find(".mc-events").hide(),e("li.current-day").children().show()):e("li.mc-events .single-details").hide()),typeof my_calendar<"u"&&my_calendar.grid=="true"&&e(".has-events > .calendar-event").children().not("header").hide(),typeof my_calendar<"u"&&my_calendar.mini=="true"&&e(".mini .has-events").children().not(".mc-date-container").hide(),y(),e("#"+r).trigger("focus");let k=e("#mc_head_"+i).text();wp.a11y.speak(k),p(),g(),v()})}}));function p(){let t=e(".mc-user-time"),r=Intl.DateTimeFormat().resolvedOptions().timeZone,s="",i="";t.each(function(){let a=e(this).text();r===void 0&&(r=e(this).attr("data-label")),a.replace("Z",".000Z")===new Date(a).toISOString()&&e(this).css({display:"none"}),i='<span class="mc-local-time-time">'+new Date(a).toLocaleTimeString().replace(":00 "," ")+"</span>",s='<span class="mc-local-time-date">'+new Date(a).toLocaleDateString()+"</span>",e(this).html('<span class="mc-local-time-label">'+r+":</span> "+s+'<span class="sep">, </span>'+i).attr("data-time",a)})}function y(){e(".my-calendar-header a:not(.mc-print a, .mc-export a), .my-calendar-footer a:not(.mc-print a, .mc-export a)").each(function(){e(this).attr("role","button")})}function g(){let t=e(".mc-subscribe"),r=e(".mc-download");if(t.length>0){let i="mc_control_"+Math.floor(Math.random()*1e3).toString(),a=document.createElement("button");a.setAttribute("type","button"),a.setAttribute("aria-controls",i),a.setAttribute("aria-expanded",!1),a.innerHTML=my_calendar.subscribe+' <span class="dashicons dashicons-arrow-right" aria-hidden="true"></span>',t.find("ul").attr("id",i),t.find("ul").css({display:"none"}),t.prepend(a)}if(r.length>0){let i="mc_control_"+Math.floor(Math.random()*1e3).toString(),a=document.createElement("button");a.setAttribute("type","button"),a.setAttribute("aria-controls",i),a.setAttribute("aria-expanded",!1),a.innerText=my_calendar.export,r.find("ul").attr("id",i),r.find("ul").css({display:"none"}),r.prepend(a)}e(".mc-export button").each(function(){e(this).on("click",function(i){let a=e(this).attr("aria-controls"),o=e("#"+a);o.is(":visible")?(o.css({display:"none"}),e(this).attr("aria-expanded","false"),e(this).find(".dashicons").removeClass("dashicons-arrow-down").addClass("dashicons-arrow-right")):(o.css({display:"block"}),e(this).attr("aria-expanded","true"),e(this).find(".dashicons").removeClass("dashicons-arrow-right").addClass("dashicons-arrow-down"))})})}e(".mc-main a[target=_blank]").append(' <span class="dashicons dashicons-external" aria-hidden="true"></span><span class="screen-reader-text"> '+my_calendar.newWindow+"</span>");function v(){try{let t=document.querySelectorAll(".mc-main.calendar table.my-calendar-table"),r=document.querySelectorAll(".mc-main.calendar table.my-calendar-table thead, .mc-main.calendar table.my-calendar-table tbody, .mc-main.calendar table.my-calendar-table tfoot"),s=document.querySelectorAll(".mc-main.calendar table.my-calendar-table tr"),i=document.querySelectorAll(".mc-main.calendar table.my-calendar-table td"),a=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th"),o=document.querySelectorAll(".mc-main.calendar table.my-calendar-table th[scope=row]");for(let n=0;n<t.length;n++)t[n].setAttribute("role","table");for(let n=0;n<r.length;n++)r[n].setAttribute("role","rowgroup");for(let n=0;n<s.length;n++)s[n].setAttribute("role","row");for(let n=0;n<i.length;n++)i[n].setAttribute("role","cell");for(let n=0;n<a.length;n++)a[n].setAttribute("role","columnheader");for(let n=0;n<o.length;n++)o[n].setAttribute("role","rowheader")}catch(t){console.log("my_calendar_table_aria(): "+t)}}v()})(jQuery);})();
