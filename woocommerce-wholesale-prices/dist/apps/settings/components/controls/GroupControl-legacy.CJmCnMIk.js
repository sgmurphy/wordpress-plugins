System.register(["../../index-legacy.DPQ6n18a.js","../../../../common/settings-store-legacy.CdiTRmyl.js","../../../../common/DataTableControl.vue_vue_type_script_setup_true_lang-legacy.CN4qxNx8.js","../../../../common/index-legacy.D14KrnAq.js","../../../../common/GroupControl.vue_vue_type_style_index_0_scoped_acb2f5d3_lang-legacy.Ba5ylEZA.js","../../../../common/_plugin-vue_export-helper-legacy.DgAO6S8O.js","../../../../common/GroupEditFields.vue_vue_type_script_setup_true_lang-legacy.DKHYtZMi.js","../../../../common/index-legacy.CUNdH6AN.js","../../../../common/FormItemContext-legacy.DxVkbCII.js","../../../../common/createContext-legacy.Br6p6aG5.js","../../../../common/statusUtils-legacy.DZU55vim.js","../../../../common/motion-legacy.DJuHWLJs.js","../../../../common/SearchOutlined-legacy.C67dfslp.js","../../../../common/compact-item-legacy.CJ90dT-1.js","../../../../common/index-legacy.DtD_rFHa.js","../../../../common/isPlainObject-legacy.7GPb9rbP.js","../../../../common/_getPrototype-legacy.D0LW3mPW.js","../../../../common/index-legacy.uHqJdCnV.js","../../../../common/index-legacy.CE-iq_Ow.js","../../../../common/KeyCode-legacy.CYgXvjDm.js","../../../../common/index-legacy.DPUpTeOZ.js","../../../../common/useState-legacy.2KNpATnI.js","../../../../common/index-legacy.CwWBfvRK.js","../../../../common/DownOutlined-legacy.5hrwyqLo.js","../../../../common/isMobile-legacy.u4Sbg_0V.js","../../../../common/warning-legacy.BV4CRm2j.js","../../../../common/index-legacy.CN4NpyOo.js","../../../../common/pickAttrs-legacy.CWpQb6XD.js","../../../../common/slide-legacy.Vn-KekI8.js","../../../../common/useMergedState-legacy.BhAX_xCK.js","../../../../common/index-legacy.DVS7avyj.js","../../../../common/index-legacy.DMk1JnJp.js","../../../../common/ActionButton-legacy.DZZ_7eLr.js","../../../../common/EditOutlined-legacy.BvzjtWiy.js","../../../../common/DeleteOutlined-legacy.DfePoDxB.js","../../../../common/index-legacy.Bf79lq9x.js","../../../../common/index-legacy.HcXjs-qb.js","../../../../common/index-legacy.DNw5JjSd.js","../../../../common/Checkbox-legacy.DQ_ZYWlZ.js","../../../../common/index-legacy.DoC9q07U.js","../../../../common/debounce-legacy.C0j8_2w7.js","../../../../common/cloneDeep-legacy.D8kZilT4.js","../../../../common/_assignValue-legacy.DkvNSkRx.js"],(function(e,l){"use strict";var n,a,o,t,i,u,d,c,s,m,v,r,y,p,f,g,j,_,b,x,h,k,D,O,C,S,U;return{setters:[e=>{n=e.d,a=e.t,o=e.s,t=e.r,i=e.S,u=e.o,d=e.c,c=e.U,s=e.V,m=e.e,v=e.w,r=e.b,y=e.W,p=e.X,f=e.u,g=e.Y,j=e.Z,_=e.a,b=e.f,x=e.h,h=e.i,k=e.n,D=e.$},e=>{O=e.u},e=>{C=e._},e=>{S=e.B},null,e=>{U=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const l=["id"],A={class:"data-table-buttons"},F={class:"data-table"};e("default",U(n({__name:"GroupControl",props:{params:{type:Object,required:!0},conditionalValues:{type:Object,required:!1,default:()=>({})}},emits:["input","fieldData","selectedCondition","conditionalData","selectedDependent","fieldUpdatedData","fieldUpdatedPopupData"],setup(e,{emit:n}){var U,V;const w=e,{params:P}=a(w),E=O(),{selectedConditionKey:G,selectedConditionValue:I,groupData:M}=o(E),q=n,B=P.value,J=B.classes,K=B.id,T=t(B.fields),W=i({fields:T.value}),X=t(B.table.data),Y=B.group_action,Z=t(null===(U=null===(V=B.table)||void 0===V?void 0:V.inline_edit)||void 0===U||U),$=t(!1),N=t([]),Q=t([]);if(void 0!==M.value&&Object.keys(M.value).length>0&&void 0!==M.value[K]&&(X.value=M.value[K]),W.fields)for(const[l,a]of Object.entries(W.fields)){const e=a;N.value[e.id]=e.default}const R=e=>{Object.entries(e).forEach((([e,l])=>{N.value[e]=l}))};void 0!==T.value&&null!==T.value&&(W.fields=T.value.filter((e=>void 0===e.hide||null===e.hide||!e.hide)));const z=e=>{let l="",n="";for(const[a,o]of Object.entries(e))l=a,n=o;W.fields=T.value.filter((e=>{if(void 0!==e.condition&&null!==e.condition){const a=e.condition.find((e=>e.key===l));return"yes"===a.value&&"yes"===n||"no"===a.value&&"no"===n}return!0})),Q.value[l]=n},H=e=>{Object.assign(X.value.filter((l=>e.key===l.key))[0],e),M.value[K]=X.value},L=e=>{X.value=X.value.filter((l=>l.key!==e)),M.value[K]=X.value},ee=e=>{let l="",n="";for(const[a,o]of Object.entries(e))l=a,n=o;W.fields=T.value.filter((e=>{const a=T.value.find((l=>l.id===e.id));if(a){if(void 0!==a.condition&&null!==a.condition){const o=a.condition.find((e=>e.key===l));return!(void 0===o||o.key!==l||(Array.isArray(o.value)||o.value!==n)&&(!Array.isArray(o.value)||!o.value.includes(n))||(void 0!==N.value[a.id]&&null!==N.value[a.id]&&(e.default=N.value[a.id]),void 0!==a.dependent_option&&null!==a.dependent_option&&(e.default=a.dependent_default),0))}return void 0!==N.value[a.id]&&null!==N.value[a.id]&&(e.default=N.value[a.id]),void 0!==a.dependent_option&&null!==a.dependent_option&&(e.default=a.dependent_default),!0}return!1}))},le=e=>{W.fields=T.value.filter((e=>{const l=T.value.find((l=>l.id===e.id));return!(!l||void 0!==l.hide&&null!==l.hide&&l.hide||(void 0!==N.value[l.id]&&null!==N.value[l.id]&&(e.default=N.value[l.id]),void 0!==l.dependent_option&&null!==l.dependent_option&&(e.default=l.dependent_default),0))}))},ne=async()=>{$.value=!0;const e=[{key:"action",value:Y}],l={};let n=0;if(X.value.length>0){let e=X.value.map((e=>e.key));n=Math.max(...e)+1}l.key=n;for(const[o,t]of Object.entries(N.value)){let n=t;"object"==typeof t&&null!==t&&(n=JSON.stringify(t)),e.push({key:o,value:n});let a=t;const i=T.value.find((e=>e.id===o));void 0!==i&&void 0!==i.prefix&&(a=i.prefix+t),l[o]=a}N.value=[];try{"success"===await D(e)&&(X.value.push(l),M.value[K]=X.value,G.value="",I.value="",Z.value||q("fieldUpdatedData",l)),$.value=!1}catch(a){console.error(a)}finally{$.value=!1}};return(e,n)=>(u(),d("div",{id:f(K),class:k(f(J))},[(u(!0),d(c,null,s(W.fields,((e,l)=>(u(),d("div",{key:l},[(u(),m(j,null,{fallback:v((()=>[r(y)])),default:v((()=>[(u(),m(p(f(g)(e.type)),{params:e,"conditional-values":Q.value,onFieldData:R,onConditionalData:z,onSelectedCondition:ee,onSelectedDependent:le},null,40,["params","conditional-values"]))])),_:2},1024))])))),128)),_("div",A,[""!==f(B).button_label?(u(),m(f(S),{key:0,type:"primary",class:"save-group-btn",loading:$.value,onClick:ne},{default:v((()=>[b(x(f(B).button_label),1)])),_:1},8,["loading"])):h("",!0)]),_("div",F,[r(C,{params:f(B).table,data:X.value,"edit-fields":T.value,onFieldUpdatedData:H,onFieldDeletedData:L},null,8,["params","data","edit-fields"])])],10,l))}}),[["__scopeId","data-v-acb2f5d3"]]))}}}));
