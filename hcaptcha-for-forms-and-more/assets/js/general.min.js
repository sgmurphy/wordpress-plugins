(()=>{var e=function(e){var t="#hcaptcha-message",a=e(t),c=e("form.hcaptcha-general"),n=e('[name="hcaptcha_settings[site_key]"]'),o=e('[name="hcaptcha_settings[secret_key]"]'),i=e('[name="hcaptcha_settings[theme]"]'),s=e('[name="hcaptcha_settings[size]"]'),r=e('[name="hcaptcha_settings[language]"]'),h=e('[name="hcaptcha_settings[mode]"]'),l=e('[name="hcaptcha_settings[custom_themes][]"]'),p=e('[name="hcaptcha_settings[config_params]"]'),d=e(".hcaptcha-section-enterprise + table input"),u=c.find("#submit"),f={},g=n.val(),m=o.val(),b=v(d);function v(t){var a=[];return t.each((function(){a.push(e(this).val())})),a}function C(){a.remove(),e('<div id="hcaptcha-message"></div>').insertAfter("#hcaptcha-options h2"),a=e(t)}function O(t,c){a.removeClass(),a.addClass(c+" notice is-dismissible");var n=t.split("\n").map((function(e){return"<p>".concat(e,"</p>")}));a.html(n.join("")),e(document).trigger("wp-updates-notice-added");var o=e("#wpwrap").position().top;e("html, body").animate({scrollTop:a.offset().top-o-parseInt(a.css("margin-bottom"))},1e3)}function j(e){O(e,"notice-success")}function H(e){O(e,"notice-error")}function y(e){var t=Object.assign(hCaptcha.getParams(),e);hCaptcha.setParams(t);var a=document.querySelector("#hcaptcha-options .h-captcha");for(var c in a.innerHTML="",e)a.setAttribute("data-".concat(c),"".concat(e[c]));hCaptcha.bindEvents()}function G(){var e,t=p.val().trim();t=t||null;try{e=JSON.parse(t)}catch(e){return p.css("background-color","#ffabaf"),u.attr("disabled",!0),void H("Bad JSON!")}l.prop("checked")||(e={sitekey:n.val(),theme:i.val(),size:s.val(),hl:r.val()}),y(e)}function k(){n.val()===g&&o.val()===m?(C(),u.attr("disabled",!1)):(H(HCaptchaGeneralObject.checkConfigNotice),u.attr("disabled",!0))}f[HCaptchaGeneralObject.modeLive]=HCaptchaGeneralObject.siteKey,f[HCaptchaGeneralObject.modeTestPublisher]=HCaptchaGeneralObject.modeTestPublisherSiteKey,f[HCaptchaGeneralObject.modeTestEnterpriseSafeEndUser]=HCaptchaGeneralObject.modeTestEnterpriseSafeEndUserSiteKey,f[HCaptchaGeneralObject.modeTestEnterpriseBotDetected]=HCaptchaGeneralObject.modeTestEnterpriseBotDetectedSiteKey,e("#check_config").on("click",(function(t){t.preventDefault(),""!==e(".hcaptcha-general-sample-hcaptcha iframe").attr("data-hcaptcha-response")?function(){C(),u.attr("disabled",!0);var t={action:HCaptchaGeneralObject.checkConfigAction,nonce:HCaptchaGeneralObject.checkConfigNonce,mode:h.val(),siteKey:n.val(),secretKey:o.val(),"h-captcha-response":e('textarea[name="h-captcha-response"]').val()};e.post({url:HCaptchaGeneralObject.ajaxUrl,data:t,beforeSend:function(){return j(HCaptchaGeneralObject.checkingConfigMsg)}}).done((function(e){e.success?(g=n.val(),m=o.val(),b=v(d),j(e.data),u.attr("disabled",!1)):H(e.data)})).fail((function(e){H(e.statusText)})).always((function(){y({})}))}():kaggDialog.confirm({title:HCaptchaGeneralObject.completeHCaptchaTitle,content:HCaptchaGeneralObject.completeHCaptchaContent,type:"info",buttons:{ok:{text:HCaptchaGeneralObject.OKBtnText}},onAction:function(){return window.hCaptchaReset(document.querySelector(".hcaptcha-general-sample-hcaptcha"))}})})),n.on("change",(function(t){y({sitekey:e(t.target).val()}),k()})),o.on("change",(function(){k()})),d.on("change",(function(){JSON.stringify(v(d))===JSON.stringify(b)?(C(),u.attr("disabled",!1)):(H(HCaptchaGeneralObject.checkConfigNotice),u.attr("disabled",!0))})),i.on("change",(function(t){y({theme:e(t.target).val()})})),s.on("change",(function(t){var a=e("#hcaptcha-invisible-notice"),c=e(t.target).val();"invisible"===c?a.show():a.hide(),y({size:c})})),r.on("change",(function(t){y({hl:e(t.target).val()})})),h.on("change",(function(t){var a=e(t.target).val();f.hasOwnProperty(a)&&(a===HCaptchaGeneralObject.modeLive?(n.attr("disabled",!1),o.attr("disabled",!1)):(n.attr("disabled",!0),o.attr("disabled",!0)),y({sitekey:f[a]}))})),l.on("change",(function(){G()})),p.on("blur",(function(){G()})),p.on("focus",(function(){p.css("background-color","unset"),u.attr("disabled",!1)})),e(".hcaptcha-general h3").on("click",(function(t){var a=e(t.currentTarget);a.toggleClass("closed");var c={action:HCaptchaGeneralObject.toggleSectionAction,nonce:HCaptchaGeneralObject.toggleSectionNonce,section:a.attr("class").replaceAll(/(hcaptcha-section-|closed)/g,"").trim(),status:!a.hasClass("closed")};e.post({url:HCaptchaGeneralObject.ajaxUrl,data:c}).done((function(e){e.success||H(e.data)})).fail((function(e){H(e.statusText)}))}))};window.hCaptchaGeneral=e,jQuery(document).ready(e)})();